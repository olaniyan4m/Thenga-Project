(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function n(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(l){if(l.ep)return;l.ep=!0;const u=n(l);fetch(l.href,u)}})();var m0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lm(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function OS(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var n=function r(){var l=!1;try{l=this instanceof r}catch{}return l?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var l=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,l.get?l:{enumerable:!0,get:function(){return i[r]}})}),n}var p0={exports:{}},Rl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv;function BS(){if(pv)return Rl;pv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,l,u){var f=null;if(u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:i,type:r,key:f,ref:l!==void 0?l:null,props:u}}return Rl.Fragment=e,Rl.jsx=n,Rl.jsxs=n,Rl}var gv;function MS(){return gv||(gv=1,p0.exports=BS()),p0.exports}var a=MS(),g0={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xv;function FS(){if(xv)return Ke;xv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.iterator;function S(H){return H===null||typeof H!="object"?null:(H=b&&H[b]||H["@@iterator"],typeof H=="function"?H:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,D={};function k(H,G,z){this.props=H,this.context=G,this.refs=D,this.updater=z||I}k.prototype.isReactComponent={},k.prototype.setState=function(H,G){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,G,"setState")},k.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function q(){}q.prototype=k.prototype;function O(H,G,z){this.props=H,this.context=G,this.refs=D,this.updater=z||I}var L=O.prototype=new q;L.constructor=O,R(L,k.prototype),L.isPureReactComponent=!0;var N=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function E(H,G,z,W,J,Ae){return z=Ae.ref,{$$typeof:i,type:H,key:G,ref:z!==void 0?z:null,props:Ae}}function _(H,G){return E(H.type,G,void 0,void 0,void 0,H.props)}function A(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function w(H){var G={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(z){return G[z]})}var T=/\/+/g;function U(H,G){return typeof H=="object"&&H!==null&&H.key!=null?w(""+H.key):G.toString(36)}function B(){}function ve(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(B,B):(H.status="pending",H.then(function(G){H.status==="pending"&&(H.status="fulfilled",H.value=G)},function(G){H.status==="pending"&&(H.status="rejected",H.reason=G)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function ye(H,G,z,W,J){var Ae=typeof H;(Ae==="undefined"||Ae==="boolean")&&(H=null);var he=!1;if(H===null)he=!0;else switch(Ae){case"bigint":case"string":case"number":he=!0;break;case"object":switch(H.$$typeof){case i:case e:he=!0;break;case v:return he=H._init,ye(he(H._payload),G,z,W,J)}}if(he)return J=J(H),he=W===""?"."+U(H,0):W,N(J)?(z="",he!=null&&(z=he.replace(T,"$&/")+"/"),ye(J,G,z,"",function(be){return be})):J!=null&&(A(J)&&(J=_(J,z+(J.key==null||H&&H.key===J.key?"":(""+J.key).replace(T,"$&/")+"/")+he)),G.push(J)),1;he=0;var qe=W===""?".":W+":";if(N(H))for(var _e=0;_e<H.length;_e++)W=H[_e],Ae=qe+U(W,_e),he+=ye(W,G,z,Ae,J);else if(_e=S(H),typeof _e=="function")for(H=_e.call(H),_e=0;!(W=H.next()).done;)W=W.value,Ae=qe+U(W,_e++),he+=ye(W,G,z,Ae,J);else if(Ae==="object"){if(typeof H.then=="function")return ye(ve(H),G,z,W,J);throw G=String(H),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return he}function Q(H,G,z){if(H==null)return H;var W=[],J=0;return ye(H,W,"","",function(Ae){return G.call(z,Ae,J++)}),W}function ue(H){if(H._status===-1){var G=H._result;G=G(),G.then(function(z){(H._status===0||H._status===-1)&&(H._status=1,H._result=z)},function(z){(H._status===0||H._status===-1)&&(H._status=2,H._result=z)}),H._status===-1&&(H._status=0,H._result=G)}if(H._status===1)return H._result.default;throw H._result}var pe=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function Ce(){}return Ke.Children={map:Q,forEach:function(H,G,z){Q(H,function(){G.apply(this,arguments)},z)},count:function(H){var G=0;return Q(H,function(){G++}),G},toArray:function(H){return Q(H,function(G){return G})||[]},only:function(H){if(!A(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Ke.Component=k,Ke.Fragment=n,Ke.Profiler=l,Ke.PureComponent=O,Ke.StrictMode=r,Ke.Suspense=x,Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Ke.__COMPILER_RUNTIME={__proto__:null,c:function(H){return F.H.useMemoCache(H)}},Ke.cache=function(H){return function(){return H.apply(null,arguments)}},Ke.cloneElement=function(H,G,z){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var W=R({},H.props),J=H.key,Ae=void 0;if(G!=null)for(he in G.ref!==void 0&&(Ae=void 0),G.key!==void 0&&(J=""+G.key),G)!P.call(G,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&G.ref===void 0||(W[he]=G[he]);var he=arguments.length-2;if(he===1)W.children=z;else if(1<he){for(var qe=Array(he),_e=0;_e<he;_e++)qe[_e]=arguments[_e+2];W.children=qe}return E(H.type,J,void 0,void 0,Ae,W)},Ke.createContext=function(H){return H={$$typeof:f,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:u,_context:H},H},Ke.createElement=function(H,G,z){var W,J={},Ae=null;if(G!=null)for(W in G.key!==void 0&&(Ae=""+G.key),G)P.call(G,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(J[W]=G[W]);var he=arguments.length-2;if(he===1)J.children=z;else if(1<he){for(var qe=Array(he),_e=0;_e<he;_e++)qe[_e]=arguments[_e+2];J.children=qe}if(H&&H.defaultProps)for(W in he=H.defaultProps,he)J[W]===void 0&&(J[W]=he[W]);return E(H,Ae,void 0,void 0,null,J)},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(H){return{$$typeof:p,render:H}},Ke.isValidElement=A,Ke.lazy=function(H){return{$$typeof:v,_payload:{_status:-1,_result:H},_init:ue}},Ke.memo=function(H,G){return{$$typeof:m,type:H,compare:G===void 0?null:G}},Ke.startTransition=function(H){var G=F.T,z={};F.T=z;try{var W=H(),J=F.S;J!==null&&J(z,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(Ce,pe)}catch(Ae){pe(Ae)}finally{F.T=G}},Ke.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Ke.use=function(H){return F.H.use(H)},Ke.useActionState=function(H,G,z){return F.H.useActionState(H,G,z)},Ke.useCallback=function(H,G){return F.H.useCallback(H,G)},Ke.useContext=function(H){return F.H.useContext(H)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(H,G){return F.H.useDeferredValue(H,G)},Ke.useEffect=function(H,G,z){var W=F.H;if(typeof z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(H,G)},Ke.useId=function(){return F.H.useId()},Ke.useImperativeHandle=function(H,G,z){return F.H.useImperativeHandle(H,G,z)},Ke.useInsertionEffect=function(H,G){return F.H.useInsertionEffect(H,G)},Ke.useLayoutEffect=function(H,G){return F.H.useLayoutEffect(H,G)},Ke.useMemo=function(H,G){return F.H.useMemo(H,G)},Ke.useOptimistic=function(H,G){return F.H.useOptimistic(H,G)},Ke.useReducer=function(H,G,z){return F.H.useReducer(H,G,z)},Ke.useRef=function(H){return F.H.useRef(H)},Ke.useState=function(H){return F.H.useState(H)},Ke.useSyncExternalStore=function(H,G,z){return F.H.useSyncExternalStore(H,G,z)},Ke.useTransition=function(){return F.H.useTransition()},Ke.version="19.1.1",Ke}var vv;function cm(){return vv||(vv=1,g0.exports=FS()),g0.exports}var X=cm();const LS=lm(X);var x0={exports:{}},Dl={},v0={exports:{}},y0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yv;function VS(){return yv||(yv=1,(function(i){function e(Q,ue){var pe=Q.length;Q.push(ue);e:for(;0<pe;){var Ce=pe-1>>>1,H=Q[Ce];if(0<l(H,ue))Q[Ce]=ue,Q[pe]=H,pe=Ce;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var ue=Q[0],pe=Q.pop();if(pe!==ue){Q[0]=pe;e:for(var Ce=0,H=Q.length,G=H>>>1;Ce<G;){var z=2*(Ce+1)-1,W=Q[z],J=z+1,Ae=Q[J];if(0>l(W,pe))J<H&&0>l(Ae,W)?(Q[Ce]=Ae,Q[J]=pe,Ce=J):(Q[Ce]=W,Q[z]=pe,Ce=z);else if(J<H&&0>l(Ae,pe))Q[Ce]=Ae,Q[J]=pe,Ce=J;else break e}}return ue}function l(Q,ue){var pe=Q.sortIndex-ue.sortIndex;return pe!==0?pe:Q.id-ue.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;i.unstable_now=function(){return u.now()}}else{var f=Date,p=f.now();i.unstable_now=function(){return f.now()-p}}var x=[],m=[],v=1,b=null,S=3,I=!1,R=!1,D=!1,k=!1,q=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function N(Q){for(var ue=n(m);ue!==null;){if(ue.callback===null)r(m);else if(ue.startTime<=Q)r(m),ue.sortIndex=ue.expirationTime,e(x,ue);else break;ue=n(m)}}function F(Q){if(D=!1,N(Q),!R)if(n(x)!==null)R=!0,P||(P=!0,U());else{var ue=n(m);ue!==null&&ye(F,ue.startTime-Q)}}var P=!1,E=-1,_=5,A=-1;function w(){return k?!0:!(i.unstable_now()-A<_)}function T(){if(k=!1,P){var Q=i.unstable_now();A=Q;var ue=!0;try{e:{R=!1,D&&(D=!1,O(E),E=-1),I=!0;var pe=S;try{t:{for(N(Q),b=n(x);b!==null&&!(b.expirationTime>Q&&w());){var Ce=b.callback;if(typeof Ce=="function"){b.callback=null,S=b.priorityLevel;var H=Ce(b.expirationTime<=Q);if(Q=i.unstable_now(),typeof H=="function"){b.callback=H,N(Q),ue=!0;break t}b===n(x)&&r(x),N(Q)}else r(x);b=n(x)}if(b!==null)ue=!0;else{var G=n(m);G!==null&&ye(F,G.startTime-Q),ue=!1}}break e}finally{b=null,S=pe,I=!1}ue=void 0}}finally{ue?U():P=!1}}}var U;if(typeof L=="function")U=function(){L(T)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,ve=B.port2;B.port1.onmessage=T,U=function(){ve.postMessage(null)}}else U=function(){q(T,0)};function ye(Q,ue){E=q(function(){Q(i.unstable_now())},ue)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Q){Q.callback=null},i.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<Q?Math.floor(1e3/Q):5},i.unstable_getCurrentPriorityLevel=function(){return S},i.unstable_next=function(Q){switch(S){case 1:case 2:case 3:var ue=3;break;default:ue=S}var pe=S;S=ue;try{return Q()}finally{S=pe}},i.unstable_requestPaint=function(){k=!0},i.unstable_runWithPriority=function(Q,ue){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var pe=S;S=Q;try{return ue()}finally{S=pe}},i.unstable_scheduleCallback=function(Q,ue,pe){var Ce=i.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Ce+pe:Ce):pe=Ce,Q){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=pe+H,Q={id:v++,callback:ue,priorityLevel:Q,startTime:pe,expirationTime:H,sortIndex:-1},pe>Ce?(Q.sortIndex=pe,e(m,Q),n(x)===null&&Q===n(m)&&(D?(O(E),E=-1):D=!0,ye(F,pe-Ce))):(Q.sortIndex=H,e(x,Q),R||I||(R=!0,P||(P=!0,U()))),Q},i.unstable_shouldYield=w,i.unstable_wrapCallback=function(Q){var ue=S;return function(){var pe=S;S=ue;try{return Q.apply(this,arguments)}finally{S=pe}}}})(y0)),y0}var _v;function US(){return _v||(_v=1,v0.exports=VS()),v0.exports}var _0={exports:{}},vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv;function zS(){if(bv)return vn;bv=1;var i=cm();function e(x){var m="https://react.dev/errors/"+x;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+x+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(x,m,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:b==null?null:""+b,children:x,containerInfo:m,implementation:v}}var f=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(x,m){if(x==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,vn.createPortal=function(x,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return u(x,m,null,v)},vn.flushSync=function(x){var m=f.T,v=r.p;try{if(f.T=null,r.p=2,x)return x()}finally{f.T=m,r.p=v,r.d.f()}},vn.preconnect=function(x,m){typeof x=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(x,m))},vn.prefetchDNS=function(x){typeof x=="string"&&r.d.D(x)},vn.preinit=function(x,m){if(typeof x=="string"&&m&&typeof m.as=="string"){var v=m.as,b=p(v,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,I=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?r.d.S(x,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:I}):v==="script"&&r.d.X(x,{crossOrigin:b,integrity:S,fetchPriority:I,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},vn.preinitModule=function(x,m){if(typeof x=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=p(m.as,m.crossOrigin);r.d.M(x,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(x)},vn.preload=function(x,m){if(typeof x=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,b=p(v,m.crossOrigin);r.d.L(x,v,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},vn.preloadModule=function(x,m){if(typeof x=="string")if(m){var v=p(m.as,m.crossOrigin);r.d.m(x,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(x)},vn.requestFormReset=function(x){r.d.r(x)},vn.unstable_batchedUpdates=function(x,m){return x(m)},vn.useFormState=function(x,m,v){return f.H.useFormState(x,m,v)},vn.useFormStatus=function(){return f.H.useHostTransitionStatus()},vn.version="19.1.1",vn}var Ev;function qS(){if(Ev)return _0.exports;Ev=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),_0.exports=zS(),_0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv;function HS(){if(Sv)return Dl;Sv=1;var i=US(),e=cm(),n=qS();function r(t){var s="https://react.dev/errors/"+t;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var s=t,o=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,(s.flags&4098)!==0&&(o=s.return),t=s.return;while(t)}return s.tag===3?o:null}function f(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function p(t){if(u(t)!==t)throw Error(r(188))}function x(t){var s=t.alternate;if(!s){if(s=u(t),s===null)throw Error(r(188));return s!==t?null:t}for(var o=t,c=s;;){var h=o.return;if(h===null)break;var g=h.alternate;if(g===null){if(c=h.return,c!==null){o=c;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===o)return p(h),t;if(g===c)return p(h),s;g=g.sibling}throw Error(r(188))}if(o.return!==c.return)o=h,c=g;else{for(var j=!1,M=h.child;M;){if(M===o){j=!0,o=h,c=g;break}if(M===c){j=!0,c=h,o=g;break}M=M.sibling}if(!j){for(M=g.child;M;){if(M===o){j=!0,o=g,c=h;break}if(M===c){j=!0,c=g,o=h;break}M=M.sibling}if(!j)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?t:s}function m(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t;for(t=t.child;t!==null;){if(s=m(t),s!==null)return s;t=t.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),O=Symbol.for("react.consumer"),L=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),w=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function U(t){return t===null||typeof t!="object"?null:(t=T&&t[T]||t["@@iterator"],typeof t=="function"?t:null)}var B=Symbol.for("react.client.reference");function ve(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===B?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case R:return"Fragment";case k:return"Profiler";case D:return"StrictMode";case F:return"Suspense";case P:return"SuspenseList";case A:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case I:return"Portal";case L:return(t.displayName||"Context")+".Provider";case O:return(t._context.displayName||"Context")+".Consumer";case N:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case E:return s=t.displayName||null,s!==null?s:ve(t.type)||"Memo";case _:s=t._payload,t=t._init;try{return ve(t(s))}catch{}}return null}var ye=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Ce=[],H=-1;function G(t){return{current:t}}function z(t){0>H||(t.current=Ce[H],Ce[H]=null,H--)}function W(t,s){H++,Ce[H]=t.current,t.current=s}var J=G(null),Ae=G(null),he=G(null),qe=G(null);function _e(t,s){switch(W(he,s),W(Ae,t),W(J,null),s.nodeType){case 9:case 11:t=(t=s.documentElement)&&(t=t.namespaceURI)?qx(t):0;break;default:if(t=s.tagName,s=s.namespaceURI)s=qx(s),t=Hx(s,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}z(J),W(J,t)}function be(){z(J),z(Ae),z(he)}function Be(t){t.memoizedState!==null&&W(qe,t);var s=J.current,o=Hx(s,t.type);s!==o&&(W(Ae,t),W(J,o))}function Qe(t){Ae.current===t&&(z(J),z(Ae)),qe.current===t&&(z(qe),Nl._currentValue=pe)}var lt=Object.prototype.hasOwnProperty,At=i.unstable_scheduleCallback,Nt=i.unstable_cancelCallback,gt=i.unstable_shouldYield,Fe=i.unstable_requestPaint,it=i.unstable_now,we=i.unstable_getCurrentPriorityLevel,je=i.unstable_ImmediatePriority,ge=i.unstable_UserBlockingPriority,Ue=i.unstable_NormalPriority,Dt=i.unstable_LowPriority,se=i.unstable_IdlePriority,ke=i.log,Xe=i.unstable_setDisableYieldValue,ot=null,K=null;function ie(t){if(typeof ke=="function"&&Xe(t),K&&typeof K.setStrictMode=="function")try{K.setStrictMode(ot,t)}catch{}}var le=Math.clz32?Math.clz32:xt,Ne=Math.log,Se=Math.LN2;function xt(t){return t>>>=0,t===0?32:31-(Ne(t)/Se|0)|0}var vt=256,Xt=4194304;function jn(t){var s=t&42;if(s!==0)return s;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Tn(t,s,o){var c=t.pendingLanes;if(c===0)return 0;var h=0,g=t.suspendedLanes,j=t.pingedLanes;t=t.warmLanes;var M=c&134217727;return M!==0?(c=M&~g,c!==0?h=jn(c):(j&=M,j!==0?h=jn(j):o||(o=M&~t,o!==0&&(h=jn(o))))):(M=c&~g,M!==0?h=jn(M):j!==0?h=jn(j):o||(o=c&~t,o!==0&&(h=jn(o)))),h===0?0:s!==0&&s!==h&&(s&g)===0&&(g=h&-h,o=s&-s,g>=o||g===32&&(o&4194048)!==0)?s:h}function vs(t,s){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&s)===0}function qs(t,s){switch(t){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Er(){var t=vt;return vt<<=1,(vt&4194048)===0&&(vt=256),t}function ss(){var t=Xt;return Xt<<=1,(Xt&62914560)===0&&(Xt=4194304),t}function va(t){for(var s=[],o=0;31>o;o++)s.push(t);return s}function It(t,s){t.pendingLanes|=s,s!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function vi(t,s,o,c,h,g){var j=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var M=t.entanglements,$=t.expirationTimes,ne=t.hiddenUpdates;for(o=j&~o;0<o;){var ce=31-le(o),fe=1<<ce;M[ce]=0,$[ce]=-1;var ae=ne[ce];if(ae!==null)for(ne[ce]=null,ce=0;ce<ae.length;ce++){var re=ae[ce];re!==null&&(re.lane&=-536870913)}o&=~fe}c!==0&&ys(t,c,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(j&~s))}function ys(t,s,o){t.pendingLanes|=s,t.suspendedLanes&=~s;var c=31-le(s);t.entangledLanes|=s,t.entanglements[c]=t.entanglements[c]|1073741824|o&4194090}function _s(t,s){var o=t.entangledLanes|=s;for(t=t.entanglements;o;){var c=31-le(o),h=1<<c;h&s|t[c]&s&&(t[c]|=s),o&=~h}}function ya(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Sr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function as(){var t=ue.p;return t!==0?t:(t=window.event,t===void 0?32:cv(t.type))}function yi(t,s){var o=ue.p;try{return ue.p=t,s()}finally{ue.p=o}}var Hn=Math.random().toString(36).slice(2),kt="__reactFiber$"+Hn,ut="__reactProps$"+Hn,nn="__reactContainer$"+Hn,bs="__reactEvents$"+Hn,Hs="__reactListeners$"+Hn,yh="__reactHandles$"+Hn,rs="__reactResources$"+Hn,_a="__reactMarker$"+Hn;function _i(t){delete t[kt],delete t[ut],delete t[bs],delete t[Hs],delete t[yh]}function Es(t){var s=t[kt];if(s)return s;for(var o=t.parentNode;o;){if(s=o[nn]||o[kt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(t=Yx(t);t!==null;){if(o=t[kt])return o;t=Yx(t)}return s}t=o,o=t.parentNode}return null}function Ss(t){if(t=t[kt]||t[nn]){var s=t.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return t}return null}function ba(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t.stateNode;throw Error(r(33))}function Ea(t){var s=t[rs];return s||(s=t[rs]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Vt(t){t[_a]=!0}var yc=new Set,Ar={};function As(t,s){Ns(t,s),Ns(t+"Capture",s)}function Ns(t,s){for(Ar[t]=s,t=0;t<s.length;t++)yc.add(s[t])}var Nr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ws={},bi={};function _h(t){return lt.call(bi,t)?!0:lt.call(ws,t)?!1:Nr.test(t)?bi[t]=!0:(ws[t]=!0,!1)}function wr(t,s,o){if(_h(s))if(o===null)t.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(s);return}}t.setAttribute(s,""+o)}}function Cr(t,s,o){if(o===null)t.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttribute(s,""+o)}}function $n(t,s,o,c){if(c===null)t.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(s,o,""+c)}}var jr,Ei;function $s(t){if(jr===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);jr=s&&s[1]||"",Ei=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jr+t+Ei}var Si=!1;function Ai(t,s){if(!t||Si)return"";Si=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(re){var ae=re}Reflect.construct(t,[],fe)}else{try{fe.call()}catch(re){ae=re}t.call(fe.prototype)}}else{try{throw Error()}catch(re){ae=re}(fe=t())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(re){if(re&&ae&&typeof re.stack=="string")return[re.stack,ae.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),j=g[0],M=g[1];if(j&&M){var $=j.split(`
`),ne=M.split(`
`);for(h=c=0;c<$.length&&!$[c].includes("DetermineComponentFrameRoot");)c++;for(;h<ne.length&&!ne[h].includes("DetermineComponentFrameRoot");)h++;if(c===$.length||h===ne.length)for(c=$.length-1,h=ne.length-1;1<=c&&0<=h&&$[c]!==ne[h];)h--;for(;1<=c&&0<=h;c--,h--)if($[c]!==ne[h]){if(c!==1||h!==1)do if(c--,h--,0>h||$[c]!==ne[h]){var ce=`
`+$[c].replace(" at new "," at ");return t.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",t.displayName)),ce}while(1<=c&&0<=h);break}}}finally{Si=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?$s(o):""}function bh(t){switch(t.tag){case 26:case 27:case 5:return $s(t.type);case 16:return $s("Lazy");case 13:return $s("Suspense");case 19:return $s("SuspenseList");case 0:case 15:return Ai(t.type,!1);case 11:return Ai(t.type.render,!1);case 1:return Ai(t.type,!0);case 31:return $s("Activity");default:return""}}function is(t){try{var s="";do s+=bh(t),t=t.return;while(t);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Ot(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Sa(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Tr(t){var s=Sa(t)?"checked":"value",o=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),c=""+t[s];if(!t.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,g=o.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return h.call(this)},set:function(j){c=""+j,g.call(this,j)}}),Object.defineProperty(t,s,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(j){c=""+j},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function Aa(t){t._valueTracker||(t._valueTracker=Tr(t))}function yt(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return t&&(c=Sa(t)?t.checked?"true":"false":t.value),t=c,t!==o?(s.setValue(t),!0):!1}function Gs(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Rr=/[\n"\\]/g;function sn(t){return t.replace(Rr,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ro(t,s,o,c,h,g,j,M){t.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?t.type=j:t.removeAttribute("type"),s!=null?j==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+Ot(s)):t.value!==""+Ot(s)&&(t.value=""+Ot(s)):j!=="submit"&&j!=="reset"||t.removeAttribute("value"),s!=null?Io(t,j,Ot(s)):o!=null?Io(t,j,Ot(o)):c!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?t.name=""+Ot(M):t.removeAttribute("name")}function Do(t,s,o,c,h,g,j,M){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),s!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||s!=null))return;o=o!=null?""+Ot(o):"",s=s!=null?""+Ot(s):o,M||s===t.value||(t.value=s),t.defaultValue=s}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=M?t.checked:!!c,t.defaultChecked=!!c,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(t.name=j)}function Io(t,s,o){s==="number"&&Gs(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function Na(t,s,o,c){if(t=t.options,s){s={};for(var h=0;h<o.length;h++)s["$"+o[h]]=!0;for(o=0;o<t.length;o++)h=s.hasOwnProperty("$"+t[o].value),t[o].selected!==h&&(t[o].selected=h),h&&c&&(t[o].defaultSelected=!0)}else{for(o=""+Ot(o),s=null,h=0;h<t.length;h++){if(t[h].value===o){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}s!==null||t[h].disabled||(s=t[h])}s!==null&&(s.selected=!0)}}function _c(t,s,o){if(s!=null&&(s=""+Ot(s),s!==t.value&&(t.value=s),o==null)){t.defaultValue!==s&&(t.defaultValue=s);return}t.defaultValue=o!=null?""+Ot(o):""}function bc(t,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(r(92));if(ye(c)){if(1<c.length)throw Error(r(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=Ot(s),t.defaultValue=o,c=t.textContent,c===o&&c!==""&&c!==null&&(t.value=c)}function Gn(t,s){if(s){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=s;return}}t.textContent=s}var Ks=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ko(t,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="":c?t.setProperty(s,o):typeof o!="number"||o===0||Ks.has(s)?s==="float"?t.cssFloat=o:t[s]=(""+o).trim():t[s]=o+"px"}function Po(t,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(t=t.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in s)c=s[h],s.hasOwnProperty(h)&&o[h]!==c&&ko(t,h,c)}else for(var g in s)s.hasOwnProperty(g)&&ko(t,g,s[g])}function Ni(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function os(t){return Sc.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Oo=null;function Bo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wa=null,An=null;function Ac(t){var s=Ss(t);if(s&&(t=s.stateNode)){var o=t[ut]||null;e:switch(t=s.stateNode,s.type){case"input":if(Ro(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+sn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==t&&c.form===t.form){var h=c[ut]||null;if(!h)throw Error(r(90));Ro(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===t.form&&yt(c)}break e;case"textarea":_c(t,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Na(t,!!o.multiple,s,!1)}}}var Dr=!1;function Ir(t,s,o){if(Dr)return t(s,o);Dr=!0;try{var c=t(s);return c}finally{if(Dr=!1,(wa!==null||An!==null)&&(fu(),wa&&(s=wa,t=An,An=wa=null,Ac(s),t)))for(s=0;s<t.length;s++)Ac(t[s])}}function Ca(t,s){var o=t.stateNode;if(o===null)return null;var c=o[ut]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Nn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ys=!1;if(Nn)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){Ys=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{Ys=!1}var Kn=null,wt=null,wi=null;function Nc(){if(wi)return wi;var t,s=wt,o=s.length,c,h="value"in Kn?Kn.value:Kn.textContent,g=h.length;for(t=0;t<o&&s[t]===h[t];t++);var j=o-t;for(c=1;c<=j&&s[o-c]===h[g-c];c++);return wi=h.slice(t,1<c?1-c:void 0)}function kr(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function Pr(){return!0}function Mo(){return!1}function Wt(t){function s(o,c,h,g,j){this._reactName=o,this._targetInst=h,this.type=c,this.nativeEvent=g,this.target=j,this.currentTarget=null;for(var M in t)t.hasOwnProperty(M)&&(o=t[M],this[M]=o?o(g):g[M]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Pr:Mo,this.isPropagationStopped=Mo,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Pr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Pr)},persist:function(){},isPersistent:Pr}),s}var gn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Or=Wt(gn),Br=v({},gn,{view:0,detail:0}),Mr=Wt(Br),Ci,Fr,Cs,Lr=v({},Br,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ri,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cs&&(Cs&&t.type==="mousemove"?(Ci=t.screenX-Cs.screenX,Fr=t.screenY-Cs.screenY):Fr=Ci=0,Cs=t),Ci)},movementY:function(t){return"movementY"in t?t.movementY:Fr}}),Vr=Wt(Lr),Eh=v({},Lr,{dataTransfer:0}),wc=Wt(Eh),Ur=v({},Br,{relatedTarget:0}),ji=Wt(Ur),Cc=v({},gn,{animationName:0,elapsedTime:0,pseudoElement:0}),Fo=Wt(Cc),Lo=v({},gn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jc=Wt(Lo),Ti=v({},gn,{data:0}),Vo=Wt(Ti),Tc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dc(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=Rc[t])?!!s[t]:!1}function Ri(){return Dc}var Ic=v({},Br,{key:function(t){if(t.key){var s=Tc[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=kr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Qs[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ri,charCode:function(t){return t.type==="keypress"?kr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?kr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Di=Wt(Ic),wn=v({},Lr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uo=Wt(wn),kc=v({},Br,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ri}),Ta=Wt(kc),d=v({},gn,{propertyName:0,elapsedTime:0,pseudoElement:0}),y=Wt(d),C=v({},Lr,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),V=Wt(C),te=v({},gn,{newState:0,oldState:0}),oe=Wt(te),Ee=[9,13,27,32],$e=Nn&&"CompositionEvent"in window,jt=null;Nn&&"documentMode"in document&&(jt=document.documentMode);var ft=Nn&&"TextEvent"in window&&!jt,Ut=Nn&&(!$e||jt&&8<jt&&11>=jt),On=" ",js=!1;function ls(t,s){switch(t){case"keyup":return Ee.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cs(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var us=!1;function zo(t,s){switch(t){case"compositionend":return cs(s);case"keypress":return s.which!==32?null:(js=!0,On);case"textInput":return t=s.data,t===On&&js?null:t;default:return null}}function lE(t,s){if(us)return t==="compositionend"||!$e&&ls(t,s)?(t=Nc(),wi=wt=Kn=null,us=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ut&&s.locale!=="ko"?null:s.data;default:return null}}var cE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!cE[t.type]:s==="textarea"}function ap(t,s,o,c){wa?An?An.push(c):An=[c]:wa=c,s=yu(s,"onChange"),0<s.length&&(o=new Or("onChange","change",null,o,c),t.push({event:o,listeners:s}))}var qo=null,Ho=null;function uE(t){Fx(t,0)}function Pc(t){var s=ba(t);if(yt(s))return t}function rp(t,s){if(t==="change")return s}var ip=!1;if(Nn){var Sh;if(Nn){var Ah="oninput"in document;if(!Ah){var op=document.createElement("div");op.setAttribute("oninput","return;"),Ah=typeof op.oninput=="function"}Sh=Ah}else Sh=!1;ip=Sh&&(!document.documentMode||9<document.documentMode)}function lp(){qo&&(qo.detachEvent("onpropertychange",cp),Ho=qo=null)}function cp(t){if(t.propertyName==="value"&&Pc(Ho)){var s=[];ap(s,Ho,t,Bo(t)),Ir(uE,s)}}function dE(t,s,o){t==="focusin"?(lp(),qo=s,Ho=o,qo.attachEvent("onpropertychange",cp)):t==="focusout"&&lp()}function hE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pc(Ho)}function fE(t,s){if(t==="click")return Pc(s)}function mE(t,s){if(t==="input"||t==="change")return Pc(s)}function pE(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Bn=typeof Object.is=="function"?Object.is:pE;function $o(t,s){if(Bn(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var o=Object.keys(t),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var h=o[c];if(!lt.call(s,h)||!Bn(t[h],s[h]))return!1}return!0}function up(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dp(t,s){var o=up(t);t=0;for(var c;o;){if(o.nodeType===3){if(c=t+o.textContent.length,t<=s&&c>=s)return{node:o,offset:s-t};t=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=up(o)}}function hp(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?hp(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function fp(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var s=Gs(t.document);s instanceof t.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)t=s.contentWindow;else break;s=Gs(t.document)}return s}function Nh(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}var gE=Nn&&"documentMode"in document&&11>=document.documentMode,Ii=null,wh=null,Go=null,Ch=!1;function mp(t,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ch||Ii==null||Ii!==Gs(c)||(c=Ii,"selectionStart"in c&&Nh(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Go&&$o(Go,c)||(Go=c,c=yu(wh,"onSelect"),0<c.length&&(s=new Or("onSelect","select",null,s,o),t.push({event:s,listeners:c}),s.target=Ii)))}function zr(t,s){var o={};return o[t.toLowerCase()]=s.toLowerCase(),o["Webkit"+t]="webkit"+s,o["Moz"+t]="moz"+s,o}var ki={animationend:zr("Animation","AnimationEnd"),animationiteration:zr("Animation","AnimationIteration"),animationstart:zr("Animation","AnimationStart"),transitionrun:zr("Transition","TransitionRun"),transitionstart:zr("Transition","TransitionStart"),transitioncancel:zr("Transition","TransitionCancel"),transitionend:zr("Transition","TransitionEnd")},jh={},pp={};Nn&&(pp=document.createElement("div").style,"AnimationEvent"in window||(delete ki.animationend.animation,delete ki.animationiteration.animation,delete ki.animationstart.animation),"TransitionEvent"in window||delete ki.transitionend.transition);function qr(t){if(jh[t])return jh[t];if(!ki[t])return t;var s=ki[t],o;for(o in s)if(s.hasOwnProperty(o)&&o in pp)return jh[t]=s[o];return t}var gp=qr("animationend"),xp=qr("animationiteration"),vp=qr("animationstart"),xE=qr("transitionrun"),vE=qr("transitionstart"),yE=qr("transitioncancel"),yp=qr("transitionend"),_p=new Map,Th="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Th.push("scrollEnd");function ds(t,s){_p.set(t,s),As(s,[t])}var bp=new WeakMap;function Yn(t,s){if(typeof t=="object"&&t!==null){var o=bp.get(t);return o!==void 0?o:(s={value:t,source:s,stack:is(s)},bp.set(t,s),s)}return{value:t,source:s,stack:is(s)}}var Qn=[],Pi=0,Rh=0;function Oc(){for(var t=Pi,s=Rh=Pi=0;s<t;){var o=Qn[s];Qn[s++]=null;var c=Qn[s];Qn[s++]=null;var h=Qn[s];Qn[s++]=null;var g=Qn[s];if(Qn[s++]=null,c!==null&&h!==null){var j=c.pending;j===null?h.next=h:(h.next=j.next,j.next=h),c.pending=h}g!==0&&Ep(o,h,g)}}function Bc(t,s,o,c){Qn[Pi++]=t,Qn[Pi++]=s,Qn[Pi++]=o,Qn[Pi++]=c,Rh|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Dh(t,s,o,c){return Bc(t,s,o,c),Mc(t)}function Oi(t,s){return Bc(t,null,null,s),Mc(t)}function Ep(t,s,o){t.lanes|=o;var c=t.alternate;c!==null&&(c.lanes|=o);for(var h=!1,g=t.return;g!==null;)g.childLanes|=o,c=g.alternate,c!==null&&(c.childLanes|=o),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&s!==null&&(h=31-le(o),t=g.hiddenUpdates,c=t[h],c===null?t[h]=[s]:c.push(s),s.lane=o|536870912),g):null}function Mc(t){if(50<xl)throw xl=0,Ff=null,Error(r(185));for(var s=t.return;s!==null;)t=s,s=t.return;return t.tag===3?t.stateNode:null}var Bi={};function _E(t,s,o,c){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(t,s,o,c){return new _E(t,s,o,c)}function Ih(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Xs(t,s){var o=t.alternate;return o===null?(o=Mn(t.tag,s,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=s,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,s=t.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function Sp(t,s){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=s,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,s=o.dependencies,t.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t}function Fc(t,s,o,c,h,g){var j=0;if(c=t,typeof t=="function")Ih(t)&&(j=1);else if(typeof t=="string")j=ES(t,o,J.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case A:return t=Mn(31,o,s,h),t.elementType=A,t.lanes=g,t;case R:return Hr(o.children,h,g,s);case D:j=8,h|=24;break;case k:return t=Mn(12,o,s,h|2),t.elementType=k,t.lanes=g,t;case F:return t=Mn(13,o,s,h),t.elementType=F,t.lanes=g,t;case P:return t=Mn(19,o,s,h),t.elementType=P,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q:case L:j=10;break e;case O:j=9;break e;case N:j=11;break e;case E:j=14;break e;case _:j=16,c=null;break e}j=29,o=Error(r(130,t===null?"null":typeof t,"")),c=null}return s=Mn(j,o,s,h),s.elementType=t,s.type=c,s.lanes=g,s}function Hr(t,s,o,c){return t=Mn(7,t,c,s),t.lanes=o,t}function kh(t,s,o){return t=Mn(6,t,null,s),t.lanes=o,t}function Ph(t,s,o){return s=Mn(4,t.children!==null?t.children:[],t.key,s),s.lanes=o,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}var Mi=[],Fi=0,Lc=null,Vc=0,Xn=[],Wn=0,$r=null,Ws=1,Zs="";function Gr(t,s){Mi[Fi++]=Vc,Mi[Fi++]=Lc,Lc=t,Vc=s}function Ap(t,s,o){Xn[Wn++]=Ws,Xn[Wn++]=Zs,Xn[Wn++]=$r,$r=t;var c=Ws;t=Zs;var h=32-le(c)-1;c&=~(1<<h),o+=1;var g=32-le(s)+h;if(30<g){var j=h-h%5;g=(c&(1<<j)-1).toString(32),c>>=j,h-=j,Ws=1<<32-le(s)+h|o<<h|c,Zs=g+t}else Ws=1<<g|o<<h|c,Zs=t}function Oh(t){t.return!==null&&(Gr(t,1),Ap(t,1,0))}function Bh(t){for(;t===Lc;)Lc=Mi[--Fi],Mi[Fi]=null,Vc=Mi[--Fi],Mi[Fi]=null;for(;t===$r;)$r=Xn[--Wn],Xn[Wn]=null,Zs=Xn[--Wn],Xn[Wn]=null,Ws=Xn[--Wn],Xn[Wn]=null}var Cn=null,Ft=null,dt=!1,Kr=null,Ts=!1,Mh=Error(r(519));function Yr(t){var s=Error(r(418,""));throw Qo(Yn(s,t)),Mh}function Np(t){var s=t.stateNode,o=t.type,c=t.memoizedProps;switch(s[kt]=t,s[ut]=c,o){case"dialog":Je("cancel",s),Je("close",s);break;case"iframe":case"object":case"embed":Je("load",s);break;case"video":case"audio":for(o=0;o<yl.length;o++)Je(yl[o],s);break;case"source":Je("error",s);break;case"img":case"image":case"link":Je("error",s),Je("load",s);break;case"details":Je("toggle",s);break;case"input":Je("invalid",s),Do(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Aa(s);break;case"select":Je("invalid",s);break;case"textarea":Je("invalid",s),bc(s,c.value,c.defaultValue,c.children),Aa(s)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||zx(s.textContent,o)?(c.popover!=null&&(Je("beforetoggle",s),Je("toggle",s)),c.onScroll!=null&&Je("scroll",s),c.onScrollEnd!=null&&Je("scrollend",s),c.onClick!=null&&(s.onclick=_u),s=!0):s=!1,s||Yr(t)}function wp(t){for(Cn=t.return;Cn;)switch(Cn.tag){case 5:case 13:Ts=!1;return;case 27:case 3:Ts=!0;return;default:Cn=Cn.return}}function Ko(t){if(t!==Cn)return!1;if(!dt)return wp(t),dt=!0,!1;var s=t.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||e0(t.type,t.memoizedProps)),o=!o),o&&Ft&&Yr(t),wp(t),s===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8)if(o=t.data,o==="/$"){if(s===0){Ft=fs(t.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;t=t.nextSibling}Ft=null}}else s===27?(s=Ft,$a(t.type)?(t=a0,a0=null,Ft=t):Ft=s):Ft=Cn?fs(t.stateNode.nextSibling):null;return!0}function Yo(){Ft=Cn=null,dt=!1}function Cp(){var t=Kr;return t!==null&&(In===null?In=t:In.push.apply(In,t),Kr=null),t}function Qo(t){Kr===null?Kr=[t]:Kr.push(t)}var Fh=G(null),Qr=null,Js=null;function Ra(t,s,o){W(Fh,s._currentValue),s._currentValue=o}function ea(t){t._currentValue=Fh.current,z(Fh)}function Lh(t,s,o){for(;t!==null;){var c=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),t===o)break;t=t.return}}function Vh(t,s,o,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var j=h.child;g=g.firstContext;e:for(;g!==null;){var M=g;g=h;for(var $=0;$<s.length;$++)if(M.context===s[$]){g.lanes|=o,M=g.alternate,M!==null&&(M.lanes|=o),Lh(g.return,o,t),c||(j=null);break e}g=M.next}}else if(h.tag===18){if(j=h.return,j===null)throw Error(r(341));j.lanes|=o,g=j.alternate,g!==null&&(g.lanes|=o),Lh(j,o,t),j=null}else j=h.child;if(j!==null)j.return=h;else for(j=h;j!==null;){if(j===t){j=null;break}if(h=j.sibling,h!==null){h.return=j.return,j=h;break}j=j.return}h=j}}function Xo(t,s,o,c){t=null;for(var h=s,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var j=h.alternate;if(j===null)throw Error(r(387));if(j=j.memoizedProps,j!==null){var M=h.type;Bn(h.pendingProps.value,j.value)||(t!==null?t.push(M):t=[M])}}else if(h===qe.current){if(j=h.alternate,j===null)throw Error(r(387));j.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Nl):t=[Nl])}h=h.return}t!==null&&Vh(s,t,o,c),s.flags|=262144}function Uc(t){for(t=t.firstContext;t!==null;){if(!Bn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Xr(t){Qr=t,Js=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function xn(t){return jp(Qr,t)}function zc(t,s){return Qr===null&&Xr(t),jp(t,s)}function jp(t,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Js===null){if(t===null)throw Error(r(308));Js=s,t.dependencies={lanes:0,firstContext:s},t.flags|=524288}else Js=Js.next=s;return o}var bE=typeof AbortController<"u"?AbortController:function(){var t=[],s=this.signal={aborted:!1,addEventListener:function(o,c){t.push(c)}};this.abort=function(){s.aborted=!0,t.forEach(function(o){return o()})}},EE=i.unstable_scheduleCallback,SE=i.unstable_NormalPriority,Zt={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uh(){return{controller:new bE,data:new Map,refCount:0}}function Wo(t){t.refCount--,t.refCount===0&&EE(SE,function(){t.controller.abort()})}var Zo=null,zh=0,Li=0,Vi=null;function AE(t,s){if(Zo===null){var o=Zo=[];zh=0,Li=$f(),Vi={status:"pending",value:void 0,then:function(c){o.push(c)}}}return zh++,s.then(Tp,Tp),s}function Tp(){if(--zh===0&&Zo!==null){Vi!==null&&(Vi.status="fulfilled");var t=Zo;Zo=null,Li=0,Vi=null;for(var s=0;s<t.length;s++)(0,t[s])()}}function NE(t,s){var o=[],c={status:"pending",value:null,reason:null,then:function(h){o.push(h)}};return t.then(function(){c.status="fulfilled",c.value=s;for(var h=0;h<o.length;h++)(0,o[h])(s)},function(h){for(c.status="rejected",c.reason=h,h=0;h<o.length;h++)(0,o[h])(void 0)}),c}var Rp=Q.S;Q.S=function(t,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&AE(t,s),Rp!==null&&Rp(t,s)};var Wr=G(null);function qh(){var t=Wr.current;return t!==null?t:Ct.pooledCache}function qc(t,s){s===null?W(Wr,Wr.current):W(Wr,s.pool)}function Dp(){var t=qh();return t===null?null:{parent:Zt._currentValue,pool:t}}var Jo=Error(r(460)),Ip=Error(r(474)),Hc=Error(r(542)),Hh={then:function(){}};function kp(t){return t=t.status,t==="fulfilled"||t==="rejected"}function $c(){}function Pp(t,s,o){switch(o=t[o],o===void 0?t.push(s):o!==s&&(s.then($c,$c),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,Bp(t),t;default:if(typeof s.status=="string")s.then($c,$c);else{if(t=Ct,t!==null&&100<t.shellSuspendCounter)throw Error(r(482));t=s,t.status="pending",t.then(function(c){if(s.status==="pending"){var h=s;h.status="fulfilled",h.value=c}},function(c){if(s.status==="pending"){var h=s;h.status="rejected",h.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,Bp(t),t}throw el=s,Jo}}var el=null;function Op(){if(el===null)throw Error(r(459));var t=el;return el=null,t}function Bp(t){if(t===Jo||t===Hc)throw Error(r(483))}var Da=!1;function $h(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gh(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ia(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function ka(t,s,o){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(mt&2)!==0){var h=c.pending;return h===null?s.next=s:(s.next=h.next,h.next=s),c.pending=s,s=Mc(t),Ep(t,null,o),s}return Bc(t,c,s,o),Mc(t)}function tl(t,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=t.pendingLanes,o|=c,s.lanes=o,_s(t,o)}}function Kh(t,s){var o=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var h=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var j={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?h=g=j:g=g.next=j,o=o.next}while(o!==null);g===null?h=g=s:g=g.next=s}else h=g=s;o={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=s:t.next=s,o.lastBaseUpdate=s}var Yh=!1;function nl(){if(Yh){var t=Vi;if(t!==null)throw t}}function sl(t,s,o,c){Yh=!1;var h=t.updateQueue;Da=!1;var g=h.firstBaseUpdate,j=h.lastBaseUpdate,M=h.shared.pending;if(M!==null){h.shared.pending=null;var $=M,ne=$.next;$.next=null,j===null?g=ne:j.next=ne,j=$;var ce=t.alternate;ce!==null&&(ce=ce.updateQueue,M=ce.lastBaseUpdate,M!==j&&(M===null?ce.firstBaseUpdate=ne:M.next=ne,ce.lastBaseUpdate=$))}if(g!==null){var fe=h.baseState;j=0,ce=ne=$=null,M=g;do{var ae=M.lane&-536870913,re=ae!==M.lane;if(re?(at&ae)===ae:(c&ae)===ae){ae!==0&&ae===Li&&(Yh=!0),ce!==null&&(ce=ce.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var ze=t,Oe=M;ae=s;var Et=o;switch(Oe.tag){case 1:if(ze=Oe.payload,typeof ze=="function"){fe=ze.call(Et,fe,ae);break e}fe=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Oe.payload,ae=typeof ze=="function"?ze.call(Et,fe,ae):ze,ae==null)break e;fe=v({},fe,ae);break e;case 2:Da=!0}}ae=M.callback,ae!==null&&(t.flags|=64,re&&(t.flags|=8192),re=h.callbacks,re===null?h.callbacks=[ae]:re.push(ae))}else re={lane:ae,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ce===null?(ne=ce=re,$=fe):ce=ce.next=re,j|=ae;if(M=M.next,M===null){if(M=h.shared.pending,M===null)break;re=M,M=re.next,re.next=null,h.lastBaseUpdate=re,h.shared.pending=null}}while(!0);ce===null&&($=fe),h.baseState=$,h.firstBaseUpdate=ne,h.lastBaseUpdate=ce,g===null&&(h.shared.lanes=0),Ua|=j,t.lanes=j,t.memoizedState=fe}}function Mp(t,s){if(typeof t!="function")throw Error(r(191,t));t.call(s)}function Fp(t,s){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Mp(o[t],s)}var Ui=G(null),Gc=G(0);function Lp(t,s){t=oa,W(Gc,t),W(Ui,s),oa=t|s.baseLanes}function Qh(){W(Gc,oa),W(Ui,Ui.current)}function Xh(){oa=Gc.current,z(Ui),z(Gc)}var Pa=0,Ye=null,_t=null,$t=null,Kc=!1,zi=!1,Zr=!1,Yc=0,al=0,qi=null,wE=0;function zt(){throw Error(r(321))}function Wh(t,s){if(s===null)return!1;for(var o=0;o<s.length&&o<t.length;o++)if(!Bn(t[o],s[o]))return!1;return!0}function Zh(t,s,o,c,h,g){return Pa=g,Ye=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Q.H=t===null||t.memoizedState===null?Eg:Sg,Zr=!1,g=o(c,h),Zr=!1,zi&&(g=Up(s,o,c,h)),Vp(t),g}function Vp(t){Q.H=eu;var s=_t!==null&&_t.next!==null;if(Pa=0,$t=_t=Ye=null,Kc=!1,al=0,qi=null,s)throw Error(r(300));t===null||an||(t=t.dependencies,t!==null&&Uc(t)&&(an=!0))}function Up(t,s,o,c){Ye=t;var h=0;do{if(zi&&(qi=null),al=0,zi=!1,25<=h)throw Error(r(301));if(h+=1,$t=_t=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Q.H=kE,g=s(o,c)}while(zi);return g}function CE(){var t=Q.H,s=t.useState()[0];return s=typeof s.then=="function"?rl(s):s,t=t.useState()[0],(_t!==null?_t.memoizedState:null)!==t&&(Ye.flags|=1024),s}function Jh(){var t=Yc!==0;return Yc=0,t}function ef(t,s,o){s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~o}function tf(t){if(Kc){for(t=t.memoizedState;t!==null;){var s=t.queue;s!==null&&(s.pending=null),t=t.next}Kc=!1}Pa=0,$t=_t=Ye=null,zi=!1,al=Yc=0,qi=null}function Rn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?Ye.memoizedState=$t=t:$t=$t.next=t,$t}function Gt(){if(_t===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var s=$t===null?Ye.memoizedState:$t.next;if(s!==null)$t=s,_t=t;else{if(t===null)throw Ye.alternate===null?Error(r(467)):Error(r(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},$t===null?Ye.memoizedState=$t=t:$t=$t.next=t}return $t}function nf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rl(t){var s=al;return al+=1,qi===null&&(qi=[]),t=Pp(qi,t,s),s=Ye,($t===null?s.memoizedState:$t.next)===null&&(s=s.alternate,Q.H=s===null||s.memoizedState===null?Eg:Sg),t}function Qc(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return rl(t);if(t.$$typeof===L)return xn(t)}throw Error(r(438,String(t)))}function sf(t){var s=null,o=Ye.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=Ye.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(h){return h.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=nf(),Ye.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(t),c=0;c<t;c++)o[c]=w;return s.index++,o}function ta(t,s){return typeof s=="function"?s(t):s}function Xc(t){var s=Gt();return af(s,_t,t)}function af(t,s,o){var c=t.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=o;var h=t.baseQueue,g=c.pending;if(g!==null){if(h!==null){var j=h.next;h.next=g.next,g.next=j}s.baseQueue=h=g,c.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{s=h.next;var M=j=null,$=null,ne=s,ce=!1;do{var fe=ne.lane&-536870913;if(fe!==ne.lane?(at&fe)===fe:(Pa&fe)===fe){var ae=ne.revertLane;if(ae===0)$!==null&&($=$.next={lane:0,revertLane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),fe===Li&&(ce=!0);else if((Pa&ae)===ae){ne=ne.next,ae===Li&&(ce=!0);continue}else fe={lane:0,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},$===null?(M=$=fe,j=g):$=$.next=fe,Ye.lanes|=ae,Ua|=ae;fe=ne.action,Zr&&o(g,fe),g=ne.hasEagerState?ne.eagerState:o(g,fe)}else ae={lane:fe,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},$===null?(M=$=ae,j=g):$=$.next=ae,Ye.lanes|=fe,Ua|=fe;ne=ne.next}while(ne!==null&&ne!==s);if($===null?j=g:$.next=M,!Bn(g,t.memoizedState)&&(an=!0,ce&&(o=Vi,o!==null)))throw o;t.memoizedState=g,t.baseState=j,t.baseQueue=$,c.lastRenderedState=g}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function rf(t){var s=Gt(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=t;var c=o.dispatch,h=o.pending,g=s.memoizedState;if(h!==null){o.pending=null;var j=h=h.next;do g=t(g,j.action),j=j.next;while(j!==h);Bn(g,s.memoizedState)||(an=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),o.lastRenderedState=g}return[g,c]}function zp(t,s,o){var c=Ye,h=Gt(),g=dt;if(g){if(o===void 0)throw Error(r(407));o=o()}else o=s();var j=!Bn((_t||h).memoizedState,o);j&&(h.memoizedState=o,an=!0),h=h.queue;var M=$p.bind(null,c,h,t);if(il(2048,8,M,[t]),h.getSnapshot!==s||j||$t!==null&&$t.memoizedState.tag&1){if(c.flags|=2048,Hi(9,Wc(),Hp.bind(null,c,h,o,s),null),Ct===null)throw Error(r(349));g||(Pa&124)!==0||qp(c,s,o)}return o}function qp(t,s,o){t.flags|=16384,t={getSnapshot:s,value:o},s=Ye.updateQueue,s===null?(s=nf(),Ye.updateQueue=s,s.stores=[t]):(o=s.stores,o===null?s.stores=[t]:o.push(t))}function Hp(t,s,o,c){s.value=o,s.getSnapshot=c,Gp(s)&&Kp(t)}function $p(t,s,o){return o(function(){Gp(s)&&Kp(t)})}function Gp(t){var s=t.getSnapshot;t=t.value;try{var o=s();return!Bn(t,o)}catch{return!0}}function Kp(t){var s=Oi(t,2);s!==null&&zn(s,t,2)}function of(t){var s=Rn();if(typeof t=="function"){var o=t;if(t=o(),Zr){ie(!0);try{o()}finally{ie(!1)}}}return s.memoizedState=s.baseState=t,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ta,lastRenderedState:t},s}function Yp(t,s,o,c){return t.baseState=o,af(t,_t,typeof c=="function"?c:ta)}function jE(t,s,o,c,h){if(Jc(t))throw Error(r(485));if(t=s.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){g.listeners.push(j)}};Q.T!==null?o(!0):g.isTransition=!1,c(g),o=s.pending,o===null?(g.next=s.pending=g,Qp(s,g)):(g.next=o.next,s.pending=o.next=g)}}function Qp(t,s){var o=s.action,c=s.payload,h=t.state;if(s.isTransition){var g=Q.T,j={};Q.T=j;try{var M=o(h,c),$=Q.S;$!==null&&$(j,M),Xp(t,s,M)}catch(ne){lf(t,s,ne)}finally{Q.T=g}}else try{g=o(h,c),Xp(t,s,g)}catch(ne){lf(t,s,ne)}}function Xp(t,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Wp(t,s,c)},function(c){return lf(t,s,c)}):Wp(t,s,o)}function Wp(t,s,o){s.status="fulfilled",s.value=o,Zp(s),t.state=o,s=t.pending,s!==null&&(o=s.next,o===s?t.pending=null:(o=o.next,s.next=o,Qp(t,o)))}function lf(t,s,o){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,Zp(s),s=s.next;while(s!==c)}t.action=null}function Zp(t){t=t.listeners;for(var s=0;s<t.length;s++)(0,t[s])()}function Jp(t,s){return s}function eg(t,s){if(dt){var o=Ct.formState;if(o!==null){e:{var c=Ye;if(dt){if(Ft){t:{for(var h=Ft,g=Ts;h.nodeType!==8;){if(!g){h=null;break t}if(h=fs(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){Ft=fs(h.nextSibling),c=h.data==="F!";break e}}Yr(c)}c=!1}c&&(s=o[0])}}return o=Rn(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jp,lastRenderedState:s},o.queue=c,o=yg.bind(null,Ye,c),c.dispatch=o,c=of(!1),g=ff.bind(null,Ye,!1,c.queue),c=Rn(),h={state:s,dispatch:null,action:t,pending:null},c.queue=h,o=jE.bind(null,Ye,h,g,o),h.dispatch=o,c.memoizedState=t,[s,o,!1]}function tg(t){var s=Gt();return ng(s,_t,t)}function ng(t,s,o){if(s=af(t,s,Jp)[0],t=Xc(ta)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=rl(s)}catch(j){throw j===Jo?Hc:j}else c=s;s=Gt();var h=s.queue,g=h.dispatch;return o!==s.memoizedState&&(Ye.flags|=2048,Hi(9,Wc(),TE.bind(null,h,o),null)),[c,g,t]}function TE(t,s){t.action=s}function sg(t){var s=Gt(),o=_t;if(o!==null)return ng(s,o,t);Gt(),s=s.memoizedState,o=Gt();var c=o.queue.dispatch;return o.memoizedState=t,[s,c,!1]}function Hi(t,s,o,c){return t={tag:t,create:o,deps:c,inst:s,next:null},s=Ye.updateQueue,s===null&&(s=nf(),Ye.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=t.next=t:(c=o.next,o.next=t,t.next=c,s.lastEffect=t),t}function Wc(){return{destroy:void 0,resource:void 0}}function ag(){return Gt().memoizedState}function Zc(t,s,o,c){var h=Rn();c=c===void 0?null:c,Ye.flags|=t,h.memoizedState=Hi(1|s,Wc(),o,c)}function il(t,s,o,c){var h=Gt();c=c===void 0?null:c;var g=h.memoizedState.inst;_t!==null&&c!==null&&Wh(c,_t.memoizedState.deps)?h.memoizedState=Hi(s,g,o,c):(Ye.flags|=t,h.memoizedState=Hi(1|s,g,o,c))}function rg(t,s){Zc(8390656,8,t,s)}function ig(t,s){il(2048,8,t,s)}function og(t,s){return il(4,2,t,s)}function lg(t,s){return il(4,4,t,s)}function cg(t,s){if(typeof s=="function"){t=t();var o=s(t);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function ug(t,s,o){o=o!=null?o.concat([t]):null,il(4,4,cg.bind(null,s,t),o)}function cf(){}function dg(t,s){var o=Gt();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&Wh(s,c[1])?c[0]:(o.memoizedState=[t,s],t)}function hg(t,s){var o=Gt();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&Wh(s,c[1]))return c[0];if(c=t(),Zr){ie(!0);try{t()}finally{ie(!1)}}return o.memoizedState=[c,s],c}function uf(t,s,o){return o===void 0||(Pa&1073741824)!==0?t.memoizedState=s:(t.memoizedState=o,t=px(),Ye.lanes|=t,Ua|=t,o)}function fg(t,s,o,c){return Bn(o,s)?o:Ui.current!==null?(t=uf(t,o,c),Bn(t,s)||(an=!0),t):(Pa&42)===0?(an=!0,t.memoizedState=o):(t=px(),Ye.lanes|=t,Ua|=t,s)}function mg(t,s,o,c,h){var g=ue.p;ue.p=g!==0&&8>g?g:8;var j=Q.T,M={};Q.T=M,ff(t,!1,s,o);try{var $=h(),ne=Q.S;if(ne!==null&&ne(M,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var ce=NE($,c);ol(t,s,ce,Un(t))}else ol(t,s,c,Un(t))}catch(fe){ol(t,s,{then:function(){},status:"rejected",reason:fe},Un())}finally{ue.p=g,Q.T=j}}function RE(){}function df(t,s,o,c){if(t.tag!==5)throw Error(r(476));var h=pg(t).queue;mg(t,h,s,pe,o===null?RE:function(){return gg(t),o(c)})}function pg(t){var s=t.memoizedState;if(s!==null)return s;s={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ta,lastRenderedState:pe},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ta,lastRenderedState:o},next:null},t.memoizedState=s,t=t.alternate,t!==null&&(t.memoizedState=s),s}function gg(t){var s=pg(t).next.queue;ol(t,s,{},Un())}function hf(){return xn(Nl)}function xg(){return Gt().memoizedState}function vg(){return Gt().memoizedState}function DE(t){for(var s=t.return;s!==null;){switch(s.tag){case 24:case 3:var o=Un();t=Ia(o);var c=ka(s,t,o);c!==null&&(zn(c,s,o),tl(c,s,o)),s={cache:Uh()},t.payload=s;return}s=s.return}}function IE(t,s,o){var c=Un();o={lane:c,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Jc(t)?_g(s,o):(o=Dh(t,s,o,c),o!==null&&(zn(o,t,c),bg(o,s,c)))}function yg(t,s,o){var c=Un();ol(t,s,o,c)}function ol(t,s,o,c){var h={lane:c,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Jc(t))_g(s,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var j=s.lastRenderedState,M=g(j,o);if(h.hasEagerState=!0,h.eagerState=M,Bn(M,j))return Bc(t,s,h,0),Ct===null&&Oc(),!1}catch{}finally{}if(o=Dh(t,s,h,c),o!==null)return zn(o,t,c),bg(o,s,c),!0}return!1}function ff(t,s,o,c){if(c={lane:2,revertLane:$f(),action:c,hasEagerState:!1,eagerState:null,next:null},Jc(t)){if(s)throw Error(r(479))}else s=Dh(t,o,c,2),s!==null&&zn(s,t,2)}function Jc(t){var s=t.alternate;return t===Ye||s!==null&&s===Ye}function _g(t,s){zi=Kc=!0;var o=t.pending;o===null?s.next=s:(s.next=o.next,o.next=s),t.pending=s}function bg(t,s,o){if((o&4194048)!==0){var c=s.lanes;c&=t.pendingLanes,o|=c,s.lanes=o,_s(t,o)}}var eu={readContext:xn,use:Qc,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useLayoutEffect:zt,useInsertionEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useSyncExternalStore:zt,useId:zt,useHostTransitionStatus:zt,useFormState:zt,useActionState:zt,useOptimistic:zt,useMemoCache:zt,useCacheRefresh:zt},Eg={readContext:xn,use:Qc,useCallback:function(t,s){return Rn().memoizedState=[t,s===void 0?null:s],t},useContext:xn,useEffect:rg,useImperativeHandle:function(t,s,o){o=o!=null?o.concat([t]):null,Zc(4194308,4,cg.bind(null,s,t),o)},useLayoutEffect:function(t,s){return Zc(4194308,4,t,s)},useInsertionEffect:function(t,s){Zc(4,2,t,s)},useMemo:function(t,s){var o=Rn();s=s===void 0?null:s;var c=t();if(Zr){ie(!0);try{t()}finally{ie(!1)}}return o.memoizedState=[c,s],c},useReducer:function(t,s,o){var c=Rn();if(o!==void 0){var h=o(s);if(Zr){ie(!0);try{o(s)}finally{ie(!1)}}}else h=s;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=IE.bind(null,Ye,t),[c.memoizedState,t]},useRef:function(t){var s=Rn();return t={current:t},s.memoizedState=t},useState:function(t){t=of(t);var s=t.queue,o=yg.bind(null,Ye,s);return s.dispatch=o,[t.memoizedState,o]},useDebugValue:cf,useDeferredValue:function(t,s){var o=Rn();return uf(o,t,s)},useTransition:function(){var t=of(!1);return t=mg.bind(null,Ye,t.queue,!0,!1),Rn().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,s,o){var c=Ye,h=Rn();if(dt){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),Ct===null)throw Error(r(349));(at&124)!==0||qp(c,s,o)}h.memoizedState=o;var g={value:o,getSnapshot:s};return h.queue=g,rg($p.bind(null,c,g,t),[t]),c.flags|=2048,Hi(9,Wc(),Hp.bind(null,c,g,o,s),null),o},useId:function(){var t=Rn(),s=Ct.identifierPrefix;if(dt){var o=Zs,c=Ws;o=(c&~(1<<32-le(c)-1)).toString(32)+o,s=""+s+"R"+o,o=Yc++,0<o&&(s+="H"+o.toString(32)),s+=""}else o=wE++,s=""+s+"r"+o.toString(32)+"";return t.memoizedState=s},useHostTransitionStatus:hf,useFormState:eg,useActionState:eg,useOptimistic:function(t){var s=Rn();s.memoizedState=s.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=ff.bind(null,Ye,!0,o),o.dispatch=s,[t,s]},useMemoCache:sf,useCacheRefresh:function(){return Rn().memoizedState=DE.bind(null,Ye)}},Sg={readContext:xn,use:Qc,useCallback:dg,useContext:xn,useEffect:ig,useImperativeHandle:ug,useInsertionEffect:og,useLayoutEffect:lg,useMemo:hg,useReducer:Xc,useRef:ag,useState:function(){return Xc(ta)},useDebugValue:cf,useDeferredValue:function(t,s){var o=Gt();return fg(o,_t.memoizedState,t,s)},useTransition:function(){var t=Xc(ta)[0],s=Gt().memoizedState;return[typeof t=="boolean"?t:rl(t),s]},useSyncExternalStore:zp,useId:xg,useHostTransitionStatus:hf,useFormState:tg,useActionState:tg,useOptimistic:function(t,s){var o=Gt();return Yp(o,_t,t,s)},useMemoCache:sf,useCacheRefresh:vg},kE={readContext:xn,use:Qc,useCallback:dg,useContext:xn,useEffect:ig,useImperativeHandle:ug,useInsertionEffect:og,useLayoutEffect:lg,useMemo:hg,useReducer:rf,useRef:ag,useState:function(){return rf(ta)},useDebugValue:cf,useDeferredValue:function(t,s){var o=Gt();return _t===null?uf(o,t,s):fg(o,_t.memoizedState,t,s)},useTransition:function(){var t=rf(ta)[0],s=Gt().memoizedState;return[typeof t=="boolean"?t:rl(t),s]},useSyncExternalStore:zp,useId:xg,useHostTransitionStatus:hf,useFormState:sg,useActionState:sg,useOptimistic:function(t,s){var o=Gt();return _t!==null?Yp(o,_t,t,s):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:sf,useCacheRefresh:vg},$i=null,ll=0;function tu(t){var s=ll;return ll+=1,$i===null&&($i=[]),Pp($i,t,s)}function cl(t,s){s=s.props.ref,t.ref=s!==void 0?s:null}function nu(t,s){throw s.$$typeof===b?Error(r(525)):(t=Object.prototype.toString.call(s),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t)))}function Ag(t){var s=t._init;return s(t._payload)}function Ng(t){function s(Z,Y){if(t){var ee=Z.deletions;ee===null?(Z.deletions=[Y],Z.flags|=16):ee.push(Y)}}function o(Z,Y){if(!t)return null;for(;Y!==null;)s(Z,Y),Y=Y.sibling;return null}function c(Z){for(var Y=new Map;Z!==null;)Z.key!==null?Y.set(Z.key,Z):Y.set(Z.index,Z),Z=Z.sibling;return Y}function h(Z,Y){return Z=Xs(Z,Y),Z.index=0,Z.sibling=null,Z}function g(Z,Y,ee){return Z.index=ee,t?(ee=Z.alternate,ee!==null?(ee=ee.index,ee<Y?(Z.flags|=67108866,Y):ee):(Z.flags|=67108866,Y)):(Z.flags|=1048576,Y)}function j(Z){return t&&Z.alternate===null&&(Z.flags|=67108866),Z}function M(Z,Y,ee,de){return Y===null||Y.tag!==6?(Y=kh(ee,Z.mode,de),Y.return=Z,Y):(Y=h(Y,ee),Y.return=Z,Y)}function $(Z,Y,ee,de){var Re=ee.type;return Re===R?ce(Z,Y,ee.props.children,de,ee.key):Y!==null&&(Y.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===_&&Ag(Re)===Y.type)?(Y=h(Y,ee.props),cl(Y,ee),Y.return=Z,Y):(Y=Fc(ee.type,ee.key,ee.props,null,Z.mode,de),cl(Y,ee),Y.return=Z,Y)}function ne(Z,Y,ee,de){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ee.containerInfo||Y.stateNode.implementation!==ee.implementation?(Y=Ph(ee,Z.mode,de),Y.return=Z,Y):(Y=h(Y,ee.children||[]),Y.return=Z,Y)}function ce(Z,Y,ee,de,Re){return Y===null||Y.tag!==7?(Y=Hr(ee,Z.mode,de,Re),Y.return=Z,Y):(Y=h(Y,ee),Y.return=Z,Y)}function fe(Z,Y,ee){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=kh(""+Y,Z.mode,ee),Y.return=Z,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case S:return ee=Fc(Y.type,Y.key,Y.props,null,Z.mode,ee),cl(ee,Y),ee.return=Z,ee;case I:return Y=Ph(Y,Z.mode,ee),Y.return=Z,Y;case _:var de=Y._init;return Y=de(Y._payload),fe(Z,Y,ee)}if(ye(Y)||U(Y))return Y=Hr(Y,Z.mode,ee,null),Y.return=Z,Y;if(typeof Y.then=="function")return fe(Z,tu(Y),ee);if(Y.$$typeof===L)return fe(Z,zc(Z,Y),ee);nu(Z,Y)}return null}function ae(Z,Y,ee,de){var Re=Y!==null?Y.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Re!==null?null:M(Z,Y,""+ee,de);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:return ee.key===Re?$(Z,Y,ee,de):null;case I:return ee.key===Re?ne(Z,Y,ee,de):null;case _:return Re=ee._init,ee=Re(ee._payload),ae(Z,Y,ee,de)}if(ye(ee)||U(ee))return Re!==null?null:ce(Z,Y,ee,de,null);if(typeof ee.then=="function")return ae(Z,Y,tu(ee),de);if(ee.$$typeof===L)return ae(Z,Y,zc(Z,ee),de);nu(Z,ee)}return null}function re(Z,Y,ee,de,Re){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Z=Z.get(ee)||null,M(Y,Z,""+de,Re);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case S:return Z=Z.get(de.key===null?ee:de.key)||null,$(Y,Z,de,Re);case I:return Z=Z.get(de.key===null?ee:de.key)||null,ne(Y,Z,de,Re);case _:var We=de._init;return de=We(de._payload),re(Z,Y,ee,de,Re)}if(ye(de)||U(de))return Z=Z.get(ee)||null,ce(Y,Z,de,Re,null);if(typeof de.then=="function")return re(Z,Y,ee,tu(de),Re);if(de.$$typeof===L)return re(Z,Y,ee,zc(Y,de),Re);nu(Y,de)}return null}function ze(Z,Y,ee,de){for(var Re=null,We=null,Ie=Y,Me=Y=0,on=null;Ie!==null&&Me<ee.length;Me++){Ie.index>Me?(on=Ie,Ie=null):on=Ie.sibling;var ct=ae(Z,Ie,ee[Me],de);if(ct===null){Ie===null&&(Ie=on);break}t&&Ie&&ct.alternate===null&&s(Z,Ie),Y=g(ct,Y,Me),We===null?Re=ct:We.sibling=ct,We=ct,Ie=on}if(Me===ee.length)return o(Z,Ie),dt&&Gr(Z,Me),Re;if(Ie===null){for(;Me<ee.length;Me++)Ie=fe(Z,ee[Me],de),Ie!==null&&(Y=g(Ie,Y,Me),We===null?Re=Ie:We.sibling=Ie,We=Ie);return dt&&Gr(Z,Me),Re}for(Ie=c(Ie);Me<ee.length;Me++)on=re(Ie,Z,Me,ee[Me],de),on!==null&&(t&&on.alternate!==null&&Ie.delete(on.key===null?Me:on.key),Y=g(on,Y,Me),We===null?Re=on:We.sibling=on,We=on);return t&&Ie.forEach(function(Xa){return s(Z,Xa)}),dt&&Gr(Z,Me),Re}function Oe(Z,Y,ee,de){if(ee==null)throw Error(r(151));for(var Re=null,We=null,Ie=Y,Me=Y=0,on=null,ct=ee.next();Ie!==null&&!ct.done;Me++,ct=ee.next()){Ie.index>Me?(on=Ie,Ie=null):on=Ie.sibling;var Xa=ae(Z,Ie,ct.value,de);if(Xa===null){Ie===null&&(Ie=on);break}t&&Ie&&Xa.alternate===null&&s(Z,Ie),Y=g(Xa,Y,Me),We===null?Re=Xa:We.sibling=Xa,We=Xa,Ie=on}if(ct.done)return o(Z,Ie),dt&&Gr(Z,Me),Re;if(Ie===null){for(;!ct.done;Me++,ct=ee.next())ct=fe(Z,ct.value,de),ct!==null&&(Y=g(ct,Y,Me),We===null?Re=ct:We.sibling=ct,We=ct);return dt&&Gr(Z,Me),Re}for(Ie=c(Ie);!ct.done;Me++,ct=ee.next())ct=re(Ie,Z,Me,ct.value,de),ct!==null&&(t&&ct.alternate!==null&&Ie.delete(ct.key===null?Me:ct.key),Y=g(ct,Y,Me),We===null?Re=ct:We.sibling=ct,We=ct);return t&&Ie.forEach(function(PS){return s(Z,PS)}),dt&&Gr(Z,Me),Re}function Et(Z,Y,ee,de){if(typeof ee=="object"&&ee!==null&&ee.type===R&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:e:{for(var Re=ee.key;Y!==null;){if(Y.key===Re){if(Re=ee.type,Re===R){if(Y.tag===7){o(Z,Y.sibling),de=h(Y,ee.props.children),de.return=Z,Z=de;break e}}else if(Y.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===_&&Ag(Re)===Y.type){o(Z,Y.sibling),de=h(Y,ee.props),cl(de,ee),de.return=Z,Z=de;break e}o(Z,Y);break}else s(Z,Y);Y=Y.sibling}ee.type===R?(de=Hr(ee.props.children,Z.mode,de,ee.key),de.return=Z,Z=de):(de=Fc(ee.type,ee.key,ee.props,null,Z.mode,de),cl(de,ee),de.return=Z,Z=de)}return j(Z);case I:e:{for(Re=ee.key;Y!==null;){if(Y.key===Re)if(Y.tag===4&&Y.stateNode.containerInfo===ee.containerInfo&&Y.stateNode.implementation===ee.implementation){o(Z,Y.sibling),de=h(Y,ee.children||[]),de.return=Z,Z=de;break e}else{o(Z,Y);break}else s(Z,Y);Y=Y.sibling}de=Ph(ee,Z.mode,de),de.return=Z,Z=de}return j(Z);case _:return Re=ee._init,ee=Re(ee._payload),Et(Z,Y,ee,de)}if(ye(ee))return ze(Z,Y,ee,de);if(U(ee)){if(Re=U(ee),typeof Re!="function")throw Error(r(150));return ee=Re.call(ee),Oe(Z,Y,ee,de)}if(typeof ee.then=="function")return Et(Z,Y,tu(ee),de);if(ee.$$typeof===L)return Et(Z,Y,zc(Z,ee),de);nu(Z,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,Y!==null&&Y.tag===6?(o(Z,Y.sibling),de=h(Y,ee),de.return=Z,Z=de):(o(Z,Y),de=kh(ee,Z.mode,de),de.return=Z,Z=de),j(Z)):o(Z,Y)}return function(Z,Y,ee,de){try{ll=0;var Re=Et(Z,Y,ee,de);return $i=null,Re}catch(Ie){if(Ie===Jo||Ie===Hc)throw Ie;var We=Mn(29,Ie,null,Z.mode);return We.lanes=de,We.return=Z,We}finally{}}}var Gi=Ng(!0),wg=Ng(!1),Zn=G(null),Rs=null;function Oa(t){var s=t.alternate;W(Jt,Jt.current&1),W(Zn,t),Rs===null&&(s===null||Ui.current!==null||s.memoizedState!==null)&&(Rs=t)}function Cg(t){if(t.tag===22){if(W(Jt,Jt.current),W(Zn,t),Rs===null){var s=t.alternate;s!==null&&s.memoizedState!==null&&(Rs=t)}}else Ba()}function Ba(){W(Jt,Jt.current),W(Zn,Zn.current)}function na(t){z(Zn),Rs===t&&(Rs=null),z(Jt)}var Jt=G(0);function su(t){for(var s=t;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||s0(o)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function mf(t,s,o,c){s=t.memoizedState,o=o(c,s),o=o==null?s:v({},s,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var pf={enqueueSetState:function(t,s,o){t=t._reactInternals;var c=Un(),h=Ia(c);h.payload=s,o!=null&&(h.callback=o),s=ka(t,h,c),s!==null&&(zn(s,t,c),tl(s,t,c))},enqueueReplaceState:function(t,s,o){t=t._reactInternals;var c=Un(),h=Ia(c);h.tag=1,h.payload=s,o!=null&&(h.callback=o),s=ka(t,h,c),s!==null&&(zn(s,t,c),tl(s,t,c))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var o=Un(),c=Ia(o);c.tag=2,s!=null&&(c.callback=s),s=ka(t,c,o),s!==null&&(zn(s,t,o),tl(s,t,o))}};function jg(t,s,o,c,h,g,j){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,j):s.prototype&&s.prototype.isPureReactComponent?!$o(o,c)||!$o(h,g):!0}function Tg(t,s,o,c){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==t&&pf.enqueueReplaceState(s,s.state,null)}function Jr(t,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(t=t.defaultProps){o===s&&(o=v({},o));for(var h in t)o[h]===void 0&&(o[h]=t[h])}return o}var au=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function Rg(t){au(t)}function Dg(t){console.error(t)}function Ig(t){au(t)}function ru(t,s){try{var o=t.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function kg(t,s,o){try{var c=t.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function gf(t,s,o){return o=Ia(o),o.tag=3,o.payload={element:null},o.callback=function(){ru(t,s)},o}function Pg(t){return t=Ia(t),t.tag=3,t}function Og(t,s,o,c){var h=o.type.getDerivedStateFromError;if(typeof h=="function"){var g=c.value;t.payload=function(){return h(g)},t.callback=function(){kg(s,o,c)}}var j=o.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(t.callback=function(){kg(s,o,c),typeof h!="function"&&(za===null?za=new Set([this]):za.add(this));var M=c.stack;this.componentDidCatch(c.value,{componentStack:M!==null?M:""})})}function PE(t,s,o,c,h){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&Xo(s,o,h,!0),o=Zn.current,o!==null){switch(o.tag){case 13:return Rs===null?Vf():o.alternate===null&&Lt===0&&(Lt=3),o.flags&=-257,o.flags|=65536,o.lanes=h,c===Hh?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),zf(t,c,h)),!1;case 22:return o.flags|=65536,c===Hh?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),zf(t,c,h)),!1}throw Error(r(435,o.tag))}return zf(t,c,h),Vf(),!1}if(dt)return s=Zn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=h,c!==Mh&&(t=Error(r(422),{cause:c}),Qo(Yn(t,o)))):(c!==Mh&&(s=Error(r(423),{cause:c}),Qo(Yn(s,o))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=Yn(c,o),h=gf(t.stateNode,c,h),Kh(t,h),Lt!==4&&(Lt=2)),!1;var g=Error(r(520),{cause:c});if(g=Yn(g,o),gl===null?gl=[g]:gl.push(g),Lt!==4&&(Lt=2),s===null)return!0;c=Yn(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,t=h&-h,o.lanes|=t,t=gf(o.stateNode,c,t),Kh(o,t),!1;case 1:if(s=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(za===null||!za.has(g))))return o.flags|=65536,h&=-h,o.lanes|=h,h=Pg(h),Og(h,t,o,c),Kh(o,h),!1}o=o.return}while(o!==null);return!1}var Bg=Error(r(461)),an=!1;function un(t,s,o,c){s.child=t===null?wg(s,null,o,c):Gi(s,t.child,o,c)}function Mg(t,s,o,c,h){o=o.render;var g=s.ref;if("ref"in c){var j={};for(var M in c)M!=="ref"&&(j[M]=c[M])}else j=c;return Xr(s),c=Zh(t,s,o,j,g,h),M=Jh(),t!==null&&!an?(ef(t,s,h),sa(t,s,h)):(dt&&M&&Oh(s),s.flags|=1,un(t,s,c,h),s.child)}function Fg(t,s,o,c,h){if(t===null){var g=o.type;return typeof g=="function"&&!Ih(g)&&g.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=g,Lg(t,s,g,c,h)):(t=Fc(o.type,null,c,s,s.mode,h),t.ref=s.ref,t.return=s,s.child=t)}if(g=t.child,!Af(t,h)){var j=g.memoizedProps;if(o=o.compare,o=o!==null?o:$o,o(j,c)&&t.ref===s.ref)return sa(t,s,h)}return s.flags|=1,t=Xs(g,c),t.ref=s.ref,t.return=s,s.child=t}function Lg(t,s,o,c,h){if(t!==null){var g=t.memoizedProps;if($o(g,c)&&t.ref===s.ref)if(an=!1,s.pendingProps=c=g,Af(t,h))(t.flags&131072)!==0&&(an=!0);else return s.lanes=t.lanes,sa(t,s,h)}return xf(t,s,o,c,h)}function Vg(t,s,o){var c=s.pendingProps,h=c.children,g=t!==null?t.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=g!==null?g.baseLanes|o:o,t!==null){for(h=s.child=t.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;s.childLanes=g&~c}else s.childLanes=0,s.child=null;return Ug(t,s,c,o)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},t!==null&&qc(s,g!==null?g.cachePool:null),g!==null?Lp(s,g):Qh(),Cg(s);else return s.lanes=s.childLanes=536870912,Ug(t,s,g!==null?g.baseLanes|o:o,o)}else g!==null?(qc(s,g.cachePool),Lp(s,g),Ba(),s.memoizedState=null):(t!==null&&qc(s,null),Qh(),Ba());return un(t,s,h,o),s.child}function Ug(t,s,o,c){var h=qh();return h=h===null?null:{parent:Zt._currentValue,pool:h},s.memoizedState={baseLanes:o,cachePool:h},t!==null&&qc(s,null),Qh(),Cg(s),t!==null&&Xo(t,s,c,!0),null}function iu(t,s){var o=s.ref;if(o===null)t!==null&&t.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(t===null||t.ref!==o)&&(s.flags|=4194816)}}function xf(t,s,o,c,h){return Xr(s),o=Zh(t,s,o,c,void 0,h),c=Jh(),t!==null&&!an?(ef(t,s,h),sa(t,s,h)):(dt&&c&&Oh(s),s.flags|=1,un(t,s,o,h),s.child)}function zg(t,s,o,c,h,g){return Xr(s),s.updateQueue=null,o=Up(s,c,o,h),Vp(t),c=Jh(),t!==null&&!an?(ef(t,s,g),sa(t,s,g)):(dt&&c&&Oh(s),s.flags|=1,un(t,s,o,g),s.child)}function qg(t,s,o,c,h){if(Xr(s),s.stateNode===null){var g=Bi,j=o.contextType;typeof j=="object"&&j!==null&&(g=xn(j)),g=new o(c,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=pf,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=c,g.state=s.memoizedState,g.refs={},$h(s),j=o.contextType,g.context=typeof j=="object"&&j!==null?xn(j):Bi,g.state=s.memoizedState,j=o.getDerivedStateFromProps,typeof j=="function"&&(mf(s,o,j,c),g.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(j=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),j!==g.state&&pf.enqueueReplaceState(g,g.state,null),sl(s,c,g,h),nl(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(t===null){g=s.stateNode;var M=s.memoizedProps,$=Jr(o,M);g.props=$;var ne=g.context,ce=o.contextType;j=Bi,typeof ce=="object"&&ce!==null&&(j=xn(ce));var fe=o.getDerivedStateFromProps;ce=typeof fe=="function"||typeof g.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,ce||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(M||ne!==j)&&Tg(s,g,c,j),Da=!1;var ae=s.memoizedState;g.state=ae,sl(s,c,g,h),nl(),ne=s.memoizedState,M||ae!==ne||Da?(typeof fe=="function"&&(mf(s,o,fe,c),ne=s.memoizedState),($=Da||jg(s,o,$,c,ae,ne,j))?(ce||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=ne),g.props=c,g.state=ne,g.context=j,c=$):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{g=s.stateNode,Gh(t,s),j=s.memoizedProps,ce=Jr(o,j),g.props=ce,fe=s.pendingProps,ae=g.context,ne=o.contextType,$=Bi,typeof ne=="object"&&ne!==null&&($=xn(ne)),M=o.getDerivedStateFromProps,(ne=typeof M=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(j!==fe||ae!==$)&&Tg(s,g,c,$),Da=!1,ae=s.memoizedState,g.state=ae,sl(s,c,g,h),nl();var re=s.memoizedState;j!==fe||ae!==re||Da||t!==null&&t.dependencies!==null&&Uc(t.dependencies)?(typeof M=="function"&&(mf(s,o,M,c),re=s.memoizedState),(ce=Da||jg(s,o,ce,c,ae,re,$)||t!==null&&t.dependencies!==null&&Uc(t.dependencies))?(ne||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,re,$),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,re,$)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||j===t.memoizedProps&&ae===t.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||j===t.memoizedProps&&ae===t.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=re),g.props=c,g.state=re,g.context=$,c=ce):(typeof g.componentDidUpdate!="function"||j===t.memoizedProps&&ae===t.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||j===t.memoizedProps&&ae===t.memoizedState||(s.flags|=1024),c=!1)}return g=c,iu(t,s),c=(s.flags&128)!==0,g||c?(g=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,t!==null&&c?(s.child=Gi(s,t.child,null,h),s.child=Gi(s,null,o,h)):un(t,s,o,h),s.memoizedState=g.state,t=s.child):t=sa(t,s,h),t}function Hg(t,s,o,c){return Yo(),s.flags|=256,un(t,s,o,c),s.child}var vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yf(t){return{baseLanes:t,cachePool:Dp()}}function _f(t,s,o){return t=t!==null?t.childLanes&~o:0,s&&(t|=Jn),t}function $g(t,s,o){var c=s.pendingProps,h=!1,g=(s.flags&128)!==0,j;if((j=g)||(j=t!==null&&t.memoizedState===null?!1:(Jt.current&2)!==0),j&&(h=!0,s.flags&=-129),j=(s.flags&32)!==0,s.flags&=-33,t===null){if(dt){if(h?Oa(s):Ba(),dt){var M=Ft,$;if($=M){e:{for($=M,M=Ts;$.nodeType!==8;){if(!M){M=null;break e}if($=fs($.nextSibling),$===null){M=null;break e}}M=$}M!==null?(s.memoizedState={dehydrated:M,treeContext:$r!==null?{id:Ws,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},$=Mn(18,null,null,0),$.stateNode=M,$.return=s,s.child=$,Cn=s,Ft=null,$=!0):$=!1}$||Yr(s)}if(M=s.memoizedState,M!==null&&(M=M.dehydrated,M!==null))return s0(M)?s.lanes=32:s.lanes=536870912,null;na(s)}return M=c.children,c=c.fallback,h?(Ba(),h=s.mode,M=ou({mode:"hidden",children:M},h),c=Hr(c,h,o,null),M.return=s,c.return=s,M.sibling=c,s.child=M,h=s.child,h.memoizedState=yf(o),h.childLanes=_f(t,j,o),s.memoizedState=vf,c):(Oa(s),bf(s,M))}if($=t.memoizedState,$!==null&&(M=$.dehydrated,M!==null)){if(g)s.flags&256?(Oa(s),s.flags&=-257,s=Ef(t,s,o)):s.memoizedState!==null?(Ba(),s.child=t.child,s.flags|=128,s=null):(Ba(),h=c.fallback,M=s.mode,c=ou({mode:"visible",children:c.children},M),h=Hr(h,M,o,null),h.flags|=2,c.return=s,h.return=s,c.sibling=h,s.child=c,Gi(s,t.child,null,o),c=s.child,c.memoizedState=yf(o),c.childLanes=_f(t,j,o),s.memoizedState=vf,s=h);else if(Oa(s),s0(M)){if(j=M.nextSibling&&M.nextSibling.dataset,j)var ne=j.dgst;j=ne,c=Error(r(419)),c.stack="",c.digest=j,Qo({value:c,source:null,stack:null}),s=Ef(t,s,o)}else if(an||Xo(t,s,o,!1),j=(o&t.childLanes)!==0,an||j){if(j=Ct,j!==null&&(c=o&-o,c=(c&42)!==0?1:ya(c),c=(c&(j.suspendedLanes|o))!==0?0:c,c!==0&&c!==$.retryLane))throw $.retryLane=c,Oi(t,c),zn(j,t,c),Bg;M.data==="$?"||Vf(),s=Ef(t,s,o)}else M.data==="$?"?(s.flags|=192,s.child=t.child,s=null):(t=$.treeContext,Ft=fs(M.nextSibling),Cn=s,dt=!0,Kr=null,Ts=!1,t!==null&&(Xn[Wn++]=Ws,Xn[Wn++]=Zs,Xn[Wn++]=$r,Ws=t.id,Zs=t.overflow,$r=s),s=bf(s,c.children),s.flags|=4096);return s}return h?(Ba(),h=c.fallback,M=s.mode,$=t.child,ne=$.sibling,c=Xs($,{mode:"hidden",children:c.children}),c.subtreeFlags=$.subtreeFlags&65011712,ne!==null?h=Xs(ne,h):(h=Hr(h,M,o,null),h.flags|=2),h.return=s,c.return=s,c.sibling=h,s.child=c,c=h,h=s.child,M=t.child.memoizedState,M===null?M=yf(o):($=M.cachePool,$!==null?(ne=Zt._currentValue,$=$.parent!==ne?{parent:ne,pool:ne}:$):$=Dp(),M={baseLanes:M.baseLanes|o,cachePool:$}),h.memoizedState=M,h.childLanes=_f(t,j,o),s.memoizedState=vf,c):(Oa(s),o=t.child,t=o.sibling,o=Xs(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,t!==null&&(j=s.deletions,j===null?(s.deletions=[t],s.flags|=16):j.push(t)),s.child=o,s.memoizedState=null,o)}function bf(t,s){return s=ou({mode:"visible",children:s},t.mode),s.return=t,t.child=s}function ou(t,s){return t=Mn(22,t,null,s),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function Ef(t,s,o){return Gi(s,t.child,null,o),t=bf(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function Gg(t,s,o){t.lanes|=s;var c=t.alternate;c!==null&&(c.lanes|=s),Lh(t.return,s,o)}function Sf(t,s,o,c,h){var g=t.memoizedState;g===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:h}:(g.isBackwards=s,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=o,g.tailMode=h)}function Kg(t,s,o){var c=s.pendingProps,h=c.revealOrder,g=c.tail;if(un(t,s,c.children,o),c=Jt.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Gg(t,o,s);else if(t.tag===19)Gg(t,o,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}switch(W(Jt,c),h){case"forwards":for(o=s.child,h=null;o!==null;)t=o.alternate,t!==null&&su(t)===null&&(h=o),o=o.sibling;o=h,o===null?(h=s.child,s.child=null):(h=o.sibling,o.sibling=null),Sf(s,!1,h,o,g);break;case"backwards":for(o=null,h=s.child,s.child=null;h!==null;){if(t=h.alternate,t!==null&&su(t)===null){s.child=h;break}t=h.sibling,h.sibling=o,o=h,h=t}Sf(s,!0,o,null,g);break;case"together":Sf(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function sa(t,s,o){if(t!==null&&(s.dependencies=t.dependencies),Ua|=s.lanes,(o&s.childLanes)===0)if(t!==null){if(Xo(t,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(t!==null&&s.child!==t.child)throw Error(r(153));if(s.child!==null){for(t=s.child,o=Xs(t,t.pendingProps),s.child=o,o.return=s;t.sibling!==null;)t=t.sibling,o=o.sibling=Xs(t,t.pendingProps),o.return=s;o.sibling=null}return s.child}function Af(t,s){return(t.lanes&s)!==0?!0:(t=t.dependencies,!!(t!==null&&Uc(t)))}function OE(t,s,o){switch(s.tag){case 3:_e(s,s.stateNode.containerInfo),Ra(s,Zt,t.memoizedState.cache),Yo();break;case 27:case 5:Be(s);break;case 4:_e(s,s.stateNode.containerInfo);break;case 10:Ra(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(Oa(s),s.flags|=128,null):(o&s.child.childLanes)!==0?$g(t,s,o):(Oa(s),t=sa(t,s,o),t!==null?t.sibling:null);Oa(s);break;case 19:var h=(t.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(Xo(t,s,o,!1),c=(o&s.childLanes)!==0),h){if(c)return Kg(t,s,o);s.flags|=128}if(h=s.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),W(Jt,Jt.current),c)break;return null;case 22:case 23:return s.lanes=0,Vg(t,s,o);case 24:Ra(s,Zt,t.memoizedState.cache)}return sa(t,s,o)}function Yg(t,s,o){if(t!==null)if(t.memoizedProps!==s.pendingProps)an=!0;else{if(!Af(t,o)&&(s.flags&128)===0)return an=!1,OE(t,s,o);an=(t.flags&131072)!==0}else an=!1,dt&&(s.flags&1048576)!==0&&Ap(s,Vc,s.index);switch(s.lanes=0,s.tag){case 16:e:{t=s.pendingProps;var c=s.elementType,h=c._init;if(c=h(c._payload),s.type=c,typeof c=="function")Ih(c)?(t=Jr(c,t),s.tag=1,s=qg(null,s,c,t,o)):(s.tag=0,s=xf(null,s,c,t,o));else{if(c!=null){if(h=c.$$typeof,h===N){s.tag=11,s=Mg(null,s,c,t,o);break e}else if(h===E){s.tag=14,s=Fg(null,s,c,t,o);break e}}throw s=ve(c)||c,Error(r(306,s,""))}}return s;case 0:return xf(t,s,s.type,s.pendingProps,o);case 1:return c=s.type,h=Jr(c,s.pendingProps),qg(t,s,c,h,o);case 3:e:{if(_e(s,s.stateNode.containerInfo),t===null)throw Error(r(387));c=s.pendingProps;var g=s.memoizedState;h=g.element,Gh(t,s),sl(s,c,null,o);var j=s.memoizedState;if(c=j.cache,Ra(s,Zt,c),c!==g.cache&&Vh(s,[Zt],o,!0),nl(),c=j.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:j.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=Hg(t,s,c,o);break e}else if(c!==h){h=Yn(Error(r(424)),s),Qo(h),s=Hg(t,s,c,o);break e}else{switch(t=s.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Ft=fs(t.firstChild),Cn=s,dt=!0,Kr=null,Ts=!0,o=wg(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Yo(),c===h){s=sa(t,s,o);break e}un(t,s,c,o)}s=s.child}return s;case 26:return iu(t,s),t===null?(o=Zx(s.type,null,s.pendingProps,null))?s.memoizedState=o:dt||(o=s.type,t=s.pendingProps,c=bu(he.current).createElement(o),c[kt]=s,c[ut]=t,hn(c,o,t),Vt(c),s.stateNode=c):s.memoizedState=Zx(s.type,t.memoizedProps,s.pendingProps,t.memoizedState),null;case 27:return Be(s),t===null&&dt&&(c=s.stateNode=Qx(s.type,s.pendingProps,he.current),Cn=s,Ts=!0,h=Ft,$a(s.type)?(a0=h,Ft=fs(c.firstChild)):Ft=h),un(t,s,s.pendingProps.children,o),iu(t,s),t===null&&(s.flags|=4194304),s.child;case 5:return t===null&&dt&&((h=c=Ft)&&(c=cS(c,s.type,s.pendingProps,Ts),c!==null?(s.stateNode=c,Cn=s,Ft=fs(c.firstChild),Ts=!1,h=!0):h=!1),h||Yr(s)),Be(s),h=s.type,g=s.pendingProps,j=t!==null?t.memoizedProps:null,c=g.children,e0(h,g)?c=null:j!==null&&e0(h,j)&&(s.flags|=32),s.memoizedState!==null&&(h=Zh(t,s,CE,null,null,o),Nl._currentValue=h),iu(t,s),un(t,s,c,o),s.child;case 6:return t===null&&dt&&((t=o=Ft)&&(o=uS(o,s.pendingProps,Ts),o!==null?(s.stateNode=o,Cn=s,Ft=null,t=!0):t=!1),t||Yr(s)),null;case 13:return $g(t,s,o);case 4:return _e(s,s.stateNode.containerInfo),c=s.pendingProps,t===null?s.child=Gi(s,null,c,o):un(t,s,c,o),s.child;case 11:return Mg(t,s,s.type,s.pendingProps,o);case 7:return un(t,s,s.pendingProps,o),s.child;case 8:return un(t,s,s.pendingProps.children,o),s.child;case 12:return un(t,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,Ra(s,s.type,c.value),un(t,s,c.children,o),s.child;case 9:return h=s.type._context,c=s.pendingProps.children,Xr(s),h=xn(h),c=c(h),s.flags|=1,un(t,s,c,o),s.child;case 14:return Fg(t,s,s.type,s.pendingProps,o);case 15:return Lg(t,s,s.type,s.pendingProps,o);case 19:return Kg(t,s,o);case 31:return c=s.pendingProps,o=s.mode,c={mode:c.mode,children:c.children},t===null?(o=ou(c,o),o.ref=s.ref,s.child=o,o.return=s,s=o):(o=Xs(t.child,c),o.ref=s.ref,s.child=o,o.return=s,s=o),s;case 22:return Vg(t,s,o);case 24:return Xr(s),c=xn(Zt),t===null?(h=qh(),h===null&&(h=Ct,g=Uh(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=o),h=g),s.memoizedState={parent:c,cache:h},$h(s),Ra(s,Zt,h)):((t.lanes&o)!==0&&(Gh(t,s),sl(s,null,null,o),nl()),h=t.memoizedState,g=s.memoizedState,h.parent!==c?(h={parent:c,cache:c},s.memoizedState=h,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=h),Ra(s,Zt,c)):(c=g.cache,Ra(s,Zt,c),c!==h.cache&&Vh(s,[Zt],o,!0))),un(t,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function aa(t){t.flags|=4}function Qg(t,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!sv(s)){if(s=Zn.current,s!==null&&((at&4194048)===at?Rs!==null:(at&62914560)!==at&&(at&536870912)===0||s!==Rs))throw el=Hh,Ip;t.flags|=8192}}function lu(t,s){s!==null&&(t.flags|=4),t.flags&16384&&(s=t.tag!==22?ss():536870912,t.lanes|=s,Xi|=s)}function ul(t,s){if(!dt)switch(t.tailMode){case"hidden":s=t.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Bt(t){var s=t.alternate!==null&&t.alternate.child===t.child,o=0,c=0;if(s)for(var h=t.child;h!==null;)o|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)o|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=o,s}function BE(t,s,o){var c=s.pendingProps;switch(Bh(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(s),null;case 1:return Bt(s),null;case 3:return o=s.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),ea(Zt),be(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Ko(s)?aa(s):t===null||t.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Cp())),Bt(s),null;case 26:return o=s.memoizedState,t===null?(aa(s),o!==null?(Bt(s),Qg(s,o)):(Bt(s),s.flags&=-16777217)):o?o!==t.memoizedState?(aa(s),Bt(s),Qg(s,o)):(Bt(s),s.flags&=-16777217):(t.memoizedProps!==c&&aa(s),Bt(s),s.flags&=-16777217),null;case 27:Qe(s),o=he.current;var h=s.type;if(t!==null&&s.stateNode!=null)t.memoizedProps!==c&&aa(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Bt(s),null}t=J.current,Ko(s)?Np(s):(t=Qx(h,c,o),s.stateNode=t,aa(s))}return Bt(s),null;case 5:if(Qe(s),o=s.type,t!==null&&s.stateNode!=null)t.memoizedProps!==c&&aa(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Bt(s),null}if(t=J.current,Ko(s))Np(s);else{switch(h=bu(he.current),t){case 1:t=h.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:t=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":t=h.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":t=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof c.is=="string"?h.createElement("select",{is:c.is}):h.createElement("select"),c.multiple?t.multiple=!0:c.size&&(t.size=c.size);break;default:t=typeof c.is=="string"?h.createElement(o,{is:c.is}):h.createElement(o)}}t[kt]=s,t[ut]=c;e:for(h=s.child;h!==null;){if(h.tag===5||h.tag===6)t.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break e;for(;h.sibling===null;){if(h.return===null||h.return===s)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}s.stateNode=t;e:switch(hn(t,o,c),o){case"button":case"input":case"select":case"textarea":t=!!c.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&aa(s)}}return Bt(s),s.flags&=-16777217,null;case 6:if(t&&s.stateNode!=null)t.memoizedProps!==c&&aa(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(r(166));if(t=he.current,Ko(s)){if(t=s.stateNode,o=s.memoizedProps,c=null,h=Cn,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[kt]=s,t=!!(t.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||zx(t.nodeValue,o)),t||Yr(s)}else t=bu(t).createTextNode(c),t[kt]=s,s.stateNode=t}return Bt(s),null;case 13:if(c=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Ko(s),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(r(318));if(h=s.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[kt]=s}else Yo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Bt(s),h=!1}else h=Cp(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return s.flags&256?(na(s),s):(na(s),null)}if(na(s),(s.flags&128)!==0)return s.lanes=o,s;if(o=c!==null,t=t!==null&&t.memoizedState!==null,o){c=s.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool);var g=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048)}return o!==t&&o&&(s.child.flags|=8192),lu(s,s.updateQueue),Bt(s),null;case 4:return be(),t===null&&Qf(s.stateNode.containerInfo),Bt(s),null;case 10:return ea(s.type),Bt(s),null;case 19:if(z(Jt),h=s.memoizedState,h===null)return Bt(s),null;if(c=(s.flags&128)!==0,g=h.rendering,g===null)if(c)ul(h,!1);else{if(Lt!==0||t!==null&&(t.flags&128)!==0)for(t=s.child;t!==null;){if(g=su(t),g!==null){for(s.flags|=128,ul(h,!1),t=g.updateQueue,s.updateQueue=t,lu(s,t),s.subtreeFlags=0,t=o,o=s.child;o!==null;)Sp(o,t),o=o.sibling;return W(Jt,Jt.current&1|2),s.child}t=t.sibling}h.tail!==null&&it()>du&&(s.flags|=128,c=!0,ul(h,!1),s.lanes=4194304)}else{if(!c)if(t=su(g),t!==null){if(s.flags|=128,c=!0,t=t.updateQueue,s.updateQueue=t,lu(s,t),ul(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!dt)return Bt(s),null}else 2*it()-h.renderingStartTime>du&&o!==536870912&&(s.flags|=128,c=!0,ul(h,!1),s.lanes=4194304);h.isBackwards?(g.sibling=s.child,s.child=g):(t=h.last,t!==null?t.sibling=g:s.child=g,h.last=g)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=it(),s.sibling=null,t=Jt.current,W(Jt,c?t&1|2:t&1),s):(Bt(s),null);case 22:case 23:return na(s),Xh(),c=s.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(Bt(s),s.subtreeFlags&6&&(s.flags|=8192)):Bt(s),o=s.updateQueue,o!==null&&lu(s,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),t!==null&&z(Wr),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),ea(Zt),Bt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function ME(t,s){switch(Bh(s),s.tag){case 1:return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return ea(Zt),be(),t=s.flags,(t&65536)!==0&&(t&128)===0?(s.flags=t&-65537|128,s):null;case 26:case 27:case 5:return Qe(s),null;case 13:if(na(s),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Yo()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return z(Jt),null;case 4:return be(),null;case 10:return ea(s.type),null;case 22:case 23:return na(s),Xh(),t!==null&&z(Wr),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 24:return ea(Zt),null;case 25:return null;default:return null}}function Xg(t,s){switch(Bh(s),s.tag){case 3:ea(Zt),be();break;case 26:case 27:case 5:Qe(s);break;case 4:be();break;case 13:na(s);break;case 19:z(Jt);break;case 10:ea(s.type);break;case 22:case 23:na(s),Xh(),t!==null&&z(Wr);break;case 24:ea(Zt)}}function dl(t,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var h=c.next;o=h;do{if((o.tag&t)===t){c=void 0;var g=o.create,j=o.inst;c=g(),j.destroy=c}o=o.next}while(o!==h)}}catch(M){St(s,s.return,M)}}function Ma(t,s,o){try{var c=s.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&t)===t){var j=c.inst,M=j.destroy;if(M!==void 0){j.destroy=void 0,h=s;var $=o,ne=M;try{ne()}catch(ce){St(h,$,ce)}}}c=c.next}while(c!==g)}}catch(ce){St(s,s.return,ce)}}function Wg(t){var s=t.updateQueue;if(s!==null){var o=t.stateNode;try{Fp(s,o)}catch(c){St(t,t.return,c)}}}function Zg(t,s,o){o.props=Jr(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(c){St(t,s,c)}}function hl(t,s){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof o=="function"?t.refCleanup=o(c):o.current=c}}catch(h){St(t,s,h)}}function Ds(t,s){var o=t.ref,c=t.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(h){St(t,s,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(h){St(t,s,h)}else o.current=null}function Jg(t){var s=t.type,o=t.memoizedProps,c=t.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(h){St(t,t.return,h)}}function Nf(t,s,o){try{var c=t.stateNode;aS(c,t.type,o,s),c[ut]=s}catch(h){St(t,t.return,h)}}function ex(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&$a(t.type)||t.tag===4}function wf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ex(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&$a(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Cf(t,s,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(t),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=_u));else if(c!==4&&(c===27&&$a(t.type)&&(o=t.stateNode,s=null),t=t.child,t!==null))for(Cf(t,s,o),t=t.sibling;t!==null;)Cf(t,s,o),t=t.sibling}function cu(t,s,o){var c=t.tag;if(c===5||c===6)t=t.stateNode,s?o.insertBefore(t,s):o.appendChild(t);else if(c!==4&&(c===27&&$a(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(cu(t,s,o),t=t.sibling;t!==null;)cu(t,s,o),t=t.sibling}function tx(t){var s=t.stateNode,o=t.memoizedProps;try{for(var c=t.type,h=s.attributes;h.length;)s.removeAttributeNode(h[0]);hn(s,c,o),s[kt]=t,s[ut]=o}catch(g){St(t,t.return,g)}}var ra=!1,qt=!1,jf=!1,nx=typeof WeakSet=="function"?WeakSet:Set,rn=null;function FE(t,s){if(t=t.containerInfo,Zf=Cu,t=fp(t),Nh(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var h=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var j=0,M=-1,$=-1,ne=0,ce=0,fe=t,ae=null;t:for(;;){for(var re;fe!==o||h!==0&&fe.nodeType!==3||(M=j+h),fe!==g||c!==0&&fe.nodeType!==3||($=j+c),fe.nodeType===3&&(j+=fe.nodeValue.length),(re=fe.firstChild)!==null;)ae=fe,fe=re;for(;;){if(fe===t)break t;if(ae===o&&++ne===h&&(M=j),ae===g&&++ce===c&&($=j),(re=fe.nextSibling)!==null)break;fe=ae,ae=fe.parentNode}fe=re}o=M===-1||$===-1?null:{start:M,end:$}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jf={focusedElem:t,selectionRange:o},Cu=!1,rn=s;rn!==null;)if(s=rn,t=s.child,(s.subtreeFlags&1024)!==0&&t!==null)t.return=s,rn=t;else for(;rn!==null;){switch(s=rn,g=s.alternate,t=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,o=s,h=g.memoizedProps,g=g.memoizedState,c=o.stateNode;try{var ze=Jr(o.type,h,o.elementType===o.type);t=c.getSnapshotBeforeUpdate(ze,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(Oe){St(o,o.return,Oe)}}break;case 3:if((t&1024)!==0){if(t=s.stateNode.containerInfo,o=t.nodeType,o===9)n0(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":n0(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(r(163))}if(t=s.sibling,t!==null){t.return=s.return,rn=t;break}rn=s.return}}function sx(t,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Fa(t,o),c&4&&dl(5,o);break;case 1:if(Fa(t,o),c&4)if(t=o.stateNode,s===null)try{t.componentDidMount()}catch(j){St(o,o.return,j)}else{var h=Jr(o.type,s.memoizedProps);s=s.memoizedState;try{t.componentDidUpdate(h,s,t.__reactInternalSnapshotBeforeUpdate)}catch(j){St(o,o.return,j)}}c&64&&Wg(o),c&512&&hl(o,o.return);break;case 3:if(Fa(t,o),c&64&&(t=o.updateQueue,t!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{Fp(t,s)}catch(j){St(o,o.return,j)}}break;case 27:s===null&&c&4&&tx(o);case 26:case 5:Fa(t,o),s===null&&c&4&&Jg(o),c&512&&hl(o,o.return);break;case 12:Fa(t,o);break;case 13:Fa(t,o),c&4&&ix(t,o),c&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=KE.bind(null,o),dS(t,o))));break;case 22:if(c=o.memoizedState!==null||ra,!c){s=s!==null&&s.memoizedState!==null||qt,h=ra;var g=qt;ra=c,(qt=s)&&!g?La(t,o,(o.subtreeFlags&8772)!==0):Fa(t,o),ra=h,qt=g}break;case 30:break;default:Fa(t,o)}}function ax(t){var s=t.alternate;s!==null&&(t.alternate=null,ax(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&_i(s)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Pt=null,Dn=!1;function ia(t,s,o){for(o=o.child;o!==null;)rx(t,s,o),o=o.sibling}function rx(t,s,o){if(K&&typeof K.onCommitFiberUnmount=="function")try{K.onCommitFiberUnmount(ot,o)}catch{}switch(o.tag){case 26:qt||Ds(o,s),ia(t,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:qt||Ds(o,s);var c=Pt,h=Dn;$a(o.type)&&(Pt=o.stateNode,Dn=!1),ia(t,s,o),bl(o.stateNode),Pt=c,Dn=h;break;case 5:qt||Ds(o,s);case 6:if(c=Pt,h=Dn,Pt=null,ia(t,s,o),Pt=c,Dn=h,Pt!==null)if(Dn)try{(Pt.nodeType===9?Pt.body:Pt.nodeName==="HTML"?Pt.ownerDocument.body:Pt).removeChild(o.stateNode)}catch(g){St(o,s,g)}else try{Pt.removeChild(o.stateNode)}catch(g){St(o,s,g)}break;case 18:Pt!==null&&(Dn?(t=Pt,Kx(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),Tl(t)):Kx(Pt,o.stateNode));break;case 4:c=Pt,h=Dn,Pt=o.stateNode.containerInfo,Dn=!0,ia(t,s,o),Pt=c,Dn=h;break;case 0:case 11:case 14:case 15:qt||Ma(2,o,s),qt||Ma(4,o,s),ia(t,s,o);break;case 1:qt||(Ds(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Zg(o,s,c)),ia(t,s,o);break;case 21:ia(t,s,o);break;case 22:qt=(c=qt)||o.memoizedState!==null,ia(t,s,o),qt=c;break;default:ia(t,s,o)}}function ix(t,s){if(s.memoizedState===null&&(t=s.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Tl(t)}catch(o){St(s,s.return,o)}}function LE(t){switch(t.tag){case 13:case 19:var s=t.stateNode;return s===null&&(s=t.stateNode=new nx),s;case 22:return t=t.stateNode,s=t._retryCache,s===null&&(s=t._retryCache=new nx),s;default:throw Error(r(435,t.tag))}}function Tf(t,s){var o=LE(t);s.forEach(function(c){var h=YE.bind(null,t,c);o.has(c)||(o.add(c),c.then(h,h))})}function Fn(t,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var h=o[c],g=t,j=s,M=j;e:for(;M!==null;){switch(M.tag){case 27:if($a(M.type)){Pt=M.stateNode,Dn=!1;break e}break;case 5:Pt=M.stateNode,Dn=!1;break e;case 3:case 4:Pt=M.stateNode.containerInfo,Dn=!0;break e}M=M.return}if(Pt===null)throw Error(r(160));rx(g,j,h),Pt=null,Dn=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)ox(s,t),s=s.sibling}var hs=null;function ox(t,s){var o=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Fn(s,t),Ln(t),c&4&&(Ma(3,t,t.return),dl(3,t),Ma(5,t,t.return));break;case 1:Fn(s,t),Ln(t),c&512&&(qt||o===null||Ds(o,o.return)),c&64&&ra&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var h=hs;if(Fn(s,t),Ln(t),c&512&&(qt||o===null||Ds(o,o.return)),c&4){var g=o!==null?o.memoizedState:null;if(c=t.memoizedState,o===null)if(c===null)if(t.stateNode===null){e:{c=t.type,o=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":g=h.getElementsByTagName("title")[0],(!g||g[_a]||g[kt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(c),h.head.insertBefore(g,h.querySelector("head > title"))),hn(g,c,o),g[kt]=t,Vt(g),c=g;break e;case"link":var j=tv("link","href",h).get(c+(o.href||""));if(j){for(var M=0;M<j.length;M++)if(g=j[M],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){j.splice(M,1);break t}}g=h.createElement(c),hn(g,c,o),h.head.appendChild(g);break;case"meta":if(j=tv("meta","content",h).get(c+(o.content||""))){for(M=0;M<j.length;M++)if(g=j[M],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){j.splice(M,1);break t}}g=h.createElement(c),hn(g,c,o),h.head.appendChild(g);break;default:throw Error(r(468,c))}g[kt]=t,Vt(g),c=g}t.stateNode=c}else nv(h,t.type,t.stateNode);else t.stateNode=ev(h,c,t.memoizedProps);else g!==c?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,c===null?nv(h,t.type,t.stateNode):ev(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Nf(t,t.memoizedProps,o.memoizedProps)}break;case 27:Fn(s,t),Ln(t),c&512&&(qt||o===null||Ds(o,o.return)),o!==null&&c&4&&Nf(t,t.memoizedProps,o.memoizedProps);break;case 5:if(Fn(s,t),Ln(t),c&512&&(qt||o===null||Ds(o,o.return)),t.flags&32){h=t.stateNode;try{Gn(h,"")}catch(re){St(t,t.return,re)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,Nf(t,h,o!==null?o.memoizedProps:h)),c&1024&&(jf=!0);break;case 6:if(Fn(s,t),Ln(t),c&4){if(t.stateNode===null)throw Error(r(162));c=t.memoizedProps,o=t.stateNode;try{o.nodeValue=c}catch(re){St(t,t.return,re)}}break;case 3:if(Au=null,h=hs,hs=Eu(s.containerInfo),Fn(s,t),hs=h,Ln(t),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Tl(s.containerInfo)}catch(re){St(t,t.return,re)}jf&&(jf=!1,lx(t));break;case 4:c=hs,hs=Eu(t.stateNode.containerInfo),Fn(s,t),Ln(t),hs=c;break;case 12:Fn(s,t),Ln(t);break;case 13:Fn(s,t),Ln(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Of=it()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Tf(t,c)));break;case 22:h=t.memoizedState!==null;var $=o!==null&&o.memoizedState!==null,ne=ra,ce=qt;if(ra=ne||h,qt=ce||$,Fn(s,t),qt=ce,ra=ne,Ln(t),c&8192)e:for(s=t.stateNode,s._visibility=h?s._visibility&-2:s._visibility|1,h&&(o===null||$||ra||qt||ei(t)),o=null,s=t;;){if(s.tag===5||s.tag===26){if(o===null){$=o=s;try{if(g=$.stateNode,h)j=g.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{M=$.stateNode;var fe=$.memoizedProps.style,ae=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;M.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(re){St($,$.return,re)}}}else if(s.tag===6){if(o===null){$=s;try{$.stateNode.nodeValue=h?"":$.memoizedProps}catch(re){St($,$.return,re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===t)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=t.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Tf(t,o))));break;case 19:Fn(s,t),Ln(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Tf(t,c)));break;case 30:break;case 21:break;default:Fn(s,t),Ln(t)}}function Ln(t){var s=t.flags;if(s&2){try{for(var o,c=t.return;c!==null;){if(ex(c)){o=c;break}c=c.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var h=o.stateNode,g=wf(t);cu(t,g,h);break;case 5:var j=o.stateNode;o.flags&32&&(Gn(j,""),o.flags&=-33);var M=wf(t);cu(t,M,j);break;case 3:case 4:var $=o.stateNode.containerInfo,ne=wf(t);Cf(t,ne,$);break;default:throw Error(r(161))}}catch(ce){St(t,t.return,ce)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function lx(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var s=t;lx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),t=t.sibling}}function Fa(t,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)sx(t,s.alternate,s),s=s.sibling}function ei(t){for(t=t.child;t!==null;){var s=t;switch(s.tag){case 0:case 11:case 14:case 15:Ma(4,s,s.return),ei(s);break;case 1:Ds(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Zg(s,s.return,o),ei(s);break;case 27:bl(s.stateNode);case 26:case 5:Ds(s,s.return),ei(s);break;case 22:s.memoizedState===null&&ei(s);break;case 30:ei(s);break;default:ei(s)}t=t.sibling}}function La(t,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,h=t,g=s,j=g.flags;switch(g.tag){case 0:case 11:case 15:La(h,g,o),dl(4,g);break;case 1:if(La(h,g,o),c=g,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(ne){St(c,c.return,ne)}if(c=g,h=c.updateQueue,h!==null){var M=c.stateNode;try{var $=h.shared.hiddenCallbacks;if($!==null)for(h.shared.hiddenCallbacks=null,h=0;h<$.length;h++)Mp($[h],M)}catch(ne){St(c,c.return,ne)}}o&&j&64&&Wg(g),hl(g,g.return);break;case 27:tx(g);case 26:case 5:La(h,g,o),o&&c===null&&j&4&&Jg(g),hl(g,g.return);break;case 12:La(h,g,o);break;case 13:La(h,g,o),o&&j&4&&ix(h,g);break;case 22:g.memoizedState===null&&La(h,g,o),hl(g,g.return);break;case 30:break;default:La(h,g,o)}s=s.sibling}}function Rf(t,s){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(t=s.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&Wo(o))}function Df(t,s){t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&Wo(t))}function Is(t,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)cx(t,s,o,c),s=s.sibling}function cx(t,s,o,c){var h=s.flags;switch(s.tag){case 0:case 11:case 15:Is(t,s,o,c),h&2048&&dl(9,s);break;case 1:Is(t,s,o,c);break;case 3:Is(t,s,o,c),h&2048&&(t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&Wo(t)));break;case 12:if(h&2048){Is(t,s,o,c),t=s.stateNode;try{var g=s.memoizedProps,j=g.id,M=g.onPostCommit;typeof M=="function"&&M(j,s.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch($){St(s,s.return,$)}}else Is(t,s,o,c);break;case 13:Is(t,s,o,c);break;case 23:break;case 22:g=s.stateNode,j=s.alternate,s.memoizedState!==null?g._visibility&2?Is(t,s,o,c):fl(t,s):g._visibility&2?Is(t,s,o,c):(g._visibility|=2,Ki(t,s,o,c,(s.subtreeFlags&10256)!==0)),h&2048&&Rf(j,s);break;case 24:Is(t,s,o,c),h&2048&&Df(s.alternate,s);break;default:Is(t,s,o,c)}}function Ki(t,s,o,c,h){for(h=h&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var g=t,j=s,M=o,$=c,ne=j.flags;switch(j.tag){case 0:case 11:case 15:Ki(g,j,M,$,h),dl(8,j);break;case 23:break;case 22:var ce=j.stateNode;j.memoizedState!==null?ce._visibility&2?Ki(g,j,M,$,h):fl(g,j):(ce._visibility|=2,Ki(g,j,M,$,h)),h&&ne&2048&&Rf(j.alternate,j);break;case 24:Ki(g,j,M,$,h),h&&ne&2048&&Df(j.alternate,j);break;default:Ki(g,j,M,$,h)}s=s.sibling}}function fl(t,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=t,c=s,h=c.flags;switch(c.tag){case 22:fl(o,c),h&2048&&Rf(c.alternate,c);break;case 24:fl(o,c),h&2048&&Df(c.alternate,c);break;default:fl(o,c)}s=s.sibling}}var ml=8192;function Yi(t){if(t.subtreeFlags&ml)for(t=t.child;t!==null;)ux(t),t=t.sibling}function ux(t){switch(t.tag){case 26:Yi(t),t.flags&ml&&t.memoizedState!==null&&AS(hs,t.memoizedState,t.memoizedProps);break;case 5:Yi(t);break;case 3:case 4:var s=hs;hs=Eu(t.stateNode.containerInfo),Yi(t),hs=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=ml,ml=16777216,Yi(t),ml=s):Yi(t));break;default:Yi(t)}}function dx(t){var s=t.alternate;if(s!==null&&(t=s.child,t!==null)){s.child=null;do s=t.sibling,t.sibling=null,t=s;while(t!==null)}}function pl(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];rn=c,fx(c,t)}dx(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)hx(t),t=t.sibling}function hx(t){switch(t.tag){case 0:case 11:case 15:pl(t),t.flags&2048&&Ma(9,t,t.return);break;case 3:pl(t);break;case 12:pl(t);break;case 22:var s=t.stateNode;t.memoizedState!==null&&s._visibility&2&&(t.return===null||t.return.tag!==13)?(s._visibility&=-3,uu(t)):pl(t);break;default:pl(t)}}function uu(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];rn=c,fx(c,t)}dx(t)}for(t=t.child;t!==null;){switch(s=t,s.tag){case 0:case 11:case 15:Ma(8,s,s.return),uu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,uu(s));break;default:uu(s)}t=t.sibling}}function fx(t,s){for(;rn!==null;){var o=rn;switch(o.tag){case 0:case 11:case 15:Ma(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Wo(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,rn=c;else e:for(o=t;rn!==null;){c=rn;var h=c.sibling,g=c.return;if(ax(c),c===o){rn=null;break e}if(h!==null){h.return=g,rn=h;break e}rn=g}}}var VE={getCacheForType:function(t){var s=xn(Zt),o=s.data.get(t);return o===void 0&&(o=t(),s.data.set(t,o)),o}},UE=typeof WeakMap=="function"?WeakMap:Map,mt=0,Ct=null,Ze=null,at=0,pt=0,Vn=null,Va=!1,Qi=!1,If=!1,oa=0,Lt=0,Ua=0,ti=0,kf=0,Jn=0,Xi=0,gl=null,In=null,Pf=!1,Of=0,du=1/0,hu=null,za=null,dn=0,qa=null,Wi=null,Zi=0,Bf=0,Mf=null,mx=null,xl=0,Ff=null;function Un(){if((mt&2)!==0&&at!==0)return at&-at;if(Q.T!==null){var t=Li;return t!==0?t:$f()}return as()}function px(){Jn===0&&(Jn=(at&536870912)===0||dt?Er():536870912);var t=Zn.current;return t!==null&&(t.flags|=32),Jn}function zn(t,s,o){(t===Ct&&(pt===2||pt===9)||t.cancelPendingCommit!==null)&&(Ji(t,0),Ha(t,at,Jn,!1)),It(t,o),((mt&2)===0||t!==Ct)&&(t===Ct&&((mt&2)===0&&(ti|=o),Lt===4&&Ha(t,at,Jn,!1)),ks(t))}function gx(t,s,o){if((mt&6)!==0)throw Error(r(327));var c=!o&&(s&124)===0&&(s&t.expiredLanes)===0||vs(t,s),h=c?HE(t,s):Uf(t,s,!0),g=c;do{if(h===0){Qi&&!c&&Ha(t,s,0,!1);break}else{if(o=t.current.alternate,g&&!zE(o)){h=Uf(t,s,!1),g=!1;continue}if(h===2){if(g=s,t.errorRecoveryDisabledLanes&g)var j=0;else j=t.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){s=j;e:{var M=t;h=gl;var $=M.current.memoizedState.isDehydrated;if($&&(Ji(M,j).flags|=256),j=Uf(M,j,!1),j!==2){if(If&&!$){M.errorRecoveryDisabledLanes|=g,ti|=g,h=4;break e}g=In,In=h,g!==null&&(In===null?In=g:In.push.apply(In,g))}h=j}if(g=!1,h!==2)continue}}if(h===1){Ji(t,0),Ha(t,s,0,!0);break}e:{switch(c=t,g=h,g){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:Ha(c,s,Jn,!Va);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(h=Of+300-it(),10<h)){if(Ha(c,s,Jn,!Va),Tn(c,0,!0)!==0)break e;c.timeoutHandle=$x(xx.bind(null,c,o,In,hu,Pf,s,Jn,ti,Xi,Va,g,2,-0,0),h);break e}xx(c,o,In,hu,Pf,s,Jn,ti,Xi,Va,g,0,-0,0)}}break}while(!0);ks(t)}function xx(t,s,o,c,h,g,j,M,$,ne,ce,fe,ae,re){if(t.timeoutHandle=-1,fe=s.subtreeFlags,(fe&8192||(fe&16785408)===16785408)&&(Al={stylesheets:null,count:0,unsuspend:SS},ux(s),fe=NS(),fe!==null)){t.cancelPendingCommit=fe(Ax.bind(null,t,s,g,o,c,h,j,M,$,ce,1,ae,re)),Ha(t,g,j,!ne);return}Ax(t,s,g,o,c,h,j,M,$)}function zE(t){for(var s=t;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var h=o[c],g=h.getSnapshot;h=h.value;try{if(!Bn(g(),h))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ha(t,s,o,c){s&=~kf,s&=~ti,t.suspendedLanes|=s,t.pingedLanes&=~s,c&&(t.warmLanes|=s),c=t.expirationTimes;for(var h=s;0<h;){var g=31-le(h),j=1<<g;c[g]=-1,h&=~j}o!==0&&ys(t,o,s)}function fu(){return(mt&6)===0?(vl(0),!1):!0}function Lf(){if(Ze!==null){if(pt===0)var t=Ze.return;else t=Ze,Js=Qr=null,tf(t),$i=null,ll=0,t=Ze;for(;t!==null;)Xg(t.alternate,t),t=t.return;Ze=null}}function Ji(t,s){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,iS(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Lf(),Ct=t,Ze=o=Xs(t.current,null),at=s,pt=0,Vn=null,Va=!1,Qi=vs(t,s),If=!1,Xi=Jn=kf=ti=Ua=Lt=0,In=gl=null,Pf=!1,(s&8)!==0&&(s|=s&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=s;0<c;){var h=31-le(c),g=1<<h;s|=t[h],c&=~g}return oa=s,Oc(),o}function vx(t,s){Ye=null,Q.H=eu,s===Jo||s===Hc?(s=Op(),pt=3):s===Ip?(s=Op(),pt=4):pt=s===Bg?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Vn=s,Ze===null&&(Lt=1,ru(t,Yn(s,t.current)))}function yx(){var t=Q.H;return Q.H=eu,t===null?eu:t}function _x(){var t=Q.A;return Q.A=VE,t}function Vf(){Lt=4,Va||(at&4194048)!==at&&Zn.current!==null||(Qi=!0),(Ua&134217727)===0&&(ti&134217727)===0||Ct===null||Ha(Ct,at,Jn,!1)}function Uf(t,s,o){var c=mt;mt|=2;var h=yx(),g=_x();(Ct!==t||at!==s)&&(hu=null,Ji(t,s)),s=!1;var j=Lt;e:do try{if(pt!==0&&Ze!==null){var M=Ze,$=Vn;switch(pt){case 8:Lf(),j=6;break e;case 3:case 2:case 9:case 6:Zn.current===null&&(s=!0);var ne=pt;if(pt=0,Vn=null,eo(t,M,$,ne),o&&Qi){j=0;break e}break;default:ne=pt,pt=0,Vn=null,eo(t,M,$,ne)}}qE(),j=Lt;break}catch(ce){vx(t,ce)}while(!0);return s&&t.shellSuspendCounter++,Js=Qr=null,mt=c,Q.H=h,Q.A=g,Ze===null&&(Ct=null,at=0,Oc()),j}function qE(){for(;Ze!==null;)bx(Ze)}function HE(t,s){var o=mt;mt|=2;var c=yx(),h=_x();Ct!==t||at!==s?(hu=null,du=it()+500,Ji(t,s)):Qi=vs(t,s);e:do try{if(pt!==0&&Ze!==null){s=Ze;var g=Vn;t:switch(pt){case 1:pt=0,Vn=null,eo(t,s,g,1);break;case 2:case 9:if(kp(g)){pt=0,Vn=null,Ex(s);break}s=function(){pt!==2&&pt!==9||Ct!==t||(pt=7),ks(t)},g.then(s,s);break e;case 3:pt=7;break e;case 4:pt=5;break e;case 7:kp(g)?(pt=0,Vn=null,Ex(s)):(pt=0,Vn=null,eo(t,s,g,7));break;case 5:var j=null;switch(Ze.tag){case 26:j=Ze.memoizedState;case 5:case 27:var M=Ze;if(!j||sv(j)){pt=0,Vn=null;var $=M.sibling;if($!==null)Ze=$;else{var ne=M.return;ne!==null?(Ze=ne,mu(ne)):Ze=null}break t}}pt=0,Vn=null,eo(t,s,g,5);break;case 6:pt=0,Vn=null,eo(t,s,g,6);break;case 8:Lf(),Lt=6;break e;default:throw Error(r(462))}}$E();break}catch(ce){vx(t,ce)}while(!0);return Js=Qr=null,Q.H=c,Q.A=h,mt=o,Ze!==null?0:(Ct=null,at=0,Oc(),Lt)}function $E(){for(;Ze!==null&&!gt();)bx(Ze)}function bx(t){var s=Yg(t.alternate,t,oa);t.memoizedProps=t.pendingProps,s===null?mu(t):Ze=s}function Ex(t){var s=t,o=s.alternate;switch(s.tag){case 15:case 0:s=zg(o,s,s.pendingProps,s.type,void 0,at);break;case 11:s=zg(o,s,s.pendingProps,s.type.render,s.ref,at);break;case 5:tf(s);default:Xg(o,s),s=Ze=Sp(s,oa),s=Yg(o,s,oa)}t.memoizedProps=t.pendingProps,s===null?mu(t):Ze=s}function eo(t,s,o,c){Js=Qr=null,tf(s),$i=null,ll=0;var h=s.return;try{if(PE(t,h,s,o,at)){Lt=1,ru(t,Yn(o,t.current)),Ze=null;return}}catch(g){if(h!==null)throw Ze=h,g;Lt=1,ru(t,Yn(o,t.current)),Ze=null;return}s.flags&32768?(dt||c===1?t=!0:Qi||(at&536870912)!==0?t=!1:(Va=t=!0,(c===2||c===9||c===3||c===6)&&(c=Zn.current,c!==null&&c.tag===13&&(c.flags|=16384))),Sx(s,t)):mu(s)}function mu(t){var s=t;do{if((s.flags&32768)!==0){Sx(s,Va);return}t=s.return;var o=BE(s.alternate,s,oa);if(o!==null){Ze=o;return}if(s=s.sibling,s!==null){Ze=s;return}Ze=s=t}while(s!==null);Lt===0&&(Lt=5)}function Sx(t,s){do{var o=ME(t.alternate,t);if(o!==null){o.flags&=32767,Ze=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(t=t.sibling,t!==null)){Ze=t;return}Ze=t=o}while(t!==null);Lt=6,Ze=null}function Ax(t,s,o,c,h,g,j,M,$){t.cancelPendingCommit=null;do pu();while(dn!==0);if((mt&6)!==0)throw Error(r(327));if(s!==null){if(s===t.current)throw Error(r(177));if(g=s.lanes|s.childLanes,g|=Rh,vi(t,o,g,j,M,$),t===Ct&&(Ze=Ct=null,at=0),Wi=s,qa=t,Zi=o,Bf=g,Mf=h,mx=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,QE(Ue,function(){return Tx(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=Q.T,Q.T=null,h=ue.p,ue.p=2,j=mt,mt|=4;try{FE(t,s,o)}finally{mt=j,ue.p=h,Q.T=c}}dn=1,Nx(),wx(),Cx()}}function Nx(){if(dn===1){dn=0;var t=qa,s=Wi,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=Q.T,Q.T=null;var c=ue.p;ue.p=2;var h=mt;mt|=4;try{ox(s,t);var g=Jf,j=fp(t.containerInfo),M=g.focusedElem,$=g.selectionRange;if(j!==M&&M&&M.ownerDocument&&hp(M.ownerDocument.documentElement,M)){if($!==null&&Nh(M)){var ne=$.start,ce=$.end;if(ce===void 0&&(ce=ne),"selectionStart"in M)M.selectionStart=ne,M.selectionEnd=Math.min(ce,M.value.length);else{var fe=M.ownerDocument||document,ae=fe&&fe.defaultView||window;if(ae.getSelection){var re=ae.getSelection(),ze=M.textContent.length,Oe=Math.min($.start,ze),Et=$.end===void 0?Oe:Math.min($.end,ze);!re.extend&&Oe>Et&&(j=Et,Et=Oe,Oe=j);var Z=dp(M,Oe),Y=dp(M,Et);if(Z&&Y&&(re.rangeCount!==1||re.anchorNode!==Z.node||re.anchorOffset!==Z.offset||re.focusNode!==Y.node||re.focusOffset!==Y.offset)){var ee=fe.createRange();ee.setStart(Z.node,Z.offset),re.removeAllRanges(),Oe>Et?(re.addRange(ee),re.extend(Y.node,Y.offset)):(ee.setEnd(Y.node,Y.offset),re.addRange(ee))}}}}for(fe=[],re=M;re=re.parentNode;)re.nodeType===1&&fe.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<fe.length;M++){var de=fe[M];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}Cu=!!Zf,Jf=Zf=null}finally{mt=h,ue.p=c,Q.T=o}}t.current=s,dn=2}}function wx(){if(dn===2){dn=0;var t=qa,s=Wi,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=Q.T,Q.T=null;var c=ue.p;ue.p=2;var h=mt;mt|=4;try{sx(t,s.alternate,s)}finally{mt=h,ue.p=c,Q.T=o}}dn=3}}function Cx(){if(dn===4||dn===3){dn=0,Fe();var t=qa,s=Wi,o=Zi,c=mx;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?dn=5:(dn=0,Wi=qa=null,jx(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(za=null),Sr(o),s=s.stateNode,K&&typeof K.onCommitFiberRoot=="function")try{K.onCommitFiberRoot(ot,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=Q.T,h=ue.p,ue.p=2,Q.T=null;try{for(var g=t.onRecoverableError,j=0;j<c.length;j++){var M=c[j];g(M.value,{componentStack:M.stack})}}finally{Q.T=s,ue.p=h}}(Zi&3)!==0&&pu(),ks(t),h=t.pendingLanes,(o&4194090)!==0&&(h&42)!==0?t===Ff?xl++:(xl=0,Ff=t):xl=0,vl(0)}}function jx(t,s){(t.pooledCacheLanes&=s)===0&&(s=t.pooledCache,s!=null&&(t.pooledCache=null,Wo(s)))}function pu(t){return Nx(),wx(),Cx(),Tx()}function Tx(){if(dn!==5)return!1;var t=qa,s=Bf;Bf=0;var o=Sr(Zi),c=Q.T,h=ue.p;try{ue.p=32>o?32:o,Q.T=null,o=Mf,Mf=null;var g=qa,j=Zi;if(dn=0,Wi=qa=null,Zi=0,(mt&6)!==0)throw Error(r(331));var M=mt;if(mt|=4,hx(g.current),cx(g,g.current,j,o),mt=M,vl(0,!1),K&&typeof K.onPostCommitFiberRoot=="function")try{K.onPostCommitFiberRoot(ot,g)}catch{}return!0}finally{ue.p=h,Q.T=c,jx(t,s)}}function Rx(t,s,o){s=Yn(o,s),s=gf(t.stateNode,s,2),t=ka(t,s,2),t!==null&&(It(t,2),ks(t))}function St(t,s,o){if(t.tag===3)Rx(t,t,o);else for(;s!==null;){if(s.tag===3){Rx(s,t,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(za===null||!za.has(c))){t=Yn(o,t),o=Pg(2),c=ka(s,o,2),c!==null&&(Og(o,c,s,t),It(c,2),ks(c));break}}s=s.return}}function zf(t,s,o){var c=t.pingCache;if(c===null){c=t.pingCache=new UE;var h=new Set;c.set(s,h)}else h=c.get(s),h===void 0&&(h=new Set,c.set(s,h));h.has(o)||(If=!0,h.add(o),t=GE.bind(null,t,s,o),s.then(t,t))}function GE(t,s,o){var c=t.pingCache;c!==null&&c.delete(s),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Ct===t&&(at&o)===o&&(Lt===4||Lt===3&&(at&62914560)===at&&300>it()-Of?(mt&2)===0&&Ji(t,0):kf|=o,Xi===at&&(Xi=0)),ks(t)}function Dx(t,s){s===0&&(s=ss()),t=Oi(t,s),t!==null&&(It(t,s),ks(t))}function KE(t){var s=t.memoizedState,o=0;s!==null&&(o=s.retryLane),Dx(t,o)}function YE(t,s){var o=0;switch(t.tag){case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(o=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(s),Dx(t,o)}function QE(t,s){return At(t,s)}var gu=null,to=null,qf=!1,xu=!1,Hf=!1,ni=0;function ks(t){t!==to&&t.next===null&&(to===null?gu=to=t:to=to.next=t),xu=!0,qf||(qf=!0,WE())}function vl(t,s){if(!Hf&&xu){Hf=!0;do for(var o=!1,c=gu;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var g=0;else{var j=c.suspendedLanes,M=c.pingedLanes;g=(1<<31-le(42|t)+1)-1,g&=h&~(j&~M),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,Ox(c,g))}else g=at,g=Tn(c,c===Ct?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||vs(c,g)||(o=!0,Ox(c,g));c=c.next}while(o);Hf=!1}}function XE(){Ix()}function Ix(){xu=qf=!1;var t=0;ni!==0&&(rS()&&(t=ni),ni=0);for(var s=it(),o=null,c=gu;c!==null;){var h=c.next,g=kx(c,s);g===0?(c.next=null,o===null?gu=h:o.next=h,h===null&&(to=o)):(o=c,(t!==0||(g&3)!==0)&&(xu=!0)),c=h}vl(t)}function kx(t,s){for(var o=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var j=31-le(g),M=1<<j,$=h[j];$===-1?((M&o)===0||(M&c)!==0)&&(h[j]=qs(M,s)):$<=s&&(t.expiredLanes|=M),g&=~M}if(s=Ct,o=at,o=Tn(t,t===s?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,o===0||t===s&&(pt===2||pt===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Nt(c),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||vs(t,o)){if(s=o&-o,s===t.callbackPriority)return s;switch(c!==null&&Nt(c),Sr(o)){case 2:case 8:o=ge;break;case 32:o=Ue;break;case 268435456:o=se;break;default:o=Ue}return c=Px.bind(null,t),o=At(o,c),t.callbackPriority=s,t.callbackNode=o,s}return c!==null&&c!==null&&Nt(c),t.callbackPriority=2,t.callbackNode=null,2}function Px(t,s){if(dn!==0&&dn!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(pu()&&t.callbackNode!==o)return null;var c=at;return c=Tn(t,t===Ct?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(gx(t,c,s),kx(t,it()),t.callbackNode!=null&&t.callbackNode===o?Px.bind(null,t):null)}function Ox(t,s){if(pu())return null;gx(t,s,!0)}function WE(){oS(function(){(mt&6)!==0?At(je,XE):Ix()})}function $f(){return ni===0&&(ni=Er()),ni}function Bx(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:os(""+t)}function Mx(t,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,t.id&&o.setAttribute("form",t.id),s.parentNode.insertBefore(o,s),t=new FormData(t),o.parentNode.removeChild(o),t}function ZE(t,s,o,c,h){if(s==="submit"&&o&&o.stateNode===h){var g=Bx((h[ut]||null).action),j=c.submitter;j&&(s=(s=j[ut]||null)?Bx(s.formAction):j.getAttribute("formAction"),s!==null&&(g=s,j=null));var M=new Or("action","action",null,c,h);t.push({event:M,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ni!==0){var $=j?Mx(h,j):new FormData(h);df(o,{pending:!0,data:$,method:h.method,action:g},null,$)}}else typeof g=="function"&&(M.preventDefault(),$=j?Mx(h,j):new FormData(h),df(o,{pending:!0,data:$,method:h.method,action:g},g,$))},currentTarget:h}]})}}for(var Gf=0;Gf<Th.length;Gf++){var Kf=Th[Gf],JE=Kf.toLowerCase(),eS=Kf[0].toUpperCase()+Kf.slice(1);ds(JE,"on"+eS)}ds(gp,"onAnimationEnd"),ds(xp,"onAnimationIteration"),ds(vp,"onAnimationStart"),ds("dblclick","onDoubleClick"),ds("focusin","onFocus"),ds("focusout","onBlur"),ds(xE,"onTransitionRun"),ds(vE,"onTransitionStart"),ds(yE,"onTransitionCancel"),ds(yp,"onTransitionEnd"),Ns("onMouseEnter",["mouseout","mouseover"]),Ns("onMouseLeave",["mouseout","mouseover"]),Ns("onPointerEnter",["pointerout","pointerover"]),Ns("onPointerLeave",["pointerout","pointerover"]),As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),As("onBeforeInput",["compositionend","keypress","textInput","paste"]),As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(yl));function Fx(t,s){s=(s&4)!==0;for(var o=0;o<t.length;o++){var c=t[o],h=c.event;c=c.listeners;e:{var g=void 0;if(s)for(var j=c.length-1;0<=j;j--){var M=c[j],$=M.instance,ne=M.currentTarget;if(M=M.listener,$!==g&&h.isPropagationStopped())break e;g=M,h.currentTarget=ne;try{g(h)}catch(ce){au(ce)}h.currentTarget=null,g=$}else for(j=0;j<c.length;j++){if(M=c[j],$=M.instance,ne=M.currentTarget,M=M.listener,$!==g&&h.isPropagationStopped())break e;g=M,h.currentTarget=ne;try{g(h)}catch(ce){au(ce)}h.currentTarget=null,g=$}}}}function Je(t,s){var o=s[bs];o===void 0&&(o=s[bs]=new Set);var c=t+"__bubble";o.has(c)||(Lx(s,t,2,!1),o.add(c))}function Yf(t,s,o){var c=0;s&&(c|=4),Lx(o,t,c,s)}var vu="_reactListening"+Math.random().toString(36).slice(2);function Qf(t){if(!t[vu]){t[vu]=!0,yc.forEach(function(o){o!=="selectionchange"&&(tS.has(o)||Yf(o,!1,t),Yf(o,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[vu]||(s[vu]=!0,Yf("selectionchange",!1,s))}}function Lx(t,s,o,c){switch(cv(s)){case 2:var h=jS;break;case 8:h=TS;break;default:h=c0}o=h.bind(null,s,o,t),h=void 0,!Ys||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(s,o,{capture:!0,passive:h}):t.addEventListener(s,o,!0):h!==void 0?t.addEventListener(s,o,{passive:h}):t.addEventListener(s,o,!1)}function Xf(t,s,o,c,h){var g=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var j=c.tag;if(j===3||j===4){var M=c.stateNode.containerInfo;if(M===h)break;if(j===4)for(j=c.return;j!==null;){var $=j.tag;if(($===3||$===4)&&j.stateNode.containerInfo===h)return;j=j.return}for(;M!==null;){if(j=Es(M),j===null)return;if($=j.tag,$===5||$===6||$===26||$===27){c=g=j;continue e}M=M.parentNode}}c=c.return}Ir(function(){var ne=g,ce=Bo(o),fe=[];e:{var ae=_p.get(t);if(ae!==void 0){var re=Or,ze=t;switch(t){case"keypress":if(kr(o)===0)break e;case"keydown":case"keyup":re=Di;break;case"focusin":ze="focus",re=ji;break;case"focusout":ze="blur",re=ji;break;case"beforeblur":case"afterblur":re=ji;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Vr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=wc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=Ta;break;case gp:case xp:case vp:re=Fo;break;case yp:re=y;break;case"scroll":case"scrollend":re=Mr;break;case"wheel":re=V;break;case"copy":case"cut":case"paste":re=jc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Uo;break;case"toggle":case"beforetoggle":re=oe}var Oe=(s&4)!==0,Et=!Oe&&(t==="scroll"||t==="scrollend"),Z=Oe?ae!==null?ae+"Capture":null:ae;Oe=[];for(var Y=ne,ee;Y!==null;){var de=Y;if(ee=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||ee===null||Z===null||(de=Ca(Y,Z),de!=null&&Oe.push(_l(Y,de,ee))),Et)break;Y=Y.return}0<Oe.length&&(ae=new re(ae,ze,null,o,ce),fe.push({event:ae,listeners:Oe}))}}if((s&7)===0){e:{if(ae=t==="mouseover"||t==="pointerover",re=t==="mouseout"||t==="pointerout",ae&&o!==Oo&&(ze=o.relatedTarget||o.fromElement)&&(Es(ze)||ze[nn]))break e;if((re||ae)&&(ae=ce.window===ce?ce:(ae=ce.ownerDocument)?ae.defaultView||ae.parentWindow:window,re?(ze=o.relatedTarget||o.toElement,re=ne,ze=ze?Es(ze):null,ze!==null&&(Et=u(ze),Oe=ze.tag,ze!==Et||Oe!==5&&Oe!==27&&Oe!==6)&&(ze=null)):(re=null,ze=ne),re!==ze)){if(Oe=Vr,de="onMouseLeave",Z="onMouseEnter",Y="mouse",(t==="pointerout"||t==="pointerover")&&(Oe=Uo,de="onPointerLeave",Z="onPointerEnter",Y="pointer"),Et=re==null?ae:ba(re),ee=ze==null?ae:ba(ze),ae=new Oe(de,Y+"leave",re,o,ce),ae.target=Et,ae.relatedTarget=ee,de=null,Es(ce)===ne&&(Oe=new Oe(Z,Y+"enter",ze,o,ce),Oe.target=ee,Oe.relatedTarget=Et,de=Oe),Et=de,re&&ze)t:{for(Oe=re,Z=ze,Y=0,ee=Oe;ee;ee=no(ee))Y++;for(ee=0,de=Z;de;de=no(de))ee++;for(;0<Y-ee;)Oe=no(Oe),Y--;for(;0<ee-Y;)Z=no(Z),ee--;for(;Y--;){if(Oe===Z||Z!==null&&Oe===Z.alternate)break t;Oe=no(Oe),Z=no(Z)}Oe=null}else Oe=null;re!==null&&Vx(fe,ae,re,Oe,!1),ze!==null&&Et!==null&&Vx(fe,Et,ze,Oe,!0)}}e:{if(ae=ne?ba(ne):window,re=ae.nodeName&&ae.nodeName.toLowerCase(),re==="select"||re==="input"&&ae.type==="file")var Re=rp;else if(sp(ae))if(ip)Re=mE;else{Re=hE;var We=dE}else re=ae.nodeName,!re||re.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?ne&&Ni(ne.elementType)&&(Re=rp):Re=fE;if(Re&&(Re=Re(t,ne))){ap(fe,Re,o,ce);break e}We&&We(t,ae,ne),t==="focusout"&&ne&&ae.type==="number"&&ne.memoizedProps.value!=null&&Io(ae,"number",ae.value)}switch(We=ne?ba(ne):window,t){case"focusin":(sp(We)||We.contentEditable==="true")&&(Ii=We,wh=ne,Go=null);break;case"focusout":Go=wh=Ii=null;break;case"mousedown":Ch=!0;break;case"contextmenu":case"mouseup":case"dragend":Ch=!1,mp(fe,o,ce);break;case"selectionchange":if(gE)break;case"keydown":case"keyup":mp(fe,o,ce)}var Ie;if($e)e:{switch(t){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else us?ls(t,o)&&(Me="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(Me="onCompositionStart");Me&&(Ut&&o.locale!=="ko"&&(us||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&us&&(Ie=Nc()):(Kn=ce,wt="value"in Kn?Kn.value:Kn.textContent,us=!0)),We=yu(ne,Me),0<We.length&&(Me=new Vo(Me,t,null,o,ce),fe.push({event:Me,listeners:We}),Ie?Me.data=Ie:(Ie=cs(o),Ie!==null&&(Me.data=Ie)))),(Ie=ft?zo(t,o):lE(t,o))&&(Me=yu(ne,"onBeforeInput"),0<Me.length&&(We=new Vo("onBeforeInput","beforeinput",null,o,ce),fe.push({event:We,listeners:Me}),We.data=Ie)),ZE(fe,t,ne,o,ce)}Fx(fe,s)})}function _l(t,s,o){return{instance:t,listener:s,currentTarget:o}}function yu(t,s){for(var o=s+"Capture",c=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=Ca(t,o),h!=null&&c.unshift(_l(t,h,g)),h=Ca(t,s),h!=null&&c.push(_l(t,h,g))),t.tag===3)return c;t=t.return}return[]}function no(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Vx(t,s,o,c,h){for(var g=s._reactName,j=[];o!==null&&o!==c;){var M=o,$=M.alternate,ne=M.stateNode;if(M=M.tag,$!==null&&$===c)break;M!==5&&M!==26&&M!==27||ne===null||($=ne,h?(ne=Ca(o,g),ne!=null&&j.unshift(_l(o,ne,$))):h||(ne=Ca(o,g),ne!=null&&j.push(_l(o,ne,$)))),o=o.return}j.length!==0&&t.push({event:s,listeners:j})}var nS=/\r\n?/g,sS=/\u0000|\uFFFD/g;function Ux(t){return(typeof t=="string"?t:""+t).replace(nS,`
`).replace(sS,"")}function zx(t,s){return s=Ux(s),Ux(t)===s}function _u(){}function bt(t,s,o,c,h,g){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Gn(t,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Gn(t,""+c);break;case"className":Cr(t,"class",c);break;case"tabIndex":Cr(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Cr(t,o,c);break;case"style":Po(t,c,g);break;case"data":if(s!=="object"){Cr(t,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){t.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=os(""+c),t.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(s!=="input"&&bt(t,s,"name",h.name,h,null),bt(t,s,"formEncType",h.formEncType,h,null),bt(t,s,"formMethod",h.formMethod,h,null),bt(t,s,"formTarget",h.formTarget,h,null)):(bt(t,s,"encType",h.encType,h,null),bt(t,s,"method",h.method,h,null),bt(t,s,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(o);break}c=os(""+c),t.setAttribute(o,c);break;case"onClick":c!=null&&(t.onclick=_u);break;case"onScroll":c!=null&&Je("scroll",t);break;case"onScrollEnd":c!=null&&Je("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(h.children!=null)throw Error(r(60));t.innerHTML=o}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}o=os(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""+c):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":c===!0?t.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(o,c):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(o,c):t.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(o):t.setAttribute(o,c);break;case"popover":Je("beforetoggle",t),Je("toggle",t),wr(t,"popover",c);break;case"xlinkActuate":$n(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":$n(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":$n(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":$n(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":$n(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":$n(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":$n(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":$n(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":$n(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":wr(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ec.get(o)||o,wr(t,o,c))}}function Wf(t,s,o,c,h,g){switch(o){case"style":Po(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(h.children!=null)throw Error(r(60));t.innerHTML=o}}break;case"children":typeof c=="string"?Gn(t,c):(typeof c=="number"||typeof c=="bigint")&&Gn(t,""+c);break;case"onScroll":c!=null&&Je("scroll",t);break;case"onScrollEnd":c!=null&&Je("scrollend",t);break;case"onClick":c!=null&&(t.onclick=_u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ar.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(h=o.endsWith("Capture"),s=o.slice(2,h?o.length-7:void 0),g=t[ut]||null,g=g!=null?g[o]:null,typeof g=="function"&&t.removeEventListener(s,g,h),typeof c=="function")){typeof g!="function"&&g!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(s,c,h);break e}o in t?t[o]=c:c===!0?t.setAttribute(o,""):wr(t,o,c)}}}function hn(t,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",t),Je("load",t);var c=!1,h=!1,g;for(g in o)if(o.hasOwnProperty(g)){var j=o[g];if(j!=null)switch(g){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:bt(t,s,g,j,o,null)}}h&&bt(t,s,"srcSet",o.srcSet,o,null),c&&bt(t,s,"src",o.src,o,null);return;case"input":Je("invalid",t);var M=g=j=h=null,$=null,ne=null;for(c in o)if(o.hasOwnProperty(c)){var ce=o[c];if(ce!=null)switch(c){case"name":h=ce;break;case"type":j=ce;break;case"checked":$=ce;break;case"defaultChecked":ne=ce;break;case"value":g=ce;break;case"defaultValue":M=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,s));break;default:bt(t,s,c,ce,o,null)}}Do(t,g,M,$,ne,j,h,!1),Aa(t);return;case"select":Je("invalid",t),c=j=g=null;for(h in o)if(o.hasOwnProperty(h)&&(M=o[h],M!=null))switch(h){case"value":g=M;break;case"defaultValue":j=M;break;case"multiple":c=M;default:bt(t,s,h,M,o,null)}s=g,o=j,t.multiple=!!c,s!=null?Na(t,!!c,s,!1):o!=null&&Na(t,!!c,o,!0);return;case"textarea":Je("invalid",t),g=h=c=null;for(j in o)if(o.hasOwnProperty(j)&&(M=o[j],M!=null))switch(j){case"value":c=M;break;case"defaultValue":h=M;break;case"children":g=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(r(91));break;default:bt(t,s,j,M,o,null)}bc(t,c,h,g),Aa(t);return;case"option":for($ in o)if(o.hasOwnProperty($)&&(c=o[$],c!=null))switch($){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:bt(t,s,$,c,o,null)}return;case"dialog":Je("beforetoggle",t),Je("toggle",t),Je("cancel",t),Je("close",t);break;case"iframe":case"object":Je("load",t);break;case"video":case"audio":for(c=0;c<yl.length;c++)Je(yl[c],t);break;case"image":Je("error",t),Je("load",t);break;case"details":Je("toggle",t);break;case"embed":case"source":case"link":Je("error",t),Je("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(c=o[ne],c!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:bt(t,s,ne,c,o,null)}return;default:if(Ni(s)){for(ce in o)o.hasOwnProperty(ce)&&(c=o[ce],c!==void 0&&Wf(t,s,ce,c,o,void 0));return}}for(M in o)o.hasOwnProperty(M)&&(c=o[M],c!=null&&bt(t,s,M,c,o,null))}function aS(t,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,j=null,M=null,$=null,ne=null,ce=null;for(re in o){var fe=o[re];if(o.hasOwnProperty(re)&&fe!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":$=fe;default:c.hasOwnProperty(re)||bt(t,s,re,null,c,fe)}}for(var ae in c){var re=c[ae];if(fe=o[ae],c.hasOwnProperty(ae)&&(re!=null||fe!=null))switch(ae){case"type":g=re;break;case"name":h=re;break;case"checked":ne=re;break;case"defaultChecked":ce=re;break;case"value":j=re;break;case"defaultValue":M=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,s));break;default:re!==fe&&bt(t,s,ae,re,c,fe)}}Ro(t,j,M,$,ne,ce,g,h);return;case"select":re=j=M=ae=null;for(g in o)if($=o[g],o.hasOwnProperty(g)&&$!=null)switch(g){case"value":break;case"multiple":re=$;default:c.hasOwnProperty(g)||bt(t,s,g,null,c,$)}for(h in c)if(g=c[h],$=o[h],c.hasOwnProperty(h)&&(g!=null||$!=null))switch(h){case"value":ae=g;break;case"defaultValue":M=g;break;case"multiple":j=g;default:g!==$&&bt(t,s,h,g,c,$)}s=M,o=j,c=re,ae!=null?Na(t,!!o,ae,!1):!!c!=!!o&&(s!=null?Na(t,!!o,s,!0):Na(t,!!o,o?[]:"",!1));return;case"textarea":re=ae=null;for(M in o)if(h=o[M],o.hasOwnProperty(M)&&h!=null&&!c.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:bt(t,s,M,null,c,h)}for(j in c)if(h=c[j],g=o[j],c.hasOwnProperty(j)&&(h!=null||g!=null))switch(j){case"value":ae=h;break;case"defaultValue":re=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(r(91));break;default:h!==g&&bt(t,s,j,h,c,g)}_c(t,ae,re);return;case"option":for(var ze in o)if(ae=o[ze],o.hasOwnProperty(ze)&&ae!=null&&!c.hasOwnProperty(ze))switch(ze){case"selected":t.selected=!1;break;default:bt(t,s,ze,null,c,ae)}for($ in c)if(ae=c[$],re=o[$],c.hasOwnProperty($)&&ae!==re&&(ae!=null||re!=null))switch($){case"selected":t.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:bt(t,s,$,ae,c,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Oe in o)ae=o[Oe],o.hasOwnProperty(Oe)&&ae!=null&&!c.hasOwnProperty(Oe)&&bt(t,s,Oe,null,c,ae);for(ne in c)if(ae=c[ne],re=o[ne],c.hasOwnProperty(ne)&&ae!==re&&(ae!=null||re!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,s));break;default:bt(t,s,ne,ae,c,re)}return;default:if(Ni(s)){for(var Et in o)ae=o[Et],o.hasOwnProperty(Et)&&ae!==void 0&&!c.hasOwnProperty(Et)&&Wf(t,s,Et,void 0,c,ae);for(ce in c)ae=c[ce],re=o[ce],!c.hasOwnProperty(ce)||ae===re||ae===void 0&&re===void 0||Wf(t,s,ce,ae,c,re);return}}for(var Z in o)ae=o[Z],o.hasOwnProperty(Z)&&ae!=null&&!c.hasOwnProperty(Z)&&bt(t,s,Z,null,c,ae);for(fe in c)ae=c[fe],re=o[fe],!c.hasOwnProperty(fe)||ae===re||ae==null&&re==null||bt(t,s,fe,ae,c,re)}var Zf=null,Jf=null;function bu(t){return t.nodeType===9?t:t.ownerDocument}function qx(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hx(t,s){if(t===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&s==="foreignObject"?0:t}function e0(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var t0=null;function rS(){var t=window.event;return t&&t.type==="popstate"?t===t0?!1:(t0=t,!0):(t0=null,!1)}var $x=typeof setTimeout=="function"?setTimeout:void 0,iS=typeof clearTimeout=="function"?clearTimeout:void 0,Gx=typeof Promise=="function"?Promise:void 0,oS=typeof queueMicrotask=="function"?queueMicrotask:typeof Gx<"u"?function(t){return Gx.resolve(null).then(t).catch(lS)}:$x;function lS(t){setTimeout(function(){throw t})}function $a(t){return t==="head"}function Kx(t,s){var o=s,c=0,h=0;do{var g=o.nextSibling;if(t.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(0<c&&8>c){o=c;var j=t.ownerDocument;if(o&1&&bl(j.documentElement),o&2&&bl(j.body),o&4)for(o=j.head,bl(o),j=o.firstChild;j;){var M=j.nextSibling,$=j.nodeName;j[_a]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&j.rel.toLowerCase()==="stylesheet"||o.removeChild(j),j=M}}if(h===0){t.removeChild(g),Tl(s);return}h--}else o==="$"||o==="$?"||o==="$!"?h++:c=o.charCodeAt(0)-48;else c=0;o=g}while(o);Tl(s)}function n0(t){var s=t.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":n0(o),_i(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function cS(t,s,o,c){for(;t.nodeType===1;){var h=o;if(t.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[_a])switch(s){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(s==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=fs(t.nextSibling),t===null)break}return null}function uS(t,s,o){if(s==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=fs(t.nextSibling),t===null))return null;return t}function s0(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function dS(t,s){var o=t.ownerDocument;if(t.data!=="$?"||o.readyState==="complete")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function fs(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return t}var a0=null;function Yx(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return t;s--}else o==="/$"&&s++}t=t.previousSibling}return null}function Qx(t,s,o){switch(s=bu(o),t){case"html":if(t=s.documentElement,!t)throw Error(r(452));return t;case"head":if(t=s.head,!t)throw Error(r(453));return t;case"body":if(t=s.body,!t)throw Error(r(454));return t;default:throw Error(r(451))}}function bl(t){for(var s=t.attributes;s.length;)t.removeAttributeNode(s[0]);_i(t)}var es=new Map,Xx=new Set;function Eu(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var la=ue.d;ue.d={f:hS,r:fS,D:mS,C:pS,L:gS,m:xS,X:yS,S:vS,M:_S};function hS(){var t=la.f(),s=fu();return t||s}function fS(t){var s=Ss(t);s!==null&&s.tag===5&&s.type==="form"?gg(s):la.r(t)}var so=typeof document>"u"?null:document;function Wx(t,s,o){var c=so;if(c&&typeof s=="string"&&s){var h=sn(s);h='link[rel="'+t+'"][href="'+h+'"]',typeof o=="string"&&(h+='[crossorigin="'+o+'"]'),Xx.has(h)||(Xx.add(h),t={rel:t,crossOrigin:o,href:s},c.querySelector(h)===null&&(s=c.createElement("link"),hn(s,"link",t),Vt(s),c.head.appendChild(s)))}}function mS(t){la.D(t),Wx("dns-prefetch",t,null)}function pS(t,s){la.C(t,s),Wx("preconnect",t,s)}function gS(t,s,o){la.L(t,s,o);var c=so;if(c&&t&&s){var h='link[rel="preload"][as="'+sn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(h+='[imagesrcset="'+sn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(h+='[imagesizes="'+sn(o.imageSizes)+'"]')):h+='[href="'+sn(t)+'"]';var g=h;switch(s){case"style":g=ao(t);break;case"script":g=ro(t)}es.has(g)||(t=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:t,as:s},o),es.set(g,t),c.querySelector(h)!==null||s==="style"&&c.querySelector(El(g))||s==="script"&&c.querySelector(Sl(g))||(s=c.createElement("link"),hn(s,"link",t),Vt(s),c.head.appendChild(s)))}}function xS(t,s){la.m(t,s);var o=so;if(o&&t){var c=s&&typeof s.as=="string"?s.as:"script",h='link[rel="modulepreload"][as="'+sn(c)+'"][href="'+sn(t)+'"]',g=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=ro(t)}if(!es.has(g)&&(t=v({rel:"modulepreload",href:t},s),es.set(g,t),o.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Sl(g)))return}c=o.createElement("link"),hn(c,"link",t),Vt(c),o.head.appendChild(c)}}}function vS(t,s,o){la.S(t,s,o);var c=so;if(c&&t){var h=Ea(c).hoistableStyles,g=ao(t);s=s||"default";var j=h.get(g);if(!j){var M={loading:0,preload:null};if(j=c.querySelector(El(g)))M.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":s},o),(o=es.get(g))&&r0(t,o);var $=j=c.createElement("link");Vt($),hn($,"link",t),$._p=new Promise(function(ne,ce){$.onload=ne,$.onerror=ce}),$.addEventListener("load",function(){M.loading|=1}),$.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Su(j,s,c)}j={type:"stylesheet",instance:j,count:1,state:M},h.set(g,j)}}}function yS(t,s){la.X(t,s);var o=so;if(o&&t){var c=Ea(o).hoistableScripts,h=ro(t),g=c.get(h);g||(g=o.querySelector(Sl(h)),g||(t=v({src:t,async:!0},s),(s=es.get(h))&&i0(t,s),g=o.createElement("script"),Vt(g),hn(g,"link",t),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function _S(t,s){la.M(t,s);var o=so;if(o&&t){var c=Ea(o).hoistableScripts,h=ro(t),g=c.get(h);g||(g=o.querySelector(Sl(h)),g||(t=v({src:t,async:!0,type:"module"},s),(s=es.get(h))&&i0(t,s),g=o.createElement("script"),Vt(g),hn(g,"link",t),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function Zx(t,s,o,c){var h=(h=he.current)?Eu(h):null;if(!h)throw Error(r(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=ao(o.href),o=Ea(h).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=ao(o.href);var g=Ea(h).hoistableStyles,j=g.get(t);if(j||(h=h.ownerDocument||h,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,j),(g=h.querySelector(El(t)))&&!g._p&&(j.instance=g,j.state.loading=5),es.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},es.set(t,o),g||bS(h,t,o,j.state))),s&&c===null)throw Error(r(528,""));return j}if(s&&c!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=ro(o),o=Ea(h).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,t))}}function ao(t){return'href="'+sn(t)+'"'}function El(t){return'link[rel="stylesheet"]['+t+"]"}function Jx(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function bS(t,s,o,c){t.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=t.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),hn(s,"link",o),Vt(s),t.head.appendChild(s))}function ro(t){return'[src="'+sn(t)+'"]'}function Sl(t){return"script[async]"+t}function ev(t,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=t.querySelector('style[data-href~="'+sn(o.href)+'"]');if(c)return s.instance=c,Vt(c),c;var h=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),Vt(c),hn(c,"style",h),Su(c,o.precedence,t),s.instance=c;case"stylesheet":h=ao(o.href);var g=t.querySelector(El(h));if(g)return s.state.loading|=4,s.instance=g,Vt(g),g;c=Jx(o),(h=es.get(h))&&r0(c,h),g=(t.ownerDocument||t).createElement("link"),Vt(g);var j=g;return j._p=new Promise(function(M,$){j.onload=M,j.onerror=$}),hn(g,"link",c),s.state.loading|=4,Su(g,o.precedence,t),s.instance=g;case"script":return g=ro(o.src),(h=t.querySelector(Sl(g)))?(s.instance=h,Vt(h),h):(c=o,(h=es.get(g))&&(c=v({},o),i0(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),Vt(h),hn(h,"link",c),t.head.appendChild(h),s.instance=h);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,Su(c,o.precedence,t));return s.instance}function Su(t,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,g=h,j=0;j<c.length;j++){var M=c[j];if(M.dataset.precedence===s)g=M;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(t,s.firstChild))}function r0(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.title==null&&(t.title=s.title)}function i0(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.integrity==null&&(t.integrity=s.integrity)}var Au=null;function tv(t,s,o){if(Au===null){var c=new Map,h=Au=new Map;h.set(o,c)}else h=Au,c=h.get(o),c||(c=new Map,h.set(o,c));if(c.has(t))return c;for(c.set(t,null),o=o.getElementsByTagName(t),h=0;h<o.length;h++){var g=o[h];if(!(g[_a]||g[kt]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var j=g.getAttribute(s)||"";j=t+j;var M=c.get(j);M?M.push(g):c.set(j,[g])}}return c}function nv(t,s,o){t=t.ownerDocument||t,t.head.insertBefore(o,s==="title"?t.querySelector("head > title"):null)}function ES(t,s,o){if(o===1||s.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return t=s.disabled,typeof s.precedence=="string"&&t==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function sv(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var Al=null;function SS(){}function AS(t,s,o){if(Al===null)throw Error(r(475));var c=Al;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var h=ao(o.href),g=t.querySelector(El(h));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(c.count++,c=Nu.bind(c),t.then(c,c)),s.state.loading|=4,s.instance=g,Vt(g);return}g=t.ownerDocument||t,o=Jx(o),(h=es.get(h))&&r0(o,h),g=g.createElement("link"),Vt(g);var j=g;j._p=new Promise(function(M,$){j.onload=M,j.onerror=$}),hn(g,"link",o),s.instance=g}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,t),(t=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=Nu.bind(c),t.addEventListener("load",s),t.addEventListener("error",s))}}function NS(){if(Al===null)throw Error(r(475));var t=Al;return t.stylesheets&&t.count===0&&o0(t,t.stylesheets),0<t.count?function(s){var o=setTimeout(function(){if(t.stylesheets&&o0(t,t.stylesheets),t.unsuspend){var c=t.unsuspend;t.unsuspend=null,c()}},6e4);return t.unsuspend=s,function(){t.unsuspend=null,clearTimeout(o)}}:null}function Nu(){if(this.count--,this.count===0){if(this.stylesheets)o0(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var wu=null;function o0(t,s){t.stylesheets=null,t.unsuspend!==null&&(t.count++,wu=new Map,s.forEach(wS,t),wu=null,Nu.call(t))}function wS(t,s){if(!(s.state.loading&4)){var o=wu.get(t);if(o)var c=o.get(null);else{o=new Map,wu.set(t,o);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var j=h[g];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(o.set(j.dataset.precedence,j),c=j)}c&&o.set(null,c)}h=s.instance,j=h.getAttribute("data-precedence"),g=o.get(j)||c,g===c&&o.set(null,h),o.set(j,h),this.count++,c=Nu.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),s.state.loading|=4}}var Nl={$$typeof:L,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function CS(t,s,o,c,h,g,j,M){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=va(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=va(0),this.hiddenUpdates=va(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function av(t,s,o,c,h,g,j,M,$,ne,ce,fe){return t=new CS(t,s,o,j,M,$,ne,fe),s=1,g===!0&&(s|=24),g=Mn(3,null,null,s),t.current=g,g.stateNode=t,s=Uh(),s.refCount++,t.pooledCache=s,s.refCount++,g.memoizedState={element:c,isDehydrated:o,cache:s},$h(g),t}function rv(t){return t?(t=Bi,t):Bi}function iv(t,s,o,c,h,g){h=rv(h),c.context===null?c.context=h:c.pendingContext=h,c=Ia(s),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=ka(t,c,s),o!==null&&(zn(o,t,s),tl(o,t,s))}function ov(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<s?o:s}}function l0(t,s){ov(t,s),(t=t.alternate)&&ov(t,s)}function lv(t){if(t.tag===13){var s=Oi(t,67108864);s!==null&&zn(s,t,67108864),l0(t,67108864)}}var Cu=!0;function jS(t,s,o,c){var h=Q.T;Q.T=null;var g=ue.p;try{ue.p=2,c0(t,s,o,c)}finally{ue.p=g,Q.T=h}}function TS(t,s,o,c){var h=Q.T;Q.T=null;var g=ue.p;try{ue.p=8,c0(t,s,o,c)}finally{ue.p=g,Q.T=h}}function c0(t,s,o,c){if(Cu){var h=u0(c);if(h===null)Xf(t,s,c,ju,o),uv(t,c);else if(DS(h,t,s,o,c))c.stopPropagation();else if(uv(t,c),s&4&&-1<RS.indexOf(t)){for(;h!==null;){var g=Ss(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var j=jn(g.pendingLanes);if(j!==0){var M=g;for(M.pendingLanes|=2,M.entangledLanes|=2;j;){var $=1<<31-le(j);M.entanglements[1]|=$,j&=~$}ks(g),(mt&6)===0&&(du=it()+500,vl(0))}}break;case 13:M=Oi(g,2),M!==null&&zn(M,g,2),fu(),l0(g,2)}if(g=u0(c),g===null&&Xf(t,s,c,ju,o),g===h)break;h=g}h!==null&&c.stopPropagation()}else Xf(t,s,c,null,o)}}function u0(t){return t=Bo(t),d0(t)}var ju=null;function d0(t){if(ju=null,t=Es(t),t!==null){var s=u(t);if(s===null)t=null;else{var o=s.tag;if(o===13){if(t=f(s),t!==null)return t;t=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null)}}return ju=t,null}function cv(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(we()){case je:return 2;case ge:return 8;case Ue:case Dt:return 32;case se:return 268435456;default:return 32}default:return 32}}var h0=!1,Ga=null,Ka=null,Ya=null,wl=new Map,Cl=new Map,Qa=[],RS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uv(t,s){switch(t){case"focusin":case"focusout":Ga=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":wl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cl.delete(s.pointerId)}}function jl(t,s,o,c,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:g,targetContainers:[h]},s!==null&&(s=Ss(s),s!==null&&lv(s)),t):(t.eventSystemFlags|=c,s=t.targetContainers,h!==null&&s.indexOf(h)===-1&&s.push(h),t)}function DS(t,s,o,c,h){switch(s){case"focusin":return Ga=jl(Ga,t,s,o,c,h),!0;case"dragenter":return Ka=jl(Ka,t,s,o,c,h),!0;case"mouseover":return Ya=jl(Ya,t,s,o,c,h),!0;case"pointerover":var g=h.pointerId;return wl.set(g,jl(wl.get(g)||null,t,s,o,c,h)),!0;case"gotpointercapture":return g=h.pointerId,Cl.set(g,jl(Cl.get(g)||null,t,s,o,c,h)),!0}return!1}function dv(t){var s=Es(t.target);if(s!==null){var o=u(s);if(o!==null){if(s=o.tag,s===13){if(s=f(o),s!==null){t.blockedOn=s,yi(t.priority,function(){if(o.tag===13){var c=Un();c=ya(c);var h=Oi(o,c);h!==null&&zn(h,o,c),l0(o,c)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Tu(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var o=u0(t.nativeEvent);if(o===null){o=t.nativeEvent;var c=new o.constructor(o.type,o);Oo=c,o.target.dispatchEvent(c),Oo=null}else return s=Ss(o),s!==null&&lv(s),t.blockedOn=o,!1;s.shift()}return!0}function hv(t,s,o){Tu(t)&&o.delete(s)}function IS(){h0=!1,Ga!==null&&Tu(Ga)&&(Ga=null),Ka!==null&&Tu(Ka)&&(Ka=null),Ya!==null&&Tu(Ya)&&(Ya=null),wl.forEach(hv),Cl.forEach(hv)}function Ru(t,s){t.blockedOn===s&&(t.blockedOn=null,h0||(h0=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,IS)))}var Du=null;function fv(t){Du!==t&&(Du=t,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Du===t&&(Du=null);for(var s=0;s<t.length;s+=3){var o=t[s],c=t[s+1],h=t[s+2];if(typeof c!="function"){if(d0(c||o)===null)continue;break}var g=Ss(o);g!==null&&(t.splice(s,3),s-=3,df(g,{pending:!0,data:h,method:o.method,action:c},c,h))}}))}function Tl(t){function s($){return Ru($,t)}Ga!==null&&Ru(Ga,t),Ka!==null&&Ru(Ka,t),Ya!==null&&Ru(Ya,t),wl.forEach(s),Cl.forEach(s);for(var o=0;o<Qa.length;o++){var c=Qa[o];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Qa.length&&(o=Qa[0],o.blockedOn===null);)dv(o),o.blockedOn===null&&Qa.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var h=o[c],g=o[c+1],j=h[ut]||null;if(typeof g=="function")j||fv(o);else if(j){var M=null;if(g&&g.hasAttribute("formAction")){if(h=g,j=g[ut]||null)M=j.formAction;else if(d0(h)!==null)continue}else M=j.action;typeof M=="function"?o[c+1]=M:(o.splice(c,3),c-=3),fv(o)}}}function f0(t){this._internalRoot=t}Iu.prototype.render=f0.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,c=Un();iv(o,c,t,s,null,null)},Iu.prototype.unmount=f0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;iv(t.current,2,null,t,null,null),fu(),s[nn]=null}};function Iu(t){this._internalRoot=t}Iu.prototype.unstable_scheduleHydration=function(t){if(t){var s=as();t={blockedOn:null,target:t,priority:s};for(var o=0;o<Qa.length&&s!==0&&s<Qa[o].priority;o++);Qa.splice(o,0,t),o===0&&dv(t)}};var mv=e.version;if(mv!=="19.1.1")throw Error(r(527,mv,"19.1.1"));ue.findDOMNode=function(t){var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=x(s),t=t!==null?m(t):null,t=t===null?null:t.stateNode,t};var kS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ku.isDisabled&&ku.supportsFiber)try{ot=ku.inject(kS),K=ku}catch{}}return Dl.createRoot=function(t,s){if(!l(t))throw Error(r(299));var o=!1,c="",h=Rg,g=Dg,j=Ig,M=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(h=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(j=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(M=s.unstable_transitionCallbacks)),s=av(t,1,!1,null,null,o,c,h,g,j,M,null),t[nn]=s.current,Qf(t),new f0(s)},Dl.hydrateRoot=function(t,s,o){if(!l(t))throw Error(r(299));var c=!1,h="",g=Rg,j=Dg,M=Ig,$=null,ne=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(j=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&($=o.unstable_transitionCallbacks),o.formState!==void 0&&(ne=o.formState)),s=av(t,1,!0,s,o??null,c,h,g,j,M,$,ne),s.context=rv(null),o=s.current,c=Un(),c=ya(c),h=Ia(c),h.callback=null,ka(o,h,c),o=c,s.current.lanes=o,It(s,o),ks(s),t[nn]=s.current,Qf(t),new Iu(s)},Dl.version="19.1.1",Dl}var Av;function $S(){if(Av)return x0.exports;Av=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),x0.exports=HS(),x0.exports}var GS=$S();const KS=lm(GS),P0="/assets/Logo2-B_XoaKGn.PNG",YS=()=>{const[i,e]=X.useState("dashboard"),[n]=X.useState([{id:"1",name:"John Smith",businessName:"Smith Coffee Shop",email:"john@smithcoffee.co.za",phone:"+27821234567",kycStatus:"pending",documents:{idDocument:"ID_12345.pdf",businessLicense:"LICENSE_67890.pdf",bankStatement:"BANK_11111.pdf"},submittedAt:"2024-01-15T10:30:00Z"},{id:"2",name:"Sarah Johnson",businessName:"Johnson Bakery",email:"sarah@johnsonbakery.co.za",phone:"+27829876543",kycStatus:"verified",documents:{idDocument:"ID_54321.pdf",businessLicense:"LICENSE_09876.pdf",bankStatement:"BANK_22222.pdf"},submittedAt:"2024-01-10T14:20:00Z",reviewedAt:"2024-01-12T09:15:00Z",reviewer:"Admin User"}]),[r]=X.useState([{id:"1",merchantId:"1",merchantName:"Smith Coffee Shop",orderId:"ORD-001",customerName:"Mike Wilson",issue:"Customer claims order was not delivered",status:"open",priority:"medium",createdAt:"2024-01-20T16:45:00Z"},{id:"2",merchantId:"2",merchantName:"Johnson Bakery",orderId:"ORD-002",customerName:"Lisa Brown",issue:"Payment charged twice for same order",status:"investigating",priority:"high",createdAt:"2024-01-19T11:30:00Z"}]),[l]=X.useState([{id:"1",timestamp:"2024-01-20T15:30:00Z",action:"LOGIN",entity:"USER",entityId:"user_123",userId:"admin_001",details:"Admin user logged in from desktop",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"},{id:"2",timestamp:"2024-01-20T14:15:00Z",action:"UPDATE_ORDER",entity:"ORDER",entityId:"ORD-001",userId:"merchant_456",details:"Order status changed from pending to confirmed",ipAddress:"192.168.1.101",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X)"}]),u=(b,S)=>{alert(`Merchant ${b} ${S==="verified"?"verified":"rejected"} successfully!`)},f=b=>{alert(`Dispute ${b} resolved successfully!`)},p=()=>a.jsxs("div",{className:"admin-dashboard",children:[a.jsx("h2",{children:"Admin Dashboard"}),a.jsxs("div",{className:"admin-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Total Merchants"}),a.jsx("div",{className:"stat-number",children:n.length})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Pending Verification"}),a.jsx("div",{className:"stat-number",children:n.filter(b=>b.kycStatus==="pending").length})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Open Disputes"}),a.jsx("div",{className:"stat-number",children:r.filter(b=>b.status==="open").length})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"System Logs"}),a.jsx("div",{className:"stat-number",children:l.length})]})]})]}),x=()=>a.jsxs("div",{className:"admin-verification",children:[a.jsx("h2",{children:"Merchant Verification"}),a.jsx("div",{className:"verification-list",children:n.map(b=>a.jsxs("div",{className:"verification-card",children:[a.jsxs("div",{className:"merchant-info",children:[a.jsx("h3",{children:b.businessName}),a.jsxs("p",{children:["Owner: ",b.name]}),a.jsxs("p",{children:["Email: ",b.email]}),a.jsxs("p",{children:["Phone: ",b.phone]}),a.jsxs("p",{children:["Status: ",a.jsx("span",{className:`status ${b.kycStatus}`,children:b.kycStatus})]})]}),a.jsxs("div",{className:"documents",children:[a.jsx("h4",{children:"Documents:"}),a.jsxs("ul",{children:[a.jsxs("li",{children:["ID Document: ",b.documents.idDocument]}),a.jsxs("li",{children:["Business License: ",b.documents.businessLicense]}),a.jsxs("li",{children:["Bank Statement: ",b.documents.bankStatement]})]})]}),b.kycStatus==="pending"&&a.jsxs("div",{className:"verification-actions",children:[a.jsx("button",{className:"verify-btn",onClick:()=>u(b.id,"verified"),children:"Verify"}),a.jsx("button",{className:"reject-btn",onClick:()=>u(b.id,"rejected"),children:"Reject"})]})]},b.id))})]}),m=()=>a.jsxs("div",{className:"admin-disputes",children:[a.jsx("h2",{children:"Disputes Management"}),a.jsx("div",{className:"disputes-list",children:r.map(b=>a.jsxs("div",{className:"dispute-card",children:[a.jsxs("div",{className:"dispute-header",children:[a.jsxs("h3",{children:["Dispute #",b.id]}),a.jsx("span",{className:`priority ${b.priority}`,children:b.priority}),a.jsx("span",{className:`status ${b.status}`,children:b.status})]}),a.jsxs("div",{className:"dispute-details",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Merchant:"})," ",b.merchantName]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Order:"})," ",b.orderId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Customer:"})," ",b.customerName]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Issue:"})," ",b.issue]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Created:"})," ",new Date(b.createdAt).toLocaleString()]})]}),b.status!=="resolved"&&a.jsxs("div",{className:"dispute-actions",children:[a.jsx("button",{className:"resolve-btn",onClick:()=>f(b.id),children:"Resolve"}),a.jsx("button",{className:"investigate-btn",children:"Investigate"})]})]},b.id))})]}),v=()=>a.jsxs("div",{className:"admin-logs",children:[a.jsx("h2",{children:"System Audit Logs"}),a.jsxs("div",{className:"logs-filters",children:[a.jsxs("select",{children:[a.jsx("option",{value:"",children:"All Actions"}),a.jsx("option",{value:"LOGIN",children:"Login"}),a.jsx("option",{value:"UPDATE_ORDER",children:"Order Updates"}),a.jsx("option",{value:"PAYMENT",children:"Payments"})]}),a.jsx("input",{type:"date",placeholder:"From Date"}),a.jsx("input",{type:"date",placeholder:"To Date"})]}),a.jsx("div",{className:"logs-list",children:l.map(b=>a.jsxs("div",{className:"log-entry",children:[a.jsxs("div",{className:"log-header",children:[a.jsx("span",{className:"log-action",children:b.action}),a.jsx("span",{className:"log-timestamp",children:new Date(b.timestamp).toLocaleString()})]}),a.jsxs("div",{className:"log-details",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Entity:"})," ",b.entity," (",b.entityId,")"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"User:"})," ",b.userId]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Details:"})," ",b.details]}),a.jsxs("p",{children:[a.jsx("strong",{children:"IP:"})," ",b.ipAddress]})]})]},b.id))})]});return a.jsxs("div",{className:"admin-panel",children:[a.jsxs("div",{className:"admin-header",children:[a.jsx("h1",{children:"Pezela Admin Panel"}),a.jsxs("div",{className:"admin-tabs",children:[a.jsx("button",{className:i==="dashboard"?"active":"",onClick:()=>e("dashboard"),children:"Dashboard"}),a.jsx("button",{className:i==="verification"?"active":"",onClick:()=>e("verification"),children:"Verification"}),a.jsx("button",{className:i==="disputes"?"active":"",onClick:()=>e("disputes"),children:"Disputes"}),a.jsx("button",{className:i==="logs"?"active":"",onClick:()=>e("logs"),children:"Logs"})]})]}),a.jsxs("div",{className:"admin-content",children:[i==="dashboard"&&p(),i==="verification"&&x(),i==="disputes"&&m(),i==="logs"&&v()]})]})},ca={SETUP_FEE:0,MONTHLY_SUBSCRIPTION:199,BOOKKEEPING_ADDON:249,BACKUP_ADDON:99,CURRENCY:"ZAR"},QS={id:"setup_fee",name:"Business Onboarding",description:"FREE setup for new product launch",price:0,currency:"ZAR",isOneTime:!0,features:["WhatsApp Business API setup","QR code payment integration","Invoice template customization","Business profile setup","Payment gateway configuration","Initial training session","Account setup assistance","30-day free trial (credit card required for auto-renewal)"]},XS=[{id:"basic_monthly",name:"Basic Monthly",description:"Essential features for small businesses - 30 DAYS FREE TRIAL",price:199,currency:"ZAR",billingCycle:"monthly",features:["30-day free trial (credit card required)","WhatsApp automation","QR code payments","Basic invoicing","Order management","Customer database","Basic analytics","1 support call per month","Mobile app access","PWA access"],isRecommended:!0},{id:"premium_monthly",name:"Premium Monthly",description:"Advanced features for growing businesses - 30 DAYS FREE TRIAL",price:399,currency:"ZAR",billingCycle:"monthly",features:["30-day free trial (credit card required)","All Basic features","Advanced analytics","Inventory management","Staff management","Multi-location support","Priority support","3 support calls per month","Custom branding","API access"],isPopular:!0},{id:"enterprise_monthly",name:"Enterprise Monthly",description:"Full-featured solution for large businesses - 30 DAYS FREE TRIAL",price:799,currency:"ZAR",billingCycle:"monthly",features:["30-day free trial (credit card required)","All Premium features","Advanced reporting","Custom integrations","Dedicated account manager","Unlimited support","White-label options","Custom development","SLA guarantees"]}],WS=[{id:"bookkeeping_snapshot",name:"Bookkeeping Snapshot",description:"Automated bookkeeping and financial reporting",price:249,currency:"ZAR",billingCycle:"monthly",features:["Automated transaction categorization","Financial reports generation","Tax preparation assistance","SARS compliance reporting","Expense tracking","Profit & loss statements","Balance sheet generation"],isOptional:!0},{id:"managed_backups",name:"Managed Backups",description:"Automated data backup and recovery",price:99,currency:"ZAR",billingCycle:"monthly",features:["Daily automated backups","Cloud storage","Data recovery services","Backup verification","Disaster recovery planning","Data retention management"],isOptional:!0},{id:"advanced_analytics",name:"Advanced Analytics",description:"Business intelligence and insights",price:149,currency:"ZAR",billingCycle:"monthly",features:["Advanced reporting","Business insights","Trend analysis","Customer behavior analytics","Sales forecasting","Performance metrics"],isOptional:!0}],ZS={getSetupFee:()=>QS,getSubscriptionTiers:()=>XS,getAddOnServices:()=>WS,getPricingSummary:()=>({setupFee:ca.SETUP_FEE,monthlySubscription:ca.MONTHLY_SUBSCRIPTION,bookkeepingAddOn:ca.BOOKKEEPING_ADDON,backupAddOn:ca.BACKUP_ADDON,analyticsAddOn:149,currency:ca.CURRENCY}),calculateRevenue:(i,e=0,n=0,r=0)=>{const l=i*ca.SETUP_FEE,u=i*ca.MONTHLY_SUBSCRIPTION,f=e*ca.BOOKKEEPING_ADDON+n*ca.BACKUP_ADDON+r*149,p=l+u+f;return{setupFeeRevenue:l,monthlySubscriptionRevenue:u,addOnRevenue:f,totalRevenue:p}}};class JS{config;constructor(){this.config={merchantId:"19804699",merchantKey:"a5tum0tdbbcnb",passphrase:"Mo/akin/1970",environment:"sandbox",returnUrl:`${window.location.origin}/payment/success`,cancelUrl:`${window.location.origin}/payment/cancel`,notifyUrl:`${window.location.origin}/api/payfast/webhook`}}generateSignature(e){const n=new URLSearchParams;Object.entries(e).forEach(([l,u])=>{u!=null&&u!==""&&n.append(l,u.toString())}),n.append("passphrase",this.config.passphrase);const r=Array.from(n.entries()).sort(([l],[u])=>l.localeCompare(u)).map(([l,u])=>`${l}=${u}`).join("&");return this.md5(r)}md5(e){return btoa(e).replace(/[^a-zA-Z0-9]/g,"").substring(0,32)}async createPayment(e){try{const n=`pezela_${Date.now()}_${Math.random().toString(36).substring(2,15)}`,r={merchant_id:this.config.merchantId,merchant_key:this.config.merchantKey,return_url:this.config.returnUrl,cancel_url:this.config.cancelUrl,notify_url:this.config.notifyUrl,name_first:e.firstName,name_last:e.lastName,email_address:e.email,cell_number:e.phone,m_payment_id:n,amount:e.amount,item_name:e.itemName,item_description:e.itemDescription,custom_int1:e.customData?.userId?parseInt(e.customData.userId):void 0,custom_str1:e.customData?.planId||"",custom_str2:e.customData?.subscriptionType||"",custom_str3:"Pezela Subscription",custom_str4:"South Africa",custom_str5:"Digital Commerce Platform"},l=this.generateSignature(r),u={...r,signature:l},f=this.config.environment==="production"?"https://www.payfast.co.za/eng/process":"https://sandbox.payfast.co.za/eng/process",p=new URLSearchParams;return Object.entries(u).forEach(([m,v])=>{v!=null&&v!==""&&p.append(m,v.toString())}),{success:!0,paymentUrl:`${f}?${p.toString()}`,transactionId:n}}catch(n){return console.error("PayFast payment creation error:",n),{success:!1,error:n instanceof Error?n.message:"Payment creation failed"}}}verifyWebhookSignature(e){try{const n=new URLSearchParams;Object.entries(e).forEach(([u,f])=>{u!=="signature"&&f!==null&&f!==void 0&&f!==""&&n.append(u,f.toString())}),n.append("passphrase",this.config.passphrase);const r=Array.from(n.entries()).sort(([u],[f])=>u.localeCompare(f)).map(([u,f])=>`${u}=${f}`).join("&");return this.md5(r)===e.signature}catch(n){return console.error("PayFast webhook verification error:",n),!1}}async processWebhook(e){try{return this.verifyWebhookSignature(e)?e.payment_status==="COMPLETE"?(console.log("Payment successful:",{transactionId:e.m_payment_id,amount:e.amount_gross,user:e.email_address}),{success:!0,message:"Payment processed successfully",transactionId:e.m_payment_id}):e.payment_status==="CANCELLED"?(console.log("Payment cancelled:",e.m_payment_id),{success:!0,message:"Payment cancelled by user",transactionId:e.m_payment_id}):e.payment_status==="FAILED"?(console.log("Payment failed:",e.m_payment_id),{success:!0,message:"Payment failed",transactionId:e.m_payment_id}):{success:!1,message:`Unknown payment status: ${e.payment_status}`}:{success:!1,message:"Invalid webhook signature"}}catch(n){return console.error("PayFast webhook processing error:",n),{success:!1,message:n instanceof Error?n.message:"Webhook processing failed"}}}getConfig(){return{...this.config}}updateConfig(e){this.config={...this.config,...e}}async testConnection(){try{const e=this.config.environment==="production"?"https://www.payfast.co.za/eng/query/validate":"https://sandbox.payfast.co.za/eng/query/validate",n={merchant_id:this.config.merchantId,merchant_key:this.config.merchantKey,passphrase:this.config.passphrase};return(await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n).toString()})).ok?{success:!0,message:"PayFast connection successful",environment:this.config.environment}:{success:!1,message:"PayFast connection failed",environment:this.config.environment}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Connection test failed",environment:this.config.environment}}}}const O0=new JS,eA=({userData:i,subscriptionPlan:e,onPaymentSuccess:n,onPaymentCancel:r,onBack:l})=>{const[u,f]=X.useState(!1),[p,x]=X.useState(null),[m,v]=X.useState(null),[b,S]=X.useState("checking");X.useEffect(()=>{I()},[]);const I=async()=>{try{const k=await O0.testConnection();S(k.success?"connected":"failed")}catch{S("failed")}},R=async()=>{f(!0),v(null);try{const k=await O0.createPayment({firstName:i.firstName,lastName:i.lastName,email:i.email,phone:i.phone,amount:e.price,itemName:`Pezela ${e.name}`,itemDescription:e.description,customData:{userId:i.email,planId:e.id,subscriptionType:"monthly"}});k.success&&k.paymentUrl?(x(k.paymentUrl),window.location.href=k.paymentUrl):v(k.error||"Payment creation failed")}catch(k){v(k instanceof Error?k.message:"Payment processing failed")}finally{f(!1)}},D=()=>{l()};return a.jsxs("div",{className:"payment-processor",children:[a.jsxs("div",{className:"payment-header",children:[a.jsx("button",{className:"back-button",onClick:D,children:" Back to Plans"}),a.jsx("h2",{children:" Complete Your Payment"}),a.jsx("p",{children:"Secure payment processing with PayFast"})]}),a.jsx("div",{className:"connection-status",children:a.jsxs("div",{className:`status-indicator ${b}`,children:[b==="checking"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{children:"Checking PayFast connection..."})]}),b==="connected"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{children:"PayFast connected successfully"})]}),b==="failed"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{children:"PayFast connection failed"})]})]})}),a.jsxs("div",{className:"payment-summary",children:[a.jsx("h3",{children:" Payment Summary"}),a.jsxs("div",{className:"summary-card",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"Plan:"}),a.jsx("span",{className:"value",children:e.name})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"Description:"}),a.jsx("span",{className:"value",children:e.description})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"Amount:"}),a.jsxs("span",{className:"value",children:["R",e.price]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"Billing:"}),a.jsx("span",{className:"value",children:"Monthly (after 30-day free trial)"})]}),a.jsxs("div",{className:"summary-row total",children:[a.jsx("span",{className:"label",children:"Total:"}),a.jsxs("span",{className:"value",children:["R",e.price,"/month"]})]})]})]}),a.jsxs("div",{className:"user-info",children:[a.jsx("h3",{children:" Account Information"}),a.jsxs("div",{className:"info-card",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Name:"}),a.jsxs("span",{className:"value",children:[i.firstName," ",i.lastName]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Email:"}),a.jsx("span",{className:"value",children:i.email})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Phone:"}),a.jsx("span",{className:"value",children:i.phone})]})]})]}),a.jsxs("div",{className:"payment-method",children:[a.jsx("h3",{children:" Payment Method"}),a.jsx("div",{className:"payment-method-card",children:a.jsxs("div",{className:"payment-provider",children:[a.jsx("span",{className:"provider-icon",children:""}),a.jsxs("div",{className:"provider-info",children:[a.jsx("h4",{children:"PayFast"}),a.jsx("p",{children:"Secure payment processing in South Africa"}),a.jsxs("div",{className:"provider-features",children:[a.jsx("span",{className:"feature",children:" Credit/Debit Cards"}),a.jsx("span",{className:"feature",children:" EFT"}),a.jsx("span",{className:"feature",children:" Instant EFT"}),a.jsx("span",{className:"feature",children:" Mobile Payments"})]})]})]})})]}),a.jsx("div",{className:"trial-info",children:a.jsxs("div",{className:"trial-card",children:[a.jsx("h4",{children:" 30-Day Free Trial"}),a.jsxs("p",{children:["Your card will not be charged during the trial period. You'll be automatically charged R",e.price," after 30 days unless you cancel."]}),a.jsxs("div",{className:"trial-features",children:[a.jsx("span",{className:"feature",children:" Full access to all features"}),a.jsx("span",{className:"feature",children:" No setup fees"}),a.jsx("span",{className:"feature",children:" Cancel anytime"}),a.jsx("span",{className:"feature",children:" 24/7 support"})]})]})}),m&&a.jsxs("div",{className:"error-message",children:[a.jsx("span",{className:"error-icon",children:""}),a.jsx("span",{children:m})]}),a.jsxs("div",{className:"payment-actions",children:[a.jsx("button",{className:"secondary-button",onClick:D,disabled:u,children:"Back to Plans"}),a.jsx("button",{className:"primary-button",onClick:R,disabled:u||b!=="connected",children:u?"Processing...":`Pay R${e.price} with PayFast`})]}),a.jsxs("div",{className:"security-info",children:[a.jsx("h4",{children:" Security & Compliance"}),a.jsxs("div",{className:"security-features",children:[a.jsxs("div",{className:"security-item",children:[a.jsx("span",{className:"security-icon",children:""}),a.jsx("span",{children:"PCI DSS Compliant"})]}),a.jsxs("div",{className:"security-item",children:[a.jsx("span",{className:"security-icon",children:""}),a.jsx("span",{children:"256-bit SSL Encryption"})]}),a.jsxs("div",{className:"security-item",children:[a.jsx("span",{className:"security-icon",children:""}),a.jsx("span",{children:"Bank-level Security"})]}),a.jsxs("div",{className:"security-item",children:[a.jsx("span",{className:"security-icon",children:""}),a.jsx("span",{children:"South African Regulated"})]})]})]}),p&&a.jsxs("div",{className:"payment-url-debug",children:[a.jsx("h4",{children:"Payment URL (Debug)"}),a.jsx("p",{className:"url-text",children:p})]})]})},tA=({onSelectPlan:i,onBack:e})=>{const[n,r]=X.useState("basic_monthly"),[l,u]=X.useState([]),[f,p]=X.useState(!1),[x,m]=X.useState({firstName:"",lastName:"",email:"",phone:""}),v=ZS,b=v.getSubscriptionTiers(),S=v.getAddOnServices(),I=v.getSetupFee(),R=F=>{u(P=>P.includes(F)?P.filter(E=>E!==F):[...P,F])},k=(()=>{const F=b.find(A=>A.id===n),P=S.filter(A=>l.includes(A.id)),E=F?.price||0,_=P.reduce((A,w)=>A+w.price,0);return{setupFee:I.price,monthlyPrice:E+_,totalFirstMonth:I.price+E+_}})(),q=()=>{m({firstName:"John",lastName:"Doe",email:"john.doe@example.com",phone:"+27821234567"}),p(!0)},O=F=>{console.log("Payment successful:",F),i(n)},L=()=>{p(!1)},N=()=>{p(!1)};if(f){const F=b.find(P=>P.id===n);if(F)return a.jsx(eA,{userData:x,subscriptionPlan:{id:F.id,name:F.name,price:F.price,description:F.description},onPaymentSuccess:O,onPaymentCancel:L,onBack:N})}return a.jsxs("div",{className:"subscription-plans",children:[a.jsxs("div",{className:"plans-header",children:[a.jsx("button",{className:"back-button",onClick:e,children:" Back to Registration"}),a.jsx("h2",{children:" Choose Your Pezela Plan"}),a.jsx("p",{children:"Select the perfect plan for your business needs"})]}),a.jsx("div",{className:"setup-fee-info",children:a.jsxs("div",{className:"setup-fee-card",children:[a.jsx("h3",{children:" Business Onboarding"}),a.jsx("div",{className:"setup-price",children:"FREE for new product launch"}),a.jsx("p",{children:"Includes: WhatsApp setup, QR codes, training, and account configuration"}),a.jsxs("div",{className:"trial-info",children:[a.jsx("span",{className:"trial-badge",children:"30 DAYS FREE TRIAL"}),a.jsx("p",{children:"Credit card required for auto-renewal after trial"})]})]})}),a.jsxs("div",{className:"subscription-tiers",children:[a.jsx("h3",{children:" Monthly Subscription Plans"}),a.jsx("div",{className:"tiers-grid",children:b.map(F=>a.jsxs("div",{className:`tier-card ${n===F.id?"selected":""} ${F.isPopular?"popular":""}`,onClick:()=>r(F.id),children:[F.isPopular&&a.jsx("div",{className:"popular-badge",children:"Most Popular"}),F.isRecommended&&a.jsx("div",{className:"recommended-badge",children:"Recommended"}),a.jsx("h4",{children:F.name}),a.jsxs("div",{className:"tier-price",children:["R",F.price,"/month"]}),a.jsx("p",{className:"tier-description",children:F.description}),a.jsx("ul",{className:"tier-features",children:F.features.map((P,E)=>a.jsxs("li",{children:[" ",P]},E))}),a.jsx("button",{className:`select-button ${n===F.id?"selected":""}`,onClick:()=>r(F.id),children:n===F.id?"Selected":"Select Plan"})]},F.id))})]}),a.jsxs("div",{className:"addon-services",children:[a.jsx("h3",{children:" Optional Add-on Services"}),a.jsx("div",{className:"addons-grid",children:S.map(F=>a.jsxs("div",{className:`addon-card ${l.includes(F.id)?"selected":""}`,onClick:()=>R(F.id),children:[a.jsxs("div",{className:"addon-header",children:[a.jsx("h4",{children:F.name}),a.jsxs("div",{className:"addon-price",children:["R",F.price,"/month"]})]}),a.jsx("p",{className:"addon-description",children:F.description}),a.jsx("ul",{className:"addon-features",children:F.features.map((P,E)=>a.jsxs("li",{children:[" ",P]},E))}),a.jsxs("div",{className:"addon-toggle",children:[a.jsx("input",{type:"checkbox",checked:l.includes(F.id),onChange:()=>R(F.id)}),a.jsx("span",{children:"Add to plan"})]})]},F.id))})]}),a.jsxs("div",{className:"price-summary",children:[a.jsx("h3",{children:" Price Summary"}),a.jsxs("div",{className:"summary-card",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"Setup Fee (one-time):"}),a.jsx("span",{className:"value",children:"FREE"})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"First 30 Days:"}),a.jsx("span",{className:"value",children:"FREE"})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{className:"label",children:"After Trial (Monthly):"}),a.jsxs("span",{className:"value",children:["R",k.monthlyPrice]})]}),a.jsxs("div",{className:"summary-row trial-note",children:[a.jsx("span",{className:"label",children:"Trial Period:"}),a.jsxs("span",{className:"value",children:["30 days free, then R",k.monthlyPrice,"/month"]})]})]})]}),a.jsxs("div",{className:"credit-card-section",children:[a.jsx("h3",{children:" Payment Information"}),a.jsxs("div",{className:"card-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Card Number"}),a.jsx("input",{type:"text",placeholder:"1234 5678 9012 3456",maxLength:"19"})]}),a.jsxs("div",{className:"card-details",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Expiry Date"}),a.jsx("input",{type:"text",placeholder:"MM/YY",maxLength:"5"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"CVV"}),a.jsx("input",{type:"text",placeholder:"123",maxLength:"4"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Cardholder Name"}),a.jsx("input",{type:"text",placeholder:"John Doe"})]}),a.jsx("div",{className:"trial-disclaimer",children:a.jsxs("p",{children:[" Your card will not be charged during the 30-day free trial. You'll be automatically charged R",k.monthlyPrice," after the trial period unless you cancel."]})})]})]}),a.jsxs("div",{className:"plan-actions",children:[a.jsx("button",{className:"secondary-button",onClick:e,children:"Back to Registration"}),a.jsx("button",{className:"primary-button",onClick:q,children:"Proceed to Payment"})]}),a.jsxs("div",{className:"plan-benefits",children:[a.jsx("h3",{children:" Why Choose Pezela?"}),a.jsxs("div",{className:"benefits-grid",children:[a.jsxs("div",{className:"benefit-item",children:[a.jsx("span",{className:"icon",children:""}),a.jsxs("div",{className:"benefit-content",children:[a.jsx("h4",{children:"South African Focused"}),a.jsx("p",{children:"Built specifically for SA businesses with local payment gateways and SARS compliance"})]})]}),a.jsxs("div",{className:"benefit-item",children:[a.jsx("span",{className:"icon",children:""}),a.jsxs("div",{className:"benefit-content",children:[a.jsx("h4",{children:"WhatsApp Integration"}),a.jsx("p",{children:"Your customers already use WhatsApp - now you can accept orders and payments through it"})]})]}),a.jsxs("div",{className:"benefit-item",children:[a.jsx("span",{className:"icon",children:""}),a.jsxs("div",{className:"benefit-content",children:[a.jsx("h4",{children:"Loadshedding Resilient"}),a.jsx("p",{children:"Works offline during power cuts and syncs when power returns"})]})]}),a.jsxs("div",{className:"benefit-item",children:[a.jsx("span",{className:"icon",children:""}),a.jsxs("div",{className:"benefit-content",children:[a.jsx("h4",{children:"Secure & Compliant"}),a.jsx("p",{children:"POPIA compliant data protection and PCI DSS secure payments"})]})]})]})]})]})};var Vu={exports:{}};function nA(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Uu={exports:{}};const sA={},aA=Object.freeze(Object.defineProperty({__proto__:null,default:sA},Symbol.toStringTag,{value:"Module"})),rA=OS(aA);var iA=Uu.exports,Nv;function st(){return Nv||(Nv=1,(function(i,e){(function(n,r){i.exports=r()})(iA,function(){var n=n||(function(r,l){var u;if(typeof window<"u"&&window.crypto&&(u=window.crypto),typeof self<"u"&&self.crypto&&(u=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(u=globalThis.crypto),!u&&typeof window<"u"&&window.msCrypto&&(u=window.msCrypto),!u&&typeof m0<"u"&&m0.crypto&&(u=m0.crypto),!u&&typeof nA=="function")try{u=rA}catch{}var f=function(){if(u){if(typeof u.getRandomValues=="function")try{return u.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof u.randomBytes=="function")try{return u.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},p=Object.create||(function(){function O(){}return function(L){var N;return O.prototype=L,N=new O,O.prototype=null,N}})(),x={},m=x.lib={},v=m.Base=(function(){return{extend:function(O){var L=p(this);return O&&L.mixIn(O),(!L.hasOwnProperty("init")||this.init===L.init)&&(L.init=function(){L.$super.init.apply(this,arguments)}),L.init.prototype=L,L.$super=this,L},create:function(){var O=this.extend();return O.init.apply(O,arguments),O},init:function(){},mixIn:function(O){for(var L in O)O.hasOwnProperty(L)&&(this[L]=O[L]);O.hasOwnProperty("toString")&&(this.toString=O.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),b=m.WordArray=v.extend({init:function(O,L){O=this.words=O||[],L!=l?this.sigBytes=L:this.sigBytes=O.length*4},toString:function(O){return(O||I).stringify(this)},concat:function(O){var L=this.words,N=O.words,F=this.sigBytes,P=O.sigBytes;if(this.clamp(),F%4)for(var E=0;E<P;E++){var _=N[E>>>2]>>>24-E%4*8&255;L[F+E>>>2]|=_<<24-(F+E)%4*8}else for(var A=0;A<P;A+=4)L[F+A>>>2]=N[A>>>2];return this.sigBytes+=P,this},clamp:function(){var O=this.words,L=this.sigBytes;O[L>>>2]&=4294967295<<32-L%4*8,O.length=r.ceil(L/4)},clone:function(){var O=v.clone.call(this);return O.words=this.words.slice(0),O},random:function(O){for(var L=[],N=0;N<O;N+=4)L.push(f());return new b.init(L,O)}}),S=x.enc={},I=S.Hex={stringify:function(O){for(var L=O.words,N=O.sigBytes,F=[],P=0;P<N;P++){var E=L[P>>>2]>>>24-P%4*8&255;F.push((E>>>4).toString(16)),F.push((E&15).toString(16))}return F.join("")},parse:function(O){for(var L=O.length,N=[],F=0;F<L;F+=2)N[F>>>3]|=parseInt(O.substr(F,2),16)<<24-F%8*4;return new b.init(N,L/2)}},R=S.Latin1={stringify:function(O){for(var L=O.words,N=O.sigBytes,F=[],P=0;P<N;P++){var E=L[P>>>2]>>>24-P%4*8&255;F.push(String.fromCharCode(E))}return F.join("")},parse:function(O){for(var L=O.length,N=[],F=0;F<L;F++)N[F>>>2]|=(O.charCodeAt(F)&255)<<24-F%4*8;return new b.init(N,L)}},D=S.Utf8={stringify:function(O){try{return decodeURIComponent(escape(R.stringify(O)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(O){return R.parse(unescape(encodeURIComponent(O)))}},k=m.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(O){typeof O=="string"&&(O=D.parse(O)),this._data.concat(O),this._nDataBytes+=O.sigBytes},_process:function(O){var L,N=this._data,F=N.words,P=N.sigBytes,E=this.blockSize,_=E*4,A=P/_;O?A=r.ceil(A):A=r.max((A|0)-this._minBufferSize,0);var w=A*E,T=r.min(w*4,P);if(w){for(var U=0;U<w;U+=E)this._doProcessBlock(F,U);L=F.splice(0,w),N.sigBytes-=T}return new b.init(L,T)},clone:function(){var O=v.clone.call(this);return O._data=this._data.clone(),O},_minBufferSize:0});m.Hasher=k.extend({cfg:v.extend(),init:function(O){this.cfg=this.cfg.extend(O),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(O){return this._append(O),this._process(),this},finalize:function(O){O&&this._append(O);var L=this._doFinalize();return L},blockSize:16,_createHelper:function(O){return function(L,N){return new O.init(N).finalize(L)}},_createHmacHelper:function(O){return function(L,N){return new q.HMAC.init(O,N).finalize(L)}}});var q=x.algo={};return x})(Math);return n})})(Uu)),Uu.exports}var zu={exports:{}},oA=zu.exports,wv;function Zd(){return wv||(wv=1,(function(i,e){(function(n,r){i.exports=r(st())})(oA,function(n){return(function(r){var l=n,u=l.lib,f=u.Base,p=u.WordArray,x=l.x64={};x.Word=f.extend({init:function(m,v){this.high=m,this.low=v}}),x.WordArray=f.extend({init:function(m,v){m=this.words=m||[],v!=r?this.sigBytes=v:this.sigBytes=m.length*8},toX32:function(){for(var m=this.words,v=m.length,b=[],S=0;S<v;S++){var I=m[S];b.push(I.high),b.push(I.low)}return p.create(b,this.sigBytes)},clone:function(){for(var m=f.clone.call(this),v=m.words=this.words.slice(0),b=v.length,S=0;S<b;S++)v[S]=v[S].clone();return m}})})(),n})})(zu)),zu.exports}var qu={exports:{}},lA=qu.exports,Cv;function cA(){return Cv||(Cv=1,(function(i,e){(function(n,r){i.exports=r(st())})(lA,function(n){return(function(){if(typeof ArrayBuffer=="function"){var r=n,l=r.lib,u=l.WordArray,f=u.init,p=u.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||typeof Uint8ClampedArray<"u"&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var m=x.byteLength,v=[],b=0;b<m;b++)v[b>>>2]|=x[b]<<24-b%4*8;f.call(this,v,m)}else f.apply(this,arguments)};p.prototype=u}})(),n.lib.WordArray})})(qu)),qu.exports}var Hu={exports:{}},uA=Hu.exports,jv;function dA(){return jv||(jv=1,(function(i,e){(function(n,r){i.exports=r(st())})(uA,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=r.enc;f.Utf16=f.Utf16BE={stringify:function(x){for(var m=x.words,v=x.sigBytes,b=[],S=0;S<v;S+=2){var I=m[S>>>2]>>>16-S%4*8&65535;b.push(String.fromCharCode(I))}return b.join("")},parse:function(x){for(var m=x.length,v=[],b=0;b<m;b++)v[b>>>1]|=x.charCodeAt(b)<<16-b%2*16;return u.create(v,m*2)}},f.Utf16LE={stringify:function(x){for(var m=x.words,v=x.sigBytes,b=[],S=0;S<v;S+=2){var I=p(m[S>>>2]>>>16-S%4*8&65535);b.push(String.fromCharCode(I))}return b.join("")},parse:function(x){for(var m=x.length,v=[],b=0;b<m;b++)v[b>>>1]|=p(x.charCodeAt(b)<<16-b%2*16);return u.create(v,m*2)}};function p(x){return x<<8&4278255360|x>>>8&16711935}})(),n.enc.Utf16})})(Hu)),Hu.exports}var $u={exports:{}},hA=$u.exports,Tv;function fi(){return Tv||(Tv=1,(function(i,e){(function(n,r){i.exports=r(st())})(hA,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=r.enc;f.Base64={stringify:function(x){var m=x.words,v=x.sigBytes,b=this._map;x.clamp();for(var S=[],I=0;I<v;I+=3)for(var R=m[I>>>2]>>>24-I%4*8&255,D=m[I+1>>>2]>>>24-(I+1)%4*8&255,k=m[I+2>>>2]>>>24-(I+2)%4*8&255,q=R<<16|D<<8|k,O=0;O<4&&I+O*.75<v;O++)S.push(b.charAt(q>>>6*(3-O)&63));var L=b.charAt(64);if(L)for(;S.length%4;)S.push(L);return S.join("")},parse:function(x){var m=x.length,v=this._map,b=this._reverseMap;if(!b){b=this._reverseMap=[];for(var S=0;S<v.length;S++)b[v.charCodeAt(S)]=S}var I=v.charAt(64);if(I){var R=x.indexOf(I);R!==-1&&(m=R)}return p(x,m,b)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function p(x,m,v){for(var b=[],S=0,I=0;I<m;I++)if(I%4){var R=v[x.charCodeAt(I-1)]<<I%4*2,D=v[x.charCodeAt(I)]>>>6-I%4*2,k=R|D;b[S>>>2]|=k<<24-S%4*8,S++}return u.create(b,S)}})(),n.enc.Base64})})($u)),$u.exports}var Gu={exports:{}},fA=Gu.exports,Rv;function mA(){return Rv||(Rv=1,(function(i,e){(function(n,r){i.exports=r(st())})(fA,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=r.enc;f.Base64url={stringify:function(x,m){m===void 0&&(m=!0);var v=x.words,b=x.sigBytes,S=m?this._safe_map:this._map;x.clamp();for(var I=[],R=0;R<b;R+=3)for(var D=v[R>>>2]>>>24-R%4*8&255,k=v[R+1>>>2]>>>24-(R+1)%4*8&255,q=v[R+2>>>2]>>>24-(R+2)%4*8&255,O=D<<16|k<<8|q,L=0;L<4&&R+L*.75<b;L++)I.push(S.charAt(O>>>6*(3-L)&63));var N=S.charAt(64);if(N)for(;I.length%4;)I.push(N);return I.join("")},parse:function(x,m){m===void 0&&(m=!0);var v=x.length,b=m?this._safe_map:this._map,S=this._reverseMap;if(!S){S=this._reverseMap=[];for(var I=0;I<b.length;I++)S[b.charCodeAt(I)]=I}var R=b.charAt(64);if(R){var D=x.indexOf(R);D!==-1&&(v=D)}return p(x,v,S)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function p(x,m,v){for(var b=[],S=0,I=0;I<m;I++)if(I%4){var R=v[x.charCodeAt(I-1)]<<I%4*2,D=v[x.charCodeAt(I)]>>>6-I%4*2,k=R|D;b[S>>>2]|=k<<24-S%4*8,S++}return u.create(b,S)}})(),n.enc.Base64url})})(Gu)),Gu.exports}var Ku={exports:{}},pA=Ku.exports,Dv;function mi(){return Dv||(Dv=1,(function(i,e){(function(n,r){i.exports=r(st())})(pA,function(n){return(function(r){var l=n,u=l.lib,f=u.WordArray,p=u.Hasher,x=l.algo,m=[];(function(){for(var D=0;D<64;D++)m[D]=r.abs(r.sin(D+1))*4294967296|0})();var v=x.MD5=p.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(D,k){for(var q=0;q<16;q++){var O=k+q,L=D[O];D[O]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}var N=this._hash.words,F=D[k+0],P=D[k+1],E=D[k+2],_=D[k+3],A=D[k+4],w=D[k+5],T=D[k+6],U=D[k+7],B=D[k+8],ve=D[k+9],ye=D[k+10],Q=D[k+11],ue=D[k+12],pe=D[k+13],Ce=D[k+14],H=D[k+15],G=N[0],z=N[1],W=N[2],J=N[3];G=b(G,z,W,J,F,7,m[0]),J=b(J,G,z,W,P,12,m[1]),W=b(W,J,G,z,E,17,m[2]),z=b(z,W,J,G,_,22,m[3]),G=b(G,z,W,J,A,7,m[4]),J=b(J,G,z,W,w,12,m[5]),W=b(W,J,G,z,T,17,m[6]),z=b(z,W,J,G,U,22,m[7]),G=b(G,z,W,J,B,7,m[8]),J=b(J,G,z,W,ve,12,m[9]),W=b(W,J,G,z,ye,17,m[10]),z=b(z,W,J,G,Q,22,m[11]),G=b(G,z,W,J,ue,7,m[12]),J=b(J,G,z,W,pe,12,m[13]),W=b(W,J,G,z,Ce,17,m[14]),z=b(z,W,J,G,H,22,m[15]),G=S(G,z,W,J,P,5,m[16]),J=S(J,G,z,W,T,9,m[17]),W=S(W,J,G,z,Q,14,m[18]),z=S(z,W,J,G,F,20,m[19]),G=S(G,z,W,J,w,5,m[20]),J=S(J,G,z,W,ye,9,m[21]),W=S(W,J,G,z,H,14,m[22]),z=S(z,W,J,G,A,20,m[23]),G=S(G,z,W,J,ve,5,m[24]),J=S(J,G,z,W,Ce,9,m[25]),W=S(W,J,G,z,_,14,m[26]),z=S(z,W,J,G,B,20,m[27]),G=S(G,z,W,J,pe,5,m[28]),J=S(J,G,z,W,E,9,m[29]),W=S(W,J,G,z,U,14,m[30]),z=S(z,W,J,G,ue,20,m[31]),G=I(G,z,W,J,w,4,m[32]),J=I(J,G,z,W,B,11,m[33]),W=I(W,J,G,z,Q,16,m[34]),z=I(z,W,J,G,Ce,23,m[35]),G=I(G,z,W,J,P,4,m[36]),J=I(J,G,z,W,A,11,m[37]),W=I(W,J,G,z,U,16,m[38]),z=I(z,W,J,G,ye,23,m[39]),G=I(G,z,W,J,pe,4,m[40]),J=I(J,G,z,W,F,11,m[41]),W=I(W,J,G,z,_,16,m[42]),z=I(z,W,J,G,T,23,m[43]),G=I(G,z,W,J,ve,4,m[44]),J=I(J,G,z,W,ue,11,m[45]),W=I(W,J,G,z,H,16,m[46]),z=I(z,W,J,G,E,23,m[47]),G=R(G,z,W,J,F,6,m[48]),J=R(J,G,z,W,U,10,m[49]),W=R(W,J,G,z,Ce,15,m[50]),z=R(z,W,J,G,w,21,m[51]),G=R(G,z,W,J,ue,6,m[52]),J=R(J,G,z,W,_,10,m[53]),W=R(W,J,G,z,ye,15,m[54]),z=R(z,W,J,G,P,21,m[55]),G=R(G,z,W,J,B,6,m[56]),J=R(J,G,z,W,H,10,m[57]),W=R(W,J,G,z,T,15,m[58]),z=R(z,W,J,G,pe,21,m[59]),G=R(G,z,W,J,A,6,m[60]),J=R(J,G,z,W,Q,10,m[61]),W=R(W,J,G,z,E,15,m[62]),z=R(z,W,J,G,ve,21,m[63]),N[0]=N[0]+G|0,N[1]=N[1]+z|0,N[2]=N[2]+W|0,N[3]=N[3]+J|0},_doFinalize:function(){var D=this._data,k=D.words,q=this._nDataBytes*8,O=D.sigBytes*8;k[O>>>5]|=128<<24-O%32;var L=r.floor(q/4294967296),N=q;k[(O+64>>>9<<4)+15]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,k[(O+64>>>9<<4)+14]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,D.sigBytes=(k.length+1)*4,this._process();for(var F=this._hash,P=F.words,E=0;E<4;E++){var _=P[E];P[E]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}return F},clone:function(){var D=p.clone.call(this);return D._hash=this._hash.clone(),D}});function b(D,k,q,O,L,N,F){var P=D+(k&q|~k&O)+L+F;return(P<<N|P>>>32-N)+k}function S(D,k,q,O,L,N,F){var P=D+(k&O|q&~O)+L+F;return(P<<N|P>>>32-N)+k}function I(D,k,q,O,L,N,F){var P=D+(k^q^O)+L+F;return(P<<N|P>>>32-N)+k}function R(D,k,q,O,L,N,F){var P=D+(q^(k|~O))+L+F;return(P<<N|P>>>32-N)+k}l.MD5=p._createHelper(v),l.HmacMD5=p._createHmacHelper(v)})(Math),n.MD5})})(Ku)),Ku.exports}var Yu={exports:{}},gA=Yu.exports,Iv;function M1(){return Iv||(Iv=1,(function(i,e){(function(n,r){i.exports=r(st())})(gA,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=l.Hasher,p=r.algo,x=[],m=p.SHA1=f.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,b){for(var S=this._hash.words,I=S[0],R=S[1],D=S[2],k=S[3],q=S[4],O=0;O<80;O++){if(O<16)x[O]=v[b+O]|0;else{var L=x[O-3]^x[O-8]^x[O-14]^x[O-16];x[O]=L<<1|L>>>31}var N=(I<<5|I>>>27)+q+x[O];O<20?N+=(R&D|~R&k)+1518500249:O<40?N+=(R^D^k)+1859775393:O<60?N+=(R&D|R&k|D&k)-1894007588:N+=(R^D^k)-899497514,q=k,k=D,D=R<<30|R>>>2,R=I,I=N}S[0]=S[0]+I|0,S[1]=S[1]+R|0,S[2]=S[2]+D|0,S[3]=S[3]+k|0,S[4]=S[4]+q|0},_doFinalize:function(){var v=this._data,b=v.words,S=this._nDataBytes*8,I=v.sigBytes*8;return b[I>>>5]|=128<<24-I%32,b[(I+64>>>9<<4)+14]=Math.floor(S/4294967296),b[(I+64>>>9<<4)+15]=S,v.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var v=f.clone.call(this);return v._hash=this._hash.clone(),v}});r.SHA1=f._createHelper(m),r.HmacSHA1=f._createHmacHelper(m)})(),n.SHA1})})(Yu)),Yu.exports}var Qu={exports:{}},xA=Qu.exports,kv;function um(){return kv||(kv=1,(function(i,e){(function(n,r){i.exports=r(st())})(xA,function(n){return(function(r){var l=n,u=l.lib,f=u.WordArray,p=u.Hasher,x=l.algo,m=[],v=[];(function(){function I(q){for(var O=r.sqrt(q),L=2;L<=O;L++)if(!(q%L))return!1;return!0}function R(q){return(q-(q|0))*4294967296|0}for(var D=2,k=0;k<64;)I(D)&&(k<8&&(m[k]=R(r.pow(D,1/2))),v[k]=R(r.pow(D,1/3)),k++),D++})();var b=[],S=x.SHA256=p.extend({_doReset:function(){this._hash=new f.init(m.slice(0))},_doProcessBlock:function(I,R){for(var D=this._hash.words,k=D[0],q=D[1],O=D[2],L=D[3],N=D[4],F=D[5],P=D[6],E=D[7],_=0;_<64;_++){if(_<16)b[_]=I[R+_]|0;else{var A=b[_-15],w=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,T=b[_-2],U=(T<<15|T>>>17)^(T<<13|T>>>19)^T>>>10;b[_]=w+b[_-7]+U+b[_-16]}var B=N&F^~N&P,ve=k&q^k&O^q&O,ye=(k<<30|k>>>2)^(k<<19|k>>>13)^(k<<10|k>>>22),Q=(N<<26|N>>>6)^(N<<21|N>>>11)^(N<<7|N>>>25),ue=E+Q+B+v[_]+b[_],pe=ye+ve;E=P,P=F,F=N,N=L+ue|0,L=O,O=q,q=k,k=ue+pe|0}D[0]=D[0]+k|0,D[1]=D[1]+q|0,D[2]=D[2]+O|0,D[3]=D[3]+L|0,D[4]=D[4]+N|0,D[5]=D[5]+F|0,D[6]=D[6]+P|0,D[7]=D[7]+E|0},_doFinalize:function(){var I=this._data,R=I.words,D=this._nDataBytes*8,k=I.sigBytes*8;return R[k>>>5]|=128<<24-k%32,R[(k+64>>>9<<4)+14]=r.floor(D/4294967296),R[(k+64>>>9<<4)+15]=D,I.sigBytes=R.length*4,this._process(),this._hash},clone:function(){var I=p.clone.call(this);return I._hash=this._hash.clone(),I}});l.SHA256=p._createHelper(S),l.HmacSHA256=p._createHmacHelper(S)})(Math),n.SHA256})})(Qu)),Qu.exports}var Xu={exports:{}},vA=Xu.exports,Pv;function yA(){return Pv||(Pv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),um())})(vA,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=r.algo,p=f.SHA256,x=f.SHA224=p.extend({_doReset:function(){this._hash=new u.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var m=p._doFinalize.call(this);return m.sigBytes-=4,m}});r.SHA224=p._createHelper(x),r.HmacSHA224=p._createHmacHelper(x)})(),n.SHA224})})(Xu)),Xu.exports}var Wu={exports:{}},_A=Wu.exports,Ov;function F1(){return Ov||(Ov=1,(function(i,e){(function(n,r,l){i.exports=r(st(),Zd())})(_A,function(n){return(function(){var r=n,l=r.lib,u=l.Hasher,f=r.x64,p=f.Word,x=f.WordArray,m=r.algo;function v(){return p.create.apply(p,arguments)}var b=[v(1116352408,3609767458),v(1899447441,602891725),v(3049323471,3964484399),v(3921009573,2173295548),v(961987163,4081628472),v(1508970993,3053834265),v(2453635748,2937671579),v(2870763221,3664609560),v(3624381080,2734883394),v(310598401,1164996542),v(607225278,1323610764),v(1426881987,3590304994),v(1925078388,4068182383),v(2162078206,991336113),v(2614888103,633803317),v(3248222580,3479774868),v(3835390401,2666613458),v(4022224774,944711139),v(264347078,2341262773),v(604807628,2007800933),v(770255983,1495990901),v(1249150122,1856431235),v(1555081692,3175218132),v(1996064986,2198950837),v(2554220882,3999719339),v(2821834349,766784016),v(2952996808,2566594879),v(3210313671,3203337956),v(3336571891,1034457026),v(3584528711,2466948901),v(113926993,3758326383),v(338241895,168717936),v(666307205,1188179964),v(773529912,1546045734),v(1294757372,1522805485),v(1396182291,2643833823),v(1695183700,2343527390),v(1986661051,1014477480),v(2177026350,1206759142),v(2456956037,344077627),v(2730485921,1290863460),v(2820302411,3158454273),v(3259730800,3505952657),v(3345764771,106217008),v(3516065817,3606008344),v(3600352804,1432725776),v(4094571909,1467031594),v(275423344,851169720),v(430227734,3100823752),v(506948616,1363258195),v(659060556,3750685593),v(883997877,3785050280),v(958139571,3318307427),v(1322822218,3812723403),v(1537002063,2003034995),v(1747873779,3602036899),v(1955562222,1575990012),v(2024104815,1125592928),v(2227730452,2716904306),v(2361852424,442776044),v(2428436474,593698344),v(2756734187,3733110249),v(3204031479,2999351573),v(3329325298,3815920427),v(3391569614,3928383900),v(3515267271,566280711),v(3940187606,3454069534),v(4118630271,4000239992),v(116418474,1914138554),v(174292421,2731055270),v(289380356,3203993006),v(460393269,320620315),v(685471733,587496836),v(852142971,1086792851),v(1017036298,365543100),v(1126000580,2618297676),v(1288033470,3409855158),v(1501505948,4234509866),v(1607167915,987167468),v(1816402316,1246189591)],S=[];(function(){for(var R=0;R<80;R++)S[R]=v()})();var I=m.SHA512=u.extend({_doReset:function(){this._hash=new x.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(R,D){for(var k=this._hash.words,q=k[0],O=k[1],L=k[2],N=k[3],F=k[4],P=k[5],E=k[6],_=k[7],A=q.high,w=q.low,T=O.high,U=O.low,B=L.high,ve=L.low,ye=N.high,Q=N.low,ue=F.high,pe=F.low,Ce=P.high,H=P.low,G=E.high,z=E.low,W=_.high,J=_.low,Ae=A,he=w,qe=T,_e=U,be=B,Be=ve,Qe=ye,lt=Q,At=ue,Nt=pe,gt=Ce,Fe=H,it=G,we=z,je=W,ge=J,Ue=0;Ue<80;Ue++){var Dt,se,ke=S[Ue];if(Ue<16)se=ke.high=R[D+Ue*2]|0,Dt=ke.low=R[D+Ue*2+1]|0;else{var Xe=S[Ue-15],ot=Xe.high,K=Xe.low,ie=(ot>>>1|K<<31)^(ot>>>8|K<<24)^ot>>>7,le=(K>>>1|ot<<31)^(K>>>8|ot<<24)^(K>>>7|ot<<25),Ne=S[Ue-2],Se=Ne.high,xt=Ne.low,vt=(Se>>>19|xt<<13)^(Se<<3|xt>>>29)^Se>>>6,Xt=(xt>>>19|Se<<13)^(xt<<3|Se>>>29)^(xt>>>6|Se<<26),jn=S[Ue-7],Tn=jn.high,vs=jn.low,qs=S[Ue-16],Er=qs.high,ss=qs.low;Dt=le+vs,se=ie+Tn+(Dt>>>0<le>>>0?1:0),Dt=Dt+Xt,se=se+vt+(Dt>>>0<Xt>>>0?1:0),Dt=Dt+ss,se=se+Er+(Dt>>>0<ss>>>0?1:0),ke.high=se,ke.low=Dt}var va=At&gt^~At&it,It=Nt&Fe^~Nt&we,vi=Ae&qe^Ae&be^qe&be,ys=he&_e^he&Be^_e&Be,_s=(Ae>>>28|he<<4)^(Ae<<30|he>>>2)^(Ae<<25|he>>>7),ya=(he>>>28|Ae<<4)^(he<<30|Ae>>>2)^(he<<25|Ae>>>7),Sr=(At>>>14|Nt<<18)^(At>>>18|Nt<<14)^(At<<23|Nt>>>9),as=(Nt>>>14|At<<18)^(Nt>>>18|At<<14)^(Nt<<23|At>>>9),yi=b[Ue],Hn=yi.high,kt=yi.low,ut=ge+as,nn=je+Sr+(ut>>>0<ge>>>0?1:0),ut=ut+It,nn=nn+va+(ut>>>0<It>>>0?1:0),ut=ut+kt,nn=nn+Hn+(ut>>>0<kt>>>0?1:0),ut=ut+Dt,nn=nn+se+(ut>>>0<Dt>>>0?1:0),bs=ya+ys,Hs=_s+vi+(bs>>>0<ya>>>0?1:0);je=it,ge=we,it=gt,we=Fe,gt=At,Fe=Nt,Nt=lt+ut|0,At=Qe+nn+(Nt>>>0<lt>>>0?1:0)|0,Qe=be,lt=Be,be=qe,Be=_e,qe=Ae,_e=he,he=ut+bs|0,Ae=nn+Hs+(he>>>0<ut>>>0?1:0)|0}w=q.low=w+he,q.high=A+Ae+(w>>>0<he>>>0?1:0),U=O.low=U+_e,O.high=T+qe+(U>>>0<_e>>>0?1:0),ve=L.low=ve+Be,L.high=B+be+(ve>>>0<Be>>>0?1:0),Q=N.low=Q+lt,N.high=ye+Qe+(Q>>>0<lt>>>0?1:0),pe=F.low=pe+Nt,F.high=ue+At+(pe>>>0<Nt>>>0?1:0),H=P.low=H+Fe,P.high=Ce+gt+(H>>>0<Fe>>>0?1:0),z=E.low=z+we,E.high=G+it+(z>>>0<we>>>0?1:0),J=_.low=J+ge,_.high=W+je+(J>>>0<ge>>>0?1:0)},_doFinalize:function(){var R=this._data,D=R.words,k=this._nDataBytes*8,q=R.sigBytes*8;D[q>>>5]|=128<<24-q%32,D[(q+128>>>10<<5)+30]=Math.floor(k/4294967296),D[(q+128>>>10<<5)+31]=k,R.sigBytes=D.length*4,this._process();var O=this._hash.toX32();return O},clone:function(){var R=u.clone.call(this);return R._hash=this._hash.clone(),R},blockSize:1024/32});r.SHA512=u._createHelper(I),r.HmacSHA512=u._createHmacHelper(I)})(),n.SHA512})})(Wu)),Wu.exports}var Zu={exports:{}},bA=Zu.exports,Bv;function EA(){return Bv||(Bv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),Zd(),F1())})(bA,function(n){return(function(){var r=n,l=r.x64,u=l.Word,f=l.WordArray,p=r.algo,x=p.SHA512,m=p.SHA384=x.extend({_doReset:function(){this._hash=new f.init([new u.init(3418070365,3238371032),new u.init(1654270250,914150663),new u.init(2438529370,812702999),new u.init(355462360,4144912697),new u.init(1731405415,4290775857),new u.init(2394180231,1750603025),new u.init(3675008525,1694076839),new u.init(1203062813,3204075428)])},_doFinalize:function(){var v=x._doFinalize.call(this);return v.sigBytes-=16,v}});r.SHA384=x._createHelper(m),r.HmacSHA384=x._createHmacHelper(m)})(),n.SHA384})})(Zu)),Zu.exports}var Ju={exports:{}},SA=Ju.exports,Mv;function AA(){return Mv||(Mv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),Zd())})(SA,function(n){return(function(r){var l=n,u=l.lib,f=u.WordArray,p=u.Hasher,x=l.x64,m=x.Word,v=l.algo,b=[],S=[],I=[];(function(){for(var k=1,q=0,O=0;O<24;O++){b[k+5*q]=(O+1)*(O+2)/2%64;var L=q%5,N=(2*k+3*q)%5;k=L,q=N}for(var k=0;k<5;k++)for(var q=0;q<5;q++)S[k+5*q]=q+(2*k+3*q)%5*5;for(var F=1,P=0;P<24;P++){for(var E=0,_=0,A=0;A<7;A++){if(F&1){var w=(1<<A)-1;w<32?_^=1<<w:E^=1<<w-32}F&128?F=F<<1^113:F<<=1}I[P]=m.create(E,_)}})();var R=[];(function(){for(var k=0;k<25;k++)R[k]=m.create()})();var D=v.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var k=this._state=[],q=0;q<25;q++)k[q]=new m.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(k,q){for(var O=this._state,L=this.blockSize/2,N=0;N<L;N++){var F=k[q+2*N],P=k[q+2*N+1];F=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360;var E=O[N];E.high^=P,E.low^=F}for(var _=0;_<24;_++){for(var A=0;A<5;A++){for(var w=0,T=0,U=0;U<5;U++){var E=O[A+5*U];w^=E.high,T^=E.low}var B=R[A];B.high=w,B.low=T}for(var A=0;A<5;A++)for(var ve=R[(A+4)%5],ye=R[(A+1)%5],Q=ye.high,ue=ye.low,w=ve.high^(Q<<1|ue>>>31),T=ve.low^(ue<<1|Q>>>31),U=0;U<5;U++){var E=O[A+5*U];E.high^=w,E.low^=T}for(var pe=1;pe<25;pe++){var w,T,E=O[pe],Ce=E.high,H=E.low,G=b[pe];G<32?(w=Ce<<G|H>>>32-G,T=H<<G|Ce>>>32-G):(w=H<<G-32|Ce>>>64-G,T=Ce<<G-32|H>>>64-G);var z=R[S[pe]];z.high=w,z.low=T}var W=R[0],J=O[0];W.high=J.high,W.low=J.low;for(var A=0;A<5;A++)for(var U=0;U<5;U++){var pe=A+5*U,E=O[pe],Ae=R[pe],he=R[(A+1)%5+5*U],qe=R[(A+2)%5+5*U];E.high=Ae.high^~he.high&qe.high,E.low=Ae.low^~he.low&qe.low}var E=O[0],_e=I[_];E.high^=_e.high,E.low^=_e.low}},_doFinalize:function(){var k=this._data,q=k.words;this._nDataBytes*8;var O=k.sigBytes*8,L=this.blockSize*32;q[O>>>5]|=1<<24-O%32,q[(r.ceil((O+1)/L)*L>>>5)-1]|=128,k.sigBytes=q.length*4,this._process();for(var N=this._state,F=this.cfg.outputLength/8,P=F/8,E=[],_=0;_<P;_++){var A=N[_],w=A.high,T=A.low;w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,E.push(T),E.push(w)}return new f.init(E,F)},clone:function(){for(var k=p.clone.call(this),q=k._state=this._state.slice(0),O=0;O<25;O++)q[O]=q[O].clone();return k}});l.SHA3=p._createHelper(D),l.HmacSHA3=p._createHmacHelper(D)})(Math),n.SHA3})})(Ju)),Ju.exports}var ed={exports:{}},NA=ed.exports,Fv;function wA(){return Fv||(Fv=1,(function(i,e){(function(n,r){i.exports=r(st())})(NA,function(n){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return(function(r){var l=n,u=l.lib,f=u.WordArray,p=u.Hasher,x=l.algo,m=f.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),v=f.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),b=f.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),S=f.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),I=f.create([0,1518500249,1859775393,2400959708,2840853838]),R=f.create([1352829926,1548603684,1836072691,2053994217,0]),D=x.RIPEMD160=p.extend({_doReset:function(){this._hash=f.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(P,E){for(var _=0;_<16;_++){var A=E+_,w=P[A];P[A]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var T=this._hash.words,U=I.words,B=R.words,ve=m.words,ye=v.words,Q=b.words,ue=S.words,pe,Ce,H,G,z,W,J,Ae,he,qe;W=pe=T[0],J=Ce=T[1],Ae=H=T[2],he=G=T[3],qe=z=T[4];for(var _e,_=0;_<80;_+=1)_e=pe+P[E+ve[_]]|0,_<16?_e+=k(Ce,H,G)+U[0]:_<32?_e+=q(Ce,H,G)+U[1]:_<48?_e+=O(Ce,H,G)+U[2]:_<64?_e+=L(Ce,H,G)+U[3]:_e+=N(Ce,H,G)+U[4],_e=_e|0,_e=F(_e,Q[_]),_e=_e+z|0,pe=z,z=G,G=F(H,10),H=Ce,Ce=_e,_e=W+P[E+ye[_]]|0,_<16?_e+=N(J,Ae,he)+B[0]:_<32?_e+=L(J,Ae,he)+B[1]:_<48?_e+=O(J,Ae,he)+B[2]:_<64?_e+=q(J,Ae,he)+B[3]:_e+=k(J,Ae,he)+B[4],_e=_e|0,_e=F(_e,ue[_]),_e=_e+qe|0,W=qe,qe=he,he=F(Ae,10),Ae=J,J=_e;_e=T[1]+H+he|0,T[1]=T[2]+G+qe|0,T[2]=T[3]+z+W|0,T[3]=T[4]+pe+J|0,T[4]=T[0]+Ce+Ae|0,T[0]=_e},_doFinalize:function(){var P=this._data,E=P.words,_=this._nDataBytes*8,A=P.sigBytes*8;E[A>>>5]|=128<<24-A%32,E[(A+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,P.sigBytes=(E.length+1)*4,this._process();for(var w=this._hash,T=w.words,U=0;U<5;U++){var B=T[U];T[U]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return w},clone:function(){var P=p.clone.call(this);return P._hash=this._hash.clone(),P}});function k(P,E,_){return P^E^_}function q(P,E,_){return P&E|~P&_}function O(P,E,_){return(P|~E)^_}function L(P,E,_){return P&_|E&~_}function N(P,E,_){return P^(E|~_)}function F(P,E){return P<<E|P>>>32-E}l.RIPEMD160=p._createHelper(D),l.HmacRIPEMD160=p._createHmacHelper(D)})(),n.RIPEMD160})})(ed)),ed.exports}var td={exports:{}},CA=td.exports,Lv;function dm(){return Lv||(Lv=1,(function(i,e){(function(n,r){i.exports=r(st())})(CA,function(n){(function(){var r=n,l=r.lib,u=l.Base,f=r.enc,p=f.Utf8,x=r.algo;x.HMAC=u.extend({init:function(m,v){m=this._hasher=new m.init,typeof v=="string"&&(v=p.parse(v));var b=m.blockSize,S=b*4;v.sigBytes>S&&(v=m.finalize(v)),v.clamp();for(var I=this._oKey=v.clone(),R=this._iKey=v.clone(),D=I.words,k=R.words,q=0;q<b;q++)D[q]^=1549556828,k[q]^=909522486;I.sigBytes=R.sigBytes=S,this.reset()},reset:function(){var m=this._hasher;m.reset(),m.update(this._iKey)},update:function(m){return this._hasher.update(m),this},finalize:function(m){var v=this._hasher,b=v.finalize(m);v.reset();var S=v.finalize(this._oKey.clone().concat(b));return S}})})()})})(td)),td.exports}var nd={exports:{}},jA=nd.exports,Vv;function TA(){return Vv||(Vv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),um(),dm())})(jA,function(n){return(function(){var r=n,l=r.lib,u=l.Base,f=l.WordArray,p=r.algo,x=p.SHA256,m=p.HMAC,v=p.PBKDF2=u.extend({cfg:u.extend({keySize:128/32,hasher:x,iterations:25e4}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(b,S){for(var I=this.cfg,R=m.create(I.hasher,b),D=f.create(),k=f.create([1]),q=D.words,O=k.words,L=I.keySize,N=I.iterations;q.length<L;){var F=R.update(S).finalize(k);R.reset();for(var P=F.words,E=P.length,_=F,A=1;A<N;A++){_=R.finalize(_),R.reset();for(var w=_.words,T=0;T<E;T++)P[T]^=w[T]}D.concat(F),O[0]++}return D.sigBytes=L*4,D}});r.PBKDF2=function(b,S,I){return v.create(I).compute(b,S)}})(),n.PBKDF2})})(nd)),nd.exports}var sd={exports:{}},RA=sd.exports,Uv;function xr(){return Uv||(Uv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),M1(),dm())})(RA,function(n){return(function(){var r=n,l=r.lib,u=l.Base,f=l.WordArray,p=r.algo,x=p.MD5,m=p.EvpKDF=u.extend({cfg:u.extend({keySize:128/32,hasher:x,iterations:1}),init:function(v){this.cfg=this.cfg.extend(v)},compute:function(v,b){for(var S,I=this.cfg,R=I.hasher.create(),D=f.create(),k=D.words,q=I.keySize,O=I.iterations;k.length<q;){S&&R.update(S),S=R.update(v).finalize(b),R.reset();for(var L=1;L<O;L++)S=R.finalize(S),R.reset();D.concat(S)}return D.sigBytes=q*4,D}});r.EvpKDF=function(v,b,S){return m.create(S).compute(v,b)}})(),n.EvpKDF})})(sd)),sd.exports}var ad={exports:{}},DA=ad.exports,zv;function cn(){return zv||(zv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),xr())})(DA,function(n){n.lib.Cipher||(function(r){var l=n,u=l.lib,f=u.Base,p=u.WordArray,x=u.BufferedBlockAlgorithm,m=l.enc;m.Utf8;var v=m.Base64,b=l.algo,S=b.EvpKDF,I=u.Cipher=x.extend({cfg:f.extend(),createEncryptor:function(w,T){return this.create(this._ENC_XFORM_MODE,w,T)},createDecryptor:function(w,T){return this.create(this._DEC_XFORM_MODE,w,T)},init:function(w,T,U){this.cfg=this.cfg.extend(U),this._xformMode=w,this._key=T,this.reset()},reset:function(){x.reset.call(this),this._doReset()},process:function(w){return this._append(w),this._process()},finalize:function(w){w&&this._append(w);var T=this._doFinalize();return T},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function w(T){return typeof T=="string"?A:P}return function(T){return{encrypt:function(U,B,ve){return w(B).encrypt(T,U,B,ve)},decrypt:function(U,B,ve){return w(B).decrypt(T,U,B,ve)}}}})()});u.StreamCipher=I.extend({_doFinalize:function(){var w=this._process(!0);return w},blockSize:1});var R=l.mode={},D=u.BlockCipherMode=f.extend({createEncryptor:function(w,T){return this.Encryptor.create(w,T)},createDecryptor:function(w,T){return this.Decryptor.create(w,T)},init:function(w,T){this._cipher=w,this._iv=T}}),k=R.CBC=(function(){var w=D.extend();w.Encryptor=w.extend({processBlock:function(U,B){var ve=this._cipher,ye=ve.blockSize;T.call(this,U,B,ye),ve.encryptBlock(U,B),this._prevBlock=U.slice(B,B+ye)}}),w.Decryptor=w.extend({processBlock:function(U,B){var ve=this._cipher,ye=ve.blockSize,Q=U.slice(B,B+ye);ve.decryptBlock(U,B),T.call(this,U,B,ye),this._prevBlock=Q}});function T(U,B,ve){var ye,Q=this._iv;Q?(ye=Q,this._iv=r):ye=this._prevBlock;for(var ue=0;ue<ve;ue++)U[B+ue]^=ye[ue]}return w})(),q=l.pad={},O=q.Pkcs7={pad:function(w,T){for(var U=T*4,B=U-w.sigBytes%U,ve=B<<24|B<<16|B<<8|B,ye=[],Q=0;Q<B;Q+=4)ye.push(ve);var ue=p.create(ye,B);w.concat(ue)},unpad:function(w){var T=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=T}};u.BlockCipher=I.extend({cfg:I.cfg.extend({mode:k,padding:O}),reset:function(){var w;I.reset.call(this);var T=this.cfg,U=T.iv,B=T.mode;this._xformMode==this._ENC_XFORM_MODE?w=B.createEncryptor:(w=B.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==w?this._mode.init(this,U&&U.words):(this._mode=w.call(B,this,U&&U.words),this._mode.__creator=w)},_doProcessBlock:function(w,T){this._mode.processBlock(w,T)},_doFinalize:function(){var w,T=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(T.pad(this._data,this.blockSize),w=this._process(!0)):(w=this._process(!0),T.unpad(w)),w},blockSize:128/32});var L=u.CipherParams=f.extend({init:function(w){this.mixIn(w)},toString:function(w){return(w||this.formatter).stringify(this)}}),N=l.format={},F=N.OpenSSL={stringify:function(w){var T,U=w.ciphertext,B=w.salt;return B?T=p.create([1398893684,1701076831]).concat(B).concat(U):T=U,T.toString(v)},parse:function(w){var T,U=v.parse(w),B=U.words;return B[0]==1398893684&&B[1]==1701076831&&(T=p.create(B.slice(2,4)),B.splice(0,4),U.sigBytes-=16),L.create({ciphertext:U,salt:T})}},P=u.SerializableCipher=f.extend({cfg:f.extend({format:F}),encrypt:function(w,T,U,B){B=this.cfg.extend(B);var ve=w.createEncryptor(U,B),ye=ve.finalize(T),Q=ve.cfg;return L.create({ciphertext:ye,key:U,iv:Q.iv,algorithm:w,mode:Q.mode,padding:Q.padding,blockSize:w.blockSize,formatter:B.format})},decrypt:function(w,T,U,B){B=this.cfg.extend(B),T=this._parse(T,B.format);var ve=w.createDecryptor(U,B).finalize(T.ciphertext);return ve},_parse:function(w,T){return typeof w=="string"?T.parse(w,this):w}}),E=l.kdf={},_=E.OpenSSL={execute:function(w,T,U,B,ve){if(B||(B=p.random(64/8)),ve)var ye=S.create({keySize:T+U,hasher:ve}).compute(w,B);else var ye=S.create({keySize:T+U}).compute(w,B);var Q=p.create(ye.words.slice(T),U*4);return ye.sigBytes=T*4,L.create({key:ye,iv:Q,salt:B})}},A=u.PasswordBasedCipher=P.extend({cfg:P.cfg.extend({kdf:_}),encrypt:function(w,T,U,B){B=this.cfg.extend(B);var ve=B.kdf.execute(U,w.keySize,w.ivSize,B.salt,B.hasher);B.iv=ve.iv;var ye=P.encrypt.call(this,w,T,ve.key,B);return ye.mixIn(ve),ye},decrypt:function(w,T,U,B){B=this.cfg.extend(B),T=this._parse(T,B.format);var ve=B.kdf.execute(U,w.keySize,w.ivSize,T.salt,B.hasher);B.iv=ve.iv;var ye=P.decrypt.call(this,w,T,ve.key,B);return ye}})})()})})(ad)),ad.exports}var rd={exports:{}},IA=rd.exports,qv;function kA(){return qv||(qv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(IA,function(n){return n.mode.CFB=(function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(u,f){var p=this._cipher,x=p.blockSize;l.call(this,u,f,x,p),this._prevBlock=u.slice(f,f+x)}}),r.Decryptor=r.extend({processBlock:function(u,f){var p=this._cipher,x=p.blockSize,m=u.slice(f,f+x);l.call(this,u,f,x,p),this._prevBlock=m}});function l(u,f,p,x){var m,v=this._iv;v?(m=v.slice(0),this._iv=void 0):m=this._prevBlock,x.encryptBlock(m,0);for(var b=0;b<p;b++)u[f+b]^=m[b]}return r})(),n.mode.CFB})})(rd)),rd.exports}var id={exports:{}},PA=id.exports,Hv;function OA(){return Hv||(Hv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(PA,function(n){return n.mode.CTR=(function(){var r=n.lib.BlockCipherMode.extend(),l=r.Encryptor=r.extend({processBlock:function(u,f){var p=this._cipher,x=p.blockSize,m=this._iv,v=this._counter;m&&(v=this._counter=m.slice(0),this._iv=void 0);var b=v.slice(0);p.encryptBlock(b,0),v[x-1]=v[x-1]+1|0;for(var S=0;S<x;S++)u[f+S]^=b[S]}});return r.Decryptor=l,r})(),n.mode.CTR})})(id)),id.exports}var od={exports:{}},BA=od.exports,$v;function MA(){return $v||($v=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(BA,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=(function(){var r=n.lib.BlockCipherMode.extend();function l(p){if((p>>24&255)===255){var x=p>>16&255,m=p>>8&255,v=p&255;x===255?(x=0,m===255?(m=0,v===255?v=0:++v):++m):++x,p=0,p+=x<<16,p+=m<<8,p+=v}else p+=1<<24;return p}function u(p){return(p[0]=l(p[0]))===0&&(p[1]=l(p[1])),p}var f=r.Encryptor=r.extend({processBlock:function(p,x){var m=this._cipher,v=m.blockSize,b=this._iv,S=this._counter;b&&(S=this._counter=b.slice(0),this._iv=void 0),u(S);var I=S.slice(0);m.encryptBlock(I,0);for(var R=0;R<v;R++)p[x+R]^=I[R]}});return r.Decryptor=f,r})(),n.mode.CTRGladman})})(od)),od.exports}var ld={exports:{}},FA=ld.exports,Gv;function LA(){return Gv||(Gv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(FA,function(n){return n.mode.OFB=(function(){var r=n.lib.BlockCipherMode.extend(),l=r.Encryptor=r.extend({processBlock:function(u,f){var p=this._cipher,x=p.blockSize,m=this._iv,v=this._keystream;m&&(v=this._keystream=m.slice(0),this._iv=void 0),p.encryptBlock(v,0);for(var b=0;b<x;b++)u[f+b]^=v[b]}});return r.Decryptor=l,r})(),n.mode.OFB})})(ld)),ld.exports}var cd={exports:{}},VA=cd.exports,Kv;function UA(){return Kv||(Kv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(VA,function(n){return n.mode.ECB=(function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(l,u){this._cipher.encryptBlock(l,u)}}),r.Decryptor=r.extend({processBlock:function(l,u){this._cipher.decryptBlock(l,u)}}),r})(),n.mode.ECB})})(cd)),cd.exports}var ud={exports:{}},zA=ud.exports,Yv;function qA(){return Yv||(Yv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(zA,function(n){return n.pad.AnsiX923={pad:function(r,l){var u=r.sigBytes,f=l*4,p=f-u%f,x=u+p-1;r.clamp(),r.words[x>>>2]|=p<<24-x%4*8,r.sigBytes+=p},unpad:function(r){var l=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=l}},n.pad.Ansix923})})(ud)),ud.exports}var dd={exports:{}},HA=dd.exports,Qv;function $A(){return Qv||(Qv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(HA,function(n){return n.pad.Iso10126={pad:function(r,l){var u=l*4,f=u-r.sigBytes%u;r.concat(n.lib.WordArray.random(f-1)).concat(n.lib.WordArray.create([f<<24],1))},unpad:function(r){var l=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=l}},n.pad.Iso10126})})(dd)),dd.exports}var hd={exports:{}},GA=hd.exports,Xv;function KA(){return Xv||(Xv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(GA,function(n){return n.pad.Iso97971={pad:function(r,l){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,l)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})})(hd)),hd.exports}var fd={exports:{}},YA=fd.exports,Wv;function QA(){return Wv||(Wv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(YA,function(n){return n.pad.ZeroPadding={pad:function(r,l){var u=l*4;r.clamp(),r.sigBytes+=u-(r.sigBytes%u||u)},unpad:function(r){for(var l=r.words,u=r.sigBytes-1,u=r.sigBytes-1;u>=0;u--)if(l[u>>>2]>>>24-u%4*8&255){r.sigBytes=u+1;break}}},n.pad.ZeroPadding})})(fd)),fd.exports}var md={exports:{}},XA=md.exports,Zv;function WA(){return Zv||(Zv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(XA,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})})(md)),md.exports}var pd={exports:{}},ZA=pd.exports,Jv;function JA(){return Jv||(Jv=1,(function(i,e){(function(n,r,l){i.exports=r(st(),cn())})(ZA,function(n){return(function(r){var l=n,u=l.lib,f=u.CipherParams,p=l.enc,x=p.Hex,m=l.format;m.Hex={stringify:function(v){return v.ciphertext.toString(x)},parse:function(v){var b=x.parse(v);return f.create({ciphertext:b})}}})(),n.format.Hex})})(pd)),pd.exports}var gd={exports:{}},eN=gd.exports,ey;function tN(){return ey||(ey=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(eN,function(n){return(function(){var r=n,l=r.lib,u=l.BlockCipher,f=r.algo,p=[],x=[],m=[],v=[],b=[],S=[],I=[],R=[],D=[],k=[];(function(){for(var L=[],N=0;N<256;N++)N<128?L[N]=N<<1:L[N]=N<<1^283;for(var F=0,P=0,N=0;N<256;N++){var E=P^P<<1^P<<2^P<<3^P<<4;E=E>>>8^E&255^99,p[F]=E,x[E]=F;var _=L[F],A=L[_],w=L[A],T=L[E]*257^E*16843008;m[F]=T<<24|T>>>8,v[F]=T<<16|T>>>16,b[F]=T<<8|T>>>24,S[F]=T;var T=w*16843009^A*65537^_*257^F*16843008;I[E]=T<<24|T>>>8,R[E]=T<<16|T>>>16,D[E]=T<<8|T>>>24,k[E]=T,F?(F=_^L[L[L[w^_]]],P^=L[L[P]]):F=P=1}})();var q=[0,1,2,4,8,16,32,64,128,27,54],O=f.AES=u.extend({_doReset:function(){var L;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var N=this._keyPriorReset=this._key,F=N.words,P=N.sigBytes/4,E=this._nRounds=P+6,_=(E+1)*4,A=this._keySchedule=[],w=0;w<_;w++)w<P?A[w]=F[w]:(L=A[w-1],w%P?P>6&&w%P==4&&(L=p[L>>>24]<<24|p[L>>>16&255]<<16|p[L>>>8&255]<<8|p[L&255]):(L=L<<8|L>>>24,L=p[L>>>24]<<24|p[L>>>16&255]<<16|p[L>>>8&255]<<8|p[L&255],L^=q[w/P|0]<<24),A[w]=A[w-P]^L);for(var T=this._invKeySchedule=[],U=0;U<_;U++){var w=_-U;if(U%4)var L=A[w];else var L=A[w-4];U<4||w<=4?T[U]=L:T[U]=I[p[L>>>24]]^R[p[L>>>16&255]]^D[p[L>>>8&255]]^k[p[L&255]]}}},encryptBlock:function(L,N){this._doCryptBlock(L,N,this._keySchedule,m,v,b,S,p)},decryptBlock:function(L,N){var F=L[N+1];L[N+1]=L[N+3],L[N+3]=F,this._doCryptBlock(L,N,this._invKeySchedule,I,R,D,k,x);var F=L[N+1];L[N+1]=L[N+3],L[N+3]=F},_doCryptBlock:function(L,N,F,P,E,_,A,w){for(var T=this._nRounds,U=L[N]^F[0],B=L[N+1]^F[1],ve=L[N+2]^F[2],ye=L[N+3]^F[3],Q=4,ue=1;ue<T;ue++){var pe=P[U>>>24]^E[B>>>16&255]^_[ve>>>8&255]^A[ye&255]^F[Q++],Ce=P[B>>>24]^E[ve>>>16&255]^_[ye>>>8&255]^A[U&255]^F[Q++],H=P[ve>>>24]^E[ye>>>16&255]^_[U>>>8&255]^A[B&255]^F[Q++],G=P[ye>>>24]^E[U>>>16&255]^_[B>>>8&255]^A[ve&255]^F[Q++];U=pe,B=Ce,ve=H,ye=G}var pe=(w[U>>>24]<<24|w[B>>>16&255]<<16|w[ve>>>8&255]<<8|w[ye&255])^F[Q++],Ce=(w[B>>>24]<<24|w[ve>>>16&255]<<16|w[ye>>>8&255]<<8|w[U&255])^F[Q++],H=(w[ve>>>24]<<24|w[ye>>>16&255]<<16|w[U>>>8&255]<<8|w[B&255])^F[Q++],G=(w[ye>>>24]<<24|w[U>>>16&255]<<16|w[B>>>8&255]<<8|w[ve&255])^F[Q++];L[N]=pe,L[N+1]=Ce,L[N+2]=H,L[N+3]=G},keySize:256/32});r.AES=u._createHelper(O)})(),n.AES})})(gd)),gd.exports}var xd={exports:{}},nN=xd.exports,ty;function sN(){return ty||(ty=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(nN,function(n){return(function(){var r=n,l=r.lib,u=l.WordArray,f=l.BlockCipher,p=r.algo,x=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],m=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],v=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],b=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],S=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],I=p.DES=f.extend({_doReset:function(){for(var q=this._key,O=q.words,L=[],N=0;N<56;N++){var F=x[N]-1;L[N]=O[F>>>5]>>>31-F%32&1}for(var P=this._subKeys=[],E=0;E<16;E++){for(var _=P[E]=[],A=v[E],N=0;N<24;N++)_[N/6|0]|=L[(m[N]-1+A)%28]<<31-N%6,_[4+(N/6|0)]|=L[28+(m[N+24]-1+A)%28]<<31-N%6;_[0]=_[0]<<1|_[0]>>>31;for(var N=1;N<7;N++)_[N]=_[N]>>>(N-1)*4+3;_[7]=_[7]<<5|_[7]>>>27}for(var w=this._invSubKeys=[],N=0;N<16;N++)w[N]=P[15-N]},encryptBlock:function(q,O){this._doCryptBlock(q,O,this._subKeys)},decryptBlock:function(q,O){this._doCryptBlock(q,O,this._invSubKeys)},_doCryptBlock:function(q,O,L){this._lBlock=q[O],this._rBlock=q[O+1],R.call(this,4,252645135),R.call(this,16,65535),D.call(this,2,858993459),D.call(this,8,16711935),R.call(this,1,1431655765);for(var N=0;N<16;N++){for(var F=L[N],P=this._lBlock,E=this._rBlock,_=0,A=0;A<8;A++)_|=b[A][((E^F[A])&S[A])>>>0];this._lBlock=E,this._rBlock=P^_}var w=this._lBlock;this._lBlock=this._rBlock,this._rBlock=w,R.call(this,1,1431655765),D.call(this,8,16711935),D.call(this,2,858993459),R.call(this,16,65535),R.call(this,4,252645135),q[O]=this._lBlock,q[O+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function R(q,O){var L=(this._lBlock>>>q^this._rBlock)&O;this._rBlock^=L,this._lBlock^=L<<q}function D(q,O){var L=(this._rBlock>>>q^this._lBlock)&O;this._lBlock^=L,this._rBlock^=L<<q}r.DES=f._createHelper(I);var k=p.TripleDES=f.extend({_doReset:function(){var q=this._key,O=q.words;if(O.length!==2&&O.length!==4&&O.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var L=O.slice(0,2),N=O.length<4?O.slice(0,2):O.slice(2,4),F=O.length<6?O.slice(0,2):O.slice(4,6);this._des1=I.createEncryptor(u.create(L)),this._des2=I.createEncryptor(u.create(N)),this._des3=I.createEncryptor(u.create(F))},encryptBlock:function(q,O){this._des1.encryptBlock(q,O),this._des2.decryptBlock(q,O),this._des3.encryptBlock(q,O)},decryptBlock:function(q,O){this._des3.decryptBlock(q,O),this._des2.encryptBlock(q,O),this._des1.decryptBlock(q,O)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=f._createHelper(k)})(),n.TripleDES})})(xd)),xd.exports}var vd={exports:{}},aN=vd.exports,ny;function rN(){return ny||(ny=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(aN,function(n){return(function(){var r=n,l=r.lib,u=l.StreamCipher,f=r.algo,p=f.RC4=u.extend({_doReset:function(){for(var v=this._key,b=v.words,S=v.sigBytes,I=this._S=[],R=0;R<256;R++)I[R]=R;for(var R=0,D=0;R<256;R++){var k=R%S,q=b[k>>>2]>>>24-k%4*8&255;D=(D+I[R]+q)%256;var O=I[R];I[R]=I[D],I[D]=O}this._i=this._j=0},_doProcessBlock:function(v,b){v[b]^=x.call(this)},keySize:256/32,ivSize:0});function x(){for(var v=this._S,b=this._i,S=this._j,I=0,R=0;R<4;R++){b=(b+1)%256,S=(S+v[b])%256;var D=v[b];v[b]=v[S],v[S]=D,I|=v[(v[b]+v[S])%256]<<24-R*8}return this._i=b,this._j=S,I}r.RC4=u._createHelper(p);var m=f.RC4Drop=p.extend({cfg:p.cfg.extend({drop:192}),_doReset:function(){p._doReset.call(this);for(var v=this.cfg.drop;v>0;v--)x.call(this)}});r.RC4Drop=u._createHelper(m)})(),n.RC4})})(vd)),vd.exports}var yd={exports:{}},iN=yd.exports,sy;function oN(){return sy||(sy=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(iN,function(n){return(function(){var r=n,l=r.lib,u=l.StreamCipher,f=r.algo,p=[],x=[],m=[],v=f.Rabbit=u.extend({_doReset:function(){for(var S=this._key.words,I=this.cfg.iv,R=0;R<4;R++)S[R]=(S[R]<<8|S[R]>>>24)&16711935|(S[R]<<24|S[R]>>>8)&4278255360;var D=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],k=this._C=[S[2]<<16|S[2]>>>16,S[0]&4294901760|S[1]&65535,S[3]<<16|S[3]>>>16,S[1]&4294901760|S[2]&65535,S[0]<<16|S[0]>>>16,S[2]&4294901760|S[3]&65535,S[1]<<16|S[1]>>>16,S[3]&4294901760|S[0]&65535];this._b=0;for(var R=0;R<4;R++)b.call(this);for(var R=0;R<8;R++)k[R]^=D[R+4&7];if(I){var q=I.words,O=q[0],L=q[1],N=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,F=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,P=N>>>16|F&4294901760,E=F<<16|N&65535;k[0]^=N,k[1]^=P,k[2]^=F,k[3]^=E,k[4]^=N,k[5]^=P,k[6]^=F,k[7]^=E;for(var R=0;R<4;R++)b.call(this)}},_doProcessBlock:function(S,I){var R=this._X;b.call(this),p[0]=R[0]^R[5]>>>16^R[3]<<16,p[1]=R[2]^R[7]>>>16^R[5]<<16,p[2]=R[4]^R[1]>>>16^R[7]<<16,p[3]=R[6]^R[3]>>>16^R[1]<<16;for(var D=0;D<4;D++)p[D]=(p[D]<<8|p[D]>>>24)&16711935|(p[D]<<24|p[D]>>>8)&4278255360,S[I+D]^=p[D]},blockSize:128/32,ivSize:64/32});function b(){for(var S=this._X,I=this._C,R=0;R<8;R++)x[R]=I[R];I[0]=I[0]+1295307597+this._b|0,I[1]=I[1]+3545052371+(I[0]>>>0<x[0]>>>0?1:0)|0,I[2]=I[2]+886263092+(I[1]>>>0<x[1]>>>0?1:0)|0,I[3]=I[3]+1295307597+(I[2]>>>0<x[2]>>>0?1:0)|0,I[4]=I[4]+3545052371+(I[3]>>>0<x[3]>>>0?1:0)|0,I[5]=I[5]+886263092+(I[4]>>>0<x[4]>>>0?1:0)|0,I[6]=I[6]+1295307597+(I[5]>>>0<x[5]>>>0?1:0)|0,I[7]=I[7]+3545052371+(I[6]>>>0<x[6]>>>0?1:0)|0,this._b=I[7]>>>0<x[7]>>>0?1:0;for(var R=0;R<8;R++){var D=S[R]+I[R],k=D&65535,q=D>>>16,O=((k*k>>>17)+k*q>>>15)+q*q,L=((D&4294901760)*D|0)+((D&65535)*D|0);m[R]=O^L}S[0]=m[0]+(m[7]<<16|m[7]>>>16)+(m[6]<<16|m[6]>>>16)|0,S[1]=m[1]+(m[0]<<8|m[0]>>>24)+m[7]|0,S[2]=m[2]+(m[1]<<16|m[1]>>>16)+(m[0]<<16|m[0]>>>16)|0,S[3]=m[3]+(m[2]<<8|m[2]>>>24)+m[1]|0,S[4]=m[4]+(m[3]<<16|m[3]>>>16)+(m[2]<<16|m[2]>>>16)|0,S[5]=m[5]+(m[4]<<8|m[4]>>>24)+m[3]|0,S[6]=m[6]+(m[5]<<16|m[5]>>>16)+(m[4]<<16|m[4]>>>16)|0,S[7]=m[7]+(m[6]<<8|m[6]>>>24)+m[5]|0}r.Rabbit=u._createHelper(v)})(),n.Rabbit})})(yd)),yd.exports}var _d={exports:{}},lN=_d.exports,ay;function cN(){return ay||(ay=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(lN,function(n){return(function(){var r=n,l=r.lib,u=l.StreamCipher,f=r.algo,p=[],x=[],m=[],v=f.RabbitLegacy=u.extend({_doReset:function(){var S=this._key.words,I=this.cfg.iv,R=this._X=[S[0],S[3]<<16|S[2]>>>16,S[1],S[0]<<16|S[3]>>>16,S[2],S[1]<<16|S[0]>>>16,S[3],S[2]<<16|S[1]>>>16],D=this._C=[S[2]<<16|S[2]>>>16,S[0]&4294901760|S[1]&65535,S[3]<<16|S[3]>>>16,S[1]&4294901760|S[2]&65535,S[0]<<16|S[0]>>>16,S[2]&4294901760|S[3]&65535,S[1]<<16|S[1]>>>16,S[3]&4294901760|S[0]&65535];this._b=0;for(var k=0;k<4;k++)b.call(this);for(var k=0;k<8;k++)D[k]^=R[k+4&7];if(I){var q=I.words,O=q[0],L=q[1],N=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,F=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,P=N>>>16|F&4294901760,E=F<<16|N&65535;D[0]^=N,D[1]^=P,D[2]^=F,D[3]^=E,D[4]^=N,D[5]^=P,D[6]^=F,D[7]^=E;for(var k=0;k<4;k++)b.call(this)}},_doProcessBlock:function(S,I){var R=this._X;b.call(this),p[0]=R[0]^R[5]>>>16^R[3]<<16,p[1]=R[2]^R[7]>>>16^R[5]<<16,p[2]=R[4]^R[1]>>>16^R[7]<<16,p[3]=R[6]^R[3]>>>16^R[1]<<16;for(var D=0;D<4;D++)p[D]=(p[D]<<8|p[D]>>>24)&16711935|(p[D]<<24|p[D]>>>8)&4278255360,S[I+D]^=p[D]},blockSize:128/32,ivSize:64/32});function b(){for(var S=this._X,I=this._C,R=0;R<8;R++)x[R]=I[R];I[0]=I[0]+1295307597+this._b|0,I[1]=I[1]+3545052371+(I[0]>>>0<x[0]>>>0?1:0)|0,I[2]=I[2]+886263092+(I[1]>>>0<x[1]>>>0?1:0)|0,I[3]=I[3]+1295307597+(I[2]>>>0<x[2]>>>0?1:0)|0,I[4]=I[4]+3545052371+(I[3]>>>0<x[3]>>>0?1:0)|0,I[5]=I[5]+886263092+(I[4]>>>0<x[4]>>>0?1:0)|0,I[6]=I[6]+1295307597+(I[5]>>>0<x[5]>>>0?1:0)|0,I[7]=I[7]+3545052371+(I[6]>>>0<x[6]>>>0?1:0)|0,this._b=I[7]>>>0<x[7]>>>0?1:0;for(var R=0;R<8;R++){var D=S[R]+I[R],k=D&65535,q=D>>>16,O=((k*k>>>17)+k*q>>>15)+q*q,L=((D&4294901760)*D|0)+((D&65535)*D|0);m[R]=O^L}S[0]=m[0]+(m[7]<<16|m[7]>>>16)+(m[6]<<16|m[6]>>>16)|0,S[1]=m[1]+(m[0]<<8|m[0]>>>24)+m[7]|0,S[2]=m[2]+(m[1]<<16|m[1]>>>16)+(m[0]<<16|m[0]>>>16)|0,S[3]=m[3]+(m[2]<<8|m[2]>>>24)+m[1]|0,S[4]=m[4]+(m[3]<<16|m[3]>>>16)+(m[2]<<16|m[2]>>>16)|0,S[5]=m[5]+(m[4]<<8|m[4]>>>24)+m[3]|0,S[6]=m[6]+(m[5]<<16|m[5]>>>16)+(m[4]<<16|m[4]>>>16)|0,S[7]=m[7]+(m[6]<<8|m[6]>>>24)+m[5]|0}r.RabbitLegacy=u._createHelper(v)})(),n.RabbitLegacy})})(_d)),_d.exports}var bd={exports:{}},uN=bd.exports,ry;function dN(){return ry||(ry=1,(function(i,e){(function(n,r,l){i.exports=r(st(),fi(),mi(),xr(),cn())})(uN,function(n){return(function(){var r=n,l=r.lib,u=l.BlockCipher,f=r.algo;const p=16,x=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],m=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var v={pbox:[],sbox:[]};function b(k,q){let O=q>>24&255,L=q>>16&255,N=q>>8&255,F=q&255,P=k.sbox[0][O]+k.sbox[1][L];return P=P^k.sbox[2][N],P=P+k.sbox[3][F],P}function S(k,q,O){let L=q,N=O,F;for(let P=0;P<p;++P)L=L^k.pbox[P],N=b(k,L)^N,F=L,L=N,N=F;return F=L,L=N,N=F,N=N^k.pbox[p],L=L^k.pbox[p+1],{left:L,right:N}}function I(k,q,O){let L=q,N=O,F;for(let P=p+1;P>1;--P)L=L^k.pbox[P],N=b(k,L)^N,F=L,L=N,N=F;return F=L,L=N,N=F,N=N^k.pbox[1],L=L^k.pbox[0],{left:L,right:N}}function R(k,q,O){for(let E=0;E<4;E++){k.sbox[E]=[];for(let _=0;_<256;_++)k.sbox[E][_]=m[E][_]}let L=0;for(let E=0;E<p+2;E++)k.pbox[E]=x[E]^q[L],L++,L>=O&&(L=0);let N=0,F=0,P=0;for(let E=0;E<p+2;E+=2)P=S(k,N,F),N=P.left,F=P.right,k.pbox[E]=N,k.pbox[E+1]=F;for(let E=0;E<4;E++)for(let _=0;_<256;_+=2)P=S(k,N,F),N=P.left,F=P.right,k.sbox[E][_]=N,k.sbox[E][_+1]=F;return!0}var D=f.Blowfish=u.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var k=this._keyPriorReset=this._key,q=k.words,O=k.sigBytes/4;R(v,q,O)}},encryptBlock:function(k,q){var O=S(v,k[q],k[q+1]);k[q]=O.left,k[q+1]=O.right},decryptBlock:function(k,q){var O=I(v,k[q],k[q+1]);k[q]=O.left,k[q+1]=O.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=u._createHelper(D)})(),n.Blowfish})})(bd)),bd.exports}var hN=Vu.exports,iy;function fN(){return iy||(iy=1,(function(i,e){(function(n,r,l){i.exports=r(st(),Zd(),cA(),dA(),fi(),mA(),mi(),M1(),um(),yA(),F1(),EA(),AA(),wA(),dm(),TA(),xr(),cn(),kA(),OA(),MA(),LA(),UA(),qA(),$A(),KA(),QA(),WA(),JA(),tN(),sN(),rN(),oN(),cN(),dN())})(hN,function(n){return n})})(Vu)),Vu.exports}var mN=fN();const oy=lm(mN),Il="https://efiling.sars.gov.za/api/v1",kl="https://sandbox.efiling.sars.gov.za/api/v1";class pN{config;accessToken=null;refreshToken=null;constructor(e){this.config=e}async authenticate(){try{const e=this.buildAuthUrl(),n=await this.getAuthCode(e),r=await this.exchangeCodeForToken(n);return this.accessToken=r.access_token,this.refreshToken=r.refresh_token,localStorage.setItem("sars_access_token",this.accessToken),localStorage.setItem("sars_refresh_token",this.refreshToken),!0}catch(e){return console.error("SARS Authentication failed:",e),!1}}buildAuthUrl(){const e=this.config.environment==="production"?Il:kl,n=new URLSearchParams({client_id:this.config.clientId,redirect_uri:this.config.redirectUri,response_type:"code",scope:"vat_return submission tax_calculation",state:this.generateState()});return`${e}/oauth/authorize?${n.toString()}`}async exchangeCodeForToken(e){const n=this.config.environment==="production"?Il:kl,r=await fetch(`${n}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({grant_type:"authorization_code",client_id:this.config.clientId,client_secret:this.config.clientSecret,redirect_uri:this.config.redirectUri,code:e})});if(!r.ok)throw new Error(`Token exchange failed: ${r.statusText}`);return await r.json()}async submitVATReturn(e){if(!this.accessToken)throw new Error("Not authenticated with SARS");try{const n=this.prepareVATSubmission(e),r=this.config.environment==="production"?Il:kl,l=await fetch(`${r}/vat/returns`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json",Accept:"application/json","X-VAT-Number":this.config.vatNumber,"X-Tax-Year":this.config.taxYear},body:JSON.stringify(n)});if(!l.ok){const f=await l.json();throw new Error(`VAT submission failed: ${f.message||l.statusText}`)}const u=await l.json();return{id:u.submission_id,vatReturn:e,submissionDate:new Date().toISOString(),status:"submitted",referenceNumber:u.reference_number}}catch(n){throw console.error("VAT submission failed:",n),n}}async getVATReturnStatus(e){if(!this.accessToken)throw new Error("Not authenticated with SARS");try{const n=this.config.environment==="production"?Il:kl,r=await fetch(`${n}/vat/returns/${e}`,{method:"GET",headers:{Authorization:`Bearer ${this.accessToken}`,Accept:"application/json"}});if(!r.ok)throw new Error(`Failed to get VAT return status: ${r.statusText}`);return await r.json()}catch(n){throw console.error("Failed to get VAT return status:",n),n}}calculateVAT(e){let n=0,r=0,l=0,u=0,f=0,p=0;e.forEach(m=>{m.type==="income"?(l+=m.amount,m.vatRate===15?n+=m.vatAmount||0:m.vatRate===0?f+=m.amount:m.vatRate==="exempt"&&(p+=m.amount)):m.type==="expense"&&(u+=m.amount,m.vatRate===15&&(r+=m.vatAmount||0))});const x=n-r;return{period:this.getCurrentPeriod(),vatCollected:n,vatPaid:r,vatOwing:x,sales:l,purchases:u,zeroRated:f,exempt:p}}prepareVATSubmission(e){return{vat_number:this.config.vatNumber,tax_year:this.config.taxYear,period:e.period,vat_collected:e.vatCollected,vat_paid:e.vatPaid,vat_owing:e.vatOwing,sales:e.sales,purchases:e.purchases,zero_rated:e.zeroRated,exempt:e.exempt,submission_date:new Date().toISOString(),digital_signature:this.generateDigitalSignature(e)}}generateDigitalSignature(e){const n=`${this.config.vatNumber}${e.period}${e.vatCollected}${e.vatPaid}`;return oy.SHA256(n).toString()}getCurrentPeriod(){const e=new Date,n=e.getFullYear(),r=e.getMonth()+1;return`${n}-${r.toString().padStart(2,"0")}`}generateState(){return oy.lib.WordArray.random(32).toString()}async getAuthCode(e){return new Promise(n=>{setTimeout(()=>{n("mock_auth_code_"+Date.now())},1e3)})}async refreshAccessToken(){if(!this.refreshToken)return!1;try{const e=this.config.environment==="production"?Il:kl,n=await fetch(`${e}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({grant_type:"refresh_token",client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:this.refreshToken})});if(!n.ok)throw new Error(`Token refresh failed: ${n.statusText}`);const r=await n.json();return this.accessToken=r.access_token,localStorage.setItem("sars_access_token",this.accessToken),!0}catch(e){return console.error("Token refresh failed:",e),!1}}isAuthenticated(){return!!this.accessToken}logout(){this.accessToken=null,this.refreshToken=null,localStorage.removeItem("sars_access_token"),localStorage.removeItem("sars_refresh_token")}}class gN{config;accessToken=null;refreshToken=null;constructor(e){this.config=e}async authenticate(){try{const e=this.buildAuthUrl(),n=await this.getAuthCode(e),r=await this.exchangeCodeForToken(n);return this.accessToken=r.access_token,this.refreshToken=r.refresh_token,localStorage.setItem(`${this.config.system}_access_token`,this.accessToken),localStorage.setItem(`${this.config.system}_refresh_token`,this.refreshToken),!0}catch(e){return console.error(`${this.config.system} Authentication failed:`,e),!1}}buildAuthUrl(){const n={quickbooks:"https://appcenter.intuit.com/connect/oauth2",xero:"https://login.xero.com/identity/connect/authorize",sage:"https://api.sage.com/oauth/authorize",pastel:"https://api.pastel.com/oauth/authorize"}[this.config.system],r=new URLSearchParams({client_id:this.config.clientId,redirect_uri:this.config.redirectUri,response_type:"code",scope:this.getScope(),state:this.generateState()});return`${n}?${r.toString()}`}getScope(){return{quickbooks:"com.intuit.quickbooks.accounting",xero:"accounting.transactions.read accounting.transactions.write",sage:"accounting.read accounting.write",pastel:"transactions.read transactions.write"}[this.config.system]}async exchangeCodeForToken(e){const r={quickbooks:"https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer",xero:"https://identity.xero.com/connect/token",sage:"https://api.sage.com/oauth/token",pastel:"https://api.pastel.com/oauth/token"}[this.config.system],l=await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({grant_type:"authorization_code",client_id:this.config.clientId,client_secret:this.config.clientSecret,redirect_uri:this.config.redirectUri,code:e})});if(!l.ok)throw new Error(`Token exchange failed: ${l.statusText}`);return await l.json()}async syncTransactions(e){if(!this.accessToken)throw new Error(`Not authenticated with ${this.config.system}`);try{const n={success:!0,syncedTransactions:0,errors:[],lastSyncDate:new Date().toISOString()};for(const r of e)try{await this.createTransaction(r),n.syncedTransactions++}catch(l){n.errors.push(`Failed to sync transaction ${r.id}: ${l.message}`)}return n.errors.length>0&&(n.success=!1),n}catch(n){throw console.error(`Transaction sync failed for ${this.config.system}:`,n),n}}async createTransaction(e){const n=this.getApiUrl(),r=this.formatTransactionForSystem(e),l=await fetch(`${n}/transactions`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)});if(!l.ok){const u=await l.json();throw new Error(`Transaction creation failed: ${u.message||l.statusText}`)}}async getTransactions(e,n){if(!this.accessToken)throw new Error(`Not authenticated with ${this.config.system}`);try{const r=this.getApiUrl(),l=await fetch(`${r}/transactions?start_date=${e}&end_date=${n}`,{method:"GET",headers:{Authorization:`Bearer ${this.accessToken}`,Accept:"application/json"}});if(!l.ok)throw new Error(`Failed to get transactions: ${l.statusText}`);const u=await l.json();return this.parseTransactionsFromSystem(u)}catch(r){throw console.error(`Failed to get transactions from ${this.config.system}:`,r),r}}getApiUrl(){const n={quickbooks:"https://sandbox-quickbooks.api.intuit.com/v3/company",xero:"https://api.xero.com/api.xro/2.0",sage:"https://api.sage.com/v1",pastel:"https://api.pastel.com/v1"}[this.config.system];return this.config.system==="quickbooks"&&this.config.companyId?`${n}/${this.config.companyId}`:n}formatTransactionForSystem(e){switch(this.config.system){case"quickbooks":return this.formatForQuickBooks(e);case"xero":return this.formatForXero(e);case"sage":return this.formatForSage(e);case"pastel":return this.formatForPastel(e);default:throw new Error(`Unsupported accounting system: ${this.config.system}`)}}formatForQuickBooks(e){return{Line:[{DetailType:"JournalEntryLineDetail",Amount:e.amount,JournalEntryLineDetail:{PostingType:e.type==="income"?"Credit":"Debit",AccountRef:{value:this.getAccountId(e.account)}}}],TxnDate:e.date,DocNumber:e.reference}}formatForXero(e){return{Type:"ACCREC",Contact:{Name:"Pezela Customer"},Date:e.date,LineItems:[{Description:e.description,Quantity:1,UnitAmount:e.amount,AccountCode:this.getAccountCode(e.account),TaxType:e.vatAmount?"OUTPUT":"NONE"}],Reference:e.reference}}formatForSage(e){return{transaction_date:e.date,description:e.description,amount:e.amount,account_code:this.getAccountCode(e.account),transaction_type:e.type,reference:e.reference,vat_amount:e.vatAmount||0}}formatForPastel(e){return{date:e.date,description:e.description,amount:e.amount,account:e.account,type:e.type,reference:e.reference,vat:e.vatAmount||0}}parseTransactionsFromSystem(e){switch(this.config.system){case"quickbooks":return this.parseQuickBooksTransactions(e);case"xero":return this.parseXeroTransactions(e);case"sage":return this.parseSageTransactions(e);case"pastel":return this.parsePastelTransactions(e);default:throw new Error(`Unsupported accounting system: ${this.config.system}`)}}parseQuickBooksTransactions(e){return e.QueryResponse.JournalEntry?.map(n=>({id:n.Id,date:n.TxnDate,description:n.Line[0]?.Description||"",amount:n.Line[0]?.Amount||0,type:n.Line[0]?.JournalEntryLineDetail?.PostingType==="Credit"?"income":"expense",category:n.Line[0]?.JournalEntryLineDetail?.AccountRef?.name||"",account:n.Line[0]?.JournalEntryLineDetail?.AccountRef?.value||"",reference:n.DocNumber||""}))||[]}parseXeroTransactions(e){return e.Invoices?.map(n=>({id:n.InvoiceID,date:n.Date,description:n.LineItems[0]?.Description||"",amount:n.Total,type:"income",category:n.LineItems[0]?.AccountCode||"",account:n.LineItems[0]?.AccountCode||"",reference:n.InvoiceNumber||""}))||[]}parseSageTransactions(e){return e.transactions?.map(n=>({id:n.id,date:n.transaction_date,description:n.description,amount:n.amount,type:n.transaction_type,category:n.account_code,account:n.account_code,reference:n.reference,vatAmount:n.vat_amount}))||[]}parsePastelTransactions(e){return e.transactions?.map(n=>({id:n.id,date:n.date,description:n.description,amount:n.amount,type:n.type,category:n.account,account:n.account,reference:n.reference,vatAmount:n.vat}))||[]}getAccountId(e){return{Sales:"1","Office Expenses":"2",Marketing:"3",Travel:"4",Equipment:"5"}[e]||"1"}getAccountCode(e){return{Sales:"4000","Office Expenses":"6000",Marketing:"6100",Travel:"6200",Equipment:"6300"}[e]||"4000"}generateState(){return Math.random().toString(36).substring(2,15)}async getAuthCode(e){return new Promise(n=>{setTimeout(()=>{n(`mock_auth_code_${this.config.system}_${Date.now()}`)},1e3)})}async refreshAccessToken(){if(!this.refreshToken)return!1;try{const n={quickbooks:"https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer",xero:"https://identity.xero.com/connect/token",sage:"https://api.sage.com/oauth/token",pastel:"https://api.pastel.com/oauth/token"}[this.config.system],r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({grant_type:"refresh_token",client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:this.refreshToken})});if(!r.ok)throw new Error(`Token refresh failed: ${r.statusText}`);const l=await r.json();return this.accessToken=l.access_token,localStorage.setItem(`${this.config.system}_access_token`,this.accessToken),!0}catch(e){return console.error("Token refresh failed:",e),!1}}isAuthenticated(){return!!this.accessToken}logout(){this.accessToken=null,this.refreshToken=null,localStorage.removeItem(`${this.config.system}_access_token`),localStorage.removeItem(`${this.config.system}_refresh_token`)}}const Pl={SARS:{clientId:"your_sars_client_id",clientSecret:"your_sars_client_secret",redirectUri:"https://pezela.co.za/oauth/sars/callback",environment:"sandbox",vatNumber:"4880303328",taxYear:"2024"},QUICKBOOKS:{clientId:"your_quickbooks_client_id",clientSecret:"your_quickbooks_client_secret",redirectUri:"https://pezela.co.za/oauth/quickbooks/callback",environment:"sandbox",companyId:"your_company_id"},XERO:{clientId:"your_xero_client_id",clientSecret:"your_xero_client_secret",redirectUri:"https://pezela.co.za/oauth/xero/callback",environment:"sandbox"},SAGE:{clientId:"your_sage_client_id",clientSecret:"your_sage_client_secret",redirectUri:"https://pezela.co.za/oauth/sage/callback",environment:"sandbox"},PASTEL:{clientId:"your_pastel_client_id",clientSecret:"your_pastel_client_secret",redirectUri:"https://pezela.co.za/oauth/pastel/callback",environment:"sandbox"}},xN=()=>{const[i,e]=X.useState("dashboard"),[n,r]=X.useState([]),[l,u]=X.useState(null),[f,p]=X.useState([{id:"quickbooks",name:"QuickBooks",isConnected:!1,lastSync:"",config:{clientId:"your_quickbooks_client_id",clientSecret:"your_quickbooks_client_secret",redirectUri:"https://your-app.com/oauth/quickbooks/callback",environment:"sandbox"}},{id:"xero",name:"Xero",isConnected:!1,lastSync:"",config:{clientId:"your_xero_client_id",clientSecret:"your_xero_client_secret",redirectUri:"https://your-app.com/oauth/xero/callback",environment:"sandbox"}},{id:"sage",name:"Sage",isConnected:!1,lastSync:"",config:{clientId:"your_sage_client_id",clientSecret:"your_sage_client_secret",redirectUri:"https://your-app.com/oauth/sage/callback",environment:"sandbox"}},{id:"pastel",name:"Pastel",isConnected:!1,lastSync:"",config:{clientId:"your_pastel_client_id",clientSecret:"your_pastel_client_secret",redirectUri:"https://your-app.com/oauth/pastel/callback",environment:"sandbox"}}]),[x,m]=X.useState(null),[v,b]=X.useState("current-month"),[S,I]=X.useState(!1),[R,D]=X.useState(!1),[k,q]=X.useState(!1),[O,L]=X.useState(!1),[N,F]=X.useState({}),[P,E]=X.useState(!1),[_,A]=X.useState(!1),[w,T]=X.useState(!1),[U,B]=X.useState(!1),[ve,ye]=X.useState(!1),[Q,ue]=X.useState(!1),[pe,Ce]=X.useState(!1),[H,G]=X.useState(!1),[z,W]=X.useState(null),[J,Ae]=X.useState(!1),[he,qe]=X.useState(null),[_e,be]=X.useState(null),[Be,Qe]=X.useState(null),[lt,At]=X.useState(null),[Nt,gt]=X.useState(!1),[Fe,it]=X.useState(null),[we,je]=X.useState(null),[ge,Ue]=X.useState({});X.useEffect(()=>{const K=new pN(Pl.SARS);m(K);const ie=f.map(le=>{let Ne;switch(le.id){case"quickbooks":Ne=Pl.QUICKBOOKS;break;case"xero":Ne=Pl.XERO;break;case"sage":Ne=Pl.SAGE;break;case"pastel":Ne=Pl.PASTEL;break;default:Ne=le.config}const Se=new gN({system:le.id,clientId:Ne.clientId,clientSecret:Ne.clientSecret,redirectUri:Ne.redirectUri,environment:Ne.environment,companyId:Ne.companyId});return{...le,service:Se,config:Ne}});p(ie),Dt()},[]);const Dt=async()=>{try{const K=[];for(const ie of f)if(ie.isConnected&&ie.service)try{const le=new Date;le.setMonth(le.getMonth()-1);const Ne=new Date,Se=await ie.service.getTransactions(le.toISOString().split("T")[0],Ne.toISOString().split("T")[0]);K.push(...Se)}catch(le){console.error(`Failed to load transactions from ${ie.name}:`,le)}K.length===0?se():(r(K),ke(K))}catch(K){console.error("Failed to load transactions:",K),se()}},se=()=>{const K=[{id:"1",date:"2024-01-15",description:"Sales - Product A",amount:1500,type:"income",category:"Sales",paymentMethod:"Card",reference:"INV-001",vatAmount:195,isReconciled:!0},{id:"2",date:"2024-01-15",description:"Office Supplies",amount:250,type:"expense",category:"Office Expenses",paymentMethod:"EFT",reference:"EXP-001",vatAmount:32.5,isReconciled:!0},{id:"3",date:"2024-01-16",description:"Sales - Product B",amount:800,type:"income",category:"Sales",paymentMethod:"Cash",reference:"INV-002",vatAmount:104,isReconciled:!1}];r(K),ke(K)},ke=K=>{const ie=K.filter(vt=>vt.type==="income").reduce((vt,Xt)=>vt+Xt.amount,0),le=K.filter(vt=>vt.type==="expense").reduce((vt,Xt)=>vt+Xt.amount,0),Ne=K.filter(vt=>vt.type==="income").reduce((vt,Xt)=>vt+(Xt.vatAmount||0),0),Se=K.filter(vt=>vt.type==="expense").reduce((vt,Xt)=>vt+(Xt.vatAmount||0),0),xt={period:"January 2024",totalIncome:ie,totalExpenses:le,netProfit:ie-le,vatCollected:Ne,vatPaid:Se,vatOwing:Ne-Se,transactions:K};u(xt)},Xe=(K,ie)=>{r(le=>le.map(Ne=>Ne.id===K?{...Ne,category:ie}:Ne))},ot=K=>{r(ie=>ie.map(le=>le.id===K?{...le,isReconciled:!0}:le))};return a.jsxs("div",{className:"bookkeeping-snapshot",children:[a.jsxs("div",{className:"bookkeeping-header",children:[a.jsx("h2",{children:"Bookkeeping Snapshot"}),a.jsx("p",{children:"Automated financial management for South African businesses"})]}),a.jsxs("div",{className:"bookkeeping-tabs",children:[a.jsx("button",{className:`tab ${i==="dashboard"?"active":""}`,onClick:()=>e("dashboard"),children:"Dashboard"}),a.jsx("button",{className:`tab ${i==="transactions"?"active":""}`,onClick:()=>e("transactions"),children:"Transactions"}),a.jsx("button",{className:`tab ${i==="reports"?"active":""}`,onClick:()=>e("reports"),children:"Reports"}),a.jsx("button",{className:`tab ${i==="settings"?"active":""}`,onClick:()=>e("settings"),children:"Settings"})]}),i==="dashboard"&&a.jsxs("div",{className:"dashboard-content",children:[a.jsxs("div",{className:"financial-overview",children:[a.jsx("h3",{children:"Financial Overview"}),a.jsxs("div",{className:"overview-cards",children:[a.jsxs("div",{className:"overview-card income",children:[a.jsx("h4",{children:"Total Income"}),a.jsxs("div",{className:"amount",children:["R",l?.totalIncome.toLocaleString()]}),a.jsx("div",{className:"period",children:l?.period})]}),a.jsxs("div",{className:"overview-card expenses",children:[a.jsx("h4",{children:"Total Expenses"}),a.jsxs("div",{className:"amount",children:["R",l?.totalExpenses.toLocaleString()]}),a.jsx("div",{className:"period",children:l?.period})]}),a.jsxs("div",{className:"overview-card profit",children:[a.jsx("h4",{children:"Net Profit"}),a.jsxs("div",{className:"amount",children:["R",l?.netProfit.toLocaleString()]}),a.jsx("div",{className:"period",children:l?.period})]}),a.jsxs("div",{className:"overview-card vat",children:[a.jsx("h4",{children:"VAT Owing"}),a.jsxs("div",{className:"amount",children:["R",l?.vatOwing.toLocaleString()]}),a.jsx("div",{className:"period",children:"To SARS"})]})]})]}),a.jsxs("div",{className:"quick-actions",children:[a.jsx("h3",{children:"Quick Actions"}),a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"action-btn primary",onClick:async()=>{I(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/sars-report",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,transactions:n,timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.json();F(Ne=>({...Ne,sarsReport:le})),E(!0)}}else{await new Promise(le=>setTimeout(le,2e3));const ie={period:v,vatCollected:l?.vatCollected||0,vatPaid:l?.vatPaid||0,vatOwing:l?.vatOwing||0,referenceNumber:`SARS-${Date.now()}`,generatedAt:new Date().toISOString()};F(le=>({...le,sarsReport:ie})),E(!0)}}catch(K){console.error("Error generating SARS report:",K),alert(` Error generating SARS report:
${K.message||"Please try again."}`)}finally{I(!1)}},children:S?"Generating...":"Generate SARS Report"}),a.jsx("button",{className:"action-btn secondary",onClick:async()=>{D(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/export-pandl",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,format:"pdf",includeCharts:!0,timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=`P&L_Statement_${v}.pdf`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),F(xt=>({...xt,pandLExport:{success:!0,filename:`P&L_Statement_${v}.pdf`}})),A(!0)}}else{await new Promise(le=>setTimeout(le,1500));const ie={period:v,totalIncome:l?.totalIncome||0,totalExpenses:l?.totalExpenses||0,netProfit:l?.netProfit||0,filename:`P&L_Statement_${v}.pdf`};F(le=>({...le,pandLExport:ie})),A(!0)}}catch(K){console.error("Error exporting P&L:",K),alert(` Error exporting P&L statement:
${K.message||"Please try again."}`)}finally{D(!1)}},children:R?"Exporting...":"Export P&L Statement"}),a.jsx("button",{className:"action-btn secondary",onClick:async()=>{q(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/bank-reconciliation",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,transactions:n,timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.json();F(Ne=>({...Ne,reconciliation:le})),T(!0)}}else{await new Promise(le=>setTimeout(le,2500));const ie={matchedTransactions:Math.floor(n.length*.85),unmatchedTransactions:Math.floor(n.length*.15),discrepancies:Math.floor(Math.random()*500),status:"Completed",reconciledAt:new Date().toISOString()};F(le=>({...le,reconciliation:ie})),T(!0)}}catch(K){console.error("Error during reconciliation:",K),alert(` Error during bank reconciliation:
${K.message||"Please try again."}`)}finally{q(!1)}},children:k?"Reconciling...":"Bank Reconciliation"}),a.jsx("button",{className:"action-btn secondary",onClick:async()=>{L(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/cash-flow-analysis",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,transactions:n,timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.json();F(Ne=>({...Ne,cashFlowAnalysis:le})),B(!0)}}else{await new Promise(le=>setTimeout(le,3e3));const ie={operatingCashFlow:l?.netProfit||0,investingCashFlow:-Math.floor(Math.random()*5e3),financingCashFlow:Math.floor(Math.random()*1e4),netCashFlow:(l?.netProfit||0)+Math.floor(Math.random()*5e3),cashPosition:"Healthy",recommendations:["Monitor cash flow weekly","Consider credit facility","Optimize payment terms"]};F(le=>({...le,cashFlowAnalysis:ie})),B(!0)}}catch(K){console.error("Error analyzing cash flow:",K),alert(` Error analyzing cash flow:
${K.message||"Please try again."}`)}finally{L(!1)}},children:O?"Analyzing...":"Cash Flow Analysis"})]})]}),P&&N.sarsReport&&a.jsxs("div",{className:"result-card sars-report",children:[a.jsxs("div",{className:"result-header",children:[a.jsx("h3",{children:" SARS Report Generated Successfully"}),a.jsx("button",{className:"close-btn",onClick:()=>E(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsx("h4",{children:"Report Details"}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:N.sarsReport.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Collected:"}),a.jsxs("span",{className:"value",children:["R",N.sarsReport.vatCollected]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Paid:"}),a.jsxs("span",{className:"value",children:["R",N.sarsReport.vatPaid]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Owing:"}),a.jsxs("span",{className:"value",children:["R",N.sarsReport.vatOwing]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Reference Number:"}),a.jsx("span",{className:"value",children:N.sarsReport.referenceNumber})]})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",children:"Download Report"}),a.jsx("button",{className:"primary-btn",children:"Submit to SARS"})]})]})]}),_&&N.pandLExport&&a.jsxs("div",{className:"result-card pandl-export",children:[a.jsxs("div",{className:"result-header",children:[a.jsx("h3",{children:" P&L Statement Exported Successfully"}),a.jsx("button",{className:"close-btn",onClick:()=>A(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsx("h4",{children:"Export Details"}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"File Name:"}),a.jsx("span",{className:"value",children:N.pandLExport.filename})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Income:"}),a.jsxs("span",{className:"value",children:["R",N.pandLExport.totalIncome]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Expenses:"}),a.jsxs("span",{className:"value",children:["R",N.pandLExport.totalExpenses]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Profit:"}),a.jsxs("span",{className:"value",children:["R",N.pandLExport.netProfit]})]})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",children:"View Report"}),a.jsx("button",{className:"primary-btn",children:"Download Again"})]})]})]}),w&&N.reconciliation&&a.jsxs("div",{className:"result-card reconciliation",children:[a.jsxs("div",{className:"result-header",children:[a.jsx("h3",{children:" Bank Reconciliation Completed"}),a.jsx("button",{className:"close-btn",onClick:()=>T(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsx("h4",{children:"Reconciliation Results"}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Matched Transactions:"}),a.jsx("span",{className:"value",children:N.reconciliation.matchedTransactions})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Unmatched Transactions:"}),a.jsx("span",{className:"value",children:N.reconciliation.unmatchedTransactions})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Discrepancies:"}),a.jsxs("span",{className:"value",children:["R",N.reconciliation.discrepancies]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:N.reconciliation.status})]})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",children:"View Details"}),a.jsx("button",{className:"primary-btn",children:"Export Report"})]})]})]}),U&&N.cashFlowAnalysis&&a.jsxs("div",{className:"result-card cash-flow",children:[a.jsxs("div",{className:"result-header",children:[a.jsx("h3",{children:" Cash Flow Analysis Completed"}),a.jsx("button",{className:"close-btn",onClick:()=>B(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsx("h4",{children:"Analysis Results"}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Operating Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",N.cashFlowAnalysis.operatingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Investing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",N.cashFlowAnalysis.investingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Financing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",N.cashFlowAnalysis.financingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",N.cashFlowAnalysis.netCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Cash Position:"}),a.jsx("span",{className:"value",children:N.cashFlowAnalysis.cashPosition})]})]}),N.cashFlowAnalysis.recommendations&&a.jsxs("div",{className:"result-section",children:[a.jsx("h4",{children:"Recommendations"}),a.jsx("ul",{className:"recommendations-list",children:N.cashFlowAnalysis.recommendations.map((K,ie)=>a.jsx("li",{children:K},ie))})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",children:"View Full Report"}),a.jsx("button",{className:"primary-btn",children:"Export Analysis"})]})]})]}),a.jsxs("div",{className:"recent-transactions",children:[a.jsx("h3",{children:"Recent Transactions"}),a.jsx("div",{className:"transaction-list",children:n.slice(0,5).map(K=>a.jsxs("div",{className:"transaction-item",children:[a.jsxs("div",{className:"transaction-info",children:[a.jsx("div",{className:"transaction-date",children:K.date}),a.jsx("div",{className:"transaction-description",children:K.description}),a.jsx("div",{className:"transaction-category",children:K.category})]}),a.jsxs("div",{className:`transaction-amount ${K.type}`,children:[K.type==="income"?"+":"-","R",K.amount]})]},K.id))})]})]}),i==="transactions"&&a.jsxs("div",{className:"transactions-content",children:[a.jsxs("div",{className:"transactions-header",children:[a.jsx("h3",{children:"Transaction Management"}),a.jsxs("div",{className:"transaction-filters",children:[a.jsxs("select",{children:[a.jsx("option",{children:"All Categories"}),a.jsx("option",{children:"Sales"}),a.jsx("option",{children:"Office Expenses"}),a.jsx("option",{children:"Marketing"})]}),a.jsxs("select",{children:[a.jsx("option",{children:"All Types"}),a.jsx("option",{children:"Income"}),a.jsx("option",{children:"Expenses"})]})]})]}),a.jsxs("div",{className:"transaction-table",children:[a.jsxs("div",{className:"table-header",children:[a.jsx("div",{className:"col",children:"Date"}),a.jsx("div",{className:"col",children:"Description"}),a.jsx("div",{className:"col",children:"Category"}),a.jsx("div",{className:"col",children:"Amount"}),a.jsx("div",{className:"col",children:"VAT"}),a.jsx("div",{className:"col",children:"Status"}),a.jsx("div",{className:"col",children:"Actions"})]}),n.map(K=>a.jsxs("div",{className:"table-row",children:[a.jsx("div",{className:"col",children:K.date}),a.jsx("div",{className:"col",children:K.description}),a.jsx("div",{className:"col",children:a.jsxs("select",{value:K.category,onChange:ie=>Xe(K.id,ie.target.value),children:[a.jsx("option",{children:"Sales"}),a.jsx("option",{children:"Office Expenses"}),a.jsx("option",{children:"Marketing"}),a.jsx("option",{children:"Travel"}),a.jsx("option",{children:"Equipment"})]})}),a.jsxs("div",{className:`col amount ${K.type}`,children:["R",K.amount]}),a.jsxs("div",{className:"col",children:["R",K.vatAmount||0]}),a.jsx("div",{className:"col",children:a.jsx("span",{className:`status ${K.isReconciled?"reconciled":"pending"}`,children:K.isReconciled?"Reconciled":"Pending"})}),a.jsx("div",{className:"col",children:!K.isReconciled&&a.jsx("button",{className:"reconcile-btn",onClick:()=>ot(K.id),children:"Reconcile"})})]},K.id))]})]}),i==="reports"&&a.jsxs("div",{className:"reports-content",children:[a.jsxs("div",{className:"reports-header",children:[a.jsx("h3",{children:" Financial Reports"}),a.jsx("div",{className:"report-period",children:a.jsxs("select",{value:v,onChange:K=>b(K.target.value),children:[a.jsx("option",{value:"current-month",children:"Current Month"}),a.jsx("option",{value:"last-month",children:"Last Month"}),a.jsx("option",{value:"quarter",children:"This Quarter"}),a.jsx("option",{value:"year",children:"This Year"})]})})]}),a.jsxs("div",{className:"report-cards",children:[a.jsxs("div",{className:"report-card",children:[a.jsx("h4",{children:"Profit & Loss Statement"}),a.jsxs("div",{className:"report-summary",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Total Income:"}),a.jsxs("span",{children:["R",l?.totalIncome.toLocaleString()]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Total Expenses:"}),a.jsxs("span",{children:["R",l?.totalExpenses.toLocaleString()]})]}),a.jsxs("div",{className:"summary-row total",children:[a.jsx("span",{children:"Net Profit:"}),a.jsxs("span",{children:["R",l?.netProfit.toLocaleString()]})]})]}),a.jsx("button",{className:"export-btn",onClick:async()=>{ye(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/export-pandl-pdf",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,format:"pdf",includeCharts:!0,reportType:"profit-loss",timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=`Profit_Loss_Statement_${v}.pdf`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se);const xt={type:"pdf",filename:`Profit_Loss_Statement_${v}.pdf`,period:v,totalIncome:l?.totalIncome||0,totalExpenses:l?.totalExpenses||0,netProfit:l?.netProfit||0,exportedAt:new Date().toISOString()};W(xt),G(!0)}}else{await new Promise(le=>setTimeout(le,2e3));const ie={type:"pdf",filename:`Profit_Loss_Statement_${v}.pdf`,period:v,totalIncome:l?.totalIncome||0,totalExpenses:l?.totalExpenses||0,netProfit:l?.netProfit||0,exportedAt:new Date().toISOString()};W(ie),G(!0)}}catch(K){console.error("Error exporting PDF:",K),alert(` Error exporting PDF:
${K.message||"Please try again."}`)}finally{ye(!1)}},children:ve?"Exporting...":"Export PDF"})]}),a.jsxs("div",{className:"report-card",children:[a.jsx("h4",{children:"VAT Report"}),a.jsxs("div",{className:"report-summary",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"VAT Collected:"}),a.jsxs("span",{children:["R",l?.vatCollected.toLocaleString()]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"VAT Paid:"}),a.jsxs("span",{children:["R",l?.vatPaid.toLocaleString()]})]}),a.jsxs("div",{className:"summary-row total",children:[a.jsx("span",{children:"VAT Owing:"}),a.jsxs("span",{children:["R",l?.vatOwing.toLocaleString()]})]})]}),a.jsx("button",{className:"export-btn",onClick:async()=>{ue(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/submit-vat-sars",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,vatCollected:l?.vatCollected||0,vatPaid:l?.vatPaid||0,vatOwing:l?.vatOwing||0,transactions:n,timestamp:new Date().toISOString()})});if(ie.ok){const Ne={type:"sars-submission",referenceNumber:(await ie.json()).referenceNumber,period:v,vatCollected:l?.vatCollected||0,vatPaid:l?.vatPaid||0,vatOwing:l?.vatOwing||0,status:"Submitted to SARS",submittedAt:new Date().toISOString()};W(Ne),G(!0)}}else{await new Promise(le=>setTimeout(le,3e3));const ie={type:"sars-submission",referenceNumber:`SARS-${Date.now()}`,period:v,vatCollected:l?.vatCollected||0,vatPaid:l?.vatPaid||0,vatOwing:l?.vatOwing||0,status:"Submitted to SARS",submittedAt:new Date().toISOString()};W(ie),G(!0)}}catch(K){console.error("Error submitting to SARS:",K),alert(` Error submitting to SARS:
${K.message||"Please try again."}`)}finally{ue(!1)}},children:Q?"Submitting...":"Submit to SARS"})]}),a.jsxs("div",{className:"report-card",children:[a.jsx("h4",{children:"Cash Flow Statement"}),a.jsxs("div",{className:"report-summary",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Operating Cash Flow:"}),a.jsxs("span",{children:["R",l?.netProfit.toLocaleString()]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Investing Cash Flow:"}),a.jsx("span",{children:"R0"})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Financing Cash Flow:"}),a.jsx("span",{children:"R0"})]})]}),a.jsx("button",{className:"export-btn",onClick:async()=>{Ce(!0);try{if(window.location.hostname!=="localhost"){const ie=await fetch("/api/bookkeeping/export-cashflow-excel",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:v,format:"excel",includeCharts:!0,reportType:"cash-flow",transactions:n,timestamp:new Date().toISOString()})});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=`Cash_Flow_Statement_${v}.xlsx`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se);const xt={type:"excel",filename:`Cash_Flow_Statement_${v}.xlsx`,period:v,operatingCashFlow:l?.netProfit||0,investingCashFlow:-Math.floor(Math.random()*5e3),financingCashFlow:Math.floor(Math.random()*1e4),netCashFlow:(l?.netProfit||0)+Math.floor(Math.random()*5e3),exportedAt:new Date().toISOString()};W(xt),G(!0)}}else{await new Promise(le=>setTimeout(le,2500));const ie={type:"excel",filename:`Cash_Flow_Statement_${v}.xlsx`,period:v,operatingCashFlow:l?.netProfit||0,investingCashFlow:-Math.floor(Math.random()*5e3),financingCashFlow:Math.floor(Math.random()*1e4),netCashFlow:(l?.netProfit||0)+Math.floor(Math.random()*5e3),exportedAt:new Date().toISOString()};W(ie),G(!0)}}catch(K){console.error("Error exporting Excel:",K),alert(` Error exporting Excel:
${K.message||"Please try again."}`)}finally{Ce(!1)}},children:pe?"Exporting...":"Export Excel"})]})]}),H&&z&&a.jsxs("div",{className:"result-card financial-reports",children:[a.jsxs("div",{className:"result-header",children:[a.jsxs("h3",{children:[z.type==="pdf"&&" P&L Statement Exported Successfully",z.type==="sars-submission"&&" VAT Return Submitted to SARS",z.type==="excel"&&" Cash Flow Statement Exported Successfully"]}),a.jsx("button",{className:"close-btn",onClick:()=>G(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsxs("h4",{children:[z.type==="pdf"&&"Export Details",z.type==="sars-submission"&&"SARS Submission Details",z.type==="excel"&&"Export Details"]}),z.type==="pdf"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"File Name:"}),a.jsx("span",{className:"value",children:z.filename})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:z.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Income:"}),a.jsxs("span",{className:"value",children:["R",z.totalIncome]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Expenses:"}),a.jsxs("span",{className:"value",children:["R",z.totalExpenses]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Profit:"}),a.jsxs("span",{className:"value",children:["R",z.netProfit]})]})]}),z.type==="sars-submission"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Reference Number:"}),a.jsx("span",{className:"value",children:z.referenceNumber})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:z.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Collected:"}),a.jsxs("span",{className:"value",children:["R",z.vatCollected]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Paid:"}),a.jsxs("span",{className:"value",children:["R",z.vatPaid]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Owing:"}),a.jsxs("span",{className:"value",children:["R",z.vatOwing]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:z.status})]})]}),z.type==="excel"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"File Name:"}),a.jsx("span",{className:"value",children:z.filename})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:z.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Operating Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",z.operatingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Investing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",z.investingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Financing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",z.financingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",z.netCashFlow]})]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Date:"}),a.jsx("span",{className:"value",children:new Date(z.exportedAt||z.submittedAt).toLocaleString()})]})]}),a.jsxs("div",{className:"result-actions",children:[z.type==="pdf"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"secondary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/pandl-report/${z.filename}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.json();qe({type:"pandl-report",...le}),Ae(!0)}}else qe({type:"pandl-report",filename:z.filename,period:z.period,totalIncome:z.totalIncome,totalExpenses:z.totalExpenses,netProfit:z.netProfit,generatedAt:z.exportedAt}),Ae(!0)}catch(K){console.error("Error viewing report:",K),alert(` Error viewing report:
${K.message||"Please try again."}`)}},children:"View Report"}),a.jsx("button",{className:"primary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/download-pandl/${z.filename}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=z.filename,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` P&L Statement Downloaded Again!

File: ${z.filename}
Period: ${z.period}

Report downloaded to your device.`)}}else{await new Promise(xt=>setTimeout(xt,1e3));const ie=`PROFIT & LOSS STATEMENT
Period: ${z.period}
Generated: ${new Date(z.exportedAt).toLocaleString()}

INCOME:
Total Income: R${z.totalIncome}

EXPENSES:
Total Expenses: R${z.totalExpenses}

PROFIT:
Net Profit: R${z.netProfit}

This is your Profit & Loss Statement for ${z.period}.
Keep this report for your financial records.`,le=new Blob([ie],{type:"text/plain"}),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=z.filename.replace(".pdf",".txt"),document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` P&L Statement Downloaded Again!

File: ${z.filename.replace(".pdf",".txt")}
Period: ${z.period}

Report downloaded to your device.`)}}catch(K){console.error("Error downloading report:",K),alert(` Error downloading report:
${K.message||"Please try again."}`)}},children:"Download Again"})]}),z.type==="sars-submission"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"secondary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/sars-submission/${z.referenceNumber}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.json();qe({type:"sars-submission",...le}),Ae(!0)}}else qe({type:"sars-submission",referenceNumber:z.referenceNumber,period:z.period,vatCollected:z.vatCollected,vatPaid:z.vatPaid,vatOwing:z.vatOwing,status:z.status,submittedAt:z.submittedAt}),Ae(!0)}catch(K){console.error("Error viewing submission:",K),alert(` Error viewing submission:
${K.message||"Please try again."}`)}},children:"View Submission"}),a.jsx("button",{className:"primary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/sars-receipt/${z.referenceNumber}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=`SARS_Receipt_${z.referenceNumber}.pdf`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` SARS Receipt Downloaded Successfully!

File: SARS_Receipt_${z.referenceNumber}.pdf
Reference: ${z.referenceNumber}

Receipt saved to your device.`)}}else{await new Promise(xt=>setTimeout(xt,1e3));const ie=`SARS VAT RETURN RECEIPT
Reference Number: ${z.referenceNumber}
Period: ${z.period}
Date Submitted: ${new Date(z.submittedAt).toLocaleString()}

VAT DETAILS:
VAT Collected: R${z.vatCollected}
VAT Paid: R${z.vatPaid}
VAT Owing: R${z.vatOwing}

Status: ${z.status}
Submission ID: SARS-${Date.now()}

This receipt confirms your VAT return submission to SARS.
Keep this receipt for your records.`,le=new Blob([ie],{type:"text/plain"}),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=`SARS_Receipt_${z.referenceNumber}.txt`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` SARS Receipt Downloaded Successfully!

File: SARS_Receipt_${z.referenceNumber}.txt
Reference: ${z.referenceNumber}

Receipt saved to your device.`)}}catch(K){console.error("Error downloading receipt:",K),alert(` Error downloading receipt:
${K.message||"Please try again."}`)}},children:"Download Receipt"})]}),z.type==="excel"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"secondary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/cashflow-report/${z.filename}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.json();qe({type:"cashflow-report",...le}),Ae(!0)}}else qe({type:"cashflow-report",filename:z.filename,period:z.period,operatingCashFlow:z.operatingCashFlow,investingCashFlow:z.investingCashFlow,financingCashFlow:z.financingCashFlow,netCashFlow:z.netCashFlow,generatedAt:z.exportedAt}),Ae(!0)}catch(K){console.error("Error viewing spreadsheet:",K),alert(` Error viewing spreadsheet:
${K.message||"Please try again."}`)}},children:"View Spreadsheet"}),a.jsx("button",{className:"primary-btn",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/download-cashflow/${z.filename}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(ie.ok){const le=await ie.blob(),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=z.filename,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` Cash Flow Statement Downloaded Again!

File: ${z.filename}
Period: ${z.period}

Spreadsheet downloaded to your device.`)}}else{await new Promise(xt=>setTimeout(xt,1e3));const ie=`CASH FLOW STATEMENT
Period: ${z.period}
Generated: ${new Date(z.exportedAt).toLocaleString()}

OPERATING ACTIVITIES:
Operating Cash Flow: R${z.operatingCashFlow}

INVESTING ACTIVITIES:
Investing Cash Flow: R${z.investingCashFlow}

FINANCING ACTIVITIES:
Financing Cash Flow: R${z.financingCashFlow}

NET CASH FLOW:
Net Cash Flow: R${z.netCashFlow}

This is your Cash Flow Statement for ${z.period}.
Keep this spreadsheet for your financial analysis.`,le=new Blob([ie],{type:"text/plain"}),Ne=window.URL.createObjectURL(le),Se=document.createElement("a");Se.href=Ne,Se.download=z.filename.replace(".xlsx",".txt"),document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Se),alert(` Cash Flow Statement Downloaded Again!

File: ${z.filename.replace(".xlsx",".txt")}
Period: ${z.period}

Spreadsheet downloaded to your device.`)}}catch(K){console.error("Error downloading spreadsheet:",K),alert(` Error downloading spreadsheet:
${K.message||"Please try again."}`)}},children:"Download Again"})]})]})]})]}),J&&he&&a.jsxs("div",{className:"result-card view-details",children:[a.jsxs("div",{className:"result-header",children:[a.jsxs("h3",{children:[he.type==="pandl-report"&&" P&L Statement Report Details",he.type==="sars-submission"&&" SARS Submission Details",he.type==="cashflow-report"&&" Cash Flow Statement Details"]}),a.jsx("button",{className:"close-btn",onClick:()=>Ae(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsxs("h4",{children:[he.type==="pandl-report"&&"Report Information",he.type==="sars-submission"&&"Submission Information",he.type==="cashflow-report"&&"Spreadsheet Information"]}),he.type==="pandl-report"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"File Name:"}),a.jsx("span",{className:"value",children:he.filename})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:he.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Income:"}),a.jsxs("span",{className:"value",children:["R",he.totalIncome]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Total Expenses:"}),a.jsxs("span",{className:"value",children:["R",he.totalExpenses]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Profit:"}),a.jsxs("span",{className:"value",children:["R",he.netProfit]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Generated:"}),a.jsx("span",{className:"value",children:new Date(he.generatedAt).toLocaleString()})]})]}),he.type==="sars-submission"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Reference Number:"}),a.jsx("span",{className:"value",children:he.referenceNumber})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:he.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Collected:"}),a.jsxs("span",{className:"value",children:["R",he.vatCollected]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Paid:"}),a.jsxs("span",{className:"value",children:["R",he.vatPaid]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"VAT Owing:"}),a.jsxs("span",{className:"value",children:["R",he.vatOwing]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:he.status})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Submitted:"}),a.jsx("span",{className:"value",children:new Date(he.submittedAt).toLocaleString()})]})]}),he.type==="cashflow-report"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"File Name:"}),a.jsx("span",{className:"value",children:he.filename})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:he.period})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Operating Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",he.operatingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Investing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",he.investingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Financing Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",he.financingCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Net Cash Flow:"}),a.jsxs("span",{className:"value",children:["R",he.netCashFlow]})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Generated:"}),a.jsx("span",{className:"value",children:new Date(he.generatedAt).toLocaleString()})]})]})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",onClick:()=>Ae(!1),children:"Close"}),a.jsx("button",{className:"primary-btn",onClick:()=>{Ae(!1),setTimeout(()=>Ae(!0),100)},children:"Refresh"})]})]})]})]}),i==="settings"&&a.jsxs("div",{className:"settings-content",children:[a.jsx("div",{className:"settings-header",children:a.jsx("h3",{children:"Bookkeeping Settings"})}),a.jsxs("div",{className:"accounting-integrations",children:[a.jsx("h4",{children:"Accounting System Integrations"}),a.jsx("div",{className:"integration-list",children:f.map(K=>a.jsxs("div",{className:"integration-item",children:[a.jsxs("div",{className:"integration-info",children:[a.jsx("h5",{children:K.name}),a.jsx("div",{className:`status ${K.isConnected?"connected":"disconnected"}`,children:K.isConnected?"Connected":"Not Connected"}),K.isConnected&&a.jsxs("div",{className:"last-sync",children:["Last sync: ",new Date(K.lastSync).toLocaleDateString()]})]}),a.jsx("div",{className:"integration-actions",children:K.isConnected?a.jsxs("div",{className:"connected-actions",children:[a.jsx("button",{className:"sync-btn",onClick:async()=>{Qe(K.id);try{if(window.location.hostname!=="localhost"){const le=await fetch(`/api/bookkeeping/sync-accounting/${K.id}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({systemId:K.id,transactions:n,timestamp:new Date().toISOString()})});if(le.ok){const Ne=await le.json();p(Se=>Se.map(xt=>xt.id===K.id?{...xt,lastSync:Ne.lastSync}:xt)),it({type:"sync",systemName:K.name,systemId:K.id,status:"Synced",syncedTransactions:Ne.syncedTransactions,lastSync:Ne.lastSync,syncId:Ne.syncId,syncedAt:new Date().toISOString()}),gt(!0)}}else{await new Promise(Ne=>setTimeout(Ne,3e3));const le={syncedTransactions:Math.floor(n.length*.9),lastSync:new Date().toISOString(),syncId:`SYNC-${Date.now()}`};p(Ne=>Ne.map(Se=>Se.id===K.id?{...Se,lastSync:le.lastSync}:Se)),it({type:"sync",systemName:K.name,systemId:K.id,status:"Synced",syncedTransactions:le.syncedTransactions,lastSync:le.lastSync,syncId:le.syncId,syncedAt:new Date().toISOString()}),gt(!0)}}catch(ie){console.error(`Error syncing with ${K.name}:`,ie),alert(` Error syncing with ${K.name}:
${ie.message||"Please try again."}`)}finally{Qe(null)}},children:Be===K.id?"Syncing...":"Sync Now"}),a.jsx("button",{className:"config-btn",onClick:async()=>{At(K.id);try{if(window.location.hostname!=="localhost"){const le=await fetch(`/api/bookkeeping/configure-accounting/${K.id}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({systemId:K.id,config:K.config,timestamp:new Date().toISOString()})});if(le.ok){const Ne=await le.json();it({type:"configuration",systemName:K.name,systemId:K.id,status:"Configured",configurationId:Ne.configurationId,settings:Ne.settings,configuredAt:new Date().toISOString()}),gt(!0)}}else await new Promise(le=>setTimeout(le,1500)),it({type:"configuration",systemName:K.name,systemId:K.id,status:"Configured",configurationId:`CONFIG-${Date.now()}`,settings:{autoSync:!0,syncInterval:"Daily",dataMapping:"Standard",notifications:!0},configuredAt:new Date().toISOString()}),gt(!0)}catch(ie){console.error(`Error configuring ${K.name}:`,ie),alert(` Error configuring ${K.name}:
${ie.message||"Please try again."}`)}finally{At(null)}},children:lt===K.id?"Configuring...":"Configure"})]}):a.jsx("button",{className:"connect-btn",onClick:()=>{je(K.id),Ue({systemId:K.id,systemName:K.name,clientId:"",clientSecret:"",redirectUri:"",environment:"sandbox",companyId:"",username:"",password:"",apiKey:""})},children:"Configure & Connect"})})]},K.id))})]}),we&&a.jsxs("div",{className:"result-card config-form",children:[a.jsxs("div",{className:"result-header",children:[a.jsxs("h3",{children:[" Configure ",ge.systemName," Integration"]}),a.jsx("button",{className:"close-btn",onClick:()=>je(null),children:""})]}),a.jsx("div",{className:"result-content",children:a.jsxs("div",{className:"config-form-content",children:[a.jsxs("div",{className:"config-section",children:[a.jsx("h4",{children:"API Credentials"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Client ID:"}),a.jsx("input",{type:"text",value:ge.clientId||"",onChange:K=>Ue(ie=>({...ie,clientId:K.target.value})),placeholder:"Enter your Client ID"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Client Secret:"}),a.jsx("input",{type:"password",value:ge.clientSecret||"",onChange:K=>Ue(ie=>({...ie,clientSecret:K.target.value})),placeholder:"Enter your Client Secret"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Redirect URI:"}),a.jsx("input",{type:"url",value:ge.redirectUri||"",onChange:K=>Ue(ie=>({...ie,redirectUri:K.target.value})),placeholder:"https://your-app.com/oauth/callback"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Environment:"}),a.jsxs("select",{value:ge.environment||"sandbox",onChange:K=>Ue(ie=>({...ie,environment:K.target.value})),children:[a.jsx("option",{value:"sandbox",children:"Sandbox"}),a.jsx("option",{value:"production",children:"Production"})]})]})]})]}),a.jsxs("div",{className:"config-section",children:[a.jsx("h4",{children:"Account Information"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Company ID:"}),a.jsx("input",{type:"text",value:ge.companyId||"",onChange:K=>Ue(ie=>({...ie,companyId:K.target.value})),placeholder:"Enter your Company ID"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Username:"}),a.jsx("input",{type:"text",value:ge.username||"",onChange:K=>Ue(ie=>({...ie,username:K.target.value})),placeholder:"Enter your username"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Password:"}),a.jsx("input",{type:"password",value:ge.password||"",onChange:K=>Ue(ie=>({...ie,password:K.target.value})),placeholder:"Enter your password"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"API Key:"}),a.jsx("input",{type:"password",value:ge.apiKey||"",onChange:K=>Ue(ie=>({...ie,apiKey:K.target.value})),placeholder:"Enter your API Key"})]})]})]}),a.jsxs("div",{className:"config-section",children:[a.jsx("h4",{children:"Sync Settings"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Auto Sync:"}),a.jsxs("select",{value:ge.autoSync||"enabled",onChange:K=>Ue(ie=>({...ie,autoSync:K.target.value})),children:[a.jsx("option",{value:"enabled",children:"Enabled"}),a.jsx("option",{value:"disabled",children:"Disabled"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Sync Interval:"}),a.jsxs("select",{value:ge.syncInterval||"daily",onChange:K=>Ue(ie=>({...ie,syncInterval:K.target.value})),children:[a.jsx("option",{value:"hourly",children:"Hourly"}),a.jsx("option",{value:"daily",children:"Daily"}),a.jsx("option",{value:"weekly",children:"Weekly"}),a.jsx("option",{value:"manual",children:"Manual Only"})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Data Mapping:"}),a.jsxs("select",{value:ge.dataMapping||"standard",onChange:K=>Ue(ie=>({...ie,dataMapping:K.target.value})),children:[a.jsx("option",{value:"standard",children:"Standard"}),a.jsx("option",{value:"custom",children:"Custom"}),a.jsx("option",{value:"advanced",children:"Advanced"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Notifications:"}),a.jsxs("select",{value:ge.notifications||"enabled",onChange:K=>Ue(ie=>({...ie,notifications:K.target.value})),children:[a.jsx("option",{value:"enabled",children:"Enabled"}),a.jsx("option",{value:"disabled",children:"Disabled"})]})]})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"cancel-btn",onClick:()=>je(null),children:"Cancel"}),a.jsx("button",{className:"test-btn",onClick:async()=>{try{window.location.hostname!=="localhost"?(await fetch(`/api/bookkeeping/test-connection/${ge.systemId}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({systemId:ge.systemId,credentials:{clientId:ge.clientId,clientSecret:ge.clientSecret,redirectUri:ge.redirectUri,environment:ge.environment,companyId:ge.companyId,username:ge.username,password:ge.password,apiKey:ge.apiKey}})})).ok&&alert(` Connection Test Successful!

${ge.systemName} credentials are valid and connection is working.`):(await new Promise(ie=>setTimeout(ie,2e3)),alert(` Connection Test Successful!

${ge.systemName} credentials are valid and connection is working.`))}catch(K){console.error("Error testing connection:",K),alert(` Connection Test Failed:
${K.message||"Please check your credentials and try again."}`)}},children:"Test Connection"}),a.jsx("button",{className:"save-btn",onClick:async()=>{be(ge.systemId);try{if(window.location.hostname!=="localhost"){const ie=await fetch(`/api/bookkeeping/save-config/${ge.systemId}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({systemId:ge.systemId,config:{clientId:ge.clientId,clientSecret:ge.clientSecret,redirectUri:ge.redirectUri,environment:ge.environment,companyId:ge.companyId,username:ge.username,password:ge.password,apiKey:ge.apiKey,autoSync:ge.autoSync,syncInterval:ge.syncInterval,dataMapping:ge.dataMapping,notifications:ge.notifications}})});if(ie.ok){const le=await ie.json();p(Ne=>Ne.map(Se=>Se.id===ge.systemId?{...Se,isConnected:!0,lastSync:le.lastSync,config:le.config}:Se)),it({type:"connection",systemName:ge.systemName,systemId:ge.systemId,status:"Connected",lastSync:le.lastSync,connectionId:le.connectionId,connectedAt:new Date().toISOString()}),gt(!0),je(null)}}else await new Promise(ie=>setTimeout(ie,2e3)),p(ie=>ie.map(le=>le.id===ge.systemId?{...le,isConnected:!0,lastSync:new Date().toISOString(),config:ge}:le)),it({type:"connection",systemName:ge.systemName,systemId:ge.systemId,status:"Connected",lastSync:new Date().toISOString(),connectionId:`CONN-${Date.now()}`,connectedAt:new Date().toISOString()}),gt(!0),je(null)}catch(K){console.error(`Error saving configuration for ${ge.systemName}:`,K),alert(` Error saving configuration:
${K.message||"Please try again."}`)}finally{be(null)}},children:_e===ge.systemId?"Connecting...":"Save & Connect"})]})]})})]}),Nt&&Fe&&a.jsxs("div",{className:"result-card integration-results",children:[a.jsxs("div",{className:"result-header",children:[a.jsxs("h3",{children:[Fe.type==="connection"&&" Accounting System Connected Successfully",Fe.type==="sync"&&" Data Synced Successfully",Fe.type==="configuration"&&" System Configured Successfully"]}),a.jsx("button",{className:"close-btn",onClick:()=>gt(!1),children:""})]}),a.jsxs("div",{className:"result-content",children:[a.jsxs("div",{className:"result-section",children:[a.jsxs("h4",{children:[Fe.type==="connection"&&"Connection Details",Fe.type==="sync"&&"Sync Details",Fe.type==="configuration"&&"Configuration Details"]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"System:"}),a.jsx("span",{className:"value",children:Fe.systemName})]}),Fe.type==="connection"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:Fe.status})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Connection ID:"}),a.jsx("span",{className:"value",children:Fe.connectionId})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Last Sync:"}),a.jsx("span",{className:"value",children:new Date(Fe.lastSync).toLocaleString()})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Connected:"}),a.jsx("span",{className:"value",children:new Date(Fe.connectedAt).toLocaleString()})]})]}),Fe.type==="sync"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:Fe.status})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Synced Transactions:"}),a.jsx("span",{className:"value",children:Fe.syncedTransactions})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Sync ID:"}),a.jsx("span",{className:"value",children:Fe.syncId})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Last Sync:"}),a.jsx("span",{className:"value",children:new Date(Fe.lastSync).toLocaleString()})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Synced:"}),a.jsx("span",{className:"value",children:new Date(Fe.syncedAt).toLocaleString()})]})]}),Fe.type==="configuration"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:Fe.status})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Configuration ID:"}),a.jsx("span",{className:"value",children:Fe.configurationId})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Auto Sync:"}),a.jsx("span",{className:"value",children:Fe.settings?.autoSync?"Enabled":"Disabled"})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Sync Interval:"}),a.jsx("span",{className:"value",children:Fe.settings?.syncInterval})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Data Mapping:"}),a.jsx("span",{className:"value",children:Fe.settings?.dataMapping})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Notifications:"}),a.jsx("span",{className:"value",children:Fe.settings?.notifications?"Enabled":"Disabled"})]}),a.jsxs("div",{className:"result-row",children:[a.jsx("span",{className:"label",children:"Configured:"}),a.jsx("span",{className:"value",children:new Date(Fe.configuredAt).toLocaleString()})]})]})]}),a.jsxs("div",{className:"result-actions",children:[a.jsx("button",{className:"secondary-btn",onClick:()=>gt(!1),children:"Close"}),a.jsx("button",{className:"primary-btn",onClick:()=>{gt(!1),setTimeout(()=>gt(!0),100)},children:"Refresh Status"})]})]})]}),a.jsxs("div",{className:"automation-settings",children:[a.jsx("h4",{children:"Automation Settings"}),a.jsx("div",{className:"setting-item",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",defaultChecked:!0}),"Auto-categorize transactions"]})}),a.jsx("div",{className:"setting-item",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",defaultChecked:!0}),"Auto-reconcile bank transactions"]})}),a.jsx("div",{className:"setting-item",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox"}),"Auto-generate monthly reports"]})}),a.jsx("div",{className:"setting-item",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox"}),"Auto-submit VAT returns"]})})]}),a.jsxs("div",{className:"sars-settings",children:[a.jsx("h4",{children:"SARS Compliance Settings"}),a.jsxs("div",{className:"setting-group",children:[a.jsx("label",{children:"VAT Registration Number"}),a.jsx("input",{type:"text",placeholder:"Enter VAT number"})]}),a.jsxs("div",{className:"setting-group",children:[a.jsx("label",{children:"Tax Year End"}),a.jsxs("select",{children:[a.jsx("option",{children:"28 February"}),a.jsx("option",{children:"31 March"}),a.jsx("option",{children:"30 April"}),a.jsx("option",{children:"31 May"}),a.jsx("option",{children:"30 June"}),a.jsx("option",{children:"31 July"}),a.jsx("option",{children:"31 August"}),a.jsx("option",{children:"30 September"}),a.jsx("option",{children:"31 October"}),a.jsx("option",{children:"30 November"}),a.jsx("option",{children:"31 December"}),a.jsx("option",{children:"31 January"})]})]}),a.jsxs("div",{className:"setting-group",children:[a.jsx("label",{children:"VAT Rate"}),a.jsxs("select",{children:[a.jsx("option",{children:"15% (Standard Rate)"}),a.jsx("option",{children:"0% (Zero Rate)"}),a.jsx("option",{children:"Exempt"})]})]})]})]})]})};class vN{config;websocket=null;reconnectAttempts=0;maxReconnectAttempts=5;listeners=[];constructor(e){this.config=e,this.initializeWebSocket()}initializeWebSocket(){if(!this.config.enableWebSocket||!this.config.websocketUrl){console.log("WebSocket disabled or URL not provided");return}try{this.websocket=new WebSocket(this.config.websocketUrl),this.websocket.onopen=()=>{console.log("WebSocket connected"),this.reconnectAttempts=0,this.websocket?.send(JSON.stringify({type:"auth",businessId:this.config.businessId,apiKey:this.config.apiKey}))},this.websocket.onmessage=e=>{try{const n=JSON.parse(e.data);this.handleWebSocketMessage(n)}catch(n){console.error("Error parsing WebSocket message:",n)}},this.websocket.onclose=()=>{console.log("WebSocket disconnected"),this.attemptReconnect()},this.websocket.onerror=e=>{console.error("WebSocket error:",e)}}catch(e){console.error("Failed to initialize WebSocket:",e)}}handleWebSocketMessage(e){switch(e.type){case"new_order":this.notifyListeners({type:"new_order",data:e.order});break;case"order_update":this.notifyListeners({type:"order_update",data:e.order});break;case"order_status_change":this.notifyListeners({type:"order_status_change",data:e.update});break;default:console.log("Unknown WebSocket message type:",e.type)}}attemptReconnect(){this.reconnectAttempts<this.maxReconnectAttempts?(this.reconnectAttempts++,console.log(`Attempting to reconnect WebSocket (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.initializeWebSocket()},2e3*this.reconnectAttempts)):console.error("Max reconnection attempts reached")}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}notifyListeners(e){this.listeners.forEach(n=>n(e))}async fetchOrders(){try{const e=await fetch(`${this.config.baseUrl}/api/orders`,{headers:{Authorization:`Bearer ${this.config.apiKey}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return(await e.json()).orders||[]}catch(e){return console.error("Error fetching orders:",e),[]}}async updateOrderStatus(e,n,r){try{const l=await fetch(`${this.config.baseUrl}/api/orders/${e}/status`,{method:"PUT",headers:{Authorization:`Bearer ${this.config.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({status:n,notes:r,updatedAt:new Date().toISOString()})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify({type:"order_status_update",orderId:e,status:n,notes:r,updatedAt:new Date().toISOString()})),!0}catch(l){return console.error("Error updating order status:",l),!1}}async sendWhatsAppMessage(e,n){try{const r=await fetch(`${this.config.baseUrl}/api/whatsapp/send`,{method:"POST",headers:{Authorization:`Bearer ${this.config.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({phone:e,message:n,businessId:this.config.businessId})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return!0}catch(r){return console.error("Error sending WhatsApp message:",r),!1}}async getBusinessStats(){try{const e=await fetch(`${this.config.baseUrl}/api/business/stats`,{headers:{Authorization:`Bearer ${this.config.apiKey}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Error fetching business stats:",e),null}}async healthCheck(){try{return(await fetch(`${this.config.baseUrl}/api/health`,{headers:{Authorization:`Bearer ${this.config.apiKey}`}})).ok}catch(e){return console.error("Health check failed:",e),!1}}disconnect(){this.websocket&&(this.websocket.close(),this.websocket=null)}}const yN={baseUrl:"https://api.pezela.com",apiKey:"",businessId:"store_123",enableWebSocket:!0,websocketUrl:"wss://api.pezela.com/ws"},_N={baseUrl:"http://localhost:3001",apiKey:"dev-api-key-123",businessId:"store_123",enableWebSocket:!0,websocketUrl:"ws://localhost:3001/ws"},bN=window.location.hostname==="localhost",nr=new vN(bN?_N:yN);class EN{orders=[];listeners=[];isLiveMode=!1;apiSubscription=null;constructor(){this.loadOrders(),this.initializeLiveMode()}async initializeLiveMode(){try{this.isLiveMode=!0,console.log("Initializing live mode for production"),this.apiSubscription=nr.subscribe(n=>{this.handleLiveUpdate(n)}),await this.syncWithAPI()}catch(e){console.error("Failed to initialize live mode:",e)}}handleLiveUpdate(e){switch(e.type){case"new_order":this.addLiveOrder(e.data);break;case"order_update":this.updateLiveOrder(e.data);break;case"order_status_change":this.updateOrderStatusFromAPI(e.data);break}}addLiveOrder(e){const n={id:e.id,orderNumber:e.orderNumber,customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,customerAddress:e.customerAddress,items:e.items,subtotal:e.subtotal,deliveryFee:e.deliveryFee,tax:e.tax,totalAmount:e.totalAmount,status:e.status,paymentMethod:e.paymentMethod,paymentStatus:e.paymentStatus,notes:e.notes,createdAt:e.createdAt,updatedAt:e.updatedAt,businessId:e.businessId};this.orders.find(l=>l.id===n.id)||(this.orders.unshift(n),this.saveOrders(),this.showBusinessNotification(n))}updateLiveOrder(e){const n=this.orders.findIndex(r=>r.id===e.id);n!==-1&&(this.orders[n]={...this.orders[n],...e,updatedAt:e.updatedAt},this.saveOrders())}updateOrderStatusFromAPI(e){const n=this.orders.find(r=>r.id===e.orderId);n&&(n.status=e.status,n.updatedAt=e.updatedAt,e.notes&&(n.notes=e.notes),this.saveOrders())}async syncWithAPI(){try{const n=(await nr.fetchOrders()).map(this.convertLiveOrderToCustomerOrder),r=new Set(this.orders.map(u=>u.id)),l=n.filter(u=>!r.has(u.id));this.orders=[...l,...this.orders],this.saveOrders()}catch(e){console.error("Failed to sync with API:",e)}}convertLiveOrderToCustomerOrder=e=>({id:e.id,orderNumber:e.orderNumber,customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,customerAddress:e.customerAddress,items:e.items,subtotal:e.subtotal,deliveryFee:e.deliveryFee,tax:e.tax,totalAmount:e.totalAmount,status:e.status,paymentMethod:e.paymentMethod,paymentStatus:e.paymentStatus,notes:e.notes,createdAt:e.createdAt,updatedAt:e.updatedAt,businessId:e.businessId});loadOrders(){const e=localStorage.getItem("customer_orders");e?this.orders=JSON.parse(e):(this.orders=[{id:"1",orderNumber:"ORD-001",customerName:"John Smith",customerEmail:"john@example.com",customerPhone:"+27821234567",customerAddress:"123 Main St, Johannesburg",items:[{productId:"1",name:"Classic Kota",quantity:2,price:35,totalPrice:70,image:"https://via.placeholder.com/60x60/8B4513/fff?text=",color:"Brown"}],subtotal:85,deliveryFee:25,tax:13.5,totalAmount:123.5,status:"pending",paymentMethod:"card",paymentStatus:"paid",notes:"Extra spicy please",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),businessId:"store_123"}],this.saveOrders())}saveOrders(){localStorage.setItem("customer_orders",JSON.stringify(this.orders)),this.notifyListeners()}notifyListeners(){this.listeners.forEach(e=>e([...this.orders]))}subscribe(e){return this.listeners.push(e),e([...this.orders]),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}createOrder(e){const n={...e,id:Date.now().toString(),orderNumber:`ORD-${String(Date.now()).slice(-6)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.orders.unshift(n),this.saveOrders(),this.showBusinessNotification(n),n}async updateOrderStatus(e,n,r){const l=this.orders.find(u=>u.id===e);if(l){if(l.status=n,l.updatedAt=new Date().toISOString(),r&&(l.notes=r),this.isLiveMode)try{await nr.updateOrderStatus(e,n,r)}catch(u){console.error("Failed to update order status via API:",u)}this.saveOrders(),this.notifyCustomer(l)}}getBusinessOrders(){return[...this.orders].sort((e,n)=>new Date(n.createdAt).getTime()-new Date(e.createdAt).getTime())}getCustomerOrders(e){return this.orders.filter(n=>n.customerPhone===e).sort((n,r)=>new Date(r.createdAt).getTime()-new Date(n.createdAt).getTime())}showBusinessNotification(e){"Notification"in window&&Notification.permission==="granted"&&new Notification("New Order Received!",{body:`Order #${e.orderNumber} from ${e.customerName} - R${e.totalAmount.toFixed(2)}`,icon:"/assets/Kota_logo.png"})}notifyCustomer(e){const r={confirmed:`Your order #${e.orderNumber} has been confirmed! We're preparing it now.`,preparing:`Your order #${e.orderNumber} is being prepared. It will be ready soon!`,ready:`Your order #${e.orderNumber} is ready for pickup! Please come collect it.`,delivered:`Your order #${e.orderNumber} has been delivered. Thank you!`,cancelled:`Your order #${e.orderNumber} has been cancelled. We'll contact you shortly.`}[e.status];r&&(console.log(`WhatsApp to ${e.customerPhone}: ${r}`),setTimeout(()=>{alert(`WhatsApp sent to ${e.customerPhone}:
${r}`)},1e3))}async sendWhatsAppMessage(e,n){const r=n||`Hello ${e.customerName}, regarding your order #${e.orderNumber}. How can we help you?`;if(this.isLiveMode)try{await nr.sendWhatsAppMessage(e.customerPhone,r),console.log(`WhatsApp sent via API to ${e.customerPhone}: ${r}`)}catch(l){console.error("Failed to send WhatsApp via API:",l),this.sendWhatsAppDemo(e,r)}else this.sendWhatsAppDemo(e,r)}sendWhatsAppDemo(e,n){console.log(`WhatsApp to ${e.customerPhone}: ${n}`),alert(`WhatsApp sent to ${e.customerPhone}:
${n}`)}destroy(){this.apiSubscription&&(this.apiSubscription(),this.apiSubscription=null)}getOrderStats(){const e=this.orders.length,n=this.orders.filter(u=>u.status==="pending").length,r=this.orders.filter(u=>u.status==="delivered").length,l=this.orders.filter(u=>u.paymentStatus==="paid").reduce((u,f)=>u+f.totalAmount,0);return{total:e,pending:n,completed:r,revenue:l}}}const Id=new EN;class SN{messages=[];businessListeners=[];customerListeners=[];constructor(){this.loadMessages()}loadMessages(){const e=localStorage.getItem("whatsapp_messages");e?this.messages=JSON.parse(e):(this.messages=[{id:"1",from:"customer",customerName:"John Smith",customerPhone:"+27821234567",message:"Hi! I placed an order for 2 Classic Kotas. When will it be ready?",timestamp:new Date().toISOString(),read:!1},{id:"2",from:"business",message:"Hello John! Thank you for your order. Your 2 Classic Kotas will be ready in 15 minutes. We'll notify you when it's ready for pickup.",timestamp:new Date().toISOString(),read:!0}],this.saveMessages())}saveMessages(){localStorage.setItem("whatsapp_messages",JSON.stringify(this.messages)),this.notifyBusinessListeners(),this.notifyCustomerListeners()}notifyBusinessListeners(){this.businessListeners.forEach(e=>e([...this.messages]))}notifyCustomerListeners(){this.customerListeners.forEach(e=>e([...this.messages]))}subscribeBusiness(e){return this.businessListeners.push(e),e([...this.messages]),()=>{this.businessListeners=this.businessListeners.filter(n=>n!==e)}}subscribeCustomer(e,n){this.customerListeners.push(n);const r=this.messages.filter(l=>l.customerPhone===e||l.from==="business");return n(r),()=>{this.customerListeners=this.customerListeners.filter(l=>l!==n)}}sendCustomerMessage(e,n,r){const l={id:Date.now().toString(),from:"customer",customerName:e,customerPhone:n,message:r,timestamp:new Date().toISOString(),read:!1};return this.messages.push(l),this.saveMessages(),l}sendBusinessMessage(e,n){const r={id:Date.now().toString(),from:"business",message:n,timestamp:new Date().toISOString(),read:!0};return this.messages.push(r),this.saveMessages(),r}markAsRead(e){this.messages=this.messages.map(n=>n.id===e?{...n,read:!0}:n),this.saveMessages()}getUnreadCount(){return this.messages.filter(e=>e.from==="customer"&&!e.read).length}getCustomerMessages(e){return this.messages.filter(n=>n.customerPhone===e||n.from==="business")}getBusinessMessages(){return[...this.messages].sort((e,n)=>new Date(e.timestamp).getTime()-new Date(n.timestamp).getTime())}}const zl=new SN,AN=()=>{};var ly={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=function(i){const e=[];let n=0;for(let r=0;r<i.length;r++){let l=i.charCodeAt(r);l<128?e[n++]=l:l<2048?(e[n++]=l>>6|192,e[n++]=l&63|128):(l&64512)===55296&&r+1<i.length&&(i.charCodeAt(r+1)&64512)===56320?(l=65536+((l&1023)<<10)+(i.charCodeAt(++r)&1023),e[n++]=l>>18|240,e[n++]=l>>12&63|128,e[n++]=l>>6&63|128,e[n++]=l&63|128):(e[n++]=l>>12|224,e[n++]=l>>6&63|128,e[n++]=l&63|128)}return e},NN=function(i){const e=[];let n=0,r=0;for(;n<i.length;){const l=i[n++];if(l<128)e[r++]=String.fromCharCode(l);else if(l>191&&l<224){const u=i[n++];e[r++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=i[n++],f=i[n++],p=i[n++],x=((l&7)<<18|(u&63)<<12|(f&63)<<6|p&63)-65536;e[r++]=String.fromCharCode(55296+(x>>10)),e[r++]=String.fromCharCode(56320+(x&1023))}else{const u=i[n++],f=i[n++];e[r++]=String.fromCharCode((l&15)<<12|(u&63)<<6|f&63)}}return e.join("")},V1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let l=0;l<i.length;l+=3){const u=i[l],f=l+1<i.length,p=f?i[l+1]:0,x=l+2<i.length,m=x?i[l+2]:0,v=u>>2,b=(u&3)<<4|p>>4;let S=(p&15)<<2|m>>6,I=m&63;x||(I=64,f||(S=64)),r.push(n[v],n[b],n[S],n[I])}return r.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(L1(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):NN(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let l=0;l<i.length;){const u=n[i.charAt(l++)],p=l<i.length?n[i.charAt(l)]:0;++l;const m=l<i.length?n[i.charAt(l)]:64;++l;const b=l<i.length?n[i.charAt(l)]:64;if(++l,u==null||p==null||m==null||b==null)throw new wN;const S=u<<2|p>>4;if(r.push(S),m!==64){const I=p<<4&240|m>>2;if(r.push(I),b!==64){const R=m<<6&192|b;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class wN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CN=function(i){const e=L1(i);return V1.encodeByteArray(e,!0)},kd=function(i){return CN(i).replace(/\./g,"")},U1=function(i){try{return V1.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=()=>jN().__FIREBASE_DEFAULTS__,RN=()=>{if(typeof process>"u"||typeof ly>"u")return;const i=ly.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},DN=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&U1(i[1]);return e&&JSON.parse(e)},Jd=()=>{try{return AN()||TN()||RN()||DN()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},z1=i=>Jd()?.emulatorHosts?.[i],IN=i=>{const e=z1(i);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},q1=()=>Jd()?.config,H1=i=>Jd()?.[`_${i}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $1(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",l=i.iat||0,u=i.sub||i.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${r}`,aud:r,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...i};return[kd(JSON.stringify(n)),kd(JSON.stringify(f)),""].join(".")}const ql={};function ON(){const i={prod:[],emulator:[]};for(const e of Object.keys(ql))ql[e]?i.emulator.push(e):i.prod.push(e);return i}function BN(i){let e=document.getElementById(i),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),n=!0),{created:n,element:e}}let cy=!1;function G1(i,e){if(typeof window>"u"||typeof document>"u"||!So(window.location.host)||ql[i]===e||ql[i]||cy)return;ql[i]=e;function n(S){return`__firebase__banner__${S}`}const r="__firebase__banner",u=ON().prod.length>0;function f(){const S=document.getElementById(r);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function x(S,I){S.setAttribute("width","24"),S.setAttribute("id",I),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function m(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{cy=!0,f()},S}function v(S,I){S.setAttribute("id",I),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function b(){const S=BN(r),I=n("text"),R=document.getElementById(I)||document.createElement("span"),D=n("learnmore"),k=document.getElementById(D)||document.createElement("a"),q=n("preprendIcon"),O=document.getElementById(q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const L=S.element;p(L),v(k,D);const N=m();x(O,q),L.append(O,R,k,N),document.body.appendChild(L)}u?(R.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(En())}function FN(){const i=Jd()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VN(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function UN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zN(){const i=En();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function qN(){return!FN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HN(){try{return typeof indexedDB=="object"}catch{return!1}}function $N(){return new Promise((i,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(r);l.onsuccess=()=>{l.result.close(),n||self.indexedDB.deleteDatabase(r),i(!0)},l.onupgradeneeded=()=>{n=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN="FirebaseError";class xa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=GN,Object.setPrototypeOf(this,xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oc.prototype.create)}}class oc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},l=`${this.service}/${e}`,u=this.errors[e],f=u?KN(u,r):"Error",p=`${this.serviceName}: ${f} (${l}).`;return new xa(l,p,r)}}function KN(i,e){return i.replace(YN,(n,r)=>{const l=e[r];return l!=null?String(l):`<${r}?>`})}const YN=/\{\$([^}]+)}/g;function QN(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function oi(i,e){if(i===e)return!0;const n=Object.keys(i),r=Object.keys(e);for(const l of n){if(!r.includes(l))return!1;const u=i[l],f=e[l];if(uy(u)&&uy(f)){if(!oi(u,f))return!1}else if(u!==f)return!1}for(const l of r)if(!n.includes(l))return!1;return!0}function uy(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(i){const e=[];for(const[n,r]of Object.entries(i))Array.isArray(r)?r.forEach(l=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bl(i){const e={};return i.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[l,u]=r.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Ml(i){const e=i.indexOf("?");if(!e)return"";const n=i.indexOf("#",e);return i.substring(e,n>0?n:void 0)}function XN(i,e){const n=new WN(i,e);return n.subscribe.bind(n)}class WN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let l;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");ZN(e,["next","error","complete"])?l=e:l={next:e,error:n,complete:r},l.next===void 0&&(l.next=b0),l.error===void 0&&(l.error=b0),l.complete===void 0&&(l.complete=b0);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZN(i,e){if(typeof i!="object"||i===null)return!1;for(const n of e)if(n in i&&typeof i[n]=="function")return!0;return!1}function b0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(i){return i&&i._delegate?i._delegate:i}class li{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new kN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:n});l&&r.resolve(l)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(l){if(r)return null;throw l}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tw(e))try{this.getOrInitializeService({instanceIdentifier:si})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(n);try{const u=this.getOrInitializeService({instanceIdentifier:l});r.resolve(u)}catch{}}}}clearInstance(e=si){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=si){return this.instances.has(e)}getOptions(e=si){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[u,f]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);r===p&&f.resolve(l)}return l}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),l=this.onInitCallbacks.get(r)??new Set;l.add(e),this.onInitCallbacks.set(r,l);const u=this.instances.get(r);return u&&e(u,r),()=>{l.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const l of r)try{l(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ew(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=si){return this.component?this.component.multipleInstances?e:si:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ew(i){return i===si?void 0:i}function tw(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new JN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(et||(et={}));const sw={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},aw=et.INFO,rw={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},iw=(i,e,...n)=>{if(e<i.logLevel)return;const r=new Date().toISOString(),l=rw[e];if(l)console[l](`[${r}]  ${i.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hm{constructor(e){this.name=e,this._logLevel=aw,this._logHandler=iw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}const ow=(i,e)=>e.some(n=>i instanceof n);let dy,hy;function lw(){return dy||(dy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cw(){return hy||(hy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const K1=new WeakMap,B0=new WeakMap,Y1=new WeakMap,E0=new WeakMap,fm=new WeakMap;function uw(i){const e=new Promise((n,r)=>{const l=()=>{i.removeEventListener("success",u),i.removeEventListener("error",f)},u=()=>{n(ar(i.result)),l()},f=()=>{r(i.error),l()};i.addEventListener("success",u),i.addEventListener("error",f)});return e.then(n=>{n instanceof IDBCursor&&K1.set(n,i)}).catch(()=>{}),fm.set(e,i),e}function dw(i){if(B0.has(i))return;const e=new Promise((n,r)=>{const l=()=>{i.removeEventListener("complete",u),i.removeEventListener("error",f),i.removeEventListener("abort",f)},u=()=>{n(),l()},f=()=>{r(i.error||new DOMException("AbortError","AbortError")),l()};i.addEventListener("complete",u),i.addEventListener("error",f),i.addEventListener("abort",f)});B0.set(i,e)}let M0={get(i,e,n){if(i instanceof IDBTransaction){if(e==="done")return B0.get(i);if(e==="objectStoreNames")return i.objectStoreNames||Y1.get(i);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ar(i[e])},set(i,e,n){return i[e]=n,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function hw(i){M0=i(M0)}function fw(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=i.call(S0(this),e,...n);return Y1.set(r,e.sort?e.sort():[e]),ar(r)}:cw().includes(i)?function(...e){return i.apply(S0(this),e),ar(K1.get(this))}:function(...e){return ar(i.apply(S0(this),e))}}function mw(i){return typeof i=="function"?fw(i):(i instanceof IDBTransaction&&dw(i),ow(i,lw())?new Proxy(i,M0):i)}function ar(i){if(i instanceof IDBRequest)return uw(i);if(E0.has(i))return E0.get(i);const e=mw(i);return e!==i&&(E0.set(i,e),fm.set(e,i)),e}const S0=i=>fm.get(i);function pw(i,e,{blocked:n,upgrade:r,blocking:l,terminated:u}={}){const f=indexedDB.open(i,e),p=ar(f);return r&&f.addEventListener("upgradeneeded",x=>{r(ar(f.result),x.oldVersion,x.newVersion,ar(f.transaction),x)}),n&&f.addEventListener("blocked",x=>n(x.oldVersion,x.newVersion,x)),p.then(x=>{u&&x.addEventListener("close",()=>u()),l&&x.addEventListener("versionchange",m=>l(m.oldVersion,m.newVersion,m))}).catch(()=>{}),p}const gw=["get","getKey","getAll","getAllKeys","count"],xw=["put","add","delete","clear"],A0=new Map;function fy(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(A0.get(e))return A0.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,l=xw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(l||gw.includes(n)))return;const u=async function(f,...p){const x=this.transaction(f,l?"readwrite":"readonly");let m=x.store;return r&&(m=m.index(p.shift())),(await Promise.all([m[n](...p),l&&x.done]))[0]};return A0.set(e,u),u}hw(i=>({...i,get:(e,n,r)=>fy(e,n)||i.get(e,n,r),has:(e,n)=>!!fy(e,n)||i.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(yw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function yw(i){return i.getComponent()?.type==="VERSION"}const F0="@firebase/app",my="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=new hm("@firebase/app"),_w="@firebase/app-compat",bw="@firebase/analytics-compat",Ew="@firebase/analytics",Sw="@firebase/app-check-compat",Aw="@firebase/app-check",Nw="@firebase/auth",ww="@firebase/auth-compat",Cw="@firebase/database",jw="@firebase/data-connect",Tw="@firebase/database-compat",Rw="@firebase/functions",Dw="@firebase/functions-compat",Iw="@firebase/installations",kw="@firebase/installations-compat",Pw="@firebase/messaging",Ow="@firebase/messaging-compat",Bw="@firebase/performance",Mw="@firebase/performance-compat",Fw="@firebase/remote-config",Lw="@firebase/remote-config-compat",Vw="@firebase/storage",Uw="@firebase/storage-compat",zw="@firebase/firestore",qw="@firebase/ai",Hw="@firebase/firestore-compat",$w="firebase",Gw="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="[DEFAULT]",Kw={[F0]:"fire-core",[_w]:"fire-core-compat",[Ew]:"fire-analytics",[bw]:"fire-analytics-compat",[Aw]:"fire-app-check",[Sw]:"fire-app-check-compat",[Nw]:"fire-auth",[ww]:"fire-auth-compat",[Cw]:"fire-rtdb",[jw]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[Rw]:"fire-fn",[Dw]:"fire-fn-compat",[Iw]:"fire-iid",[kw]:"fire-iid-compat",[Pw]:"fire-fcm",[Ow]:"fire-fcm-compat",[Bw]:"fire-perf",[Mw]:"fire-perf-compat",[Fw]:"fire-rc",[Lw]:"fire-rc-compat",[Vw]:"fire-gcs",[Uw]:"fire-gcs-compat",[zw]:"fire-fst",[Hw]:"fire-fst-compat",[qw]:"fire-vertex","fire-js":"fire-js",[$w]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=new Map,Yw=new Map,V0=new Map;function py(i,e){try{i.container.addComponent(e)}catch(n){fa.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,n)}}function go(i){const e=i.name;if(V0.has(e))return fa.debug(`There were multiple attempts to register component ${e}.`),!1;V0.set(e,i);for(const n of Wl.values())py(n,i);for(const n of Yw.values())py(n,i);return!0}function mm(i,e){const n=i.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),i.container.getProvider(e)}function ts(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rr=new oc("app","Firebase",Qw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new li("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=Gw;function Q1(i,e={}){let n=i;typeof e!="object"&&(e={name:e});const r={name:L0,automaticDataCollectionEnabled:!0,...e},l=r.name;if(typeof l!="string"||!l)throw rr.create("bad-app-name",{appName:String(l)});if(n||(n=q1()),!n)throw rr.create("no-options");const u=Wl.get(l);if(u){if(oi(n,u.options)&&oi(r,u.config))return u;throw rr.create("duplicate-app",{appName:l})}const f=new nw(l);for(const x of V0.values())f.addComponent(x);const p=new Xw(n,r,f);return Wl.set(l,p),p}function X1(i=L0){const e=Wl.get(i);if(!e&&i===L0&&q1())return Q1();if(!e)throw rr.create("no-app",{appName:i});return e}function Ww(){return Array.from(Wl.values())}function ir(i,e,n){let r=Kw[i]??i;n&&(r+=`-${n}`);const l=r.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const f=[`Unable to register library "${r}" with version "${e}":`];l&&f.push(`library name "${r}" contains illegal characters (whitespace or "/")`),l&&u&&f.push("and"),u&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fa.warn(f.join(" "));return}go(new li(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="firebase-heartbeat-database",Jw=1,Zl="firebase-heartbeat-store";let N0=null;function W1(){return N0||(N0=pw(Zw,Jw,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Zl)}catch(n){console.warn(n)}}}}).catch(i=>{throw rr.create("idb-open",{originalErrorMessage:i.message})})),N0}async function eC(i){try{const n=(await W1()).transaction(Zl),r=await n.objectStore(Zl).get(Z1(i));return await n.done,r}catch(e){if(e instanceof xa)fa.warn(e.message);else{const n=rr.create("idb-get",{originalErrorMessage:e?.message});fa.warn(n.message)}}}async function gy(i,e){try{const r=(await W1()).transaction(Zl,"readwrite");await r.objectStore(Zl).put(e,Z1(i)),await r.done}catch(n){if(n instanceof xa)fa.warn(n.message);else{const r=rr.create("idb-set",{originalErrorMessage:n?.message});fa.warn(r.message)}}}function Z1(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=1024,nC=30;class sC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(l=>l.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>nC){const l=iC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xy(),{heartbeatsToSend:n,unsentEntries:r}=aC(this._heartbeatsCache.heartbeats),l=kd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return fa.warn(e),""}}}function xy(){return new Date().toISOString().substring(0,10)}function aC(i,e=tC){const n=[];let r=i.slice();for(const l of i){const u=n.find(f=>f.agent===l.agent);if(u){if(u.dates.push(l.date),vy(n)>e){u.dates.pop();break}}else if(n.push({agent:l.agent,dates:[l.date]}),vy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return HN()?$N().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await eC(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return gy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function vy(i){return kd(JSON.stringify({version:2,heartbeats:i})).length}function iC(i){if(i.length===0)return-1;let e=0,n=i[0].date;for(let r=1;r<i.length;r++)i[r].date<n&&(n=i[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(i){go(new li("platform-logger",e=>new vw(e),"PRIVATE")),go(new li("heartbeat",e=>new sC(e),"PRIVATE")),ir(F0,my,i),ir(F0,my,"esm2020"),ir("fire-js","")}oC("");var lC="firebase",cC="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ir(lC,cC,"app");var yy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var or,J1;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,_){function A(){}A.prototype=_.prototype,E.F=_.prototype,E.prototype=new A,E.prototype.constructor=E,E.D=function(w,T,U){for(var B=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)B[ve-2]=arguments[ve];return _.prototype[T].apply(w,B)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(E,_,A){A||(A=0);const w=Array(16);if(typeof _=="string")for(var T=0;T<16;++T)w[T]=_.charCodeAt(A++)|_.charCodeAt(A++)<<8|_.charCodeAt(A++)<<16|_.charCodeAt(A++)<<24;else for(T=0;T<16;++T)w[T]=_[A++]|_[A++]<<8|_[A++]<<16|_[A++]<<24;_=E.g[0],A=E.g[1],T=E.g[2];let U=E.g[3],B;B=_+(U^A&(T^U))+w[0]+3614090360&4294967295,_=A+(B<<7&4294967295|B>>>25),B=U+(T^_&(A^T))+w[1]+3905402710&4294967295,U=_+(B<<12&4294967295|B>>>20),B=T+(A^U&(_^A))+w[2]+606105819&4294967295,T=U+(B<<17&4294967295|B>>>15),B=A+(_^T&(U^_))+w[3]+3250441966&4294967295,A=T+(B<<22&4294967295|B>>>10),B=_+(U^A&(T^U))+w[4]+4118548399&4294967295,_=A+(B<<7&4294967295|B>>>25),B=U+(T^_&(A^T))+w[5]+1200080426&4294967295,U=_+(B<<12&4294967295|B>>>20),B=T+(A^U&(_^A))+w[6]+2821735955&4294967295,T=U+(B<<17&4294967295|B>>>15),B=A+(_^T&(U^_))+w[7]+4249261313&4294967295,A=T+(B<<22&4294967295|B>>>10),B=_+(U^A&(T^U))+w[8]+1770035416&4294967295,_=A+(B<<7&4294967295|B>>>25),B=U+(T^_&(A^T))+w[9]+2336552879&4294967295,U=_+(B<<12&4294967295|B>>>20),B=T+(A^U&(_^A))+w[10]+4294925233&4294967295,T=U+(B<<17&4294967295|B>>>15),B=A+(_^T&(U^_))+w[11]+2304563134&4294967295,A=T+(B<<22&4294967295|B>>>10),B=_+(U^A&(T^U))+w[12]+1804603682&4294967295,_=A+(B<<7&4294967295|B>>>25),B=U+(T^_&(A^T))+w[13]+4254626195&4294967295,U=_+(B<<12&4294967295|B>>>20),B=T+(A^U&(_^A))+w[14]+2792965006&4294967295,T=U+(B<<17&4294967295|B>>>15),B=A+(_^T&(U^_))+w[15]+1236535329&4294967295,A=T+(B<<22&4294967295|B>>>10),B=_+(T^U&(A^T))+w[1]+4129170786&4294967295,_=A+(B<<5&4294967295|B>>>27),B=U+(A^T&(_^A))+w[6]+3225465664&4294967295,U=_+(B<<9&4294967295|B>>>23),B=T+(_^A&(U^_))+w[11]+643717713&4294967295,T=U+(B<<14&4294967295|B>>>18),B=A+(U^_&(T^U))+w[0]+3921069994&4294967295,A=T+(B<<20&4294967295|B>>>12),B=_+(T^U&(A^T))+w[5]+3593408605&4294967295,_=A+(B<<5&4294967295|B>>>27),B=U+(A^T&(_^A))+w[10]+38016083&4294967295,U=_+(B<<9&4294967295|B>>>23),B=T+(_^A&(U^_))+w[15]+3634488961&4294967295,T=U+(B<<14&4294967295|B>>>18),B=A+(U^_&(T^U))+w[4]+3889429448&4294967295,A=T+(B<<20&4294967295|B>>>12),B=_+(T^U&(A^T))+w[9]+568446438&4294967295,_=A+(B<<5&4294967295|B>>>27),B=U+(A^T&(_^A))+w[14]+3275163606&4294967295,U=_+(B<<9&4294967295|B>>>23),B=T+(_^A&(U^_))+w[3]+4107603335&4294967295,T=U+(B<<14&4294967295|B>>>18),B=A+(U^_&(T^U))+w[8]+1163531501&4294967295,A=T+(B<<20&4294967295|B>>>12),B=_+(T^U&(A^T))+w[13]+2850285829&4294967295,_=A+(B<<5&4294967295|B>>>27),B=U+(A^T&(_^A))+w[2]+4243563512&4294967295,U=_+(B<<9&4294967295|B>>>23),B=T+(_^A&(U^_))+w[7]+1735328473&4294967295,T=U+(B<<14&4294967295|B>>>18),B=A+(U^_&(T^U))+w[12]+2368359562&4294967295,A=T+(B<<20&4294967295|B>>>12),B=_+(A^T^U)+w[5]+4294588738&4294967295,_=A+(B<<4&4294967295|B>>>28),B=U+(_^A^T)+w[8]+2272392833&4294967295,U=_+(B<<11&4294967295|B>>>21),B=T+(U^_^A)+w[11]+1839030562&4294967295,T=U+(B<<16&4294967295|B>>>16),B=A+(T^U^_)+w[14]+4259657740&4294967295,A=T+(B<<23&4294967295|B>>>9),B=_+(A^T^U)+w[1]+2763975236&4294967295,_=A+(B<<4&4294967295|B>>>28),B=U+(_^A^T)+w[4]+1272893353&4294967295,U=_+(B<<11&4294967295|B>>>21),B=T+(U^_^A)+w[7]+4139469664&4294967295,T=U+(B<<16&4294967295|B>>>16),B=A+(T^U^_)+w[10]+3200236656&4294967295,A=T+(B<<23&4294967295|B>>>9),B=_+(A^T^U)+w[13]+681279174&4294967295,_=A+(B<<4&4294967295|B>>>28),B=U+(_^A^T)+w[0]+3936430074&4294967295,U=_+(B<<11&4294967295|B>>>21),B=T+(U^_^A)+w[3]+3572445317&4294967295,T=U+(B<<16&4294967295|B>>>16),B=A+(T^U^_)+w[6]+76029189&4294967295,A=T+(B<<23&4294967295|B>>>9),B=_+(A^T^U)+w[9]+3654602809&4294967295,_=A+(B<<4&4294967295|B>>>28),B=U+(_^A^T)+w[12]+3873151461&4294967295,U=_+(B<<11&4294967295|B>>>21),B=T+(U^_^A)+w[15]+530742520&4294967295,T=U+(B<<16&4294967295|B>>>16),B=A+(T^U^_)+w[2]+3299628645&4294967295,A=T+(B<<23&4294967295|B>>>9),B=_+(T^(A|~U))+w[0]+4096336452&4294967295,_=A+(B<<6&4294967295|B>>>26),B=U+(A^(_|~T))+w[7]+1126891415&4294967295,U=_+(B<<10&4294967295|B>>>22),B=T+(_^(U|~A))+w[14]+2878612391&4294967295,T=U+(B<<15&4294967295|B>>>17),B=A+(U^(T|~_))+w[5]+4237533241&4294967295,A=T+(B<<21&4294967295|B>>>11),B=_+(T^(A|~U))+w[12]+1700485571&4294967295,_=A+(B<<6&4294967295|B>>>26),B=U+(A^(_|~T))+w[3]+2399980690&4294967295,U=_+(B<<10&4294967295|B>>>22),B=T+(_^(U|~A))+w[10]+4293915773&4294967295,T=U+(B<<15&4294967295|B>>>17),B=A+(U^(T|~_))+w[1]+2240044497&4294967295,A=T+(B<<21&4294967295|B>>>11),B=_+(T^(A|~U))+w[8]+1873313359&4294967295,_=A+(B<<6&4294967295|B>>>26),B=U+(A^(_|~T))+w[15]+4264355552&4294967295,U=_+(B<<10&4294967295|B>>>22),B=T+(_^(U|~A))+w[6]+2734768916&4294967295,T=U+(B<<15&4294967295|B>>>17),B=A+(U^(T|~_))+w[13]+1309151649&4294967295,A=T+(B<<21&4294967295|B>>>11),B=_+(T^(A|~U))+w[4]+4149444226&4294967295,_=A+(B<<6&4294967295|B>>>26),B=U+(A^(_|~T))+w[11]+3174756917&4294967295,U=_+(B<<10&4294967295|B>>>22),B=T+(_^(U|~A))+w[2]+718787259&4294967295,T=U+(B<<15&4294967295|B>>>17),B=A+(U^(T|~_))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(T+(B<<21&4294967295|B>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+U&4294967295}r.prototype.v=function(E,_){_===void 0&&(_=E.length);const A=_-this.blockSize,w=this.C;let T=this.h,U=0;for(;U<_;){if(T==0)for(;U<=A;)l(this,E,U),U+=this.blockSize;if(typeof E=="string"){for(;U<_;)if(w[T++]=E.charCodeAt(U++),T==this.blockSize){l(this,w),T=0;break}}else for(;U<_;)if(w[T++]=E[U++],T==this.blockSize){l(this,w),T=0;break}}this.h=T,this.o+=_},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;_=this.o*8;for(var A=E.length-8;A<E.length;++A)E[A]=_&255,_/=256;for(this.v(E),E=Array(16),_=0,A=0;A<4;++A)for(let w=0;w<32;w+=8)E[_++]=this.g[A]>>>w&255;return E};function u(E,_){var A=p;return Object.prototype.hasOwnProperty.call(A,E)?A[E]:A[E]=_(E)}function f(E,_){this.h=_;const A=[];let w=!0;for(let T=E.length-1;T>=0;T--){const U=E[T]|0;w&&U==_||(A[T]=U,w=!1)}this.g=A}var p={};function x(E){return-128<=E&&E<128?u(E,function(_){return new f([_|0],_<0?-1:0)}):new f([E|0],E<0?-1:0)}function m(E){if(isNaN(E)||!isFinite(E))return b;if(E<0)return k(m(-E));const _=[];let A=1;for(let w=0;E>=A;w++)_[w]=E/A|0,A*=4294967296;return new f(_,0)}function v(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return k(v(E.substring(1),_));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=m(Math.pow(_,8));let w=b;for(let U=0;U<E.length;U+=8){var T=Math.min(8,E.length-U);const B=parseInt(E.substring(U,U+T),_);T<8?(T=m(Math.pow(_,T)),w=w.j(T).add(m(B))):(w=w.j(A),w=w.add(m(B)))}return w}var b=x(0),S=x(1),I=x(16777216);i=f.prototype,i.m=function(){if(D(this))return-k(this).m();let E=0,_=1;for(let A=0;A<this.g.length;A++){const w=this.i(A);E+=(w>=0?w:4294967296+w)*_,_*=4294967296}return E},i.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R(this))return"0";if(D(this))return"-"+k(this).toString(E);const _=m(Math.pow(E,6));var A=this;let w="";for(;;){const T=N(A,_).g;A=q(A,T.j(_));let U=((A.g.length>0?A.g[0]:A.h)>>>0).toString(E);if(A=T,R(A))return U+w;for(;U.length<6;)U="0"+U;w=U+w}},i.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function R(E){if(E.h!=0)return!1;for(let _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function D(E){return E.h==-1}i.l=function(E){return E=q(this,E),D(E)?-1:R(E)?0:1};function k(E){const _=E.g.length,A=[];for(let w=0;w<_;w++)A[w]=~E.g[w];return new f(A,~E.h).add(S)}i.abs=function(){return D(this)?k(this):this},i.add=function(E){const _=Math.max(this.g.length,E.g.length),A=[];let w=0;for(let T=0;T<=_;T++){let U=w+(this.i(T)&65535)+(E.i(T)&65535),B=(U>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=B>>>16,U&=65535,B&=65535,A[T]=B<<16|U}return new f(A,A[A.length-1]&-2147483648?-1:0)};function q(E,_){return E.add(k(_))}i.j=function(E){if(R(this)||R(E))return b;if(D(this))return D(E)?k(this).j(k(E)):k(k(this).j(E));if(D(E))return k(this.j(k(E)));if(this.l(I)<0&&E.l(I)<0)return m(this.m()*E.m());const _=this.g.length+E.g.length,A=[];for(var w=0;w<2*_;w++)A[w]=0;for(w=0;w<this.g.length;w++)for(let T=0;T<E.g.length;T++){const U=this.i(w)>>>16,B=this.i(w)&65535,ve=E.i(T)>>>16,ye=E.i(T)&65535;A[2*w+2*T]+=B*ye,O(A,2*w+2*T),A[2*w+2*T+1]+=U*ye,O(A,2*w+2*T+1),A[2*w+2*T+1]+=B*ve,O(A,2*w+2*T+1),A[2*w+2*T+2]+=U*ve,O(A,2*w+2*T+2)}for(E=0;E<_;E++)A[E]=A[2*E+1]<<16|A[2*E];for(E=_;E<2*_;E++)A[E]=0;return new f(A,0)};function O(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function L(E,_){this.g=E,this.h=_}function N(E,_){if(R(_))throw Error("division by zero");if(R(E))return new L(b,b);if(D(E))return _=N(k(E),_),new L(k(_.g),k(_.h));if(D(_))return _=N(E,k(_)),new L(k(_.g),_.h);if(E.g.length>30){if(D(E)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var A=S,w=_;w.l(E)<=0;)A=F(A),w=F(w);var T=P(A,1),U=P(w,1);for(w=P(w,2),A=P(A,2);!R(w);){var B=U.add(w);B.l(E)<=0&&(T=T.add(A),U=B),w=P(w,1),A=P(A,1)}return _=q(E,T.j(_)),new L(T,_)}for(T=b;E.l(_)>=0;){for(A=Math.max(1,Math.floor(E.m()/_.m())),w=Math.ceil(Math.log(A)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),U=m(A),B=U.j(_);D(B)||B.l(E)>0;)A-=w,U=m(A),B=U.j(_);R(U)&&(U=S),T=T.add(U),E=q(E,B)}return new L(T,E)}i.B=function(E){return N(this,E).h},i.and=function(E){const _=Math.max(this.g.length,E.g.length),A=[];for(let w=0;w<_;w++)A[w]=this.i(w)&E.i(w);return new f(A,this.h&E.h)},i.or=function(E){const _=Math.max(this.g.length,E.g.length),A=[];for(let w=0;w<_;w++)A[w]=this.i(w)|E.i(w);return new f(A,this.h|E.h)},i.xor=function(E){const _=Math.max(this.g.length,E.g.length),A=[];for(let w=0;w<_;w++)A[w]=this.i(w)^E.i(w);return new f(A,this.h^E.h)};function F(E){const _=E.g.length+1,A=[];for(let w=0;w<_;w++)A[w]=E.i(w)<<1|E.i(w-1)>>>31;return new f(A,E.h)}function P(E,_){const A=_>>5;_%=32;const w=E.g.length-A,T=[];for(let U=0;U<w;U++)T[U]=_>0?E.i(U+A)>>>_|E.i(U+A+1)<<32-_:E.i(U+A);return new f(T,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,J1=r,f.prototype.add=f.prototype.add,f.prototype.multiply=f.prototype.j,f.prototype.modulo=f.prototype.B,f.prototype.compare=f.prototype.l,f.prototype.toNumber=f.prototype.m,f.prototype.toString=f.prototype.toString,f.prototype.getBits=f.prototype.i,f.fromNumber=m,f.fromString=v,or=f}).apply(typeof yy<"u"?yy:typeof self<"u"?self:typeof window<"u"?window:{});var Pu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var e_,Fl,t_,Ed,U0,n_,s_,a_;(function(){var i,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pu=="object"&&Pu];for(var y=0;y<d.length;++y){var C=d[y];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=n(this);function l(d,y){if(y)e:{var C=r;d=d.split(".");for(var V=0;V<d.length-1;V++){var te=d[V];if(!(te in C))break e;C=C[te]}d=d[d.length-1],V=C[d],y=y(V),y!=V&&y!=null&&e(C,d,{configurable:!0,writable:!0,value:y})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(y){var C=[],V;for(V in y)Object.prototype.hasOwnProperty.call(y,V)&&C.push([V,y[V]]);return C}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},f=this||self;function p(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function x(d,y,C){return d.call.apply(d.bind,arguments)}function m(d,y,C){return m=x,m.apply(null,arguments)}function v(d,y){var C=Array.prototype.slice.call(arguments,1);return function(){var V=C.slice();return V.push.apply(V,arguments),d.apply(this,V)}}function b(d,y){function C(){}C.prototype=y.prototype,d.Z=y.prototype,d.prototype=new C,d.prototype.constructor=d,d.Ob=function(V,te,oe){for(var Ee=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)Ee[$e-2]=arguments[$e];return y.prototype[te].apply(V,Ee)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function I(d){const y=d.length;if(y>0){const C=Array(y);for(let V=0;V<y;V++)C[V]=d[V];return C}return[]}function R(d,y){for(let V=1;V<arguments.length;V++){const te=arguments[V];var C=typeof te;if(C=C!="object"?C:te?Array.isArray(te)?"array":C:"null",C=="array"||C=="object"&&typeof te.length=="number"){C=d.length||0;const oe=te.length||0;d.length=C+oe;for(let Ee=0;Ee<oe;Ee++)d[C+Ee]=te[Ee]}else d.push(te)}}class D{constructor(y,C){this.i=y,this.j=C,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function k(d){f.setTimeout(()=>{throw d},0)}function q(){var d=E;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class O{constructor(){this.h=this.g=null}add(y,C){const V=L.get();V.set(y,C),this.h?this.h.next=V:this.g=V,this.h=V}}var L=new D(()=>new N,d=>d.reset());class N{constructor(){this.next=this.g=this.h=null}set(y,C){this.h=y,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let F,P=!1,E=new O,_=()=>{const d=Promise.resolve(void 0);F=()=>{d.then(A)}};function A(){for(var d;d=q();){try{d.h.call(d.g)}catch(C){k(C)}var y=L;y.j(d),y.h<100&&(y.h++,d.next=y.g,y.g=d)}P=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const C=()=>{};f.addEventListener("test",C,y),f.removeEventListener("test",C,y)}catch{}return d})();function B(d){return/^[\s\xa0]*$/.test(d)}function ve(d,y){T.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,y)}b(ve,T),ve.prototype.init=function(d,y){const C=this.type=d.type,V=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget,y||(C=="mouseover"?y=d.fromElement:C=="mouseout"&&(y=d.toElement)),this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),Q=0;function ue(d,y,C,V,te){this.listener=d,this.proxy=null,this.src=y,this.type=C,this.capture=!!V,this.ha=te,this.key=++Q,this.da=this.fa=!1}function pe(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ce(d,y,C){for(const V in d)y.call(C,d[V],V,d)}function H(d,y){for(const C in d)y.call(void 0,d[C],C,d)}function G(d){const y={};for(const C in d)y[C]=d[C];return y}const z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(d,y){let C,V;for(let te=1;te<arguments.length;te++){V=arguments[te];for(C in V)d[C]=V[C];for(let oe=0;oe<z.length;oe++)C=z[oe],Object.prototype.hasOwnProperty.call(V,C)&&(d[C]=V[C])}}function J(d){this.src=d,this.g={},this.h=0}J.prototype.add=function(d,y,C,V,te){const oe=d.toString();d=this.g[oe],d||(d=this.g[oe]=[],this.h++);const Ee=he(d,y,V,te);return Ee>-1?(y=d[Ee],C||(y.fa=!1)):(y=new ue(y,this.src,oe,!!V,te),y.fa=C,d.push(y)),y};function Ae(d,y){const C=y.type;if(C in d.g){var V=d.g[C],te=Array.prototype.indexOf.call(V,y,void 0),oe;(oe=te>=0)&&Array.prototype.splice.call(V,te,1),oe&&(pe(y),d.g[C].length==0&&(delete d.g[C],d.h--))}}function he(d,y,C,V){for(let te=0;te<d.length;++te){const oe=d[te];if(!oe.da&&oe.listener==y&&oe.capture==!!C&&oe.ha==V)return te}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),_e={};function be(d,y,C,V,te){if(Array.isArray(y)){for(let oe=0;oe<y.length;oe++)be(d,y[oe],C,V,te);return null}return C=we(C),d&&d[ye]?d.J(y,C,p(V)?!!V.capture:!1,te):Be(d,y,C,!1,V,te)}function Be(d,y,C,V,te,oe){if(!y)throw Error("Invalid event type");const Ee=p(te)?!!te.capture:!!te;let $e=Fe(d);if($e||(d[qe]=$e=new J(d)),C=$e.add(y,C,V,Ee,oe),C.proxy)return C;if(V=Qe(),C.proxy=V,V.src=d,V.listener=C,d.addEventListener)U||(te=Ee),te===void 0&&(te=!1),d.addEventListener(y.toString(),V,te);else if(d.attachEvent)d.attachEvent(Nt(y.toString()),V);else if(d.addListener&&d.removeListener)d.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Qe(){function d(C){return y.call(d.src,d.listener,C)}const y=gt;return d}function lt(d,y,C,V,te){if(Array.isArray(y))for(var oe=0;oe<y.length;oe++)lt(d,y[oe],C,V,te);else V=p(V)?!!V.capture:!!V,C=we(C),d&&d[ye]?(d=d.i,oe=String(y).toString(),oe in d.g&&(y=d.g[oe],C=he(y,C,V,te),C>-1&&(pe(y[C]),Array.prototype.splice.call(y,C,1),y.length==0&&(delete d.g[oe],d.h--)))):d&&(d=Fe(d))&&(y=d.g[y.toString()],d=-1,y&&(d=he(y,C,V,te)),(C=d>-1?y[d]:null)&&At(C))}function At(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[ye])Ae(y.i,d);else{var C=d.type,V=d.proxy;y.removeEventListener?y.removeEventListener(C,V,d.capture):y.detachEvent?y.detachEvent(Nt(C),V):y.addListener&&y.removeListener&&y.removeListener(V),(C=Fe(y))?(Ae(C,d),C.h==0&&(C.src=null,y[qe]=null)):pe(d)}}}function Nt(d){return d in _e?_e[d]:_e[d]="on"+d}function gt(d,y){if(d.da)d=!0;else{y=new ve(y,this);const C=d.listener,V=d.ha||d.src;d.fa&&At(d),d=C.call(V,y)}return d}function Fe(d){return d=d[qe],d instanceof J?d:null}var it="__closure_events_fn_"+(Math.random()*1e9>>>0);function we(d){return typeof d=="function"?d:(d[it]||(d[it]=function(y){return d.handleEvent(y)}),d[it])}function je(){w.call(this),this.i=new J(this),this.M=this,this.G=null}b(je,w),je.prototype[ye]=!0,je.prototype.removeEventListener=function(d,y,C,V){lt(this,d,y,C,V)};function ge(d,y){var C,V=d.G;if(V)for(C=[];V;V=V.G)C.push(V);if(d=d.M,V=y.type||y,typeof y=="string")y=new T(y,d);else if(y instanceof T)y.target=y.target||d;else{var te=y;y=new T(V,d),W(y,te)}te=!0;let oe,Ee;if(C)for(Ee=C.length-1;Ee>=0;Ee--)oe=y.g=C[Ee],te=Ue(oe,V,!0,y)&&te;if(oe=y.g=d,te=Ue(oe,V,!0,y)&&te,te=Ue(oe,V,!1,y)&&te,C)for(Ee=0;Ee<C.length;Ee++)oe=y.g=C[Ee],te=Ue(oe,V,!1,y)&&te}je.prototype.N=function(){if(je.Z.N.call(this),this.i){var d=this.i;for(const y in d.g){const C=d.g[y];for(let V=0;V<C.length;V++)pe(C[V]);delete d.g[y],d.h--}}this.G=null},je.prototype.J=function(d,y,C,V){return this.i.add(String(d),y,!1,C,V)},je.prototype.K=function(d,y,C,V){return this.i.add(String(d),y,!0,C,V)};function Ue(d,y,C,V){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();let te=!0;for(let oe=0;oe<y.length;++oe){const Ee=y[oe];if(Ee&&!Ee.da&&Ee.capture==C){const $e=Ee.listener,jt=Ee.ha||Ee.src;Ee.fa&&Ae(d.i,Ee),te=$e.call(jt,V)!==!1&&te}}return te&&!V.defaultPrevented}function Dt(d,y){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=m(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:f.setTimeout(d,y||0)}function se(d){d.g=Dt(()=>{d.g=null,d.i&&(d.i=!1,se(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class ke extends w{constructor(y,C){super(),this.m=y,this.l=C,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xe(d){w.call(this),this.h=d,this.g={}}b(Xe,w);var ot=[];function K(d){Ce(d.g,function(y,C){this.g.hasOwnProperty(C)&&At(y)},d),d.g={}}Xe.prototype.N=function(){Xe.Z.N.call(this),K(this)},Xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ie=f.JSON.stringify,le=f.JSON.parse,Ne=class{stringify(d){return f.JSON.stringify(d,void 0)}parse(d){return f.JSON.parse(d,void 0)}};function Se(){}function xt(){}var vt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xt(){T.call(this,"d")}b(Xt,T);function jn(){T.call(this,"c")}b(jn,T);var Tn={},vs=null;function qs(){return vs=vs||new je}Tn.Ia="serverreachability";function Er(d){T.call(this,Tn.Ia,d)}b(Er,T);function ss(d){const y=qs();ge(y,new Er(y))}Tn.STAT_EVENT="statevent";function va(d,y){T.call(this,Tn.STAT_EVENT,d),this.stat=y}b(va,T);function It(d){const y=qs();ge(y,new va(y,d))}Tn.Ja="timingevent";function vi(d,y){T.call(this,Tn.Ja,d),this.size=y}b(vi,T);function ys(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){d()},y)}function _s(){this.g=!0}_s.prototype.ua=function(){this.g=!1};function ya(d,y,C,V,te,oe){d.info(function(){if(d.g)if(oe){var Ee="",$e=oe.split("&");for(let ft=0;ft<$e.length;ft++){var jt=$e[ft].split("=");if(jt.length>1){const Ut=jt[0];jt=jt[1];const On=Ut.split("_");Ee=On.length>=2&&On[1]=="type"?Ee+(Ut+"="+jt+"&"):Ee+(Ut+"=redacted&")}}}else Ee=null;else Ee=oe;return"XMLHTTP REQ ("+V+") [attempt "+te+"]: "+y+`
`+C+`
`+Ee})}function Sr(d,y,C,V,te,oe,Ee){d.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+te+"]: "+y+`
`+C+`
`+oe+" "+Ee})}function as(d,y,C,V){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+Hn(d,C)+(V?" "+V:"")})}function yi(d,y){d.info(function(){return"TIMEOUT: "+y})}_s.prototype.info=function(){};function Hn(d,y){if(!d.g)return y;if(!y)return null;try{const oe=JSON.parse(y);if(oe){for(d=0;d<oe.length;d++)if(Array.isArray(oe[d])){var C=oe[d];if(!(C.length<2)){var V=C[1];if(Array.isArray(V)&&!(V.length<1)){var te=V[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Ee=1;Ee<V.length;Ee++)V[Ee]=""}}}}return ie(oe)}catch{return y}}var kt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ut={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},nn;function bs(){}b(bs,Se),bs.prototype.g=function(){return new XMLHttpRequest},nn=new bs;function Hs(d){return encodeURIComponent(String(d))}function yh(d){var y=1;d=d.split(":");const C=[];for(;y>0&&d.length;)C.push(d.shift()),y--;return d.length&&C.push(d.join(":")),C}function rs(d,y,C,V){this.j=d,this.i=y,this.l=C,this.S=V||1,this.V=new Xe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new _a}function _a(){this.i=null,this.g="",this.h=!1}var _i={},Es={};function Ss(d,y,C){d.M=1,d.A=Gs(Ot(y)),d.u=C,d.R=!0,ba(d,null)}function ba(d,y){d.F=Date.now(),Ar(d),d.B=Ot(d.A);var C=d.B,V=d.S;Array.isArray(V)||(V=[String(V)]),Ec(C.i,"t",V),d.C=0,C=d.j.L,d.h=new _a,d.g=Ri(d.j,C?y:null,!d.u),d.P>0&&(d.O=new ke(m(d.Y,d,d.g),d.P)),y=d.V,C=d.g,V=d.ba;var te="readystatechange";Array.isArray(te)||(te&&(ot[0]=te.toString()),te=ot);for(let oe=0;oe<te.length;oe++){const Ee=be(C,te[oe],V||y.handleEvent,!1,y.h||y);if(!Ee)break;y.g[Ee.key]=Ee}y=d.J?G(d.J):{},d.u?(d.v||(d.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,y)):(d.v="GET",d.g.ea(d.B,d.v,null,y)),ss(),ya(d.i,d.v,d.B,d.l,d.S,d.u)}rs.prototype.ba=function(d){d=d.target;const y=this.O;y&&gn(d)==3?y.j():this.Y(d)},rs.prototype.Y=function(d){try{if(d==this.g)e:{const $e=gn(this.g),jt=this.g.ya(),ft=this.g.ca();if(!($e<3)&&($e!=3||this.g&&(this.h.h||this.g.la()||Or(this.g)))){this.K||$e!=4||jt==7||(jt==8||ft<=0?ss(3):ss(2)),Ns(this);var y=this.g.ca();this.X=y;var C=Ea(this);if(this.o=y==200,Sr(this.i,this.v,this.B,this.l,this.S,$e,y),this.o){if(this.U&&!this.L){t:{if(this.g){var V,te=this.g;if((V=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(V)){var oe=V;break t}}oe=null}if(d=oe)as(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bi(this,d);else{this.o=!1,this.m=3,It(12),ws(this),Nr(this);break e}}if(this.R){d=!0;let Ut;for(;!this.K&&this.C<C.length;)if(Ut=yc(this,C),Ut==Es){$e==4&&(this.m=4,It(14),d=!1),as(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==_i){this.m=4,It(15),as(this.i,this.l,C,"[Invalid Chunk]"),d=!1;break}else as(this.i,this.l,Ut,null),bi(this,Ut);if(Vt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$e!=4||C.length!=0||this.h.h||(this.m=1,It(16),d=!1),this.o=this.o&&d,!d)as(this.i,this.l,C,"[Invalid Chunked Response]"),ws(this),Nr(this);else if(C.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Lo(Ee),Ee.P=!0,It(11))}}else as(this.i,this.l,C,null),bi(this,C);$e==4&&ws(this),this.o&&!this.K&&($e==4?Vo(this.j,this):(this.o=!1,Ar(this)))}else Br(this.g),y==400&&C.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),ws(this),Nr(this)}}}catch{}finally{}};function Ea(d){if(!Vt(d))return d.g.la();const y=Or(d.g);if(y==="")return"";let C="";const V=y.length,te=gn(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return ws(d),Nr(d),"";d.h.i=new f.TextDecoder}for(let oe=0;oe<V;oe++)d.h.h=!0,C+=d.h.i.decode(y[oe],{stream:!(te&&oe==V-1)});return y.length=0,d.h.g+=C,d.C=0,d.h.g}function Vt(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function yc(d,y){var C=d.C,V=y.indexOf(`
`,C);return V==-1?Es:(C=Number(y.substring(C,V)),isNaN(C)?_i:(V+=1,V+C>y.length?Es:(y=y.slice(V,V+C),d.C=V+C,y)))}rs.prototype.cancel=function(){this.K=!0,ws(this)};function Ar(d){d.T=Date.now()+d.H,As(d,d.H)}function As(d,y){if(d.D!=null)throw Error("WatchDog timer not null");d.D=ys(m(d.aa,d),y)}function Ns(d){d.D&&(f.clearTimeout(d.D),d.D=null)}rs.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(yi(this.i,this.B),this.M!=2&&(ss(),It(17)),ws(this),this.m=2,Nr(this)):As(this,this.T-d)};function Nr(d){d.j.I==0||d.K||Vo(d.j,d)}function ws(d){Ns(d);var y=d.O;y&&typeof y.dispose=="function"&&y.dispose(),d.O=null,K(d.V),d.g&&(y=d.g,d.g=null,y.abort(),y.dispose())}function bi(d,y){try{var C=d.j;if(C.I!=0&&(C.g==d||jr(C.h,d))){if(!d.L&&jr(C.h,d)&&C.I==3){try{var V=C.Ba.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var te=V;if(te[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<d.F)Ti(C),Cs(C);else break e;Fo(C),It(18)}}else C.xa=te[1],0<C.xa-C.K&&te[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=ys(m(C.Va,C),6e3));$n(C.h)<=1&&C.ta&&(C.ta=void 0)}else Qs(C,11)}else if((d.L||C.g==d)&&Ti(C),!B(y))for(te=C.Ba.g.parse(y),y=0;y<te.length;y++){let ft=te[y];const Ut=ft[0];if(!(Ut<=C.K))if(C.K=Ut,ft=ft[1],C.I==2)if(ft[0]=="c"){C.M=ft[1],C.ba=ft[2];const On=ft[3];On!=null&&(C.ka=On,C.j.info("VER="+C.ka));const js=ft[4];js!=null&&(C.za=js,C.j.info("SVER="+C.za));const ls=ft[5];ls!=null&&typeof ls=="number"&&ls>0&&(V=1.5*ls,C.O=V,C.j.info("backChannelRequestTimeoutMs_="+V)),V=C;const cs=d.g;if(cs){const us=cs.g?cs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(us){var oe=V.h;oe.g||us.indexOf("spdy")==-1&&us.indexOf("quic")==-1&&us.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(Ei(oe,oe.h),oe.h=null))}if(V.G){const zo=cs.g?cs.g.getResponseHeader("X-HTTP-Session-Id"):null;zo&&(V.wa=zo,yt(V.J,V.G,zo))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-d.F,C.j.info("Handshake RTT: "+C.T+"ms")),V=C;var Ee=d;if(V.na=Dc(V,V.L?V.ba:null,V.W),Ee.L){$s(V.h,Ee);var $e=Ee,jt=V.O;jt&&($e.H=jt),$e.D&&(Ns($e),Ar($e)),V.g=Ee}else Cc(V);C.i.length>0&&Vr(C)}else ft[0]!="stop"&&ft[0]!="close"||Qs(C,7);else C.I==3&&(ft[0]=="stop"||ft[0]=="close"?ft[0]=="stop"?Qs(C,7):Fr(C):ft[0]!="noop"&&C.l&&C.l.qa(ft),C.A=0)}}ss(4)}catch{}}var _h=class{constructor(d,y){this.g=d,this.map=y}};function wr(d){this.l=d||10,f.PerformanceNavigationTiming?(d=f.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Cr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function $n(d){return d.h?1:d.g?d.g.size:0}function jr(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function Ei(d,y){d.g?d.g.add(y):d.h=y}function $s(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}wr.prototype.cancel=function(){if(this.i=Si(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Si(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const C of d.g.values())y=y.concat(C.G);return y}return I(d.i)}var Ai=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bh(d,y){if(d){d=d.split("&");for(let C=0;C<d.length;C++){const V=d[C].indexOf("=");let te,oe=null;V>=0?(te=d[C].substring(0,V),oe=d[C].substring(V+1)):te=d[C],y(te,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function is(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;d instanceof is?(this.l=d.l,Sa(this,d.j),this.o=d.o,this.g=d.g,Tr(this,d.u),this.h=d.h,Aa(this,Sc(d.i)),this.m=d.m):d&&(y=String(d).match(Ai))?(this.l=!1,Sa(this,y[1]||"",!0),this.o=Rr(y[2]||""),this.g=Rr(y[3]||"",!0),Tr(this,y[4]),this.h=Rr(y[5]||"",!0),Aa(this,y[6]||"",!0),this.m=Rr(y[7]||"")):(this.l=!1,this.i=new Gn(null,this.l))}is.prototype.toString=function(){const d=[];var y=this.j;y&&d.push(sn(y,Do,!0),":");var C=this.g;return(C||y=="file")&&(d.push("//"),(y=this.o)&&d.push(sn(y,Do,!0),"@"),d.push(Hs(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&d.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&d.push("/"),d.push(sn(C,C.charAt(0)=="/"?Na:Io,!0))),(C=this.i.toString())&&d.push("?",C),(C=this.m)&&d.push("#",sn(C,bc)),d.join("")},is.prototype.resolve=function(d){const y=Ot(this);let C=!!d.j;C?Sa(y,d.j):C=!!d.o,C?y.o=d.o:C=!!d.g,C?y.g=d.g:C=d.u!=null;var V=d.h;if(C)Tr(y,d.u);else if(C=!!d.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var te=y.h.lastIndexOf("/");te!=-1&&(V=y.h.slice(0,te+1)+V)}if(te=V,te==".."||te==".")V="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){V=te.lastIndexOf("/",0)==0,te=te.split("/");const oe=[];for(let Ee=0;Ee<te.length;){const $e=te[Ee++];$e=="."?V&&Ee==te.length&&oe.push(""):$e==".."?((oe.length>1||oe.length==1&&oe[0]!="")&&oe.pop(),V&&Ee==te.length&&oe.push("")):(oe.push($e),V=!0)}V=oe.join("/")}else V=te}return C?y.h=V:C=d.i.toString()!=="",C?Aa(y,Sc(d.i)):C=!!d.m,C&&(y.m=d.m),y};function Ot(d){return new is(d)}function Sa(d,y,C){d.j=C?Rr(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function Tr(d,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);d.u=y}else d.u=null}function Aa(d,y,C){y instanceof Gn?(d.i=y,Oo(d.i,d.l)):(C||(y=sn(y,_c)),d.i=new Gn(y,d.l))}function yt(d,y,C){d.i.set(y,C)}function Gs(d){return yt(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Rr(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function sn(d,y,C){return typeof d=="string"?(d=encodeURI(d).replace(y,Ro),C&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Ro(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Do=/[#\/\?@]/g,Io=/[#\?:]/g,Na=/[#\?]/g,_c=/[#\?@]/g,bc=/#/g;function Gn(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function Ks(d){d.g||(d.g=new Map,d.h=0,d.i&&bh(d.i,function(y,C){d.add(decodeURIComponent(y.replace(/\+/g," ")),C)}))}i=Gn.prototype,i.add=function(d,y){Ks(this),this.i=null,d=os(this,d);let C=this.g.get(d);return C||this.g.set(d,C=[]),C.push(y),this.h+=1,this};function ko(d,y){Ks(d),y=os(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function Po(d,y){return Ks(d),y=os(d,y),d.g.has(y)}i.forEach=function(d,y){Ks(this),this.g.forEach(function(C,V){C.forEach(function(te){d.call(y,te,V,this)},this)},this)};function Ni(d,y){Ks(d);let C=[];if(typeof y=="string")Po(d,y)&&(C=C.concat(d.g.get(os(d,y))));else for(d=Array.from(d.g.values()),y=0;y<d.length;y++)C=C.concat(d[y]);return C}i.set=function(d,y){return Ks(this),this.i=null,d=os(this,d),Po(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},i.get=function(d,y){return d?(d=Ni(this,d),d.length>0?String(d[0]):y):y};function Ec(d,y,C){ko(d,y),C.length>0&&(d.i=null,d.g.set(os(d,y),I(C)),d.h+=C.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(let V=0;V<y.length;V++){var C=y[V];const te=Hs(C);C=Ni(this,C);for(let oe=0;oe<C.length;oe++){let Ee=te;C[oe]!==""&&(Ee+="="+Hs(C[oe])),d.push(Ee)}}return this.i=d.join("&")};function Sc(d){const y=new Gn;return y.i=d.i,d.g&&(y.g=new Map(d.g),y.h=d.h),y}function os(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function Oo(d,y){y&&!d.j&&(Ks(d),d.i=null,d.g.forEach(function(C,V){const te=V.toLowerCase();V!=te&&(ko(this,V),Ec(this,te,C))},d)),d.j=y}function Bo(d,y){const C=new _s;if(f.Image){const V=new Image;V.onload=v(An,C,"TestLoadImage: loaded",!0,y,V),V.onerror=v(An,C,"TestLoadImage: error",!1,y,V),V.onabort=v(An,C,"TestLoadImage: abort",!1,y,V),V.ontimeout=v(An,C,"TestLoadImage: timeout",!1,y,V),f.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=d}else y(!1)}function wa(d,y){const C=new _s,V=new AbortController,te=setTimeout(()=>{V.abort(),An(C,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:V.signal}).then(oe=>{clearTimeout(te),oe.ok?An(C,"TestPingServer: ok",!0,y):An(C,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(te),An(C,"TestPingServer: error",!1,y)})}function An(d,y,C,V,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),V(C)}catch{}}function Ac(){this.g=new Ne}function Dr(d){this.i=d.Sb||null,this.h=d.ab||!1}b(Dr,Se),Dr.prototype.g=function(){return new Ir(this.i,this.h)};function Ir(d,y){je.call(this),this.H=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(Ir,je),i=Ir.prototype,i.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=y,this.readyState=1,Ys(this)},i.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(y.body=d),(this.H||f).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Nn(this)),this.readyState=0},i.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ys(this)),this.g&&(this.readyState=3,Ys(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ca(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ca(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}i.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Nn(this):Ys(this),this.readyState==3&&Ca(this)}},i.Oa=function(d){this.g&&(this.response=this.responseText=d,Nn(this))},i.Na=function(d){this.g&&(this.response=d,Nn(this))},i.ga=function(){this.g&&Nn(this)};function Nn(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Ys(d)}i.setRequestHeader=function(d,y){this.A.append(d,y)},i.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var C=y.next();!C.done;)C=C.value,d.push(C[0]+": "+C[1]),C=y.next();return d.join(`\r
`)};function Ys(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ir.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function ja(d){let y="";return Ce(d,function(C,V){y+=V,y+=":",y+=C,y+=`\r
`}),y}function Kn(d,y,C){e:{for(V in C){var V=!1;break e}V=!0}V||(C=ja(C),typeof d=="string"?C!=null&&Hs(C):yt(d,y,C))}function wt(d){je.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(wt,je);var wi=/^https?$/i,Nc=["POST","PUT"];i=wt.prototype,i.Fa=function(d){this.H=d},i.ea=function(d,y,C,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():nn.g(),this.g.onreadystatechange=S(m(this.Ca,this));try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(oe){kr(this,oe);return}if(d=C||"",C=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var te in V)C.set(te,V[te]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const oe of V.keys())C.set(oe,V.get(oe));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(C.keys()).find(oe=>oe.toLowerCase()=="content-type"),te=f.FormData&&d instanceof f.FormData,!(Array.prototype.indexOf.call(Nc,y,void 0)>=0)||V||te||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Ee]of C)this.g.setRequestHeader(oe,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(oe){kr(this,oe)}};function kr(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.o=5,Pr(d),Wt(d)}function Pr(d){d.A||(d.A=!0,ge(d,"complete"),ge(d,"error"))}i.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,ge(this,"complete"),ge(this,"abort"),Wt(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wt(this,!0)),wt.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Mo(this):this.Xa())},i.Xa=function(){Mo(this)};function Mo(d){if(d.h&&typeof u<"u"){if(d.v&&gn(d)==4)setTimeout(d.Ca.bind(d),0);else if(ge(d,"readystatechange"),gn(d)==4){d.h=!1;try{const oe=d.ca();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var C;if(!(C=y)){var V;if(V=oe===0){let Ee=String(d.D).match(Ai)[1]||null;!Ee&&f.self&&f.self.location&&(Ee=f.self.location.protocol.slice(0,-1)),V=!wi.test(Ee?Ee.toLowerCase():"")}C=V}if(C)ge(d,"complete"),ge(d,"success");else{d.o=6;try{var te=gn(d)>2?d.g.statusText:""}catch{te=""}d.l=te+" ["+d.ca()+"]",Pr(d)}}finally{Wt(d)}}}}function Wt(d,y){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const C=d.g;d.g=null,y||ge(d,"ready");try{C.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function gn(d){return d.g?d.g.readyState:0}i.ca=function(){try{return gn(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),le(y)}};function Or(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Br(d){const y={};d=(d.g&&gn(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<d.length;V++){if(B(d[V]))continue;var C=yh(d[V]);const te=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const oe=y[te]||[];y[te]=oe,oe.push(C)}H(y,function(V){return V.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mr(d,y,C){return C&&C.internalChannelParams&&C.internalChannelParams[d]||y}function Ci(d){this.za=0,this.i=[],this.j=new _s,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Mr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Mr("baseRetryDelayMs",5e3,d),this.Za=Mr("retryDelaySeedMs",1e4,d),this.Ta=Mr("forwardChannelMaxRetries",2,d),this.va=Mr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new wr(d&&d.concurrentRequestLimit),this.Ba=new Ac,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Ci.prototype,i.ka=8,i.I=1,i.connect=function(d,y,C,V){It(0),this.W=d,this.H=y||{},C&&V!==void 0&&(this.H.OSID=C,this.H.OAID=V),this.F=this.X,this.J=Dc(this,null,this.W),Vr(this)};function Fr(d){if(Lr(d),d.I==3){var y=d.V++,C=Ot(d.J);if(yt(C,"SID",d.M),yt(C,"RID",y),yt(C,"TYPE","terminate"),Ur(d,C),y=new rs(d,d.j,y),y.M=2,y.A=Gs(Ot(C)),C=!1,f.navigator&&f.navigator.sendBeacon)try{C=f.navigator.sendBeacon(y.A.toString(),"")}catch{}!C&&f.Image&&(new Image().src=y.A,C=!0),C||(y.g=Ri(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Ar(y)}Rc(d)}function Cs(d){d.g&&(Lo(d),d.g.cancel(),d.g=null)}function Lr(d){Cs(d),d.v&&(f.clearTimeout(d.v),d.v=null),Ti(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&f.clearTimeout(d.m),d.m=null)}function Vr(d){if(!Cr(d.h)&&!d.m){d.m=!0;var y=d.Ea;F||_(),P||(F(),P=!0),E.add(y,d),d.D=0}}function Eh(d,y){return $n(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=y.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=ys(m(d.Ea,d,y),Tc(d,d.D)),d.D++,!0)}i.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const te=new rs(this,this.j,d);let oe=this.o;if(this.U&&(oe?(oe=G(oe),W(oe,this.U)):oe=this.U),this.u!==null||this.R||(te.J=oe,oe=null),this.S)e:{for(var y=0,C=0;C<this.i.length;C++){t:{var V=this.i[C];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,y>4096){y=C;break e}if(y===4096||C===this.i.length-1){y=C+1;break e}}y=1e3}else y=1e3;y=ji(this,te,y),C=Ot(this.J),yt(C,"RID",d),yt(C,"CVER",22),this.G&&yt(C,"X-HTTP-Session-Id",this.G),Ur(this,C),oe&&(this.R?y="headers="+Hs(ja(oe))+"&"+y:this.u&&Kn(C,this.u,oe)),Ei(this.h,te),this.Ra&&yt(C,"TYPE","init"),this.S?(yt(C,"$req",y),yt(C,"SID","null"),te.U=!0,Ss(te,C,null)):Ss(te,C,y),this.I=2}}else this.I==3&&(d?wc(this,d):this.i.length==0||Cr(this.h)||wc(this))};function wc(d,y){var C;y?C=y.l:C=d.V++;const V=Ot(d.J);yt(V,"SID",d.M),yt(V,"RID",C),yt(V,"AID",d.K),Ur(d,V),d.u&&d.o&&Kn(V,d.u,d.o),C=new rs(d,d.j,C,d.D+1),d.u===null&&(C.J=d.o),y&&(d.i=y.G.concat(d.i)),y=ji(d,C,1e3),C.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Ei(d.h,C),Ss(C,V,y)}function Ur(d,y){d.H&&Ce(d.H,function(C,V){yt(y,V,C)}),d.l&&Ce({},function(C,V){yt(y,V,C)})}function ji(d,y,C){C=Math.min(d.i.length,C);const V=d.l?m(d.l.Ka,d.l,d):null;e:{var te=d.i;let $e=-1;for(;;){const jt=["count="+C];$e==-1?C>0?($e=te[0].g,jt.push("ofs="+$e)):$e=0:jt.push("ofs="+$e);let ft=!0;for(let Ut=0;Ut<C;Ut++){var oe=te[Ut].g;const On=te[Ut].map;if(oe-=$e,oe<0)$e=Math.max(0,te[Ut].g-100),ft=!1;else try{oe="req"+oe+"_"||"";try{var Ee=On instanceof Map?On:Object.entries(On);for(const[js,ls]of Ee){let cs=ls;p(ls)&&(cs=ie(ls)),jt.push(oe+js+"="+encodeURIComponent(cs))}}catch(js){throw jt.push(oe+"type="+encodeURIComponent("_badmap")),js}}catch{V&&V(On)}}if(ft){Ee=jt.join("&");break e}}Ee=void 0}return d=d.i.splice(0,C),y.G=d,Ee}function Cc(d){if(!d.g&&!d.v){d.Y=1;var y=d.Da;F||_(),P||(F(),P=!0),E.add(y,d),d.A=0}}function Fo(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=ys(m(d.Da,d),Tc(d,d.A)),d.A++,!0)}i.Da=function(){if(this.v=null,jc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=ys(m(this.Wa,this),d)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),Cs(this),jc(this))};function Lo(d){d.B!=null&&(f.clearTimeout(d.B),d.B=null)}function jc(d){d.g=new rs(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var y=Ot(d.na);yt(y,"RID","rpc"),yt(y,"SID",d.M),yt(y,"AID",d.K),yt(y,"CI",d.F?"0":"1"),!d.F&&d.ia&&yt(y,"TO",d.ia),yt(y,"TYPE","xmlhttp"),Ur(d,y),d.u&&d.o&&Kn(y,d.u,d.o),d.O&&(d.g.H=d.O);var C=d.g;d=d.ba,C.M=1,C.A=Gs(Ot(y)),C.u=null,C.R=!0,ba(C,d)}i.Va=function(){this.C!=null&&(this.C=null,Cs(this),Fo(this),It(19))};function Ti(d){d.C!=null&&(f.clearTimeout(d.C),d.C=null)}function Vo(d,y){var C=null;if(d.g==y){Ti(d),Lo(d),d.g=null;var V=2}else if(jr(d.h,y))C=y.G,$s(d.h,y),V=1;else return;if(d.I!=0){if(y.o)if(V==1){C=y.u?y.u.length:0,y=Date.now()-y.F;var te=d.D;V=qs(),ge(V,new vi(V,C)),Vr(d)}else Cc(d);else if(te=y.m,te==3||te==0&&y.X>0||!(V==1&&Eh(d,y)||V==2&&Fo(d)))switch(C&&C.length>0&&(y=d.h,y.i=y.i.concat(C)),te){case 1:Qs(d,5);break;case 4:Qs(d,10);break;case 3:Qs(d,6);break;default:Qs(d,2)}}}function Tc(d,y){let C=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(C*=2),C*y}function Qs(d,y){if(d.j.info("Error code "+y),y==2){var C=m(d.bb,d),V=d.Ua;const te=!V;V=new is(V||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Sa(V,"https"),Gs(V),te?Bo(V.toString(),C):wa(V.toString(),C)}else It(2);d.I=0,d.l&&d.l.pa(y),Rc(d),Lr(d)}i.bb=function(d){d?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Rc(d){if(d.I=0,d.ja=[],d.l){const y=Si(d.h);(y.length!=0||d.i.length!=0)&&(R(d.ja,y),R(d.ja,d.i),d.h.i.length=0,I(d.i),d.i.length=0),d.l.oa()}}function Dc(d,y,C){var V=C instanceof is?Ot(C):new is(C);if(V.g!="")y&&(V.g=y+"."+V.g),Tr(V,V.u);else{var te=f.location;V=te.protocol,y=y?y+"."+te.hostname:te.hostname,te=+te.port;const oe=new is(null);V&&Sa(oe,V),y&&(oe.g=y),te&&Tr(oe,te),C&&(oe.h=C),V=oe}return C=d.G,y=d.wa,C&&y&&yt(V,C,y),yt(V,"VER",d.ka),Ur(d,V),V}function Ri(d,y,C){if(y&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Aa&&!d.ma?new wt(new Dr({ab:C})):new wt(d.ma),y.Fa(d.L),y}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ic(){}i=Ic.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Di(){}Di.prototype.g=function(d,y){return new wn(d,y)};function wn(d,y){je.call(this),this.g=new Ci(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(d?d["X-WebChannel-Client-Profile"]=y.sa:d={"X-WebChannel-Client-Profile":y.sa}),this.g.U=d,(d=y&&y.Qb)&&!B(d)&&(this.g.u=d),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!B(y)&&(this.g.G=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Ta(this)}b(wn,je),wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Fr(this.g)},wn.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var C={};C.__data__=d,d=C}else this.v&&(C={},C.__data__=ie(d),d=C);y.i.push(new _h(y.Ya++,d)),y.I==3&&Vr(y)},wn.prototype.N=function(){this.g.l=null,delete this.j,Fr(this.g),delete this.g,wn.Z.N.call(this)};function Uo(d){Xt.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const C in y){d=C;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}b(Uo,Xt);function kc(){jn.call(this),this.status=1}b(kc,jn);function Ta(d){this.g=d}b(Ta,Ic),Ta.prototype.ra=function(){ge(this.g,"a")},Ta.prototype.qa=function(d){ge(this.g,new Uo(d))},Ta.prototype.pa=function(d){ge(this.g,new kc)},Ta.prototype.oa=function(){ge(this.g,"b")},Di.prototype.createWebChannel=Di.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,a_=function(){return new Di},s_=function(){return qs()},n_=Tn,U0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},kt.NO_ERROR=0,kt.TIMEOUT=8,kt.HTTP_ERROR=6,Ed=kt,ut.COMPLETE="complete",t_=ut,xt.EventType=vt,vt.OPEN="a",vt.CLOSE="b",vt.ERROR="c",vt.MESSAGE="d",je.prototype.listen=je.prototype.J,Fl=xt,wt.prototype.listenOnce=wt.prototype.K,wt.prototype.getLastError=wt.prototype.Ha,wt.prototype.getLastErrorCode=wt.prototype.ya,wt.prototype.getStatus=wt.prototype.ca,wt.prototype.getResponseJson=wt.prototype.La,wt.prototype.getResponseText=wt.prototype.la,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Fa,e_=wt}).apply(typeof Pu<"u"?Pu:typeof self<"u"?self:typeof window<"u"?window:{});const _y="@firebase/firestore",by="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_n.UNAUTHENTICATED=new _n(null),_n.GOOGLE_CREDENTIALS=new _n("google-credentials-uid"),_n.FIRST_PARTY=new _n("first-party-uid"),_n.MOCK_USER=new _n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let No="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new hm("@firebase/firestore");function io(){return ci.logLevel}function Te(i,...e){if(ci.logLevel<=et.DEBUG){const n=e.map(pm);ci.debug(`Firestore (${No}): ${i}`,...n)}}function ma(i,...e){if(ci.logLevel<=et.ERROR){const n=e.map(pm);ci.error(`Firestore (${No}): ${i}`,...n)}}function xo(i,...e){if(ci.logLevel<=et.WARN){const n=e.map(pm);ci.warn(`Firestore (${No}): ${i}`,...n)}}function pm(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(n){return JSON.stringify(n)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(i,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,r_(i,r,n)}function r_(i,e,n){let r=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ma(r),new Error(r)}function ht(i,e,n,r){let l="Unexpected state";typeof n=="string"?l=n:r=n,i||r_(e,l,r)}function Ge(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends xa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(_n.UNAUTHENTICATED)))}shutdown(){}}class dC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class hC{constructor(e){this.t=e,this.currentUser=_n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ht(this.o===void 0,42304);let r=this.i;const l=x=>this.i!==r?(r=this.i,n(x)):Promise.resolve();let u=new lr;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new lr,e.enqueueRetryable((()=>l(this.currentUser)))};const f=()=>{const x=u;e.enqueueRetryable((async()=>{await x.promise,await l(this.currentUser)}))},p=x=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),f())};this.t.onInit((x=>p(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?p(x):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new lr)}}),0),f()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ht(typeof r.accessToken=="string",31837,{l:r}),new i_(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ht(e===null||typeof e=="string",2055,{h:e}),new _n(e)}}class fC{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=_n.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mC{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new fC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(_n.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ey{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ts(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ht(this.o===void 0,3512);const r=u=>{u.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const f=u.token!==this.m;return this.m=u.token,Te("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?n(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>r(u)))};const l=u=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Ey(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ht(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Ey(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<i;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const l=gC(40);for(let u=0;u<l.length;++u)r.length<20&&l[u]<n&&(r+=e.charAt(l[u]%62))}return r}}function tt(i,e){return i<e?-1:i>e?1:0}function z0(i,e){const n=Math.min(i.length,e.length);for(let r=0;r<n;r++){const l=i.charAt(r),u=e.charAt(r);if(l!==u)return w0(l)===w0(u)?tt(l,u):w0(l)?1:-1}return tt(i.length,e.length)}const xC=55296,vC=57343;function w0(i){const e=i.charCodeAt(0);return e>=xC&&e<=vC}function vo(i,e,n){return i.length===e.length&&i.every(((r,l)=>n(r,e[l])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="__name__";class Ps{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ve(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ve(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ps.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ps?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let l=0;l<r;l++){const u=Ps.compareSegments(e.get(l),n.get(l));if(u!==0)return u}return tt(e.length,n.length)}static compareSegments(e,n){const r=Ps.isNumericId(e),l=Ps.isNumericId(n);return r&&!l?-1:!r&&l?1:r&&l?Ps.extractNumericId(e).compare(Ps.extractNumericId(n)):z0(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return or.fromString(e.substring(4,e.length-2))}}class Tt extends Ps{construct(e,n,r){return new Tt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new De(xe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((l=>l.length>0)))}return new Tt(n)}static emptyPath(){return new Tt([])}}const yC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mn extends Ps{construct(e,n,r){return new mn(e,n,r)}static isValidIdentifier(e){return yC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Sy}static keyField(){return new mn([Sy])}static fromServerFormat(e){const n=[];let r="",l=0;const u=()=>{if(r.length===0)throw new De(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let f=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new De(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[l+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new De(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=x,l+=2}else p==="`"?(f=!f,l++):p!=="."||f?(r+=p,l++):(u(),l++)}if(u(),f)throw new De(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mn(n)}static emptyPath(){return new mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(Tt.fromString(e))}static fromName(e){return new Pe(Tt.fromString(e).popFirst(5))}static empty(){return new Pe(Tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Tt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new Tt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(i,e,n){if(!n)throw new De(xe.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function _C(i,e,n,r){if(e===!0&&r===!0)throw new De(xe.INVALID_ARGUMENT,`${i} and ${n} cannot be used together.`)}function Ay(i){if(!Pe.isDocumentKey(i))throw new De(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Ny(i){if(Pe.isDocumentKey(i))throw new De(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function l_(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function xm(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Ve(12329,{type:typeof i})}function ur(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new De(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xm(i);throw new De(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(i,e){const n={typeString:i};return e&&(n.value=e),n}function cc(i,e){if(!l_(i))throw new De(xe.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const l=e[r].typeString,u="value"in e[r]?{value:e[r].value}:void 0;if(!(r in i)){n=`JSON missing required field: '${r}'`;break}const f=i[r];if(l&&typeof f!==l){n=`JSON field '${r}' must be a ${l}.`;break}if(u!==void 0&&f!==u.value){n=`Expected '${r}' field to equal '${u.value}'`;break}}if(n)throw new De(xe.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy=-62135596800,Cy=1e6;class Rt{static now(){return Rt.fromMillis(Date.now())}static fromDate(e){return Rt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Cy);return new Rt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new De(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new De(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<wy)throw new De(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Cy}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cc(e,Rt._jsonSchema))return new Rt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rt._jsonSchemaVersion="firestore/timestamp/1.0",Rt._jsonSchema={type:Yt("string",Rt._jsonSchemaVersion),seconds:Yt("number"),nanoseconds:Yt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{static fromTimestamp(e){return new He(e)}static min(){return new He(new Rt(0,0))}static max(){return new He(new Rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl=-1;function bC(i,e){const n=i.toTimestamp().seconds,r=i.toTimestamp().nanoseconds+1,l=He.fromTimestamp(r===1e9?new Rt(n+1,0):new Rt(n,r));return new dr(l,Pe.empty(),e)}function EC(i){return new dr(i.readTime,i.key,Jl)}class dr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new dr(He.min(),Pe.empty(),Jl)}static max(){return new dr(He.max(),Pe.empty(),Jl)}}function SC(i,e){let n=i.readTime.compareTo(e.readTime);return n!==0?n:(n=Pe.comparator(i.documentKey,e.documentKey),n!==0?n:tt(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(i){if(i.code!==xe.FAILED_PRECONDITION||i.message!==AC)throw i;Te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new me(((r,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(r,l)},this.catchCallback=u=>{this.wrapFailure(n,u).next(r,l)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof me?n:me.resolve(n)}catch(n){return me.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):me.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):me.reject(n)}static resolve(e){return new me(((n,r)=>{n(e)}))}static reject(e){return new me(((n,r)=>{r(e)}))}static waitFor(e){return new me(((n,r)=>{let l=0,u=0,f=!1;e.forEach((p=>{++l,p.next((()=>{++u,f&&u===l&&n()}),(x=>r(x)))})),f=!0,u===l&&n()}))}static or(e){let n=me.resolve(!1);for(const r of e)n=n.next((l=>l?me.resolve(l):r()));return n}static forEach(e,n){const r=[];return e.forEach(((l,u)=>{r.push(n.call(this,l,u))})),this.waitFor(r)}static mapArray(e,n){return new me(((r,l)=>{const u=e.length,f=new Array(u);let p=0;for(let x=0;x<u;x++){const m=x;n(e[m]).next((v=>{f[m]=v,++p,p===u&&r(f)}),(v=>l(v)))}}))}static doWhile(e,n){return new me(((r,l)=>{const u=()=>{e()===!0?n().next((()=>{u()}),l):r()};u()}))}}function wC(i){const e=i.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Co(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}eh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm=-1;function th(i){return i==null}function Pd(i){return i===0&&1/i==-1/0}function CC(i){return typeof i=="number"&&Number.isInteger(i)&&!Pd(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="";function jC(i){let e="";for(let n=0;n<i.length;n++)e.length>0&&(e=jy(e)),e=TC(i.get(n),e);return jy(e)}function TC(i,e){let n=e;const r=i.length;for(let l=0;l<r;l++){const u=i.charAt(l);switch(u){case"\0":n+="";break;case c_:n+="";break;default:n+=u}}return n}function jy(i){return i+c_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(i){let e=0;for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&e++;return e}function vr(i,e){for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&e(n,i[n])}function u_(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,n){this.comparator=e,this.root=n||fn.EMPTY}insert(e,n){return new Mt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new Mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const l=this.comparator(e,r.key);if(l===0)return n+r.left.size;l<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ou(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ou(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ou(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ou(this.root,e,this.comparator,!0)}}class Ou{constructor(e,n,r,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=n?r(e.key,n):1,n&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fn{constructor(e,n,r,l,u){this.key=e,this.value=n,this.color=r??fn.RED,this.left=l??fn.EMPTY,this.right=u??fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,l,u){return new fn(e??this.key,n??this.value,r??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let l=this;const u=r(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,n,r),null):u===0?l.copy(null,n,null,null,null):l.copy(null,null,null,null,l.right.insert(e,n,r)),l.fixUp()}removeMin(){if(this.left.isEmpty())return fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,l=this;if(n(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,n),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),n(e,l.key)===0){if(l.right.isEmpty())return fn.EMPTY;r=l.right.min(),l=l.copy(r.key,r.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,n))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}fn.EMPTY=null,fn.RED=!0,fn.BLACK=!1;fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,n,r,l,u){return this}insert(e,n,r){return new fn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const l=r.getNext();if(this.comparator(l.key,e[1])>=0)return;n(l.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ry(this.data.getIterator())}getIteratorFrom(e){return new Ry(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof tn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=r.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new tn(this.comparator);return n.data=e,n}}class Ry{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.fields=e,e.sort(mn.comparator)}static empty(){return new qn([])}unionWith(e){let n=new tn(mn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vo(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new d_("Invalid base64 string: "+u):u}})(e);return new pn(n)}static fromUint8Array(e){const n=(function(l){let u="";for(let f=0;f<l.length;++f)u+=String.fromCharCode(l[f]);return u})(e);return new pn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let l=0;l<n.length;l++)r[l]=n.charCodeAt(l);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pn.EMPTY_BYTE_STRING=new pn("");const RC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hr(i){if(ht(!!i,39018),typeof i=="string"){let e=0;const n=RC.exec(i);if(ht(!!n,46558,{timestamp:i}),n[1]){let l=n[1];l=(l+"000000000").substr(0,9),e=Number(l)}const r=new Date(i);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ht(i.seconds),nanos:Ht(i.nanos)}}function Ht(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function fr(i){return typeof i=="string"?pn.fromBase64String(i):pn.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_="server_timestamp",f_="__type__",m_="__previous_value__",p_="__local_write_time__";function ym(i){return(i?.mapValue?.fields||{})[f_]?.stringValue===h_}function nh(i){const e=i.mapValue.fields[m_];return ym(e)?nh(e):e}function ec(i){const e=hr(i.mapValue.fields[p_].timestampValue);return new Rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n,r,l,u,f,p,x,m,v){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=l,this.ssl=u,this.forceLongPolling=f,this.autoDetectLongPolling=p,this.longPollingOptions=x,this.useFetchStreams=m,this.isUsingEmulator=v}}const Od="(default)";class tc{constructor(e,n){this.projectId=e,this.database=n||Od}static empty(){return new tc("","")}get isDefaultDatabase(){return this.database===Od}isEqual(e){return e instanceof tc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="__type__",IC="__max__",Bu={mapValue:{}},x_="__vector__",Bd="value";function mr(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?ym(i)?4:PC(i)?9007199254740991:kC(i)?10:11:Ve(28295,{value:i})}function Us(i,e){if(i===e)return!0;const n=mr(i);if(n!==mr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return ec(i).isEqual(ec(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const f=hr(l.timestampValue),p=hr(u.timestampValue);return f.seconds===p.seconds&&f.nanos===p.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(l,u){return fr(l.bytesValue).isEqual(fr(u.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(l,u){return Ht(l.geoPointValue.latitude)===Ht(u.geoPointValue.latitude)&&Ht(l.geoPointValue.longitude)===Ht(u.geoPointValue.longitude)})(i,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Ht(l.integerValue)===Ht(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const f=Ht(l.doubleValue),p=Ht(u.doubleValue);return f===p?Pd(f)===Pd(p):isNaN(f)&&isNaN(p)}return!1})(i,e);case 9:return vo(i.arrayValue.values||[],e.arrayValue.values||[],Us);case 10:case 11:return(function(l,u){const f=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Ty(f)!==Ty(p))return!1;for(const x in f)if(f.hasOwnProperty(x)&&(p[x]===void 0||!Us(f[x],p[x])))return!1;return!0})(i,e);default:return Ve(52216,{left:i})}}function nc(i,e){return(i.values||[]).find((n=>Us(n,e)))!==void 0}function yo(i,e){if(i===e)return 0;const n=mr(i),r=mr(e);if(n!==r)return tt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(i.booleanValue,e.booleanValue);case 2:return(function(u,f){const p=Ht(u.integerValue||u.doubleValue),x=Ht(f.integerValue||f.doubleValue);return p<x?-1:p>x?1:p===x?0:isNaN(p)?isNaN(x)?0:-1:1})(i,e);case 3:return Dy(i.timestampValue,e.timestampValue);case 4:return Dy(ec(i),ec(e));case 5:return z0(i.stringValue,e.stringValue);case 6:return(function(u,f){const p=fr(u),x=fr(f);return p.compareTo(x)})(i.bytesValue,e.bytesValue);case 7:return(function(u,f){const p=u.split("/"),x=f.split("/");for(let m=0;m<p.length&&m<x.length;m++){const v=tt(p[m],x[m]);if(v!==0)return v}return tt(p.length,x.length)})(i.referenceValue,e.referenceValue);case 8:return(function(u,f){const p=tt(Ht(u.latitude),Ht(f.latitude));return p!==0?p:tt(Ht(u.longitude),Ht(f.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return Iy(i.arrayValue,e.arrayValue);case 10:return(function(u,f){const p=u.fields||{},x=f.fields||{},m=p[Bd]?.arrayValue,v=x[Bd]?.arrayValue,b=tt(m?.values?.length||0,v?.values?.length||0);return b!==0?b:Iy(m,v)})(i.mapValue,e.mapValue);case 11:return(function(u,f){if(u===Bu.mapValue&&f===Bu.mapValue)return 0;if(u===Bu.mapValue)return 1;if(f===Bu.mapValue)return-1;const p=u.fields||{},x=Object.keys(p),m=f.fields||{},v=Object.keys(m);x.sort(),v.sort();for(let b=0;b<x.length&&b<v.length;++b){const S=z0(x[b],v[b]);if(S!==0)return S;const I=yo(p[x[b]],m[v[b]]);if(I!==0)return I}return tt(x.length,v.length)})(i.mapValue,e.mapValue);default:throw Ve(23264,{he:n})}}function Dy(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return tt(i,e);const n=hr(i),r=hr(e),l=tt(n.seconds,r.seconds);return l!==0?l:tt(n.nanos,r.nanos)}function Iy(i,e){const n=i.values||[],r=e.values||[];for(let l=0;l<n.length&&l<r.length;++l){const u=yo(n[l],r[l]);if(u)return u}return tt(n.length,r.length)}function _o(i){return q0(i)}function q0(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(n){const r=hr(n);return`time(${r.seconds},${r.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(n){return fr(n).toBase64()})(i.bytesValue):"referenceValue"in i?(function(n){return Pe.fromName(n).toString()})(i.referenceValue):"geoPointValue"in i?(function(n){return`geo(${n.latitude},${n.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(n){let r="[",l=!0;for(const u of n.values||[])l?l=!1:r+=",",r+=q0(u);return r+"]"})(i.arrayValue):"mapValue"in i?(function(n){const r=Object.keys(n.fields||{}).sort();let l="{",u=!0;for(const f of r)u?u=!1:l+=",",l+=`${f}:${q0(n.fields[f])}`;return l+"}"})(i.mapValue):Ve(61005,{value:i})}function Sd(i){switch(mr(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nh(i);return e?16+Sd(e):16;case 5:return 2*i.stringValue.length;case 6:return fr(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((l,u)=>l+Sd(u)),0)})(i.arrayValue);case 10:case 11:return(function(r){let l=0;return vr(r.fields,((u,f)=>{l+=u.length+Sd(f)})),l})(i.mapValue);default:throw Ve(13486,{value:i})}}function H0(i){return!!i&&"integerValue"in i}function _m(i){return!!i&&"arrayValue"in i}function ky(i){return!!i&&"nullValue"in i}function Py(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Ad(i){return!!i&&"mapValue"in i}function kC(i){return(i?.mapValue?.fields||{})[g_]?.stringValue===x_}function Hl(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return vr(i.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Hl(r))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(i.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Hl(i.arrayValue.values[n]);return e}return{...i}}function PC(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===IC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ad(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hl(n)}setAll(e){let n=mn.emptyPath(),r={},l=[];e.forEach(((f,p)=>{if(!n.isImmediateParentOf(p)){const x=this.getFieldsMap(n);this.applyChanges(x,r,l),r={},l=[],n=p.popLast()}f?r[p.lastSegment()]=Hl(f):l.push(p.lastSegment())}));const u=this.getFieldsMap(n);this.applyChanges(u,r,l)}delete(e){const n=this.field(e.popLast());Ad(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Us(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let l=n.mapValue.fields[e.get(r)];Ad(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=l),n=l}return n.mapValue.fields}applyChanges(e,n,r){vr(n,((l,u)=>e[l]=u));for(const l of r)delete e[l]}clone(){return new Pn(Hl(this.value))}}function v_(i){const e=[];return vr(i.fields,((n,r)=>{const l=new mn([n]);if(Ad(r)){const u=v_(r.mapValue).fields;if(u.length===0)e.push(l);else for(const f of u)e.push(l.child(f))}else e.push(l)})),new qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n,r,l,u,f,p){this.key=e,this.documentType=n,this.version=r,this.readTime=l,this.createTime=u,this.data=f,this.documentState=p}static newInvalidDocument(e){return new bn(e,0,He.min(),He.min(),He.min(),Pn.empty(),0)}static newFoundDocument(e,n,r,l){return new bn(e,1,n,He.min(),r,l,0)}static newNoDocument(e,n){return new bn(e,2,n,He.min(),He.min(),Pn.empty(),0)}static newUnknownDocument(e,n){return new bn(e,3,n,He.min(),He.min(),Pn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(He.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=He.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,n){this.position=e,this.inclusive=n}}function Oy(i,e,n){let r=0;for(let l=0;l<i.position.length;l++){const u=e[l],f=i.position[l];if(u.field.isKeyField()?r=Pe.comparator(Pe.fromName(f.referenceValue),n.key):r=yo(f,n.data.field(u.field)),u.dir==="desc"&&(r*=-1),r!==0)break}return r}function By(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let n=0;n<i.position.length;n++)if(!Us(i.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,n="asc"){this.field=e,this.dir=n}}function OC(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{}class en extends y_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new MC(e,n,r):n==="array-contains"?new VC(e,r):n==="in"?new UC(e,r):n==="not-in"?new zC(e,r):n==="array-contains-any"?new qC(e,r):new en(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new FC(e,r):new LC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(yo(n,this.value)):n!==null&&mr(this.value)===mr(n)&&this.matchesComparison(yo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zs extends y_{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new zs(e,n)}matches(e){return __(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function __(i){return i.op==="and"}function b_(i){return BC(i)&&__(i)}function BC(i){for(const e of i.filters)if(e instanceof zs)return!1;return!0}function $0(i){if(i instanceof en)return i.field.canonicalString()+i.op.toString()+_o(i.value);if(b_(i))return i.filters.map((e=>$0(e))).join(",");{const e=i.filters.map((n=>$0(n))).join(",");return`${i.op}(${e})`}}function E_(i,e){return i instanceof en?(function(r,l){return l instanceof en&&r.op===l.op&&r.field.isEqual(l.field)&&Us(r.value,l.value)})(i,e):i instanceof zs?(function(r,l){return l instanceof zs&&r.op===l.op&&r.filters.length===l.filters.length?r.filters.reduce(((u,f,p)=>u&&E_(f,l.filters[p])),!0):!1})(i,e):void Ve(19439)}function S_(i){return i instanceof en?(function(n){return`${n.field.canonicalString()} ${n.op} ${_o(n.value)}`})(i):i instanceof zs?(function(n){return n.op.toString()+" {"+n.getFilters().map(S_).join(" ,")+"}"})(i):"Filter"}class MC extends en{constructor(e,n,r){super(e,n,r),this.key=Pe.fromName(r.referenceValue)}matches(e){const n=Pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class FC extends en{constructor(e,n){super(e,"in",n),this.keys=A_("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class LC extends en{constructor(e,n){super(e,"not-in",n),this.keys=A_("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function A_(i,e){return(e.arrayValue?.values||[]).map((n=>Pe.fromName(n.referenceValue)))}class VC extends en{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return _m(n)&&nc(n.arrayValue,this.value)}}class UC extends en{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nc(this.value.arrayValue,n)}}class zC extends en{constructor(e,n){super(e,"not-in",n)}matches(e){if(nc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!nc(this.value.arrayValue,n)}}class qC extends en{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!_m(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>nc(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,n=null,r=[],l=[],u=null,f=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=l,this.limit=u,this.startAt=f,this.endAt=p,this.Te=null}}function My(i,e=null,n=[],r=[],l=null,u=null,f=null){return new HC(i,e,n,r,l,u,f)}function bm(i){const e=Ge(i);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>$0(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(u){return u.field.canonicalString()+u.dir})(r))).join(","),th(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>_o(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>_o(r))).join(",")),e.Te=n}return e.Te}function Em(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<i.orderBy.length;n++)if(!OC(i.orderBy[n],e.orderBy[n]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let n=0;n<i.filters.length;n++)if(!E_(i.filters[n],e.filters[n]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!By(i.startAt,e.startAt)&&By(i.endAt,e.endAt)}function G0(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n=null,r=[],l=[],u=null,f="F",p=null,x=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=l,this.limit=u,this.limitType=f,this.startAt=p,this.endAt=x,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function $C(i,e,n,r,l,u,f,p){return new sh(i,e,n,r,l,u,f,p)}function Sm(i){return new sh(i)}function Fy(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function GC(i){return i.collectionGroup!==null}function $l(i){const e=Ge(i);if(e.Ie===null){e.Ie=[];const n=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),n.add(u.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(f){let p=new tn(mn.comparator);return f.filters.forEach((x=>{x.getFlattenedFilters().forEach((m=>{m.isInequality()&&(p=p.add(m.field))}))})),p})(e).forEach((u=>{n.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Fd(u,r))})),n.has(mn.keyField().canonicalString())||e.Ie.push(new Fd(mn.keyField(),r))}return e.Ie}function Os(i){const e=Ge(i);return e.Ee||(e.Ee=KC(e,$l(i))),e.Ee}function KC(i,e){if(i.limitType==="F")return My(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Fd(l.field,u)}));const n=i.endAt?new Md(i.endAt.position,i.endAt.inclusive):null,r=i.startAt?new Md(i.startAt.position,i.startAt.inclusive):null;return My(i.path,i.collectionGroup,e,i.filters,i.limit,n,r)}}function K0(i,e,n){return new sh(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,n,i.startAt,i.endAt)}function ah(i,e){return Em(Os(i),Os(e))&&i.limitType===e.limitType}function N_(i){return`${bm(Os(i))}|lt:${i.limitType}`}function oo(i){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((l=>S_(l))).join(", ")}]`),th(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((l=>(function(f){return`${f.field.canonicalString()} (${f.dir})`})(l))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((l=>_o(l))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((l=>_o(l))).join(",")),`Target(${r})`})(Os(i))}; limitType=${i.limitType})`}function rh(i,e){return e.isFoundDocument()&&(function(r,l){const u=l.key.path;return r.collectionGroup!==null?l.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(u):Pe.isDocumentKey(r.path)?r.path.isEqual(u):r.path.isImmediateParentOf(u)})(i,e)&&(function(r,l){for(const u of $l(r))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(i,e)&&(function(r,l){for(const u of r.filters)if(!u.matches(l))return!1;return!0})(i,e)&&(function(r,l){return!(r.startAt&&!(function(f,p,x){const m=Oy(f,p,x);return f.inclusive?m<=0:m<0})(r.startAt,$l(r),l)||r.endAt&&!(function(f,p,x){const m=Oy(f,p,x);return f.inclusive?m>=0:m>0})(r.endAt,$l(r),l))})(i,e)}function YC(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function w_(i){return(e,n)=>{let r=!1;for(const l of $l(i)){const u=QC(l,e,n);if(u!==0)return u;r=r||l.field.isKeyField()}return 0}}function QC(i,e,n){const r=i.field.isKeyField()?Pe.comparator(e.key,n.key):(function(u,f,p){const x=f.data.field(u),m=p.data.field(u);return x!==null&&m!==null?yo(x,m):Ve(42886)})(i.field,e,n);switch(i.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[l,u]of r)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),l=this.inner[r];if(l===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,n]);l.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let l=0;l<r.length;l++)if(this.equalsFn(r[l][0],e))return r.length===1?delete this.inner[n]:r.splice(l,1),this.innerSize--,!0;return!1}forEach(e){vr(this.inner,((n,r)=>{for(const[l,u]of r)e(l,u)}))}isEmpty(){return u_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=new Mt(Pe.comparator);function pa(){return XC}const C_=new Mt(Pe.comparator);function Ll(...i){let e=C_;for(const n of i)e=e.insert(n.key,n);return e}function j_(i){let e=C_;return i.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function ri(){return Gl()}function T_(){return Gl()}function Gl(){return new pi((i=>i.toString()),((i,e)=>i.isEqual(e)))}const WC=new Mt(Pe.comparator),ZC=new tn(Pe.comparator);function nt(...i){let e=ZC;for(const n of i)e=e.add(n);return e}const JC=new tn(tt);function ej(){return JC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pd(e)?"-0":e}}function R_(i){return{integerValue:""+i}}function tj(i,e){return CC(e)?R_(e):Am(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(){this._=void 0}}function nj(i,e,n){return i instanceof Ld?(function(l,u){const f={fields:{[f_]:{stringValue:h_},[p_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ym(u)&&(u=nh(u)),u&&(f.fields[m_]=u),{mapValue:f}})(n,e):i instanceof sc?I_(i,e):i instanceof ac?k_(i,e):(function(l,u){const f=D_(l,u),p=Ly(f)+Ly(l.Ae);return H0(f)&&H0(l.Ae)?R_(p):Am(l.serializer,p)})(i,e)}function sj(i,e,n){return i instanceof sc?I_(i,e):i instanceof ac?k_(i,e):n}function D_(i,e){return i instanceof Vd?(function(r){return H0(r)||(function(u){return!!u&&"doubleValue"in u})(r)})(e)?e:{integerValue:0}:null}class Ld extends ih{}class sc extends ih{constructor(e){super(),this.elements=e}}function I_(i,e){const n=P_(e);for(const r of i.elements)n.some((l=>Us(l,r)))||n.push(r);return{arrayValue:{values:n}}}class ac extends ih{constructor(e){super(),this.elements=e}}function k_(i,e){let n=P_(e);for(const r of i.elements)n=n.filter((l=>!Us(l,r)));return{arrayValue:{values:n}}}class Vd extends ih{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Ly(i){return Ht(i.integerValue||i.doubleValue)}function P_(i){return _m(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function aj(i,e){return i.field.isEqual(e.field)&&(function(r,l){return r instanceof sc&&l instanceof sc||r instanceof ac&&l instanceof ac?vo(r.elements,l.elements,Us):r instanceof Vd&&l instanceof Vd?Us(r.Ae,l.Ae):r instanceof Ld&&l instanceof Ld})(i.transform,e.transform)}class rj{constructor(e,n){this.version=e,this.transformResults=n}}class gs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gs}static exists(e){return new gs(void 0,e)}static updateTime(e){return new gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nd(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class oh{}function O_(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new M_(i.key,gs.none()):new uc(i.key,i.data,gs.none());{const n=i.data,r=Pn.empty();let l=new tn(mn.comparator);for(let u of e.fields)if(!l.has(u)){let f=n.field(u);f===null&&u.length>1&&(u=u.popLast(),f=n.field(u)),f===null?r.delete(u):r.set(u,f),l=l.add(u)}return new yr(i.key,r,new qn(l.toArray()),gs.none())}}function ij(i,e,n){i instanceof uc?(function(l,u,f){const p=l.value.clone(),x=Uy(l.fieldTransforms,u,f.transformResults);p.setAll(x),u.convertToFoundDocument(f.version,p).setHasCommittedMutations()})(i,e,n):i instanceof yr?(function(l,u,f){if(!Nd(l.precondition,u))return void u.convertToUnknownDocument(f.version);const p=Uy(l.fieldTransforms,u,f.transformResults),x=u.data;x.setAll(B_(l)),x.setAll(p),u.convertToFoundDocument(f.version,x).setHasCommittedMutations()})(i,e,n):(function(l,u,f){u.convertToNoDocument(f.version).setHasCommittedMutations()})(0,e,n)}function Kl(i,e,n,r){return i instanceof uc?(function(u,f,p,x){if(!Nd(u.precondition,f))return p;const m=u.value.clone(),v=zy(u.fieldTransforms,x,f);return m.setAll(v),f.convertToFoundDocument(f.version,m).setHasLocalMutations(),null})(i,e,n,r):i instanceof yr?(function(u,f,p,x){if(!Nd(u.precondition,f))return p;const m=zy(u.fieldTransforms,x,f),v=f.data;return v.setAll(B_(u)),v.setAll(m),f.convertToFoundDocument(f.version,v).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((b=>b.field)))})(i,e,n,r):(function(u,f,p){return Nd(u.precondition,f)?(f.convertToNoDocument(f.version).setHasLocalMutations(),null):p})(i,e,n)}function oj(i,e){let n=null;for(const r of i.fieldTransforms){const l=e.data.field(r.field),u=D_(r.transform,l||null);u!=null&&(n===null&&(n=Pn.empty()),n.set(r.field,u))}return n||null}function Vy(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(r,l){return r===void 0&&l===void 0||!(!r||!l)&&vo(r,l,((u,f)=>aj(u,f)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class uc extends oh{constructor(e,n,r,l=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yr extends oh{constructor(e,n,r,l,u=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function B_(i){const e=new Map;return i.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=i.data.field(n);e.set(n,r)}})),e}function Uy(i,e,n){const r=new Map;ht(i.length===n.length,32656,{Re:n.length,Ve:i.length});for(let l=0;l<n.length;l++){const u=i[l],f=u.transform,p=e.data.field(u.field);r.set(u.field,sj(f,p,n[l]))}return r}function zy(i,e,n){const r=new Map;for(const l of i){const u=l.transform,f=n.data.field(l.field);r.set(l.field,nj(u,f,e))}return r}class M_ extends oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lj extends oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,n,r,l){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=l}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&ij(u,e,r[l])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Kl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Kl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=T_();return this.mutations.forEach((l=>{const u=e.get(l.key),f=u.overlayedDocument;let p=this.applyToLocalView(f,u.mutatedFields);p=n.has(l.key)?null:p;const x=O_(f,p);x!==null&&r.set(l.key,x),f.isValidDocument()||f.convertToNoDocument(He.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),nt())}isEqual(e){return this.batchId===e.batchId&&vo(this.mutations,e.mutations,((n,r)=>Vy(n,r)))&&vo(this.baseMutations,e.baseMutations,((n,r)=>Vy(n,r)))}}class Nm{constructor(e,n,r,l){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=l}static from(e,n,r){ht(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let l=(function(){return WC})();const u=e.mutations;for(let f=0;f<u.length;f++)l=l.insert(u[f].key,r[f].version);return new Nm(e,n,r,l)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,rt;function hj(i){switch(i){case xe.OK:return Ve(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return Ve(15467,{code:i})}}function F_(i){if(i===void 0)return ma("GRPC error has no .code"),xe.UNKNOWN;switch(i){case Kt.OK:return xe.OK;case Kt.CANCELLED:return xe.CANCELLED;case Kt.UNKNOWN:return xe.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return xe.INTERNAL;case Kt.UNAVAILABLE:return xe.UNAVAILABLE;case Kt.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case Kt.NOT_FOUND:return xe.NOT_FOUND;case Kt.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case Kt.ABORTED:return xe.ABORTED;case Kt.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case Kt.DATA_LOSS:return xe.DATA_LOSS;default:return Ve(39323,{code:i})}}(rt=Kt||(Kt={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj=new or([4294967295,4294967295],0);function qy(i){const e=fj().encode(i),n=new J1;return n.update(e),new Uint8Array(n.digest())}function Hy(i){const e=new DataView(i.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new or([n,r],0),new or([l,u],0)]}class wm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Vl(`Invalid padding: ${n}`);if(r<0)throw new Vl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=or.fromNumber(this.ge)}ye(e,n,r){let l=e.add(n.multiply(or.fromNumber(r)));return l.compare(mj)===1&&(l=new or([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=qy(e),[r,l]=Hy(n);for(let u=0;u<this.hashCount;u++){const f=this.ye(r,l,u);if(!this.we(f))return!1}return!0}static create(e,n,r){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),f=new wm(u,l,n);return r.forEach((p=>f.insert(p))),f}insert(e){if(this.ge===0)return;const n=qy(e),[r,l]=Hy(n);for(let u=0;u<this.hashCount;u++){const f=this.ye(r,l,u);this.Se(f)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,n,r,l,u){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const l=new Map;return l.set(e,dc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lh(He.min(),l,new Mt(tt),pa(),nt())}}class dc{constructor(e,n,r,l,u){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new dc(r,n,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r,l){this.be=e,this.removedTargetIds=n,this.key=r,this.De=l}}class L_{constructor(e,n){this.targetId=e,this.Ce=n}}class V_{constructor(e,n,r=pn.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=l}}class $y{constructor(){this.ve=0,this.Fe=Gy(),this.Me=pn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),n=nt(),r=nt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:n=n.add(l);break;case 1:r=r.add(l);break;default:Ve(38017,{changeType:u})}})),new dc(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Gy()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ht(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class pj{constructor(e){this.Ge=e,this.ze=new Map,this.je=pa(),this.Je=Mu(),this.He=Mu(),this.Ye=new Mt(tt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,l)=>{this.rt(l)&&n(l)}))}st(e){const n=e.targetId,r=e.Ce.count,l=this.ot(n);if(l){const u=l.target;if(G0(u))if(r===0){const f=new Pe(u.path);this.et(n,f,bn.newNoDocument(f,He.min()))}else ht(r===1,20013,{expectedCount:r});else{const f=this._t(n);if(f!==r){const p=this.ut(e),x=p?this.ct(p,e,f):1;if(x!==0){this.it(n);const m=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,m)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:l=0},hashCount:u=0}=n;let f,p;try{f=fr(r).toUint8Array()}catch(x){if(x instanceof d_)return xo("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{p=new wm(f,l,u)}catch(x){return xo(x instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return p.ge===0?null:p}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let l=0;return r.forEach((u=>{const f=this.Ge.ht(),p=`projects/${f.projectId}/databases/${f.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(n,u,null),l++)})),l}Tt(e){const n=new Map;this.ze.forEach(((u,f)=>{const p=this.ot(f);if(p){if(u.current&&G0(p.target)){const x=new Pe(p.target.path);this.It(x).has(f)||this.Et(f,x)||this.et(f,x,bn.newNoDocument(x,e))}u.Be&&(n.set(f,u.ke()),u.qe())}}));let r=nt();this.He.forEach(((u,f)=>{let p=!0;f.forEachWhile((x=>{const m=this.ot(x);return!m||m.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(r=r.add(u))})),this.je.forEach(((u,f)=>f.setReadTime(e)));const l=new lh(e,n,this.Ye,this.je,r);return this.je=pa(),this.Je=Mu(),this.He=Mu(),this.Ye=new Mt(tt),l}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,n)?l.Qe(n,1):l.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new $y,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tn(tt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tn(tt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $y),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Mu(){return new Mt(Pe.comparator)}function Gy(){return new Mt(Pe.comparator)}const gj={asc:"ASCENDING",desc:"DESCENDING"},xj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vj={and:"AND",or:"OR"};class yj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Y0(i,e){return i.useProto3Json||th(e)?e:{value:e}}function Ud(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U_(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function _j(i,e){return Ud(i,e.toTimestamp())}function Bs(i){return ht(!!i,49232),He.fromTimestamp((function(n){const r=hr(n);return new Rt(r.seconds,r.nanos)})(i))}function Cm(i,e){return Q0(i,e).canonicalString()}function Q0(i,e){const n=(function(l){return new Tt(["projects",l.projectId,"databases",l.database])})(i).child("documents");return e===void 0?n:n.child(e)}function z_(i){const e=Tt.fromString(i);return ht(K_(e),10190,{key:e.toString()}),e}function X0(i,e){return Cm(i.databaseId,e.path)}function C0(i,e){const n=z_(e);if(n.get(1)!==i.databaseId.projectId)throw new De(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+i.databaseId.projectId);if(n.get(3)!==i.databaseId.database)throw new De(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+i.databaseId.database);return new Pe(H_(n))}function q_(i,e){return Cm(i.databaseId,e)}function bj(i){const e=z_(i);return e.length===4?Tt.emptyPath():H_(e)}function W0(i){return new Tt(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function H_(i){return ht(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Ky(i,e,n){return{name:X0(i,e),fields:n.value.mapValue.fields}}function Ej(i,e){let n;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ve(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(m,v){return m.useProto3Json?(ht(v===void 0||typeof v=="string",58123),pn.fromBase64String(v||"")):(ht(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),pn.fromUint8Array(v||new Uint8Array))})(i,e.targetChange.resumeToken),f=e.targetChange.cause,p=f&&(function(m){const v=m.code===void 0?xe.UNKNOWN:F_(m.code);return new De(v,m.message||"")})(f);n=new V_(r,l,u,p||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const l=C0(i,r.document.name),u=Bs(r.document.updateTime),f=r.document.createTime?Bs(r.document.createTime):He.min(),p=new Pn({mapValue:{fields:r.document.fields}}),x=bn.newFoundDocument(l,u,f,p),m=r.targetIds||[],v=r.removedTargetIds||[];n=new wd(m,v,x.key,x)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const l=C0(i,r.document),u=r.readTime?Bs(r.readTime):He.min(),f=bn.newNoDocument(l,u),p=r.removedTargetIds||[];n=new wd([],p,f.key,f)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const l=C0(i,r.document),u=r.removedTargetIds||[];n=new wd([],u,l,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:l=0,unchangedNames:u}=r,f=new dj(l,u),p=r.targetId;n=new L_(p,f)}}return n}function Sj(i,e){let n;if(e instanceof uc)n={update:Ky(i,e.key,e.value)};else if(e instanceof M_)n={delete:X0(i,e.key)};else if(e instanceof yr)n={update:Ky(i,e.key,e.data),updateMask:Ij(e.fieldMask)};else{if(!(e instanceof lj))return Ve(16599,{Vt:e.type});n={verify:X0(i,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(u,f){const p=f.transform;if(p instanceof Ld)return{fieldPath:f.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof sc)return{fieldPath:f.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof ac)return{fieldPath:f.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Vd)return{fieldPath:f.field.canonicalString(),increment:p.Ae};throw Ve(20930,{transform:f.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:_j(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ve(27497)})(i,e.precondition)),n}function Aj(i,e){return i&&i.length>0?(ht(e!==void 0,14353),i.map((n=>(function(l,u){let f=l.updateTime?Bs(l.updateTime):Bs(u);return f.isEqual(He.min())&&(f=Bs(u)),new rj(f,l.transformResults||[])})(n,e)))):[]}function Nj(i,e){return{documents:[q_(i,e.path)]}}function wj(i,e){const n={structuredQuery:{}},r=e.path;let l;e.collectionGroup!==null?(l=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=q_(i,l);const u=(function(m){if(m.length!==0)return G_(zs.create(m,"and"))})(e.filters);u&&(n.structuredQuery.where=u);const f=(function(m){if(m.length!==0)return m.map((v=>(function(S){return{field:lo(S.field),direction:Tj(S.dir)}})(v)))})(e.orderBy);f&&(n.structuredQuery.orderBy=f);const p=Y0(i,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:n,parent:l}}function Cj(i){let e=bj(i.parent);const n=i.structuredQuery,r=n.from?n.from.length:0;let l=null;if(r>0){ht(r===1,65062);const v=n.from[0];v.allDescendants?l=v.collectionId:e=e.child(v.collectionId)}let u=[];n.where&&(u=(function(b){const S=$_(b);return S instanceof zs&&b_(S)?S.getFilters():[S]})(n.where));let f=[];n.orderBy&&(f=(function(b){return b.map((S=>(function(R){return new Fd(co(R.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(S)))})(n.orderBy));let p=null;n.limit&&(p=(function(b){let S;return S=typeof b=="object"?b.value:b,th(S)?null:S})(n.limit));let x=null;n.startAt&&(x=(function(b){const S=!!b.before,I=b.values||[];return new Md(I,S)})(n.startAt));let m=null;return n.endAt&&(m=(function(b){const S=!b.before,I=b.values||[];return new Md(I,S)})(n.endAt)),$C(e,l,f,u,p,"F",x,m)}function jj(i,e){const n=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:l})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $_(i){return i.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=co(n.unaryFilter.field);return en.create(r,"==",{doubleValue:NaN});case"IS_NULL":const l=co(n.unaryFilter.field);return en.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=co(n.unaryFilter.field);return en.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const f=co(n.unaryFilter.field);return en.create(f,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(i):i.fieldFilter!==void 0?(function(n){return en.create(co(n.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(n){return zs.create(n.compositeFilter.filters.map((r=>$_(r))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(n.compositeFilter.op))})(i):Ve(30097,{filter:i})}function Tj(i){return gj[i]}function Rj(i){return xj[i]}function Dj(i){return vj[i]}function lo(i){return{fieldPath:i.canonicalString()}}function co(i){return mn.fromServerFormat(i.fieldPath)}function G_(i){return i instanceof en?(function(n){if(n.op==="=="){if(Py(n.value))return{unaryFilter:{field:lo(n.field),op:"IS_NAN"}};if(ky(n.value))return{unaryFilter:{field:lo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Py(n.value))return{unaryFilter:{field:lo(n.field),op:"IS_NOT_NAN"}};if(ky(n.value))return{unaryFilter:{field:lo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lo(n.field),op:Rj(n.op),value:n.value}}})(i):i instanceof zs?(function(n){const r=n.getFilters().map((l=>G_(l)));return r.length===1?r[0]:{compositeFilter:{op:Dj(n.op),filters:r}}})(i):Ve(54877,{filter:i})}function Ij(i){const e=[];return i.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function K_(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n,r,l,u=He.min(),f=He.min(),p=pn.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=p,this.expectedCount=x}withSequenceNumber(e){return new sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e){this.yt=e}}function Pj(i){const e=Cj({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?K0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(){this.Cn=new Bj}addToCollectionParentIndex(e,n){return this.Cn.add(n),me.resolve()}getCollectionParents(e,n){return me.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return me.resolve()}deleteFieldIndex(e,n){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,n){return me.resolve()}getDocumentsMatchingTarget(e,n){return me.resolve(null)}getIndexType(e,n){return me.resolve(0)}getFieldIndexes(e,n){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,n){return me.resolve(dr.min())}getMinOffsetFromCollectionGroup(e,n){return me.resolve(dr.min())}updateCollectionGroup(e,n,r){return me.resolve()}updateIndexEntries(e,n){return me.resolve()}}class Bj{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),l=this.index[n]||new tn(Tt.comparator),u=!l.has(r);return this.index[n]=l.add(r),u}has(e){const n=e.lastSegment(),r=e.popLast(),l=this.index[n];return l&&l.has(r)}getEntries(e){return(this.index[e]||new tn(Tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Y_=41943040;class kn{static withCacheSize(e){return new kn(e,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kn.DEFAULT_COLLECTION_PERCENTILE=10,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kn.DEFAULT=new kn(Y_,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kn.DISABLED=new kn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bo(0)}static cr(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy="LruGarbageCollector",Mj=1048576;function Xy([i,e],[n,r]){const l=tt(i,n);return l===0?tt(e,r):l}class Fj{constructor(e){this.Ir=e,this.buffer=new tn(Xy),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Xy(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Lj{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(Qy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Co(n)?Te(Qy,"Ignoring IndexedDB error during garbage collection: ",n):await wo(n)}await this.Vr(3e5)}))}}class Vj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return me.resolve(eh.ce);const r=new Fj(n);return this.mr.forEachTarget(e,(l=>r.Ar(l.sequenceNumber))).next((()=>this.mr.pr(e,(l=>r.Ar(l))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),me.resolve(Yy)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yy):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,l,u,f,p,x,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),l=this.params.maximumSequenceNumbersToCollect):l=b,f=Date.now(),this.nthSequenceNumber(e,l)))).next((b=>(r=b,p=Date.now(),this.removeTargets(e,r,n)))).next((b=>(u=b,x=Date.now(),this.removeOrphanedDocuments(e,r)))).next((b=>(m=Date.now(),io()<=et.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${f-v}ms
	Determined least recently used ${l} in `+(p-f)+`ms
	Removed ${u} targets in `+(x-p)+`ms
	Removed ${b} documents in `+(m-x)+`ms
Total Duration: ${m-v}ms`),me.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:b}))))}}function Uj(i,e){return new Vj(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(){this.changes=new pi((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?me.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,n,r,l){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=l}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((l=>(r=l,this.remoteDocumentCache.getEntry(e,n)))).next((l=>(r!==null&&Kl(r.mutation,l,qn.empty(),Rt.now()),l)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,nt()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=nt()){const l=ri();return this.populateOverlays(e,l,n).next((()=>this.computeViews(e,n,l,r).next((u=>{let f=Ll();return u.forEach(((p,x)=>{f=f.insert(p,x.overlayedDocument)})),f}))))}getOverlayedDocuments(e,n){const r=ri();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,nt())))}populateOverlays(e,n,r){const l=[];return r.forEach((u=>{n.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((f,p)=>{n.set(f,p)}))}))}computeViews(e,n,r,l){let u=pa();const f=Gl(),p=(function(){return Gl()})();return n.forEach(((x,m)=>{const v=r.get(m.key);l.has(m.key)&&(v===void 0||v.mutation instanceof yr)?u=u.insert(m.key,m):v!==void 0?(f.set(m.key,v.mutation.getFieldMask()),Kl(v.mutation,m,v.mutation.getFieldMask(),Rt.now())):f.set(m.key,qn.empty())})),this.recalculateAndSaveOverlays(e,u).next((x=>(x.forEach(((m,v)=>f.set(m,v))),n.forEach(((m,v)=>p.set(m,new qj(v,f.get(m)??null)))),p)))}recalculateAndSaveOverlays(e,n){const r=Gl();let l=new Mt(((f,p)=>f-p)),u=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((f=>{for(const p of f)p.keys().forEach((x=>{const m=n.get(x);if(m===null)return;let v=r.get(x)||qn.empty();v=p.applyToLocalView(m,v),r.set(x,v);const b=(l.get(p.batchId)||nt()).add(x);l=l.insert(p.batchId,b)}))})).next((()=>{const f=[],p=l.getReverseIterator();for(;p.hasNext();){const x=p.getNext(),m=x.key,v=x.value,b=T_();v.forEach((S=>{if(!u.has(S)){const I=O_(n.get(S),r.get(S));I!==null&&b.set(S,I),u=u.add(S)}})),f.push(this.documentOverlayCache.saveOverlays(e,m,b))}return me.waitFor(f)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,l){return(function(f){return Pe.isDocumentKey(f.path)&&f.collectionGroup===null&&f.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):GC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,l):this.getDocumentsMatchingCollectionQuery(e,n,r,l)}getNextDocuments(e,n,r,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,l).next((u=>{const f=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,l-u.size):me.resolve(ri());let p=Jl,x=u;return f.next((m=>me.forEach(m,((v,b)=>(p<b.largestBatchId&&(p=b.largestBatchId),u.get(v)?me.resolve():this.remoteDocumentCache.getEntry(e,v).next((S=>{x=x.insert(v,S)}))))).next((()=>this.populateOverlays(e,m,u))).next((()=>this.computeViews(e,x,m,nt()))).next((v=>({batchId:p,changes:j_(v)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Pe(n)).next((r=>{let l=Ll();return r.isFoundDocument()&&(l=l.insert(r.key,r)),l}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,l){const u=n.collectionGroup;let f=Ll();return this.indexManager.getCollectionParents(e,u).next((p=>me.forEach(p,(x=>{const m=(function(b,S){return new sh(S,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(n,x.child(u));return this.getDocumentsMatchingCollectionQuery(e,m,r,l).next((v=>{v.forEach(((b,S)=>{f=f.insert(b,S)}))}))})).next((()=>f))))}getDocumentsMatchingCollectionQuery(e,n,r,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((f=>(u=f,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,u,l)))).next((f=>{u.forEach(((x,m)=>{const v=m.getKey();f.get(v)===null&&(f=f.insert(v,bn.newInvalidDocument(v)))}));let p=Ll();return f.forEach(((x,m)=>{const v=u.get(x);v!==void 0&&Kl(v.mutation,m,qn.empty(),Rt.now()),rh(n,m)&&(p=p.insert(x,m))})),p}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return me.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(l){return{id:l.id,version:l.version,createTime:Bs(l.createTime)}})(n)),me.resolve()}getNamedQuery(e,n){return me.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(l){return{name:l.name,query:Pj(l.bundledQuery),readTime:Bs(l.readTime)}})(n)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(){this.overlays=new Mt(Pe.comparator),this.qr=new Map}getOverlay(e,n){return me.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ri();return me.forEach(n,(l=>this.getOverlay(e,l).next((u=>{u!==null&&r.set(l,u)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((l,u)=>{this.St(e,n,u)})),me.resolve()}removeOverlaysForBatchId(e,n,r){const l=this.qr.get(r);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.qr.delete(r)),me.resolve()}getOverlaysForCollection(e,n,r){const l=ri(),u=n.length+1,f=new Pe(n.child("")),p=this.overlays.getIteratorFrom(f);for(;p.hasNext();){const x=p.getNext().value,m=x.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===u&&x.largestBatchId>r&&l.set(x.getKey(),x)}return me.resolve(l)}getOverlaysForCollectionGroup(e,n,r,l){let u=new Mt(((m,v)=>m-v));const f=this.overlays.getIterator();for(;f.hasNext();){const m=f.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let v=u.get(m.largestBatchId);v===null&&(v=ri(),u=u.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const p=ri(),x=u.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((m,v)=>p.set(m,v))),!(p.size()>=l)););return me.resolve(p)}St(e,n,r){const l=this.overlays.get(r.key);if(l!==null){const f=this.qr.get(l.largestBatchId).delete(r.key);this.qr.set(l.largestBatchId,f)}this.overlays=this.overlays.insert(r.key,new uj(n,r));let u=this.qr.get(n);u===void 0&&(u=nt(),this.qr.set(n,u)),this.qr.set(n,u.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(){this.Qr=new tn(ln.$r),this.Ur=new tn(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new ln(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new ln(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new Pe(new Tt([])),r=new ln(n,e),l=new ln(n,e+1),u=[];return this.Ur.forEachInRange([r,l],(f=>{this.Gr(f),u.push(f.key)})),u}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Pe(new Tt([])),r=new ln(n,e),l=new ln(n,e+1);let u=nt();return this.Ur.forEachInRange([r,l],(f=>{u=u.add(f.key)})),u}containsKey(e){const n=new ln(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ln{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Pe.comparator(e.key,n.key)||tt(e.Yr,n.Yr)}static Kr(e,n){return tt(e.Yr,n.Yr)||Pe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tn(ln.$r)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,l){const u=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const f=new cj(u,n,r,l);this.mutationQueue.push(f);for(const p of l)this.Zr=this.Zr.add(new ln(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return me.resolve(f)}lookupMutationBatch(e,n){return me.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,l=this.ei(r),u=l<0?0:l;return me.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?vm:this.tr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ln(n,0),l=new ln(n,Number.POSITIVE_INFINITY),u=[];return this.Zr.forEachInRange([r,l],(f=>{const p=this.Xr(f.Yr);u.push(p)})),me.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new tn(tt);return n.forEach((l=>{const u=new ln(l,0),f=new ln(l,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([u,f],(p=>{r=r.add(p.Yr)}))})),me.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,l=r.length+1;let u=r;Pe.isDocumentKey(u)||(u=u.child(""));const f=new ln(new Pe(u),0);let p=new tn(tt);return this.Zr.forEachWhile((x=>{const m=x.key.path;return!!r.isPrefixOf(m)&&(m.length===l&&(p=p.add(x.Yr)),!0)}),f),me.resolve(this.ti(p))}ti(e){const n=[];return e.forEach((r=>{const l=this.Xr(r);l!==null&&n.push(l)})),n}removeMutationBatch(e,n){ht(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return me.forEach(n.mutations,(l=>{const u=new ln(l.key,n.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new ln(n,0),l=this.Zr.firstAfterOrEqual(r);return me.resolve(n.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.ri=e,this.docs=(function(){return new Mt(Pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,l=this.docs.get(r),u=l?l.size:0,f=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:f}),this.size+=f-u,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return me.resolve(r?r.document.mutableCopy():bn.newInvalidDocument(n))}getEntries(e,n){let r=pa();return n.forEach((l=>{const u=this.docs.get(l);r=r.insert(l,u?u.document.mutableCopy():bn.newInvalidDocument(l))})),me.resolve(r)}getDocumentsMatchingQuery(e,n,r,l){let u=pa();const f=n.path,p=new Pe(f.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(p);for(;x.hasNext();){const{key:m,value:{document:v}}=x.getNext();if(!f.isPrefixOf(m.path))break;m.path.length>f.length+1||SC(EC(v),r)<=0||(l.has(v.key)||rh(n,v))&&(u=u.insert(v.key,v.mutableCopy()))}return me.resolve(u)}getAllFromCollectionGroup(e,n,r,l){Ve(9500)}ii(e,n){return me.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new Xj(this)}getSize(e){return me.resolve(this.size)}}class Xj extends zj{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,l)=>{l.isValidDocument()?n.push(this.Nr.addEntry(e,l)):this.Nr.removeEntry(r)})),me.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e){this.persistence=e,this.si=new pi((n=>bm(n)),Em),this.lastRemoteSnapshotVersion=He.min(),this.highestTargetId=0,this.oi=0,this._i=new jm,this.targetCount=0,this.ai=bo.ur()}forEachTarget(e,n){return this.si.forEach(((r,l)=>n(l))),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),me.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,me.resolve()}updateTargetData(e,n){return this.Pr(n),me.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,n,r){let l=0;const u=[];return this.si.forEach(((f,p)=>{p.sequenceNumber<=n&&r.get(p.targetId)===null&&(this.si.delete(f),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),me.waitFor(u).next((()=>l))}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return me.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),me.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const l=this.persistence.referenceDelegate,u=[];return l&&n.forEach((f=>{u.push(l.markPotentiallyOrphaned(e,f))})),me.waitFor(u)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),me.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return me.resolve(r)}containsKey(e,n){return me.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,n){this.ui={},this.overlays={},this.ci=new eh(0),this.li=!1,this.li=!0,this.hi=new Kj,this.referenceDelegate=e(this),this.Pi=new Wj(this),this.indexManager=new Oj,this.remoteDocumentCache=(function(l){return new Qj(l)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new kj(n),this.Ii=new $j(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Gj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Yj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Te("MemoryPersistence","Starting transaction:",e);const l=new Zj(this.ci.next());return this.referenceDelegate.Ei(),r(l).next((u=>this.referenceDelegate.di(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ai(e,n){return me.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class Zj extends NC{constructor(e){super(),this.currentSequenceNumber=e}}class Tm{constructor(e){this.persistence=e,this.Ri=new jm,this.Vi=null}static mi(e){return new Tm(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),me.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),me.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),me.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((l=>this.fi.add(l.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((l=>{l.forEach((u=>this.fi.add(u.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.fi,(r=>{const l=Pe.fromPath(r);return this.gi(e,l).next((u=>{u||n.removeEntry(l,He.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return me.or([()=>me.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class zd{constructor(e,n){this.persistence=e,this.pi=new pi((r=>jC(r.path)),((r,l)=>r.isEqual(l))),this.garbageCollector=Uj(this,n)}static mi(e,n){return new zd(e,n)}Ei(){}di(e){return me.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((l=>r+l))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return me.forEach(this.pi,((r,l)=>this.br(e,r,l).next((u=>u?me.resolve():n(l)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ii(e,(f=>this.br(e,f,n).next((p=>{p||(r++,u.removeEntry(f,He.min()))})))).next((()=>u.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),me.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),me.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),me.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Sd(e.data.value)),n}br(e,n,r){return me.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const l=this.pi.get(n);return me.resolve(l!==void 0&&l>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,n,r,l){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=l}static As(e,n){let r=nt(),l=nt();for(const u of n.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Rm(e,n.fromCache,r,l)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return qN()?8:wC(En())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,l){const u={result:null};return this.ys(e,n).next((f=>{u.result=f})).next((()=>{if(!u.result)return this.ws(e,n,l,r).next((f=>{u.result=f}))})).next((()=>{if(u.result)return;const f=new Jj;return this.Ss(e,n,f).next((p=>{if(u.result=p,this.Vs)return this.bs(e,n,f,p.size)}))})).next((()=>u.result))}bs(e,n,r,l){return r.documentReadCount<this.fs?(io()<=et.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",oo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),me.resolve()):(io()<=et.DEBUG&&Te("QueryEngine","Query:",oo(n),"scans",r.documentReadCount,"local documents and returns",l,"documents as results."),r.documentReadCount>this.gs*l?(io()<=et.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",oo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Os(n))):me.resolve())}ys(e,n){if(Fy(n))return me.resolve(null);let r=Os(n);return this.indexManager.getIndexType(e,r).next((l=>l===0?null:(n.limit!==null&&l===1&&(n=K0(n,null,"F"),r=Os(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((u=>{const f=nt(...u);return this.ps.getDocuments(e,f).next((p=>this.indexManager.getMinOffset(e,r).next((x=>{const m=this.Ds(n,p);return this.Cs(n,m,f,x.readTime)?this.ys(e,K0(n,null,"F")):this.vs(e,m,n,x)}))))})))))}ws(e,n,r,l){return Fy(n)||l.isEqual(He.min())?me.resolve(null):this.ps.getDocuments(e,r).next((u=>{const f=this.Ds(n,u);return this.Cs(n,f,r,l)?me.resolve(null):(io()<=et.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),oo(n)),this.vs(e,f,n,bC(l,Jl)).next((p=>p)))}))}Ds(e,n){let r=new tn(w_(e));return n.forEach(((l,u)=>{rh(e,u)&&(r=r.add(u))})),r}Cs(e,n,r,l){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const u=e.limitType==="F"?n.last():n.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}Ss(e,n,r){return io()<=et.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",oo(n)),this.ps.getDocumentsMatchingQuery(e,n,dr.min(),r)}vs(e,n,r,l){return this.ps.getDocumentsMatchingQuery(e,r,l).next((u=>(n.forEach((f=>{u=u.insert(f.key,f)})),u)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm="LocalStore",t2=3e8;class n2{constructor(e,n,r,l){this.persistence=e,this.Fs=n,this.serializer=l,this.Ms=new Mt(tt),this.xs=new pi((u=>bm(u)),Em),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function s2(i,e,n,r){return new n2(i,e,n,r)}async function X_(i,e){const n=Ge(i);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let l;return n.mutationQueue.getAllMutationBatches(r).next((u=>(l=u,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((u=>{const f=[],p=[];let x=nt();for(const m of l){f.push(m.batchId);for(const v of m.mutations)x=x.add(v.key)}for(const m of u){p.push(m.batchId);for(const v of m.mutations)x=x.add(v.key)}return n.localDocuments.getDocuments(r,x).next((m=>({Ls:m,removedBatchIds:f,addedBatchIds:p})))}))}))}function a2(i,e){const n=Ge(i);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const l=e.batch.keys(),u=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(p,x,m,v){const b=m.batch,S=b.keys();let I=me.resolve();return S.forEach((R=>{I=I.next((()=>v.getEntry(x,R))).next((D=>{const k=m.docVersions.get(R);ht(k!==null,48541),D.version.compareTo(k)<0&&(b.applyToRemoteDocument(D,m),D.isValidDocument()&&(D.setReadTime(m.commitVersion),v.addEntry(D)))}))})),I.next((()=>p.mutationQueue.removeMutationBatch(x,b)))})(n,r,e,u).next((()=>u.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,l,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(p){let x=nt();for(let m=0;m<p.mutationResults.length;++m)p.mutationResults[m].transformResults.length>0&&(x=x.add(p.batch.mutations[m].key));return x})(e)))).next((()=>n.localDocuments.getDocuments(r,l)))}))}function W_(i){const e=Ge(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function r2(i,e){const n=Ge(i),r=e.snapshotVersion;let l=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const f=n.Ns.newChangeBuffer({trackRemovals:!0});l=n.Ms;const p=[];e.targetChanges.forEach(((v,b)=>{const S=l.get(b);if(!S)return;p.push(n.Pi.removeMatchingKeys(u,v.removedDocuments,b).next((()=>n.Pi.addMatchingKeys(u,v.addedDocuments,b))));let I=S.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(b)!==null?I=I.withResumeToken(pn.EMPTY_BYTE_STRING,He.min()).withLastLimboFreeSnapshotVersion(He.min()):v.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(v.resumeToken,r)),l=l.insert(b,I),(function(D,k,q){return D.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=t2?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0})(S,I,v)&&p.push(n.Pi.updateTargetData(u,I))}));let x=pa(),m=nt();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(u,v))})),p.push(i2(u,f,e.documentUpdates).next((v=>{x=v.ks,m=v.qs}))),!r.isEqual(He.min())){const v=n.Pi.getLastRemoteSnapshotVersion(u).next((b=>n.Pi.setTargetsMetadata(u,u.currentSequenceNumber,r)));p.push(v)}return me.waitFor(p).next((()=>f.apply(u))).next((()=>n.localDocuments.getLocalViewOfDocuments(u,x,m))).next((()=>x))})).then((u=>(n.Ms=l,u)))}function i2(i,e,n){let r=nt(),l=nt();return n.forEach((u=>r=r.add(u))),e.getEntries(i,r).next((u=>{let f=pa();return n.forEach(((p,x)=>{const m=u.get(p);x.isFoundDocument()!==m.isFoundDocument()&&(l=l.add(p)),x.isNoDocument()&&x.version.isEqual(He.min())?(e.removeEntry(p,x.readTime),f=f.insert(p,x)):!m.isValidDocument()||x.version.compareTo(m.version)>0||x.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(x),f=f.insert(p,x)):Te(Dm,"Ignoring outdated watch update for ",p,". Current version:",m.version," Watch version:",x.version)})),{ks:f,qs:l}}))}function o2(i,e){const n=Ge(i);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=vm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function l2(i,e){const n=Ge(i);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let l;return n.Pi.getTargetData(r,e).next((u=>u?(l=u,me.resolve(l)):n.Pi.allocateTargetId(r).next((f=>(l=new sr(e,f,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,l).next((()=>l)))))))})).then((r=>{const l=n.Ms.get(r.targetId);return(l===null||r.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function Z0(i,e,n){const r=Ge(i),l=r.Ms.get(e),u=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",u,(f=>r.persistence.referenceDelegate.removeTarget(f,l)))}catch(f){if(!Co(f))throw f;Te(Dm,`Failed to update sequence numbers for target ${e}: ${f}`)}r.Ms=r.Ms.remove(e),r.xs.delete(l.target)}function Wy(i,e,n){const r=Ge(i);let l=He.min(),u=nt();return r.persistence.runTransaction("Execute query","readwrite",(f=>(function(x,m,v){const b=Ge(x),S=b.xs.get(v);return S!==void 0?me.resolve(b.Ms.get(S)):b.Pi.getTargetData(m,v)})(r,f,Os(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(f,p.targetId).next((x=>{u=x}))})).next((()=>r.Fs.getDocumentsMatchingQuery(f,e,n?l:He.min(),n?u:nt()))).next((p=>(c2(r,YC(e),p),{documents:p,Qs:u})))))}function c2(i,e,n){let r=i.Os.get(e)||He.min();n.forEach(((l,u)=>{u.readTime.compareTo(r)>0&&(r=u.readTime)})),i.Os.set(e,r)}class Zy{constructor(){this.activeTargetIds=ej()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u2{constructor(){this.Mo=new Zy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jy="ConnectivityMonitor";class e1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(Jy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(Jy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fu=null;function J0(){return Fu===null?Fu=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fu++,"0x"+Fu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="RestConnection",h2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class f2{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${l}`,this.Wo=this.databaseId.database===Od?`project_id=${r}`:`project_id=${r}&database_id=${l}`}Go(e,n,r,l,u){const f=J0(),p=this.zo(e,n.toUriEncodedString());Te(j0,`Sending RPC '${e}' ${f}:`,p,r);const x={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(x,l,u);const{host:m}=new URL(p),v=So(m);return this.Jo(e,p,x,r,v).then((b=>(Te(j0,`Received RPC '${e}' ${f}: `,b),b)),(b=>{throw xo(j0,`RPC '${e}' ${f} failed with error: `,b,"url: ",p,"request:",r),b}))}Ho(e,n,r,l,u,f){return this.Go(e,n,r,l,u)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+No})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((l,u)=>e[u]=l)),r&&r.headers.forEach(((l,u)=>e[u]=l))}zo(e,n){const r=h2[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn="WebChannelConnection";class p2 extends f2{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,l,u){const f=J0();return new Promise(((p,x)=>{const m=new e_;m.setWithCredentials(!0),m.listenOnce(t_.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Ed.NO_ERROR:const b=m.getResponseJson();Te(yn,`XHR for RPC '${e}' ${f} received:`,JSON.stringify(b)),p(b);break;case Ed.TIMEOUT:Te(yn,`RPC '${e}' ${f} timed out`),x(new De(xe.DEADLINE_EXCEEDED,"Request time out"));break;case Ed.HTTP_ERROR:const S=m.getStatus();if(Te(yn,`RPC '${e}' ${f} failed with status:`,S,"response text:",m.getResponseText()),S>0){let I=m.getResponseJson();Array.isArray(I)&&(I=I[0]);const R=I?.error;if(R&&R.status&&R.message){const D=(function(q){const O=q.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(O)>=0?O:xe.UNKNOWN})(R.status);x(new De(D,R.message))}else x(new De(xe.UNKNOWN,"Server responded with status "+m.getStatus()))}else x(new De(xe.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:f,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Te(yn,`RPC '${e}' ${f} completed.`)}}));const v=JSON.stringify(l);Te(yn,`RPC '${e}' ${f} sending request:`,l),m.send(n,"POST",v,r,15)}))}T_(e,n,r){const l=J0(),u=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=a_(),p=s_(),x={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(x.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(x.useFetchStreams=!0),this.jo(x.initMessageHeaders,n,r),x.encodeInitMessageHeaders=!0;const v=u.join("");Te(yn,`Creating RPC '${e}' stream ${l}: ${v}`,x);const b=f.createWebChannel(v,x);this.I_(b);let S=!1,I=!1;const R=new m2({Yo:k=>{I?Te(yn,`Not sending because RPC '${e}' stream ${l} is closed:`,k):(S||(Te(yn,`Opening RPC '${e}' stream ${l} transport.`),b.open(),S=!0),Te(yn,`RPC '${e}' stream ${l} sending:`,k),b.send(k))},Zo:()=>b.close()}),D=(k,q,O)=>{k.listen(q,(L=>{try{O(L)}catch(N){setTimeout((()=>{throw N}),0)}}))};return D(b,Fl.EventType.OPEN,(()=>{I||(Te(yn,`RPC '${e}' stream ${l} transport opened.`),R.o_())})),D(b,Fl.EventType.CLOSE,(()=>{I||(I=!0,Te(yn,`RPC '${e}' stream ${l} transport closed`),R.a_(),this.E_(b))})),D(b,Fl.EventType.ERROR,(k=>{I||(I=!0,xo(yn,`RPC '${e}' stream ${l} transport errored. Name:`,k.name,"Message:",k.message),R.a_(new De(xe.UNAVAILABLE,"The operation could not be completed")))})),D(b,Fl.EventType.MESSAGE,(k=>{if(!I){const q=k.data[0];ht(!!q,16349);const O=q,L=O?.error||O[0]?.error;if(L){Te(yn,`RPC '${e}' stream ${l} received error:`,L);const N=L.status;let F=(function(_){const A=Kt[_];if(A!==void 0)return F_(A)})(N),P=L.message;F===void 0&&(F=xe.INTERNAL,P="Unknown error status: "+N+" with message "+L.message),I=!0,R.a_(new De(F,P)),b.close()}else Te(yn,`RPC '${e}' stream ${l} received:`,q),R.u_(q)}})),D(p,n_.STAT_EVENT,(k=>{k.stat===U0.PROXY?Te(yn,`RPC '${e}' stream ${l} detected buffering proxy`):k.stat===U0.NOPROXY&&Te(yn,`RPC '${e}' stream ${l} detected no buffering proxy`)})),setTimeout((()=>{R.__()}),0),R}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function T0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(i){return new yj(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n,r=1e3,l=1.5,u=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=l,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),l=Math.max(0,n-r);l>0&&Te("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="PersistentStream";class J_{constructor(e,n,r,l,u,f,p,x){this.Mi=e,this.S_=r,this.b_=l,this.connection=u,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=p,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Z_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===xe.RESOURCE_EXHAUSTED?(ma(n.toString()),ma("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,l])=>{this.D_===n&&this.G_(r,l)}),(r=>{e((()=>{const l=new De(xe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(l)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((l=>{r((()=>this.z_(l)))})),this.stream.onMessage((l=>{r((()=>++this.F_==1?this.J_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(t1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Te(t1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class g2 extends J_{constructor(e,n,r,l,u,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,l,f),this.serializer=u}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Ej(this.serializer,e),r=(function(u){if(!("targetChange"in u))return He.min();const f=u.targetChange;return f.targetIds&&f.targetIds.length?He.min():f.readTime?Bs(f.readTime):He.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=W0(this.serializer),n.addTarget=(function(u,f){let p;const x=f.target;if(p=G0(x)?{documents:Nj(u,x)}:{query:wj(u,x).ft},p.targetId=f.targetId,f.resumeToken.approximateByteSize()>0){p.resumeToken=U_(u,f.resumeToken);const m=Y0(u,f.expectedCount);m!==null&&(p.expectedCount=m)}else if(f.snapshotVersion.compareTo(He.min())>0){p.readTime=Ud(u,f.snapshotVersion.toTimestamp());const m=Y0(u,f.expectedCount);m!==null&&(p.expectedCount=m)}return p})(this.serializer,e);const r=jj(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=W0(this.serializer),n.removeTarget=e,this.q_(n)}}class x2 extends J_{constructor(e,n,r,l,u,f){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,l,f),this.serializer=u}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ht(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ht(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ht(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Aj(e.writeResults,e.commitTime),r=Bs(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=W0(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>Sj(this.serializer,r)))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{}class y2 extends v2{constructor(e,n,r,l){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new De(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Go(e,Q0(n,r),l,u,f))).catch((u=>{throw u.name==="FirebaseError"?(u.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new De(xe.UNKNOWN,u.toString())}))}Ho(e,n,r,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([f,p])=>this.connection.Ho(e,Q0(n,r),l,f,p,u))).catch((f=>{throw f.name==="FirebaseError"?(f.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new De(xe.UNKNOWN,f.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ma(n),this.aa=!1):Te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui="RemoteStore";class b2{constructor(e,n,r,l,u){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=u,this.Aa.Oo((f=>{r.enqueueAndForget((async()=>{gi(this)&&(Te(ui,"Restarting streams for network reachability change."),await(async function(x){const m=Ge(x);m.Ea.add(4),await hc(m),m.Ra.set("Unknown"),m.Ea.delete(4),await uh(m)})(this))}))})),this.Ra=new _2(r,l)}}async function uh(i){if(gi(i))for(const e of i.da)await e(!0)}async function hc(i){for(const e of i.da)await e(!1)}function eb(i,e){const n=Ge(i);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Om(n)?Pm(n):jo(n).O_()&&km(n,e))}function Im(i,e){const n=Ge(i),r=jo(n);n.Ia.delete(e),r.O_()&&tb(n,e),n.Ia.size===0&&(r.O_()?r.L_():gi(n)&&n.Ra.set("Unknown"))}function km(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(He.min())>0){const n=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}jo(i).Y_(e)}function tb(i,e){i.Va.Ue(e),jo(i).Z_(e)}function Pm(i){i.Va=new pj({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),jo(i).start(),i.Ra.ua()}function Om(i){return gi(i)&&!jo(i).x_()&&i.Ia.size>0}function gi(i){return Ge(i).Ea.size===0}function nb(i){i.Va=void 0}async function E2(i){i.Ra.set("Online")}async function S2(i){i.Ia.forEach(((e,n)=>{km(i,e)}))}async function A2(i,e){nb(i),Om(i)?(i.Ra.ha(e),Pm(i)):i.Ra.set("Unknown")}async function N2(i,e,n){if(i.Ra.set("Online"),e instanceof V_&&e.state===2&&e.cause)try{await(async function(l,u){const f=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,f),l.Ia.delete(p),l.Va.removeTarget(p))})(i,e)}catch(r){Te(ui,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qd(i,r)}else if(e instanceof wd?i.Va.Ze(e):e instanceof L_?i.Va.st(e):i.Va.tt(e),!n.isEqual(He.min()))try{const r=await W_(i.localStore);n.compareTo(r)>=0&&await(function(u,f){const p=u.Va.Tt(f);return p.targetChanges.forEach(((x,m)=>{if(x.resumeToken.approximateByteSize()>0){const v=u.Ia.get(m);v&&u.Ia.set(m,v.withResumeToken(x.resumeToken,f))}})),p.targetMismatches.forEach(((x,m)=>{const v=u.Ia.get(x);if(!v)return;u.Ia.set(x,v.withResumeToken(pn.EMPTY_BYTE_STRING,v.snapshotVersion)),tb(u,x);const b=new sr(v.target,x,m,v.sequenceNumber);km(u,b)})),u.remoteSyncer.applyRemoteEvent(p)})(i,n)}catch(r){Te(ui,"Failed to raise snapshot:",r),await qd(i,r)}}async function qd(i,e,n){if(!Co(e))throw e;i.Ea.add(1),await hc(i),i.Ra.set("Offline"),n||(n=()=>W_(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{Te(ui,"Retrying IndexedDB access"),await n(),i.Ea.delete(1),await uh(i)}))}function sb(i,e){return e().catch((n=>qd(i,n,e)))}async function dh(i){const e=Ge(i),n=pr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vm;for(;w2(e);)try{const l=await o2(e.localStore,r);if(l===null){e.Ta.length===0&&n.L_();break}r=l.batchId,C2(e,l)}catch(l){await qd(e,l)}ab(e)&&rb(e)}function w2(i){return gi(i)&&i.Ta.length<10}function C2(i,e){i.Ta.push(e);const n=pr(i);n.O_()&&n.X_&&n.ea(e.mutations)}function ab(i){return gi(i)&&!pr(i).x_()&&i.Ta.length>0}function rb(i){pr(i).start()}async function j2(i){pr(i).ra()}async function T2(i){const e=pr(i);for(const n of i.Ta)e.ea(n.mutations)}async function R2(i,e,n){const r=i.Ta.shift(),l=Nm.from(r,e,n);await sb(i,(()=>i.remoteSyncer.applySuccessfulWrite(l))),await dh(i)}async function D2(i,e){e&&pr(i).X_&&await(async function(r,l){if((function(f){return hj(f)&&f!==xe.ABORTED})(l.code)){const u=r.Ta.shift();pr(r).B_(),await sb(r,(()=>r.remoteSyncer.rejectFailedWrite(u.batchId,l))),await dh(r)}})(i,e),ab(i)&&rb(i)}async function n1(i,e){const n=Ge(i);n.asyncQueue.verifyOperationInProgress(),Te(ui,"RemoteStore received new credentials");const r=gi(n);n.Ea.add(3),await hc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await uh(n)}async function I2(i,e){const n=Ge(i);e?(n.Ea.delete(2),await uh(n)):e||(n.Ea.add(2),await hc(n),n.Ra.set("Unknown"))}function jo(i){return i.ma||(i.ma=(function(n,r,l){const u=Ge(n);return u.sa(),new g2(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(i.datastore,i.asyncQueue,{Xo:E2.bind(null,i),t_:S2.bind(null,i),r_:A2.bind(null,i),H_:N2.bind(null,i)}),i.da.push((async e=>{e?(i.ma.B_(),Om(i)?Pm(i):i.Ra.set("Unknown")):(await i.ma.stop(),nb(i))}))),i.ma}function pr(i){return i.fa||(i.fa=(function(n,r,l){const u=Ge(n);return u.sa(),new x2(r,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:j2.bind(null,i),r_:D2.bind(null,i),ta:T2.bind(null,i),na:R2.bind(null,i)}),i.da.push((async e=>{e?(i.fa.B_(),await dh(i)):(await i.fa.stop(),i.Ta.length>0&&(Te(ui,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,n,r,l,u){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=l,this.removalCallback=u,this.deferred=new lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((f=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,l,u){const f=Date.now()+r,p=new Bm(e,n,f,l,u);return p.start(r),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mm(i,e){if(ma("AsyncQueue",`${e}: ${i}`),Co(i))return new De(xe.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{static emptySet(e){return new ho(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Pe.comparator(n.key,r.key):(n,r)=>Pe.comparator(n.key,r.key),this.keyedMap=Ll(),this.sortedSet=new Mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ho)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const l=n.getNext().key,u=r.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ho;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.ga=new Mt(Pe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Eo{constructor(e,n,r,l,u,f,p,x,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=l,this.mutatedKeys=u,this.fromCache=f,this.syncStateChanged=p,this.excludesMetadataChanges=x,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,l,u){const f=[];return n.forEach((p=>{f.push({type:0,doc:p})})),new Eo(e,n,ho.emptySet(n),f,r,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ah(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let l=0;l<n.length;l++)if(n[l].type!==r[l].type||!n[l].doc.isEqual(r[l].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class P2{constructor(){this.queries=a1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const l=Ge(n),u=l.queries;l.queries=a1(),u.forEach(((f,p)=>{for(const x of p.Sa)x.onError(r)}))})(this,new De(xe.ABORTED,"Firestore shutting down"))}}function a1(){return new pi((i=>N_(i)),ah)}async function O2(i,e){const n=Ge(i);let r=3;const l=e.query;let u=n.queries.get(l);u?!u.ba()&&e.Da()&&(r=2):(u=new k2,r=e.Da()?0:1);try{switch(r){case 0:u.wa=await n.onListen(l,!0);break;case 1:u.wa=await n.onListen(l,!1);break;case 2:await n.onFirstRemoteStoreListen(l)}}catch(f){const p=Mm(f,`Initialization of query '${oo(e.query)}' failed`);return void e.onError(p)}n.queries.set(l,u),u.Sa.push(e),e.va(n.onlineState),u.wa&&e.Fa(u.wa)&&Fm(n)}async function B2(i,e){const n=Ge(i),r=e.query;let l=3;const u=n.queries.get(r);if(u){const f=u.Sa.indexOf(e);f>=0&&(u.Sa.splice(f,1),u.Sa.length===0?l=e.Da()?0:1:!u.ba()&&e.Da()&&(l=2))}switch(l){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function M2(i,e){const n=Ge(i);let r=!1;for(const l of e){const u=l.query,f=n.queries.get(u);if(f){for(const p of f.Sa)p.Fa(l)&&(r=!0);f.wa=l}}r&&Fm(n)}function F2(i,e,n){const r=Ge(i),l=r.queries.get(e);if(l)for(const u of l.Sa)u.onError(n);r.queries.delete(e)}function Fm(i){i.Ca.forEach((e=>{e.next()}))}var em,r1;(r1=em||(em={})).Ma="default",r1.Cache="cache";class L2{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const l of e.docChanges)l.type!==3&&r.push(l);e=new Eo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==em.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){this.key=e}}class ob{constructor(e){this.key=e}}class V2{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=nt(),this.mutatedKeys=nt(),this.eu=w_(e),this.tu=new ho(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new s1,l=n?n.tu:this.tu;let u=n?n.mutatedKeys:this.mutatedKeys,f=l,p=!1;const x=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,m=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((v,b)=>{const S=l.get(v),I=rh(this.query,b)?b:null,R=!!S&&this.mutatedKeys.has(S.key),D=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let k=!1;S&&I?S.data.isEqual(I.data)?R!==D&&(r.track({type:3,doc:I}),k=!0):this.su(S,I)||(r.track({type:2,doc:I}),k=!0,(x&&this.eu(I,x)>0||m&&this.eu(I,m)<0)&&(p=!0)):!S&&I?(r.track({type:0,doc:I}),k=!0):S&&!I&&(r.track({type:1,doc:S}),k=!0,(x||m)&&(p=!0)),k&&(I?(f=f.add(I),u=D?u.add(v):u.delete(v)):(f=f.delete(v),u=u.delete(v)))})),this.query.limit!==null)for(;f.size>this.query.limit;){const v=this.query.limitType==="F"?f.last():f.first();f=f.delete(v.key),u=u.delete(v.key),r.track({type:1,doc:v})}return{tu:f,iu:r,Cs:p,mutatedKeys:u}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const f=e.iu.ya();f.sort(((v,b)=>(function(I,R){const D=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:k})}};return D(I)-D(R)})(v.type,b.type)||this.eu(v.doc,b.doc))),this.ou(r),l=l??!1;const p=n&&!l?this._u():[],x=this.Xa.size===0&&this.current&&!l?1:0,m=x!==this.Za;return this.Za=x,f.length!==0||m?{snapshot:new Eo(this.query,e.tu,u,f,e.mutatedKeys,x===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new s1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=nt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new ob(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new ib(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=nt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Eo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Lm="SyncEngine";class U2{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class z2{constructor(e){this.key=e,this.hu=!1}}class q2{constructor(e,n,r,l,u,f){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=f,this.Pu={},this.Tu=new pi((p=>N_(p)),ah),this.Iu=new Map,this.Eu=new Set,this.du=new Mt(Pe.comparator),this.Au=new Map,this.Ru=new jm,this.Vu={},this.mu=new Map,this.fu=bo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function H2(i,e,n=!0){const r=fb(i);let l;const u=r.Tu.get(e);return u?(r.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await lb(r,e,n,!0),l}async function $2(i,e){const n=fb(i);await lb(n,e,!0,!1)}async function lb(i,e,n,r){const l=await l2(i.localStore,Os(e)),u=l.targetId,f=i.sharedClientState.addLocalQueryTarget(u,n);let p;return r&&(p=await G2(i,e,u,f==="current",l.resumeToken)),i.isPrimaryClient&&n&&eb(i.remoteStore,l),p}async function G2(i,e,n,r,l){i.pu=(b,S,I)=>(async function(D,k,q,O){let L=k.view.ru(q);L.Cs&&(L=await Wy(D.localStore,k.query,!1).then((({documents:E})=>k.view.ru(E,L))));const N=O&&O.targetChanges.get(k.targetId),F=O&&O.targetMismatches.get(k.targetId)!=null,P=k.view.applyChanges(L,D.isPrimaryClient,N,F);return o1(D,k.targetId,P.au),P.snapshot})(i,b,S,I);const u=await Wy(i.localStore,e,!0),f=new V2(e,u.Qs),p=f.ru(u.documents),x=dc.createSynthesizedTargetChangeForCurrentChange(n,r&&i.onlineState!=="Offline",l),m=f.applyChanges(p,i.isPrimaryClient,x);o1(i,n,m.au);const v=new U2(e,n,f);return i.Tu.set(e,v),i.Iu.has(n)?i.Iu.get(n).push(e):i.Iu.set(n,[e]),m.snapshot}async function K2(i,e,n){const r=Ge(i),l=r.Tu.get(e),u=r.Iu.get(l.targetId);if(u.length>1)return r.Iu.set(l.targetId,u.filter((f=>!ah(f,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(l.targetId),r.sharedClientState.isActiveQueryTarget(l.targetId)||await Z0(r.localStore,l.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(l.targetId),n&&Im(r.remoteStore,l.targetId),tm(r,l.targetId)})).catch(wo)):(tm(r,l.targetId),await Z0(r.localStore,l.targetId,!0))}async function Y2(i,e){const n=Ge(i),r=n.Tu.get(e),l=n.Iu.get(r.targetId);n.isPrimaryClient&&l.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Im(n.remoteStore,r.targetId))}async function Q2(i,e,n){const r=nT(i);try{const l=await(function(f,p){const x=Ge(f),m=Rt.now(),v=p.reduce(((I,R)=>I.add(R.key)),nt());let b,S;return x.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let R=pa(),D=nt();return x.Ns.getEntries(I,v).next((k=>{R=k,R.forEach(((q,O)=>{O.isValidDocument()||(D=D.add(q))}))})).next((()=>x.localDocuments.getOverlayedDocuments(I,R))).next((k=>{b=k;const q=[];for(const O of p){const L=oj(O,b.get(O.key).overlayedDocument);L!=null&&q.push(new yr(O.key,L,v_(L.value.mapValue),gs.exists(!0)))}return x.mutationQueue.addMutationBatch(I,m,q,p)})).next((k=>{S=k;const q=k.applyToLocalDocumentSet(b,D);return x.documentOverlayCache.saveOverlays(I,k.batchId,q)}))})).then((()=>({batchId:S.batchId,changes:j_(b)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(l.batchId),(function(f,p,x){let m=f.Vu[f.currentUser.toKey()];m||(m=new Mt(tt)),m=m.insert(p,x),f.Vu[f.currentUser.toKey()]=m})(r,l.batchId,n),await fc(r,l.changes),await dh(r.remoteStore)}catch(l){const u=Mm(l,"Failed to persist write");n.reject(u)}}async function cb(i,e){const n=Ge(i);try{const r=await r2(n.localStore,e);e.targetChanges.forEach(((l,u)=>{const f=n.Au.get(u);f&&(ht(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?f.hu=!0:l.modifiedDocuments.size>0?ht(f.hu,14607):l.removedDocuments.size>0&&(ht(f.hu,42227),f.hu=!1))})),await fc(n,r,e)}catch(r){await wo(r)}}function i1(i,e,n){const r=Ge(i);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const l=[];r.Tu.forEach(((u,f)=>{const p=f.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(f,p){const x=Ge(f);x.onlineState=p;let m=!1;x.queries.forEach(((v,b)=>{for(const S of b.Sa)S.va(p)&&(m=!0)})),m&&Fm(x)})(r.eventManager,e),l.length&&r.Pu.H_(l),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function X2(i,e,n){const r=Ge(i);r.sharedClientState.updateQueryState(e,"rejected",n);const l=r.Au.get(e),u=l&&l.key;if(u){let f=new Mt(Pe.comparator);f=f.insert(u,bn.newNoDocument(u,He.min()));const p=nt().add(u),x=new lh(He.min(),new Map,new Mt(tt),f,p);await cb(r,x),r.du=r.du.remove(u),r.Au.delete(e),Vm(r)}else await Z0(r.localStore,e,!1).then((()=>tm(r,e,n))).catch(wo)}async function W2(i,e){const n=Ge(i),r=e.batch.batchId;try{const l=await a2(n.localStore,e);db(n,r,null),ub(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fc(n,l)}catch(l){await wo(l)}}async function Z2(i,e,n){const r=Ge(i);try{const l=await(function(f,p){const x=Ge(f);return x.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let v;return x.mutationQueue.lookupMutationBatch(m,p).next((b=>(ht(b!==null,37113),v=b.keys(),x.mutationQueue.removeMutationBatch(m,b)))).next((()=>x.mutationQueue.performConsistencyCheck(m))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(m,v,p))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v))).next((()=>x.localDocuments.getDocuments(m,v)))}))})(r.localStore,e);db(r,e,n),ub(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await fc(r,l)}catch(l){await wo(l)}}function ub(i,e){(i.mu.get(e)||[]).forEach((n=>{n.resolve()})),i.mu.delete(e)}function db(i,e,n){const r=Ge(i);let l=r.Vu[r.currentUser.toKey()];if(l){const u=l.get(e);u&&(n?u.reject(n):u.resolve(),l=l.remove(e)),r.Vu[r.currentUser.toKey()]=l}}function tm(i,e,n=null){i.sharedClientState.removeLocalQueryTarget(e);for(const r of i.Iu.get(e))i.Tu.delete(r),n&&i.Pu.yu(r,n);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach((r=>{i.Ru.containsKey(r)||hb(i,r)}))}function hb(i,e){i.Eu.delete(e.path.canonicalString());const n=i.du.get(e);n!==null&&(Im(i.remoteStore,n),i.du=i.du.remove(e),i.Au.delete(n),Vm(i))}function o1(i,e,n){for(const r of n)r instanceof ib?(i.Ru.addReference(r.key,e),J2(i,r)):r instanceof ob?(Te(Lm,"Document no longer in limbo: "+r.key),i.Ru.removeReference(r.key,e),i.Ru.containsKey(r.key)||hb(i,r.key)):Ve(19791,{wu:r})}function J2(i,e){const n=e.key,r=n.path.canonicalString();i.du.get(n)||i.Eu.has(r)||(Te(Lm,"New document in limbo: "+n),i.Eu.add(r),Vm(i))}function Vm(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const n=new Pe(Tt.fromString(e)),r=i.fu.next();i.Au.set(r,new z2(n)),i.du=i.du.insert(n,r),eb(i.remoteStore,new sr(Os(Sm(n.path)),r,"TargetPurposeLimboResolution",eh.ce))}}async function fc(i,e,n){const r=Ge(i),l=[],u=[],f=[];r.Tu.isEmpty()||(r.Tu.forEach(((p,x)=>{f.push(r.pu(x,e,n).then((m=>{if((m||n)&&r.isPrimaryClient){const v=m?!m.fromCache:n?.targetChanges.get(x.targetId)?.current;r.sharedClientState.updateQueryState(x.targetId,v?"current":"not-current")}if(m){l.push(m);const v=Rm.As(x.targetId,m);u.push(v)}})))})),await Promise.all(f),r.Pu.H_(l),await(async function(x,m){const v=Ge(x);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>me.forEach(m,(S=>me.forEach(S.Es,(I=>v.persistence.referenceDelegate.addReference(b,S.targetId,I))).next((()=>me.forEach(S.ds,(I=>v.persistence.referenceDelegate.removeReference(b,S.targetId,I)))))))))}catch(b){if(!Co(b))throw b;Te(Dm,"Failed to update sequence numbers: "+b)}for(const b of m){const S=b.targetId;if(!b.fromCache){const I=v.Ms.get(S),R=I.snapshotVersion,D=I.withLastLimboFreeSnapshotVersion(R);v.Ms=v.Ms.insert(S,D)}}})(r.localStore,u))}async function eT(i,e){const n=Ge(i);if(!n.currentUser.isEqual(e)){Te(Lm,"User change. New user:",e.toKey());const r=await X_(n.localStore,e);n.currentUser=e,(function(u,f){u.mu.forEach((p=>{p.forEach((x=>{x.reject(new De(xe.CANCELLED,f))}))})),u.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fc(n,r.Ls)}}function tT(i,e){const n=Ge(i),r=n.Au.get(e);if(r&&r.hu)return nt().add(r.key);{let l=nt();const u=n.Iu.get(e);if(!u)return l;for(const f of u){const p=n.Tu.get(f);l=l.unionWith(p.view.nu)}return l}}function fb(i){const e=Ge(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=cb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X2.bind(null,e),e.Pu.H_=M2.bind(null,e.eventManager),e.Pu.yu=F2.bind(null,e.eventManager),e}function nT(i){const e=Ge(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=W2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z2.bind(null,e),e}class Hd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ch(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return s2(this.persistence,new e2,e.initialUser,this.serializer)}Cu(e){return new Q_(Tm.mi,this.serializer)}Du(e){return new u2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hd.provider={build:()=>new Hd};class sT extends Hd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ht(this.persistence.referenceDelegate instanceof zd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Lj(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kn.withCacheSize(this.cacheSizeBytes):kn.DEFAULT;return new Q_((r=>zd.mi(r,n)),this.serializer)}}class nm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>i1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=eT.bind(null,this.syncEngine),await I2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new P2})()}createDatastore(e){const n=ch(e.databaseInfo.databaseId),r=(function(u){return new p2(u)})(e.databaseInfo);return(function(u,f,p,x){return new y2(u,f,p,x)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,l,u,f,p){return new b2(r,l,u,f,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>i1(this.syncEngine,n,0)),(function(){return e1.v()?new e1:new d2})())}createSyncEngine(e,n){return(function(l,u,f,p,x,m,v){const b=new q2(l,u,f,p,x,m);return v&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=Ge(n);Te(ui,"RemoteStore shutting down."),r.Ea.add(5),await hc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}nm.provider={build:()=>new nm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ma("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="FirestoreClient";class rT{constructor(e,n,r,l,u){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=l,this.user=_n.UNAUTHENTICATED,this.clientId=gm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(r,(async f=>{Te(gr,"Received user=",f.uid),await this.authCredentialListener(f),this.user=f})),this.appCheckCredentials.start(r,(f=>(Te(gr,"Received new app check token=",f),this.appCheckCredentialListener(f,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Mm(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function R0(i,e){i.asyncQueue.verifyOperationInProgress(),Te(gr,"Initializing OfflineComponentProvider");const n=i.configuration;await e.initialize(n);let r=n.initialUser;i.setCredentialChangeListener((async l=>{r.isEqual(l)||(await X_(e.localStore,l),r=l)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function l1(i,e){i.asyncQueue.verifyOperationInProgress();const n=await iT(i);Te(gr,"Initializing OnlineComponentProvider"),await e.initialize(n,i.configuration),i.setCredentialChangeListener((r=>n1(e.remoteStore,r))),i.setAppCheckTokenChangeListener(((r,l)=>n1(e.remoteStore,l))),i._onlineComponents=e}async function iT(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){Te(gr,"Using user provided OfflineComponentProvider");try{await R0(i,i._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(l){return l.name==="FirebaseError"?l.code===xe.FAILED_PRECONDITION||l.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(n))throw n;xo("Error using user provided cache. Falling back to memory cache: "+n),await R0(i,new Hd)}}else Te(gr,"Using default OfflineComponentProvider"),await R0(i,new sT(void 0));return i._offlineComponents}async function mb(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(Te(gr,"Using user provided OnlineComponentProvider"),await l1(i,i._uninitializedComponentsProvider._online)):(Te(gr,"Using default OnlineComponentProvider"),await l1(i,new nm))),i._onlineComponents}function oT(i){return mb(i).then((e=>e.syncEngine))}async function lT(i){const e=await mb(i),n=e.eventManager;return n.onListen=H2.bind(null,e.syncEngine),n.onUnlisten=K2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Y2.bind(null,e.syncEngine),n}function cT(i,e,n={}){const r=new lr;return i.asyncQueue.enqueueAndForget((async()=>(function(u,f,p,x,m){const v=new aT({next:S=>{v.Nu(),f.enqueueAndForget((()=>B2(u,b)));const I=S.docs.has(p);!I&&S.fromCache?m.reject(new De(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&S.fromCache&&x&&x.source==="server"?m.reject(new De(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),b=new L2(Sm(p.path),v,{includeMetadataChanges:!0,qa:!0});return O2(u,b)})(await lT(i),i.asyncQueue,e,n,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="firestore.googleapis.com",u1=!0;class d1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new De(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=gb,this.ssl=u1}else this.host=e.host,this.ssl=e.ssl??u1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Y_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Mj)throw new De(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_C("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pb(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new De(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new De(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new De(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,l){return r.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hh{constructor(e,n,r,l){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new d1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new d1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new uC;switch(r.type){case"firstParty":return new mC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new De(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=c1.get(n);r&&(Te("ComponentProvider","Removing Datastore"),c1.delete(n),r.terminate())})(this),Promise.resolve()}}function uT(i,e,n,r={}){i=ur(i,hh);const l=So(e),u=i._getSettings(),f={...u,emulatorOptions:i._getEmulatorOptions()},p=`${e}:${n}`;l&&($1(`https://${p}`),G1("Firestore",!0)),u.host!==gb&&u.host!==p&&xo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...u,host:p,ssl:l,emulatorOptions:r};if(!oi(x,f)&&(i._setSettings(x),r.mockUserToken)){let m,v;if(typeof r.mockUserToken=="string")m=r.mockUserToken,v=_n.MOCK_USER;else{m=PN(r.mockUserToken,i._app?.options.projectId);const b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new De(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new _n(b)}i._authCredentials=new dC(new i_(m,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Um(this.firestore,e,this._query)}}class Qt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}toJSON(){return{type:Qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(cc(n,Qt._jsonSchema))return new Qt(e,r||null,new Pe(Tt.fromString(n.referencePath)))}}Qt._jsonSchemaVersion="firestore/documentReference/1.0",Qt._jsonSchema={type:Yt("string",Qt._jsonSchemaVersion),referencePath:Yt("string")};class cr extends Um{constructor(e,n,r){super(e,n,Sm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new Pe(e))}withConverter(e){return new cr(this.firestore,e,this._path)}}function dT(i,e,...n){if(i=Sn(i),o_("collection","path",e),i instanceof hh){const r=Tt.fromString(e,...n);return Ny(r),new cr(i,null,r)}{if(!(i instanceof Qt||i instanceof cr))throw new De(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(Tt.fromString(e,...n));return Ny(r),new cr(i.firestore,null,r)}}function ai(i,e,...n){if(i=Sn(i),arguments.length===1&&(e=gm.newId()),o_("doc","path",e),i instanceof hh){const r=Tt.fromString(e,...n);return Ay(r),new Qt(i,null,new Pe(r))}{if(!(i instanceof Qt||i instanceof cr))throw new De(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(Tt.fromString(e,...n));return Ay(r),new Qt(i.firestore,i instanceof cr?i.converter:null,new Pe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="AsyncQueue";class f1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Z_(this,"async_queue_retry"),this._c=()=>{const r=T0();r&&Te(h1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=T0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=T0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new lr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Co(e))throw e;Te(h1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ma("INTERNAL UNHANDLED ERROR: ",m1(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const l=Bm.createAndSchedule(this,e,n,r,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Ve(47125,{Pc:m1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function m1(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class mc extends hh{constructor(e,n,r,l){super(e,n,r,l),this.type="firestore",this._queue=new f1,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new f1(e),this._firestoreClient=void 0,await e}}}function hT(i,e){const n=typeof i=="object"?i:X1(),r=typeof i=="string"?i:Od,l=mm(n,"firestore").getImmediate({identifier:r});if(!l._initialized){const u=IN("firestore");u&&uT(l,...u)}return l}function xb(i){if(i._terminated)throw new De(xe.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||fT(i),i._firestoreClient}function fT(i){const e=i._freezeSettings(),n=(function(l,u,f,p){return new DC(l,u,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,pb(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new rT(i._authCredentials,i._appCheckCredentials,i._queue,n,i._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ns(pn.fromBase64String(e))}catch(n){throw new De(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ns(pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ns._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cc(e,ns._jsonSchema))return ns.fromBase64String(e.bytes)}}ns._jsonSchemaVersion="firestore/bytes/1.0",ns._jsonSchema={type:Yt("string",ns._jsonSchemaVersion),bytes:Yt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new De(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new De(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new De(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ms._jsonSchemaVersion}}static fromJSON(e){if(cc(e,Ms._jsonSchema))return new Ms(e.latitude,e.longitude)}}Ms._jsonSchemaVersion="firestore/geoPoint/1.0",Ms._jsonSchema={type:Yt("string",Ms._jsonSchemaVersion),latitude:Yt("number"),longitude:Yt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,l){if(r.length!==l.length)return!1;for(let u=0;u<r.length;++u)if(r[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cc(e,Fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Fs(e.vectorValues);throw new De(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fs._jsonSchemaVersion="firestore/vectorValue/1.0",Fs._jsonSchema={type:Yt("string",Fs._jsonSchemaVersion),vectorValues:Yt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT=/^__.*__$/;class pT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new yr(e,this.data,this.fieldMask,n,this.fieldTransforms):new uc(e,this.data,n,this.fieldTransforms)}}class vb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new yr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function yb(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:i})}}class qm{constructor(e,n,r,l,u,f){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=l,u===void 0&&this.Rc(),this.fieldTransforms=u||[],this.fieldMask=f||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $d(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(yb(this.Ac)&&mT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ch(e)}Cc(e,n,r,l=!1){return new qm({Ac:e,methodName:n,Dc:r,path:mn.emptyPath(),fc:!1,bc:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hm(i){const e=i._freezeSettings(),n=ch(i._databaseId);return new gT(i._databaseId,!!e.ignoreUndefinedProperties,n)}function _b(i,e,n,r,l,u={}){const f=i.Cc(u.merge||u.mergeFields?2:0,e,n,l);$m("Data must be an object, but it was:",f,r);const p=bb(r,f);let x,m;if(u.merge)x=new qn(f.fieldMask),m=f.fieldTransforms;else if(u.mergeFields){const v=[];for(const b of u.mergeFields){const S=sm(e,b,n);if(!f.contains(S))throw new De(xe.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);Sb(v,S)||v.push(S)}x=new qn(v),m=f.fieldTransforms.filter((b=>x.covers(b.field)))}else x=null,m=f.fieldTransforms;return new pT(new Pn(p),x,m)}class mh extends zm{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mh}}function xT(i,e,n,r){const l=i.Cc(1,e,n);$m("Data must be an object, but it was:",l,r);const u=[],f=Pn.empty();vr(r,((x,m)=>{const v=Gm(e,x,n);m=Sn(m);const b=l.yc(v);if(m instanceof mh)u.push(v);else{const S=ph(m,b);S!=null&&(u.push(v),f.set(v,S))}}));const p=new qn(u);return new vb(f,p,l.fieldTransforms)}function vT(i,e,n,r,l,u){const f=i.Cc(1,e,n),p=[sm(e,r,n)],x=[l];if(u.length%2!=0)throw new De(xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<u.length;S+=2)p.push(sm(e,u[S])),x.push(u[S+1]);const m=[],v=Pn.empty();for(let S=p.length-1;S>=0;--S)if(!Sb(m,p[S])){const I=p[S];let R=x[S];R=Sn(R);const D=f.yc(I);if(R instanceof mh)m.push(I);else{const k=ph(R,D);k!=null&&(m.push(I),v.set(I,k))}}const b=new qn(m);return new vb(v,b,f.fieldTransforms)}function ph(i,e){if(Eb(i=Sn(i)))return $m("Unsupported field value:",e,i),bb(i,e);if(i instanceof zm)return(function(r,l){if(!yb(l.Ac))throw l.Sc(`${r._methodName}() can only be used with update() and set()`);if(!l.path)throw l.Sc(`${r._methodName}() is not currently supported inside arrays`);const u=r._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,l){const u=[];let f=0;for(const p of r){let x=ph(p,l.wc(f));x==null&&(x={nullValue:"NULL_VALUE"}),u.push(x),f++}return{arrayValue:{values:u}}})(i,e)}return(function(r,l){if((r=Sn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return tj(l.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const u=Rt.fromDate(r);return{timestampValue:Ud(l.serializer,u)}}if(r instanceof Rt){const u=new Rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ud(l.serializer,u)}}if(r instanceof Ms)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ns)return{bytesValue:U_(l.serializer,r._byteString)};if(r instanceof Qt){const u=l.databaseId,f=r.firestore._databaseId;if(!f.isEqual(u))throw l.Sc(`Document reference is for database ${f.projectId}/${f.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Cm(r.firestore._databaseId||l.databaseId,r._key.path)}}if(r instanceof Fs)return(function(f,p){return{mapValue:{fields:{[g_]:{stringValue:x_},[Bd]:{arrayValue:{values:f.toArray().map((m=>{if(typeof m!="number")throw p.Sc("VectorValues must only contain numeric values.");return Am(p.serializer,m)}))}}}}}})(r,l);throw l.Sc(`Unsupported field value: ${xm(r)}`)})(i,e)}function bb(i,e){const n={};return u_(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vr(i,((r,l)=>{const u=ph(l,e.mc(r));u!=null&&(n[r]=u)})),{mapValue:{fields:n}}}function Eb(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Rt||i instanceof Ms||i instanceof ns||i instanceof Qt||i instanceof zm||i instanceof Fs)}function $m(i,e,n){if(!Eb(n)||!l_(n)){const r=xm(n);throw r==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+r)}}function sm(i,e,n){if((e=Sn(e))instanceof fh)return e._internalPath;if(typeof e=="string")return Gm(i,e);throw $d("Field path arguments must be of type string or ",i,!1,void 0,n)}const yT=new RegExp("[~\\*/\\[\\]]");function Gm(i,e,n){if(e.search(yT)>=0)throw $d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,n);try{return new fh(...e.split("."))._internalPath}catch{throw $d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,n)}}function $d(i,e,n,r,l){const u=r&&!r.isEmpty(),f=l!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let x="";return(u||f)&&(x+=" (found",u&&(x+=` in field ${r}`),f&&(x+=` in document ${l}`),x+=")"),new De(xe.INVALID_ARGUMENT,p+i+x)}function Sb(i,e){return i.some((n=>n.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,n,r,l,u){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _T(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Nb("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class _T extends Ab{data(){return super.data()}}function Nb(i,e){return typeof e=="string"?Gm(i,e):e instanceof fh?e._internalPath:e._delegate._internalPath}class bT{convertValue(e,n="none"){switch(mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return vr(e,((l,u)=>{r[l]=this.convertValue(u,n)})),r}convertVectorValue(e){const n=e.fields?.[Bd].arrayValue?.values?.map((r=>Ht(r.doubleValue)));return new Fs(n)}convertGeoPoint(e){return new Ms(Ht(e.latitude),Ht(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=nh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ec(e));default:return null}}convertTimestamp(e){const n=hr(e);return new Rt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Tt.fromString(e);ht(K_(r),9688,{name:e});const l=new tc(r.get(1),r.get(3)),u=new Pe(r.popFirst(5));return l.isEqual(n)||ma(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(i,e,n){let r;return r=i?n&&(n.merge||n.mergeFields)?i.toFirestore(e,n):i.toFirestore(e):e,r}class Ul{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ii extends Ab{constructor(e,n,r,l,u,f){super(e,n,r,l,f),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Nb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new De(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ii._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ii._jsonSchemaVersion="firestore/documentSnapshot/1.0",ii._jsonSchema={type:Yt("string",ii._jsonSchemaVersion),bundleSource:Yt("string","DocumentSnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class Cd extends ii{data(e={}){return super.data(e)}}class Yl{constructor(e,n,r,l){this._firestore=e,this._userDataWriter=n,this._snapshot=l,this.metadata=new Ul(l.hasPendingWrites,l.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new Cd(this._firestore,this._userDataWriter,r.key,r,new Ul(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new De(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let f=0;return l._snapshot.docChanges.map((p=>{const x=new Cd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Ul(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:x,oldIndex:-1,newIndex:f++}}))}{let f=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const x=new Cd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Ul(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let m=-1,v=-1;return p.type!==0&&(m=f.indexOf(p.doc.key),f=f.delete(p.doc.key)),p.type!==1&&(f=f.add(p.doc),v=f.indexOf(p.doc.key)),{type:ET(p.type),doc:x,oldIndex:m,newIndex:v}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new De(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Yl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(n.push(u._document),r.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ET(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(i){i=ur(i,Qt);const e=ur(i.firestore,mc);return cT(xb(e),i._key).then((n=>wT(e,i,n)))}Yl._jsonSchemaVersion="firestore/querySnapshot/1.0",Yl._jsonSchema={type:Yt("string",Yl._jsonSchemaVersion),bundleSource:Yt("string","QuerySnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class ST extends bT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ns(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,n)}}function D0(i,e,n){i=ur(i,Qt);const r=ur(i.firestore,mc),l=wb(i.converter,e,n);return Km(r,[_b(Hm(r),"setDoc",i._key,l,i.converter!==null,n).toMutation(i._key,gs.none())])}function AT(i,e,n,...r){i=ur(i,Qt);const l=ur(i.firestore,mc),u=Hm(l);let f;return f=typeof(e=Sn(e))=="string"||e instanceof fh?vT(u,"updateDoc",i._key,e,n,r):xT(u,"updateDoc",i._key,e),Km(l,[f.toMutation(i._key,gs.exists(!0))])}function NT(i,e){const n=ur(i.firestore,mc),r=ai(i),l=wb(i.converter,e);return Km(n,[_b(Hm(i.firestore),"addDoc",r._key,l,i.converter!==null,{}).toMutation(r._key,gs.exists(!1))]).then((()=>r))}function Km(i,e){return(function(r,l){const u=new lr;return r.asyncQueue.enqueueAndForget((async()=>Q2(await oT(r),l,u))),u.promise})(xb(i),e)}function wT(i,e,n){const r=n.docs.get(e._key),l=new ST(i);return new ii(i,l,e._key,r,new Ul(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(l){No=l})(Ao),go(new li("firestore",((r,{instanceIdentifier:l,options:u})=>{const f=r.getProvider("app").getImmediate(),p=new mc(new hC(r.getProvider("auth-internal")),new pC(f,r.getProvider("app-check-internal")),(function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new De(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tc(m.options.projectId,v)})(f,l),f);return u={useFetchStreams:n,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),ir(_y,by,e),ir(_y,by,"esm2020")})();function Cb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CT=Cb,jb=new oc("auth","Firebase",Cb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd=new hm("@firebase/auth");function jT(i,...e){Gd.logLevel<=et.WARN&&Gd.warn(`Auth (${Ao}): ${i}`,...e)}function jd(i,...e){Gd.logLevel<=et.ERROR&&Gd.error(`Auth (${Ao}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(i,...e){throw Ym(i,...e)}function Ls(i,...e){return Ym(i,...e)}function Tb(i,e,n){const r={...CT(),[e]:n};return new oc("auth","Firebase",r).create(e,{appName:i.name})}function ha(i){return Tb(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ym(i,...e){if(typeof i!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=i.name),i._errorFactory.create(n,...r)}return jb.create(i,...e)}function Le(i,e,...n){if(!i)throw Ym(e,...n)}function ua(i){const e="INTERNAL ASSERTION FAILED: "+i;throw jd(e),new Error(e)}function ga(i,e){i||ua(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am(){return typeof self<"u"&&self.location?.href||""}function TT(){return g1()==="http:"||g1()==="https:"}function g1(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TT()||VN()||"connection"in navigator)?navigator.onLine:!0}function DT(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ga(n>e,"Short delay should be less than long delay!"),this.isMobile=MN()||UN()}get(){return RT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(i,e){ga(i.emulator,"Emulator should always be set here");const{url:n}=i.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ua("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ua("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ua("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PT=new pc(3e4,6e4);function _r(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function br(i,e,n,r,l={}){return Db(i,l,async()=>{let u={},f={};r&&(e==="GET"?f=r:u={body:JSON.stringify(r)});const p=lc({key:i.config.apiKey,...f}).slice(1),x=await i._getAdditionalHeaders();x["Content-Type"]="application/json",i.languageCode&&(x["X-Firebase-Locale"]=i.languageCode);const m={method:e,headers:x,...u};return LN()||(m.referrerPolicy="no-referrer"),i.emulatorConfig&&So(i.emulatorConfig.host)&&(m.credentials="include"),Rb.fetch()(await Ib(i,i.config.apiHost,n,p),m)})}async function Db(i,e,n){i._canInitEmulator=!1;const r={...IT,...e};try{const l=new BT(i),u=await Promise.race([n(),l.promise]);l.clearNetworkTimeout();const f=await u.json();if("needConfirmation"in f)throw Lu(i,"account-exists-with-different-credential",f);if(u.ok&&!("errorMessage"in f))return f;{const p=u.ok?f.errorMessage:f.error.message,[x,m]=p.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw Lu(i,"credential-already-in-use",f);if(x==="EMAIL_EXISTS")throw Lu(i,"email-already-in-use",f);if(x==="USER_DISABLED")throw Lu(i,"user-disabled",f);const v=r[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Tb(i,v,m);xs(i,v)}}catch(l){if(l instanceof xa)throw l;xs(i,"network-request-failed",{message:String(l)})}}async function gc(i,e,n,r,l={}){const u=await br(i,e,n,r,l);return"mfaPendingCredential"in u&&xs(i,"multi-factor-auth-required",{_serverResponse:u}),u}async function Ib(i,e,n,r){const l=`${e}${n}?${r}`,u=i,f=u.config.emulator?Qm(i.config,l):`${i.config.apiScheme}://${l}`;return kT.includes(n)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(f).toString():f}function OT(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ls(this.auth,"network-request-failed")),PT.get())})}}function Lu(i,e,n){const r={appName:i.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const l=Ls(i,e,r);return l.customData._tokenResponse=n,l}function x1(i){return i!==void 0&&i.enterprise!==void 0}class MT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return OT(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FT(i,e){return br(i,"GET","/v2/recaptchaConfig",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LT(i,e){return br(i,"POST","/v1/accounts:delete",e)}async function Kd(i,e){return br(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ql(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VT(i,e=!1){const n=Sn(i),r=await n.getIdToken(e),l=Xm(r);Le(l&&l.exp&&l.auth_time&&l.iat,n.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,f=u?.sign_in_provider;return{claims:l,token:r,authTime:Ql(I0(l.auth_time)),issuedAtTime:Ql(I0(l.iat)),expirationTime:Ql(I0(l.exp)),signInProvider:f||null,signInSecondFactor:u?.sign_in_second_factor||null}}function I0(i){return Number(i)*1e3}function Xm(i){const[e,n,r]=i.split(".");if(e===void 0||n===void 0||r===void 0)return jd("JWT malformed, contained fewer than 3 sections"),null;try{const l=U1(n);return l?JSON.parse(l):(jd("Failed to decode base64 JWT payload"),null)}catch(l){return jd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function v1(i){const e=Xm(i);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rc(i,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xa&&UT(r)&&i.auth.currentUser===i&&await i.auth.signOut(),r}}function UT({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ql(this.lastLoginAt),this.creationTime=Ql(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yd(i){const e=i.auth,n=await i.getIdToken(),r=await rc(i,Kd(e,{idToken:n}));Le(r?.users.length,e,"internal-error");const l=r.users[0];i._notifyReloadListener(l);const u=l.providerUserInfo?.length?kb(l.providerUserInfo):[],f=HT(i.providerData,u),p=i.isAnonymous,x=!(i.email&&l.passwordHash)&&!f?.length,m=p?x:!1,v={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new rm(l.createdAt,l.lastLoginAt),isAnonymous:m};Object.assign(i,v)}async function qT(i){const e=Sn(i);await Yd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HT(i,e){return[...i.filter(r=>!e.some(l=>l.providerId===r.providerId)),...e]}function kb(i){return i.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $T(i,e){const n=await Db(i,{},async()=>{const r=lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=i.config,f=await Ib(i,l,"/v1/token",`key=${u}`),p=await i._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:p,body:r};return i.emulatorConfig&&So(i.emulatorConfig.host)&&(x.credentials="include"),Rb.fetch()(f,x)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function GT(i,e){return br(i,"POST","/v2/accounts:revokeToken",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):v1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const n=v1(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:l,expiresIn:u}=await $T(e,n);this.updateTokensAndExpiration(r,l,Number(u))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:l,expirationTime:u}=n,f=new fo;return r&&(Le(typeof r=="string","internal-error",{appName:e}),f.refreshToken=r),l&&(Le(typeof l=="string","internal-error",{appName:e}),f.accessToken=l),u&&(Le(typeof u=="number","internal-error",{appName:e}),f.expirationTime=u),f}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fo,this.toJSON())}_performRefresh(){return ua("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(i,e){Le(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class ps{constructor({uid:e,auth:n,stsTokenManager:r,...l}){this.providerId="firebase",this.proactiveRefresh=new zT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new rm(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const n=await rc(this,this.stsTokenManager.getToken(this.auth,e));return Le(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return VT(this,e)}reload(){return qT(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ps({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Yd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ts(this.auth.app))return Promise.reject(ha(this.auth));const e=await this.getIdToken();return await rc(this,LT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,l=n.email??void 0,u=n.phoneNumber??void 0,f=n.photoURL??void 0,p=n.tenantId??void 0,x=n._redirectEventId??void 0,m=n.createdAt??void 0,v=n.lastLoginAt??void 0,{uid:b,emailVerified:S,isAnonymous:I,providerData:R,stsTokenManager:D}=n;Le(b&&D,e,"internal-error");const k=fo.fromJSON(this.name,D);Le(typeof b=="string",e,"internal-error"),Wa(r,e.name),Wa(l,e.name),Le(typeof S=="boolean",e,"internal-error"),Le(typeof I=="boolean",e,"internal-error"),Wa(u,e.name),Wa(f,e.name),Wa(p,e.name),Wa(x,e.name),Wa(m,e.name),Wa(v,e.name);const q=new ps({uid:b,auth:e,email:l,emailVerified:S,displayName:r,isAnonymous:I,photoURL:f,phoneNumber:u,tenantId:p,stsTokenManager:k,createdAt:m,lastLoginAt:v});return R&&Array.isArray(R)&&(q.providerData=R.map(O=>({...O}))),x&&(q._redirectEventId=x),q}static async _fromIdTokenResponse(e,n,r=!1){const l=new fo;l.updateFromServerResponse(n);const u=new ps({uid:n.localId,auth:e,stsTokenManager:l,isAnonymous:r});return await Yd(u),u}static async _fromGetAccountInfoResponse(e,n,r){const l=n.users[0];Le(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?kb(l.providerUserInfo):[],f=!(l.email&&l.passwordHash)&&!u?.length,p=new fo;p.updateFromIdToken(r);const x=new ps({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:f}),m={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new rm(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(x,m),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1=new Map;function da(i){ga(i instanceof Function,"Expected a class definition");let e=y1.get(i);return e?(ga(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,y1.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Pb.type="NONE";const _1=Pb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(i,e,n){return`firebase:${i}:${e}:${n}`}class mo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:l,name:u}=this.auth;this.fullUserKey=Td(this.userKey,l.apiKey,u),this.fullPersistenceKey=Td("persistence",l.apiKey,u),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Kd(this.auth,{idToken:e}).catch(()=>{});return n?ps._fromGetAccountInfoResponse(this.auth,n,e):null}return ps._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new mo(da(_1),e,r);const l=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let u=l[0]||da(_1);const f=Td(r,e.config.apiKey,e.name);let p=null;for(const m of n)try{const v=await m._get(f);if(v){let b;if(typeof v=="string"){const S=await Kd(e,{idToken:v}).catch(()=>{});if(!S)break;b=await ps._fromGetAccountInfoResponse(e,S,v)}else b=ps._fromJSON(e,v);m!==u&&(p=b),u=m;break}}catch{}const x=l.filter(m=>m._shouldAllowMigration);return!u._shouldAllowMigration||!x.length?new mo(u,e,r):(u=x[0],p&&await u._set(f,p.toJSON()),await Promise.all(n.map(async m=>{if(m!==u)try{await m._remove(f)}catch{}})),new mo(u,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ob(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Vb(e))return"Blackberry";if(Ub(e))return"Webos";if(Bb(e))return"Safari";if((e.includes("chrome/")||Mb(e))&&!e.includes("edge/"))return"Chrome";if(Lb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=i.match(n);if(r?.length===2)return r[1]}return"Other"}function Ob(i=En()){return/firefox\//i.test(i)}function Bb(i=En()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mb(i=En()){return/crios\//i.test(i)}function Fb(i=En()){return/iemobile/i.test(i)}function Lb(i=En()){return/android/i.test(i)}function Vb(i=En()){return/blackberry/i.test(i)}function Ub(i=En()){return/webos/i.test(i)}function Wm(i=En()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function KT(i=En()){return Wm(i)&&!!window.navigator?.standalone}function YT(){return zN()&&document.documentMode===10}function zb(i=En()){return Wm(i)||Lb(i)||Ub(i)||Vb(i)||/windows phone/i.test(i)||Fb(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(i,e=[]){let n;switch(i){case"Browser":n=b1(En());break;case"Worker":n=`${b1(En())}-${i}`;break;default:n=i}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=u=>new Promise((f,p)=>{try{const x=e(u);f(x)}catch(x){p(x)}});r.onAbort=n,this.queue.push(r);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const l of n)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XT(i,e={}){return br(i,"GET","/v2/passwordPolicy",_r(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=6;class ZT{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??WT,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),l&&(n.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let l=0;l<e.length;l++)r=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,n,r,l){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new E1(this),this.idTokenSubscription=new E1(this),this.beforeStateQueue=new QT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=da(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Kd(this,{idToken:e}),r=await ps._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ts(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,f=r?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===f)&&p?.user&&(r=p.user,l=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(r)}catch(u){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ts(this.app))return Promise.reject(ha(this));const n=e?Sn(e):null;return n&&Le(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ts(this.app)?Promise.reject(ha(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ts(this.app)?Promise.reject(ha(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(da(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await XT(this),n=new ZT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new oc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await GT(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&da(e)||this._popupRedirectResolver;Le(n,this,"argument-error"),this.redirectPersistenceManager=await mo.create(this,[da(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,l){if(this._deleted)return()=>{};const u=typeof n=="function"?n:n.next.bind(n);let f=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(p,this,"internal-error"),p.then(()=>{f||u(this.currentUser)}),typeof n=="function"){const x=e.addObserver(n,r,l);return()=>{f=!0,x()}}else{const x=e.addObserver(n);return()=>{f=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ts(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jT(`Error while retrieving App Check token: ${e.error}`),e?.token}}function xi(i){return Sn(i)}class E1{constructor(e){this.auth=e,this.observer=null,this.addObserver=XN(n=>this.observer=n)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function e4(i){gh=i}function Hb(i){return gh.loadJS(i)}function t4(){return gh.recaptchaEnterpriseScript}function n4(){return gh.gapiScript}function s4(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class a4{constructor(){this.enterprise=new r4}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class r4{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const i4="recaptcha-enterprise",$b="NO_RECAPTCHA";class o4{constructor(e){this.type=i4,this.auth=xi(e)}async verify(e="verify",n=!1){async function r(u){if(!n){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(f,p)=>{FT(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const m=new MT(x);return u.tenantId==null?u._agentRecaptchaConfig=m:u._tenantRecaptchaConfigs[u.tenantId]=m,f(m.siteKey)}}).catch(x=>{p(x)})})}function l(u,f,p){const x=window.grecaptcha;x1(x)?x.enterprise.ready(()=>{x.enterprise.execute(u,{action:e}).then(m=>{f(m)}).catch(()=>{f($b)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new a4().execute("siteKey",{action:"verify"}):new Promise((u,f)=>{r(this.auth).then(p=>{if(!n&&x1(window.grecaptcha))l(p,u,f);else{if(typeof window>"u"){f(new Error("RecaptchaVerifier is only supported in browser"));return}let x=t4();x.length!==0&&(x+=p),Hb(x).then(()=>{l(p,u,f)}).catch(m=>{f(m)})}}).catch(p=>{f(p)})})}}async function S1(i,e,n,r=!1,l=!1){const u=new o4(i);let f;if(l)f=$b;else try{f=await u.verify(n)}catch{f=await u.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const x=p.phoneEnrollmentInfo.phoneNumber,m=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:m,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const x=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return r?Object.assign(p,{captchaResp:f}):Object.assign(p,{captchaResponse:f}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function im(i,e,n,r,l){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await S1(i,e,n,n==="getOobCode");return r(i,u)}else return r(i,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await S1(i,e,n,n==="getOobCode");return r(i,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(i,e){const n=mm(i,"auth");if(n.isInitialized()){const l=n.getImmediate(),u=n.getOptions();if(oi(u,e??{}))return l;xs(l,"already-initialized")}return n.initialize({options:e})}function c4(i,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(da);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(r,e?.popupRedirectResolver)}function u4(i,e,n){const r=xi(i);Le(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const l=!1,u=Gb(e),{host:f,port:p}=d4(e),x=p===null?"":`:${p}`,m={url:`${u}//${f}${x}/`},v=Object.freeze({host:f,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!r._canInitEmulator){Le(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Le(oi(m,r.config.emulator)&&oi(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,So(f)?($1(`${u}//${f}${x}`),G1("Auth",!0)):h4()}function Gb(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function d4(i){const e=Gb(i),n=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(r);if(l){const u=l[1];return{host:u,port:A1(r.substr(u.length+1))}}else{const[u,f]=r.split(":");return{host:u,port:A1(f)}}}function A1(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function h4(){function i(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ua("not implemented")}_getIdTokenResponse(e){return ua("not implemented")}_linkToIdToken(e,n){return ua("not implemented")}_getReauthenticationResolver(e){return ua("not implemented")}}async function f4(i,e){return br(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m4(i,e){return gc(i,"POST","/v1/accounts:signInWithPassword",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p4(i,e){return gc(i,"POST","/v1/accounts:signInWithEmailLink",_r(i,e))}async function g4(i,e){return gc(i,"POST","/v1/accounts:signInWithEmailLink",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends Zm{constructor(e,n,r,l=null){super("password",r),this._email=e,this._password=n,this._tenantId=l}static _fromEmailAndPassword(e,n){return new ic(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ic(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return im(e,n,"signInWithPassword",m4);case"emailLink":return p4(e,{email:this._email,oobCode:this._password});default:xs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return im(e,r,"signUpPassword",f4);case"emailLink":return g4(e,{idToken:n,email:this._email,oobCode:this._password});default:xs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function po(i,e){return gc(i,"POST","/v1/accounts:signInWithIdp",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4="http://localhost";class di extends Zm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new di(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):xs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:l,...u}=n;if(!r||!l)return null;const f=new di(r,l);return f.idToken=u.idToken||void 0,f.accessToken=u.accessToken||void 0,f.secret=u.secret,f.nonce=u.nonce,f.pendingToken=u.pendingToken||null,f}_getIdTokenResponse(e){const n=this.buildRequest();return po(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,po(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,po(e,n)}buildRequest(){const e={requestUri:x4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=lc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function y4(i){const e=Bl(Ml(i)).link,n=e?Bl(Ml(e)).deep_link_id:null,r=Bl(Ml(i)).deep_link_id;return(r?Bl(Ml(r)).link:null)||r||n||e||i}class Jm{constructor(e){const n=Bl(Ml(e)),r=n.apiKey??null,l=n.oobCode??null,u=v4(n.mode??null);Le(r&&l&&u,"argument-error"),this.apiKey=r,this.operation=u,this.code=l,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=y4(e);try{return new Jm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(){this.providerId=To.PROVIDER_ID}static credential(e,n){return ic._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Jm.parseLink(n);return Le(r,"argument-error"),ic._fromEmailAndCode(e,r.code,r.tenantId)}}To.PROVIDER_ID="password";To.EMAIL_PASSWORD_SIGN_IN_METHOD="password";To.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends Kb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends xc{constructor(){super("facebook.com")}static credential(e){return di._fromParams({providerId:Za.PROVIDER_ID,signInMethod:Za.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Za.credentialFromTaggedObject(e)}static credentialFromError(e){return Za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Za.credential(e.oauthAccessToken)}catch{return null}}}Za.FACEBOOK_SIGN_IN_METHOD="facebook.com";Za.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends xc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return di._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ja.credential(n,r)}catch{return null}}}Ja.GOOGLE_SIGN_IN_METHOD="google.com";Ja.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends xc{constructor(){super("github.com")}static credential(e){return di._fromParams({providerId:er.PROVIDER_ID,signInMethod:er.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return er.credentialFromTaggedObject(e)}static credentialFromError(e){return er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return er.credential(e.oauthAccessToken)}catch{return null}}}er.GITHUB_SIGN_IN_METHOD="github.com";er.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends xc{constructor(){super("twitter.com")}static credential(e,n){return di._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return tr.credential(n,r)}catch{return null}}}tr.TWITTER_SIGN_IN_METHOD="twitter.com";tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4(i,e){return gc(i,"POST","/v1/accounts:signUp",_r(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,l=!1){const u=await ps._fromIdTokenResponse(e,r,l),f=N1(r);return new hi({user:u,providerId:f,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const l=N1(r);return new hi({user:e,providerId:l,_tokenResponse:r,operationType:n})}}function N1(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends xa{constructor(e,n,r,l){super(n.code,n.message),this.operationType=r,this.user=l,Object.setPrototypeOf(this,Qd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,l){return new Qd(e,n,r,l)}}function Yb(i,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(i):n._getIdTokenResponse(i)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Qd._fromErrorAndOperation(i,u,e,r):u})}async function b4(i,e,n=!1){const r=await rc(i,e._linkToIdToken(i.auth,await i.getIdToken()),n);return hi._forOperation(i,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4(i,e,n=!1){const{auth:r}=i;if(ts(r.app))return Promise.reject(ha(r));const l="reauthenticate";try{const u=await rc(i,Yb(r,l,e,i),n);Le(u.idToken,r,"internal-error");const f=Xm(u.idToken);Le(f,r,"internal-error");const{sub:p}=f;return Le(i.uid===p,r,"user-mismatch"),hi._forOperation(i,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&xs(r,"user-mismatch"),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qb(i,e,n=!1){if(ts(i.app))return Promise.reject(ha(i));const r="signIn",l=await Yb(i,r,e),u=await hi._fromIdTokenResponse(i,r,l);return n||await i._updateCurrentUser(u.user),u}async function S4(i,e){return Qb(xi(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xb(i){const e=xi(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function A4(i,e,n){if(ts(i.app))return Promise.reject(ha(i));const r=xi(i),f=await im(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_4).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&Xb(i),x}),p=await hi._fromIdTokenResponse(r,"signIn",f);return await r._updateCurrentUser(p.user),p}function N4(i,e,n){return ts(i.app)?Promise.reject(ha(i)):S4(Sn(i),To.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Xb(i),r})}function w4(i,e,n,r){return Sn(i).onIdTokenChanged(e,n,r)}function C4(i,e,n){return Sn(i).beforeAuthStateChanged(e,n)}function j4(i){return Sn(i).signOut()}const Xd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Xd,"1"),this.storage.removeItem(Xd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=1e3,R4=10;class Zb extends Wb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),l=this.localCache[n];r!==l&&e(n,l,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((f,p,x)=>{this.notifyListeners(f,x)});return}const r=e.key;n?this.detachListener():this.stopPolling();const l=()=>{const f=this.storage.getItem(r);!n&&this.localCache[r]===f||this.notifyListeners(r,f)},u=this.storage.getItem(r);YT()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,R4):l()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const l of Array.from(r))l(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},T4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zb.type="LOCAL";const D4=Zb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb extends Wb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Jb.type="SESSION";const eE=Jb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(l=>l.isListeningto(e));if(n)return n;const r=new xh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:l,data:u}=n.data,f=this.handlersMap[l];if(!f?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:l});const p=Array.from(f).map(async m=>m(n.origin,u)),x=await I4(p);n.ports[0].postMessage({status:"done",eventId:r,eventType:l,response:x})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(i="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return i+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,f;return new Promise((p,x)=>{const m=ep("",20);l.port1.start();const v=setTimeout(()=>{x(new Error("unsupported_event"))},r);f={messageChannel:l,onMessage(b){const S=b;if(S.data.eventId===m)switch(S.data.status){case"ack":clearTimeout(v),u=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(S.data.response);break;default:clearTimeout(v),clearTimeout(u),x(new Error("invalid_response"));break}}},this.handlers.add(f),l.port1.addEventListener("message",f.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[l.port2])}).finally(()=>{f&&this.removeMessageHandler(f)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(){return window}function P4(i){Vs().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(){return typeof Vs().WorkerGlobalScope<"u"&&typeof Vs().importScripts=="function"}async function O4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function B4(){return navigator?.serviceWorker?.controller||null}function M4(){return tE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE="firebaseLocalStorageDb",F4=1,Wd="firebaseLocalStorage",sE="fbase_key";class vc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vh(i,e){return i.transaction([Wd],e?"readwrite":"readonly").objectStore(Wd)}function L4(){const i=indexedDB.deleteDatabase(nE);return new vc(i).toPromise()}function om(){const i=indexedDB.open(nE,F4);return new Promise((e,n)=>{i.addEventListener("error",()=>{n(i.error)}),i.addEventListener("upgradeneeded",()=>{const r=i.result;try{r.createObjectStore(Wd,{keyPath:sE})}catch(l){n(l)}}),i.addEventListener("success",async()=>{const r=i.result;r.objectStoreNames.contains(Wd)?e(r):(r.close(),await L4(),e(await om()))})})}async function w1(i,e,n){const r=vh(i,!0).put({[sE]:e,value:n});return new vc(r).toPromise()}async function V4(i,e){const n=vh(i,!1).get(e),r=await new vc(n).toPromise();return r===void 0?null:r.value}function C1(i,e){const n=vh(i,!0).delete(e);return new vc(n).toPromise()}const U4=800,z4=3;class aE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await om(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>z4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xh._getInstance(M4()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await O4(),!this.activeServiceWorker)return;this.sender=new k4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||B4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await om();return await w1(e,Xd,"1"),await C1(e,Xd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>w1(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>V4(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>C1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=vh(l,!1).getAll();return new vc(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)r.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),n.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!r.has(l)&&(this.notifyListeners(l,null),n.push(l));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const l of Array.from(r))l(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),U4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aE.type="LOCAL";const q4=aE;new pc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H4(i,e){return e?da(e):(Le(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp extends Zm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return po(e,this._buildIdpRequest())}_linkToIdToken(e,n){return po(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return po(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function $4(i){return Qb(i.auth,new tp(i),i.bypassAuthState)}function G4(i){const{auth:e,user:n}=i;return Le(n,e,"internal-error"),E4(n,new tp(i),i.bypassAuthState)}async function K4(i){const{auth:e,user:n}=i;return Le(n,e,"internal-error"),b4(n,new tp(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,n,r,l,u=!1){this.auth=e,this.resolver=r,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:l,tenantId:u,error:f,type:p}=e;if(f){this.reject(f);return}const x={auth:this.auth,requestUri:n,sessionId:r,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(x))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $4;case"linkViaPopup":case"linkViaRedirect":return K4;case"reauthViaPopup":case"reauthViaRedirect":return G4;default:xs(this.auth,"internal-error")}}resolve(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=new pc(2e3,1e4);class uo extends rE{constructor(e,n,r,l,u){super(e,n,l,u),this.provider=r,this.authWindow=null,this.pollId=null,uo.currentPopupAction&&uo.currentPopupAction.cancel(),uo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){ga(this.filter.length===1,"Popup operations only handle one event");const e=ep();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,uo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Y4.get())};e()}}uo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="pendingRedirect",Rd=new Map;class X4 extends rE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Rd.get(this.auth._key());if(!e){try{const r=await W4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Rd.set(this.auth._key(),e)}return this.bypassAuthState||Rd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function W4(i,e){const n=eR(e),r=J4(i);if(!await r._isAvailable())return!1;const l=await r._get(n)==="true";return await r._remove(n),l}function Z4(i,e){Rd.set(i._key(),e)}function J4(i){return da(i._redirectPersistence)}function eR(i){return Td(Q4,i.config.apiKey,i.name)}async function tR(i,e,n=!1){if(ts(i.app))return Promise.reject(ha(i));const r=xi(i),l=H4(r,e),f=await new X4(r,l,n).execute();return f&&!n&&(delete f.user._redirectEventId,await r._persistUserIfCurrent(f.user),await r._setRedirectUser(null,e)),f}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=600*1e3;class sR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aR(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!iE(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Ls(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nR&&this.cachedEventUids.clear(),this.cachedEventUids.has(j1(e))}saveEventToCache(e){this.cachedEventUids.add(j1(e)),this.lastProcessedEventTime=Date.now()}}function j1(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function iE({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function aR(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iE(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(i,e={}){return br(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oR=/^https?/;async function lR(i){if(i.config.emulator)return;const{authorizedDomains:e}=await rR(i);for(const n of e)try{if(cR(n))return}catch{}xs(i,"unauthorized-domain")}function cR(i){const e=am(),{protocol:n,hostname:r}=new URL(e);if(i.startsWith("chrome-extension://")){const f=new URL(i);return f.hostname===""&&r===""?n==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&f.hostname===r}if(!oR.test(n))return!1;if(iR.test(i))return r===i;const l=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=new pc(3e4,6e4);function T1(){const i=Vs().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let n=0;n<i.CP.length;n++)i.CP[n]=null}}function dR(i){return new Promise((e,n)=>{function r(){T1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{T1(),n(Ls(i,"network-request-failed"))},timeout:uR.get()})}if(Vs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Vs().gapi?.load)r();else{const l=s4("iframefcb");return Vs()[l]=()=>{gapi.load?r():n(Ls(i,"network-request-failed"))},Hb(`${n4()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Dd=null,e})}let Dd=null;function hR(i){return Dd=Dd||dR(i),Dd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR=new pc(5e3,15e3),mR="__/auth/iframe",pR="emulator/auth/iframe",gR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vR(i){const e=i.config;Le(e.authDomain,i,"auth-domain-config-required");const n=e.emulator?Qm(e,pR):`https://${i.config.authDomain}/${mR}`,r={apiKey:e.apiKey,appName:i.name,v:Ao},l=xR.get(i.config.apiHost);l&&(r.eid=l);const u=i._getFrameworks();return u.length&&(r.fw=u.join(",")),`${n}?${lc(r).slice(1)}`}async function yR(i){const e=await hR(i),n=Vs().gapi;return Le(n,i,"internal-error"),e.open({where:document.body,url:vR(i),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gR,dontclear:!0},r=>new Promise(async(l,u)=>{await r.restyle({setHideOnLeave:!1});const f=Ls(i,"network-request-failed"),p=Vs().setTimeout(()=>{u(f)},fR.get());function x(){Vs().clearTimeout(p),l(r)}r.ping(x).then(x,()=>{u(f)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bR=500,ER=600,SR="_blank",AR="http://localhost";class R1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NR(i,e,n,r=bR,l=ER){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),f=Math.max((window.screen.availWidth-r)/2,0).toString();let p="";const x={..._R,width:r.toString(),height:l.toString(),top:u,left:f},m=En().toLowerCase();n&&(p=Mb(m)?SR:n),Ob(m)&&(e=e||AR,x.scrollbars="yes");const v=Object.entries(x).reduce((S,[I,R])=>`${S}${I}=${R},`,"");if(KT(m)&&p!=="_self")return wR(e||"",p),new R1(null);const b=window.open(e||"",p,v);Le(b,i,"popup-blocked");try{b.focus()}catch{}return new R1(b)}function wR(i,e){const n=document.createElement("a");n.href=i,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="__/auth/handler",jR="emulator/auth/handler",TR=encodeURIComponent("fac");async function D1(i,e,n,r,l,u){Le(i.config.authDomain,i,"auth-domain-config-required"),Le(i.config.apiKey,i,"invalid-api-key");const f={apiKey:i.config.apiKey,appName:i.name,authType:n,redirectUrl:r,v:Ao,eventId:l};if(e instanceof Kb){e.setDefaultLanguage(i.languageCode),f.providerId=e.providerId||"",QN(e.getCustomParameters())||(f.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,b]of Object.entries({}))f[v]=b}if(e instanceof xc){const v=e.getScopes().filter(b=>b!=="");v.length>0&&(f.scopes=v.join(","))}i.tenantId&&(f.tid=i.tenantId);const p=f;for(const v of Object.keys(p))p[v]===void 0&&delete p[v];const x=await i._getAppCheckToken(),m=x?`#${TR}=${encodeURIComponent(x)}`:"";return`${RR(i)}?${lc(p).slice(1)}${m}`}function RR({config:i}){return i.emulator?Qm(i,jR):`https://${i.authDomain}/${CR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="webStorageSupport";class DR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eE,this._completeRedirectFn=tR,this._overrideRedirectResult=Z4}async _openPopup(e,n,r,l){ga(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await D1(e,n,r,am(),l);return NR(e,u,ep())}async _openRedirect(e,n,r,l){await this._originValidation(e);const u=await D1(e,n,r,am(),l);return P4(u),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:l,promise:u}=this.eventManagers[n];return l?Promise.resolve(l):(ga(u,"If manager is not set, promise should be"),u)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await yR(e),r=new sR(e);return n.register("authEvent",l=>(Le(l?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(k0,{type:k0},l=>{const u=l?.[0]?.[k0];u!==void 0&&n(!!u),xs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=lR(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return zb()||Bb()||Wm()}}const IR=DR;var I1="@firebase/auth",k1="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function OR(i){go(new li("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:f,authDomain:p}=r.options;Le(f&&!f.includes(":"),"invalid-api-key",{appName:r.name});const x={apiKey:f,authDomain:p,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qb(i)},m=new JT(r,l,u,x);return c4(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),go(new li("auth-internal",e=>{const n=xi(e.getProvider("auth").getImmediate());return(r=>new kR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ir(I1,k1,PR(i)),ir(I1,k1,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR=300,MR=H1("authIdTokenMaxAge")||BR;let P1=null;const FR=i=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>MR)return;const l=n?.token;P1!==l&&(P1=l,await fetch(i,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function LR(i=X1()){const e=mm(i,"auth");if(e.isInitialized())return e.getImmediate();const n=l4(i,{popupRedirectResolver:IR,persistence:[q4,D4,eE]}),r=H1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(r,location.origin);if(location.origin===u.origin){const f=FR(u.toString());C4(n,f,()=>f(n.currentUser)),w4(n,p=>f(p))}}const l=z1("auth");return l&&u4(n,`http://${l}`),n}function VR(){return document.getElementsByTagName("head")?.[0]??document}e4({loadJS(i){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",i),r.onload=e,r.onerror=l=>{const u=Ls("internal-error");u.customData=l,n(u)},r.type="text/javascript",r.charset="UTF-8",VR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});OR("Browser");const UR={apiKey:"AIzaSyDJUj26kbMpY3CQRtDFIZYgzmD7_s5kjEY",authDomain:"pezela.firebaseapp.com",projectId:"pezela",storageBucket:"pezela.firebasestorage.app",messagingSenderId:"130842827895",appId:"1:130842827895:web:260084e690afd77828fa72",measurementId:"G-XFEGWTMEKJ"};let Ol,ms,Xl;try{const i=Ww();i.length===0?Ol=Q1(UR):Ol=i[0],ms=hT(Ol),Xl=LR(Ol)}catch(i){console.warn("Firebase initialization error:",i),Ol=null,ms=null,Xl=null}class zR{async saveBusinessData(e){try{if(!ms){console.warn("Firebase not initialized, saving to localStorage instead"),localStorage.setItem("business-data",JSON.stringify(e));return}await D0(ai(ms,"businesses",e.id),{...e,updatedAt:new Date().toISOString()}),console.log("Business data saved to Firebase")}catch(n){console.error("Error saving business data:",n),console.warn("Falling back to localStorage for business data"),localStorage.setItem("business-data",JSON.stringify(e))}}async getBusinessData(e){try{if(!ms){console.warn("Firebase not initialized, checking localStorage instead");const l=localStorage.getItem("business-data");return l?JSON.parse(l):null}const n=ai(ms,"businesses",e),r=await p1(n);return r.exists()?r.data():(console.log("No business data found"),null)}catch(n){console.error("Error getting business data:",n);const r=localStorage.getItem("business-data");return r?JSON.parse(r):null}}async saveCustomerData(e){try{await D0(ai(ms,"customers",e.id),{...e,updatedAt:new Date().toISOString()}),console.log("Customer data saved to Firebase")}catch(n){throw console.error("Error saving customer data:",n),n}}async getCustomerData(e){try{const n=ai(ms,"customers",e),r=await p1(n);return r.exists()?r.data():(console.log("No customer data found"),null)}catch(n){throw console.error("Error getting customer data:",n),n}}async getCustomerByPhone(e){try{const n=localStorage.getItem("customer-info");if(n){const r=JSON.parse(n);return{id:`customer_${Date.now()}`,name:r.name,email:r.email,phone:r.phone,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}return null}catch(n){return console.error("Error getting customer by phone:",n),null}}async saveOrder(e){try{await NT(dT(ms,"orders"),{...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),console.log("Order saved to Firebase")}catch(n){throw console.error("Error saving order:",n),n}}async updateOrderStatus(e,n){try{const r=ai(ms,"orders",e);await AT(r,{status:n,updatedAt:new Date().toISOString()}),console.log("Order status updated in Firebase")}catch(r){throw console.error("Error updating order status:",r),r}}async createBusinessAccount(e,n,r){try{const u=(await A4(Xl,e,n)).user.uid;return await this.saveBusinessData({id:u,businessName:r.businessName||"",ownerName:r.ownerName||"",email:e,phone:r.phone||"",logo:r.logo||"",description:r.description||"",address:r.address||"",hours:r.hours||{monday:{open:"08:00",close:"18:00",closed:!1},tuesday:{open:"08:00",close:"18:00",closed:!1},wednesday:{open:"08:00",close:"18:00",closed:!1},thursday:{open:"08:00",close:"18:00",closed:!1},friday:{open:"08:00",close:"20:00",closed:!1},saturday:{open:"09:00",close:"20:00",closed:!1},sunday:{open:"10:00",close:"16:00",closed:!1}},deliveryFee:r.deliveryFee||25,minimumOrder:r.minimumOrder||50,isOpen:r.isOpen||!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u}catch(l){throw console.error("Error creating business account:",l),l}}async signInBusiness(e,n){try{return(await N4(Xl,e,n)).user.uid}catch(r){throw console.error("Error signing in business:",r),r}}async signOutBusiness(){try{await j4(Xl),console.log("Business signed out")}catch(e){throw console.error("Error signing out business:",e),e}}async savePaymentRecord(e){try{await D0(ai(ms,"payments",e.id),e,{merge:!0}),console.log("Payment record saved to Firestore:",e.id)}catch(n){throw console.error("Error saving payment record:",n),n}}}const np=new zR;class qR{isLiveMode=!1;apiSubscription=null;constructor(){this.initializeLiveMode()}async initializeLiveMode(){try{this.isLiveMode=!0,console.log("PaymentService: Initializing live mode for production"),this.apiSubscription=nr.subscribe(n=>{this.handleLiveUpdate(n)})}catch(e){console.error("Failed to initialize PaymentService live mode:",e)}}handleLiveUpdate(e){switch(e.type){case"new_payment":this.handleNewPayment(e.data);break;case"payment_update":this.handlePaymentUpdate(e.data);break;case"payment_status_change":this.handlePaymentStatusChange(e.data);break}}handleNewPayment(e){console.log("New payment received:",e)}handlePaymentUpdate(e){console.log("Payment updated:",e)}handlePaymentStatusChange(e){console.log("Payment status changed:",e)}async processCustomerPayment(e){try{const n=`pay_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,r={id:n,businessId:e.businessId,customerId:e.customerId,orderId:e.orderId,amount:e.amount,currency:"ZAR",paymentMethod:e.paymentMethod,paymentStatus:"pending",gatewayProvider:"payfast",customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(await this.saveCustomerPayment(r),e.paymentMethod==="card"){const l=await this.processCardPayment(r);l.success?(r.paymentStatus="paid",r.gatewayTransactionId=l.transactionId):r.paymentStatus="failed",await this.updatePaymentStatus(n,r.paymentStatus)}if(this.isLiveMode)try{await this.sendPaymentToAPI(r)}catch(l){console.error("Failed to send payment to API:",l)}else r.paymentStatus="pending";return await this.createBusinessPayment({businessId:e.businessId,amount:e.amount,customerPaymentId:n}),{success:!0,paymentId:n}}catch(n){return console.error("Error processing customer payment:",n),{success:!1,error:n instanceof Error?n.message:"Payment processing failed"}}}async processCardPayment(e){try{const n=await O0.createPayment({firstName:e.customerName.split(" ")[0],lastName:e.customerName.split(" ").slice(1).join(" "),email:e.customerEmail,amount:e.amount,itemName:`Order #${e.orderId}`,itemDescription:`Payment for order ${e.orderId}`,merchantOrderId:e.orderId});return n.success&&n.paymentUrl?{success:!0,transactionId:`pf_${Date.now()}`}:{success:!1,error:n.error||"Payment gateway error"}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Payment gateway error"}}}async saveCustomerPayment(e){try{await np.saveCustomerPayment({id:e.id,name:e.customerName,email:e.customerEmail,phone:e.customerPhone,createdAt:e.createdAt,updatedAt:e.updatedAt}),console.log("Customer payment saved to Firebase:",e)}catch(n){throw console.error("Error saving customer payment:",n),n}}async createBusinessPayment(e){try{const n={id:`biz_pay_${Date.now()}`,businessId:e.businessId,totalAmount:e.amount,netAmount:e.amount*.97,fees:e.amount*.03,currency:"ZAR",status:"pending",createdAt:new Date().toISOString()};console.log("Business payment created:",n)}catch(n){throw console.error("Error creating business payment:",n),n}}async updatePaymentStatus(e,n){try{console.log(`Payment ${e} status updated to ${n}`)}catch(r){throw console.error("Error updating payment status:",r),r}}async getBusinessPayments(e){try{return[{id:"biz_pay_1",businessId:e,totalAmount:150,netAmount:145.5,fees:4.5,currency:"ZAR",status:"completed",createdAt:new Date(Date.now()-7200*1e3).toISOString()}]}catch(n){return console.error("Error getting business payments:",n),[]}}async getCustomerPayments(e){try{return[{id:"pay_1",businessId:"store_123",customerId:e,orderId:"ORD-001",amount:150,currency:"ZAR",paymentMethod:"card",paymentStatus:"paid",gatewayProvider:"payfast",gatewayTransactionId:"pf_123456",customerName:"John Smith",customerEmail:"john@example.com",customerPhone:"+27821234567",createdAt:new Date(Date.now()-7200*1e3).toISOString(),updatedAt:new Date(Date.now()-7200*1e3).toISOString()}]}catch(n){return console.error("Error getting customer payments:",n),[]}}async calculateBusinessEarnings(e){try{const n=await this.getBusinessPayments(e),r=n.reduce((p,x)=>p+x.totalAmount,0),l=n.reduce((p,x)=>p+x.netAmount,0),u=n.reduce((p,x)=>p+x.fees,0),f=n.filter(p=>p.status==="pending").length;return{totalRevenue:r,netEarnings:l,totalFees:u,pendingPayments:f}}catch(n){return console.error("Error calculating business earnings:",n),{totalRevenue:0,netEarnings:0,totalFees:0,pendingPayments:0}}}async sendPaymentToAPI(e){try{const n=await fetch(`${nr.config.baseUrl}/api/payments`,{method:"POST",headers:{Authorization:`Bearer ${nr.config.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({id:e.id,businessId:e.businessId,orderId:e.orderId,amount:e.amount,currency:e.currency,paymentMethod:e.paymentMethod,paymentStatus:e.paymentStatus,gatewayProvider:e.gatewayProvider,gatewayTransactionId:e.gatewayTransactionId,customerName:e.customerName,customerEmail:e.customerEmail,customerPhone:e.customerPhone,createdAt:e.createdAt,updatedAt:e.updatedAt})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);console.log("Payment sent to API successfully")}catch(n){throw console.error("Error sending payment to API:",n),n}}async getBusinessPaymentStats(){if(this.isLiveMode)try{return await nr.getBusinessStats()}catch(e){console.error("Failed to fetch payment stats from API:",e)}return{totalPayments:0,totalAmount:0,completedPayments:0,pendingPayments:0,failedPayments:0}}destroy(){this.apiSubscription&&(this.apiSubscription(),this.apiSubscription=null)}}const oE=new qR,O1=()=>{const[i,e]=X.useState(null),[n,r]=X.useState([]),[l,u]=X.useState([]),[f,p]=X.useState("all"),[x,m]=X.useState(""),[v,b]=X.useState(!1),[S,I]=X.useState(!1),[R,D]=X.useState(0),[k,q]=X.useState(0),[O,L]=X.useState({name:"",phone:"",address:"",email:""}),[N,F]=X.useState("catalogue"),[P,E]=X.useState([]),[_,A]=X.useState(!0),[w,T]=X.useState({name:"",email:"",phone:""}),[U,B]=X.useState([{id:"3",name:"Beef Kota",price:50,quantity:1,image:"/assets/Beef_Kota.jpg"},{id:"4",name:"Coca Cola",price:15,quantity:1,image:"/assets/coca_cola.webp"}]),[ve,ye]=X.useState(!1),[Q,ue]=X.useState([{id:1,last4:"1234",brand:"Visa",expiry:"12/25",isDefault:!0}]),[pe,Ce]=X.useState({cardNumber:"",expiryDate:"",cvv:"",cardholderName:"",saveCard:!0}),[H,G]=X.useState(!1),[z,W]=X.useState([{id:1,from:"business",message:"Welcome to Mama Zanele's Kota Stand! How can we help you today?",timestamp:new Date().toISOString()}]),[J,Ae]=X.useState(""),[he,qe]=X.useState(!0);X.useEffect(()=>Id.subscribe(ke=>{const Xe=ke.filter(ot=>ot.customerPhone===O?.phone);E(Xe)}),[O?.phone]),X.useEffect(()=>{if(O?.phone)return zl.subscribeCustomer(O.phone,ke=>{W(ke)})},[O?.phone]),X.useEffect(()=>{const se=localStorage.getItem("customer-info");if(se){const ke=JSON.parse(se);L(ke),qe(!1)}else{const ke=setTimeout(()=>{qe(!1),A(!0)},2e3);return()=>clearTimeout(ke)}},[]),X.useEffect(()=>{(async()=>{const ot={id:new URLSearchParams(window.location.search).get("business")||"store_123",merchantName:"Mama Zanele's Kota Stand",description:"Fresh, delicious kotas made with love. Serving the community for over 10 years.",logo:"/assets/Kota_logo.png",banner:"/api/placeholder/400/200",address:"123 Main Street, Soweto, Johannesburg",phone:"+27 11 123 4567",hours:{monday:{open:"08:00",close:"18:00",closed:!1},tuesday:{open:"08:00",close:"18:00",closed:!1},wednesday:{open:"08:00",close:"18:00",closed:!1},thursday:{open:"08:00",close:"18:00",closed:!1},friday:{open:"08:00",close:"20:00",closed:!1},saturday:{open:"09:00",close:"20:00",closed:!1},sunday:{open:"10:00",close:"16:00",closed:!1}},deliveryFee:25,minimumOrder:50,isOpen:!0};e(ot);const K=[{id:"1",name:"Classic Kota",description:"Fresh bread with chips, polony, and atchar",price:35,image:"/assets/Classic_Kota.jpg",category:"meats",isAvailable:!0},{id:"2",name:"Chicken Kota",description:"Fresh bread with chips, chicken, and atchar",price:45,image:"/assets/Chicken_Kota.jpg",category:"meats",isAvailable:!0},{id:"3",name:"Beef Kota",description:"Fresh bread with chips, beef, and atchar",price:50,image:"/assets/Beef_Kota.jpg",category:"meats",isAvailable:!0},{id:"4",name:"Coca-Cola",description:"Ice-cold Coca-Cola 500ml",price:15,image:"/assets/coca_cola.webp",category:"drinks",isAvailable:!0},{id:"5",name:"Fanta",description:"Ice-cold Fanta 500ml",price:15,image:"/assets/Fanta.webp",category:"drinks",isAvailable:!0},{id:"6",name:"Chips",description:"Fresh hot chips with salt",price:20,image:"/assets/Chips.jpeg",category:"veggies",isAvailable:!0},{id:"7",name:"Fresh Salad",description:"Mixed green salad with tomatoes",price:25,image:"/assets/Classic_Kota.jpg",category:"veggies",isAvailable:!0},{id:"8",name:"Hot Sauce",description:"Spicy hot sauce",price:10,image:"/assets/Classic_Kota.jpg",category:"salsas",isAvailable:!0},{id:"9",name:"Baked Beans",description:"Traditional baked beans",price:18,image:"/assets/Classic_Kota.jpg",category:"beans",isAvailable:!0}],ie=[{id:"1",date:"2024-01-15",items:["Beef Kota","Chips"],total:45,status:"Delivered"},{id:"2",date:"2024-01-14",items:["Chicken Kota","Coke"],total:35,status:"Delivered"},{id:"3",date:"2024-01-13",items:["Veggie Kota"],total:25,status:"Preparing"}];r(K),E(ie)})()},[]),[...Array.from(new Set(n.map(se=>se.category)))];const _e=n.filter(se=>{const ke=f==="all"||se.category===f,Xe=se.name.toLowerCase().includes(x.toLowerCase())||se.description.toLowerCase().includes(x.toLowerCase());return ke&&Xe&&se.isAvailable}),be=se=>{u(l.filter(ke=>ke.product.id!==se))},Be=()=>l.reduce((se,ke)=>se+ke.totalPrice,0),Qe=()=>Be()>=i?.minimumOrder&&i?.deliveryFee||0,lt=()=>Be()+Qe(),At=()=>{if(Be()<(i?.minimumOrder||0)){alert(`Minimum order is R${i?.minimumOrder}. Please add more items.`);return}I(!0)};if(!i)return a.jsx("div",{className:"loading",children:"Loading storefront..."});const Nt=async se=>{if(se.preventDefault(),w.name&&w.email&&w.phone)try{const ke={id:`customer_${Date.now()}`,name:w.name,email:w.email,phone:w.phone,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await np.saveCustomerData(ke),localStorage.setItem("customer-info",JSON.stringify(w)),L(w),A(!1),alert("Welcome! You can now browse our products.")}catch(ke){console.error("Error saving customer data:",ke),localStorage.setItem("customer-info",JSON.stringify(w)),L(w),A(!1),alert("Welcome! You can now browse our products.")}else alert("Please fill in all required fields.")},gt=(se,ke)=>{console.log("updateQuantity called with:",se,ke),B(Xe=>{console.log("Current cartItems:",Xe);const ot=n.find(ie=>ie.id===se);if(!ot)return console.log("Product not found:",se),Xe;if(Xe.find(ie=>ie.id===se)){const ie=Xe.map(le=>{if(le.id===se){const Ne=Math.max(0,le.quantity+ke);return console.log("Updating item:",le.name,"from",le.quantity,"to",Ne),Ne===0?null:{...le,quantity:Ne}}return le}).filter(le=>le!==null);return console.log("Updated cartItems:",ie),ie}else{if(ke>0){const ie={id:ot.id,name:ot.name,price:ot.price,quantity:ke,image:ot.image};console.log("Adding new item to cart:",ie);const le=[...Xe,ie];return console.log("Updated cartItems:",le),le}return Xe}})},Fe=()=>U.reduce((se,ke)=>se+ke.price*ke.quantity,0),it=()=>U.reduce((se,ke)=>se+ke.quantity,0),we=()=>{ye(!0)},je=async se=>{try{const ke={customerName:w.name,customerEmail:w.email,customerPhone:w.phone,customerAddress:"123 Main Street, Johannesburg",items:U.map(K=>({productId:K.id,name:K.name,quantity:K.quantity,price:K.price,totalPrice:K.price*K.quantity})),subtotal:Fe(),deliveryFee:25,tax:Fe()*.15,totalAmount:Fe()+25+Fe()*.15,status:"pending",paymentMethod:"card",paymentStatus:"paid",notes:"Order placed via customer storefront",businessId:"store_123"},Xe=Id.createOrder(ke),ot=await oE.processCustomerPayment({businessId:"store_123",customerId:w.phone,orderId:Xe.id,amount:Xe.totalAmount,customerName:w.name,customerEmail:w.email,customerPhone:w.phone,paymentMethod:"card"});if(ot.success?console.log("Payment processed successfully:",ot.paymentId):console.error("Payment processing failed:",ot.error),se)alert(`Order #${Xe.orderNumber} placed successfully using saved card ending in ${Q.find(K=>K.id===se)?.last4}!`);else if(pe.saveCard){const K=Q.length+1;ue(ie=>[...ie,{id:K,last4:pe.cardNumber.slice(-4),brand:"Visa",expiry:pe.expiryDate,isDefault:!1}]),alert(`Order #${Xe.orderNumber} placed successfully! Card saved for future orders.`)}else alert(`Order #${Xe.orderNumber} placed successfully!`);ye(!1),B([]),setTimeout(()=>{alert(`Order Confirmed!

Order #${Xe.orderNumber}
Total: R${Xe.totalAmount.toFixed(2)}

You will receive WhatsApp updates about your order status.`)},500)}catch(ke){console.error("Payment processing error:",ke),alert("Payment processing failed. Please try again.")}},ge=(se,ke)=>{Ce(Xe=>({...Xe,[se]:ke}))},Ue=()=>{J.trim()&&O&&(zl.sendCustomerMessage(O.name,O.phone,J),Ae(""),setTimeout(()=>{const se=["Thank you for your message! We'll get back to you shortly.","Your order is being prepared! We'll notify you when it's ready.","Is there anything specific you'd like to know about our menu?","We're here to help! What can we do for you today?"],ke=se[Math.floor(Math.random()*se.length)];zl.sendBusinessMessage(O.phone,ke)},2e3))},Dt=()=>N==="orders"?a.jsxs("div",{className:"cart-page",children:[a.jsxs("div",{className:"cart-header",children:[a.jsx("div",{}),a.jsx("h2",{children:"My Cart"}),a.jsx("div",{})]}),a.jsxs("div",{className:"main-cart-card",children:[U.length>0?U.map(se=>a.jsxs("div",{className:"cart-item",children:[a.jsx("div",{className:"item-image",children:a.jsx("img",{src:se.image,alt:se.name})}),a.jsxs("div",{className:"item-details",children:[a.jsx("h4",{children:se.name}),a.jsxs("p",{className:"unit-price",children:["R",se.price.toFixed(2)," / ",se.name==="Beef Kota"?"each":"bottle"]}),a.jsx("p",{className:"quantity-size",children:se.name==="Beef Kota"?"1 kota":"500ml"}),a.jsxs("div",{className:"item-controls",children:[a.jsx("div",{className:"price-display",children:a.jsxs("span",{className:"total-price",children:["R",(se.price*se.quantity).toFixed(2)]})}),a.jsxs("div",{className:"quantity-controls",children:[a.jsx("button",{className:"qty-btn minus",onClick:()=>gt(se.id,-1),children:"-"}),a.jsx("span",{className:"quantity",children:se.quantity}),a.jsx("button",{className:"qty-btn plus",onClick:()=>gt(se.id,1),children:"+"})]})]})]})]},se.id)):a.jsx("div",{className:"empty-cart",children:a.jsx("p",{children:"Your cart is empty"})}),a.jsxs("div",{className:"cart-summary",children:[a.jsxs("div",{className:"summary-left",children:[a.jsxs("p",{children:[it()," Items added"]}),a.jsx("p",{children:"Total Price"})]}),a.jsxs("div",{className:"summary-right",children:[a.jsxs("span",{className:"total-price",children:["R",Fe().toFixed(2)]}),a.jsx("button",{className:"place-order-btn",onClick:we,children:"PLACE ORDER"})]})]})]})]}):N==="account"?a.jsxs("div",{className:"account-page",children:[a.jsxs("div",{className:"account-header",children:[a.jsx("h2",{children:"My Account"}),a.jsx("p",{children:"Manage your profile and preferences"})]}),a.jsxs("div",{className:"account-content",children:[a.jsxs("div",{className:"account-section",children:[a.jsx("h3",{children:"Profile Information"}),a.jsxs("p",{children:["Name: ",w.name||"John Doe"]}),a.jsxs("p",{children:["Email: ",w.email||"john@example.com"]}),a.jsxs("p",{children:["Phone: ",w.phone||"+27 12 345 6789"]})]}),a.jsxs("div",{className:"account-section",children:[a.jsx("h3",{children:"Saved Payment Methods"}),Q.map(se=>a.jsxs("div",{className:"saved-card-account",children:[a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-brand",children:se.brand}),a.jsxs("span",{className:"card-number",children:["**** **** **** ",se.last4]}),a.jsxs("span",{className:"card-expiry",children:["Expires ",se.expiry]})]}),se.isDefault&&a.jsx("span",{className:"default-badge",children:"Default"})]},se.id))]}),a.jsxs("div",{className:"account-section",children:[a.jsx("h3",{children:"Order History"}),a.jsx("p",{children:"Total Orders: 3"}),a.jsx("p",{children:"Last Order: R70.00"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"modern-categories",children:a.jsx("div",{className:"category-filters",children:["Meats","Veggies","Salsas","Drinks","Beans"].map(se=>a.jsx("button",{className:`category-btn ${f===se.toLowerCase()?"active":""}`,onClick:()=>p(se.toLowerCase()),children:se},se))})}),a.jsx("div",{className:"modern-products",children:a.jsx("div",{className:"products-grid",children:_e.map(se=>{const ke=U.find(K=>K.id===se.id),Xe=ke?ke.quantity:0,ot=Xe*se.price;return a.jsxs("div",{className:"modern-product-card",onClick:()=>F("orders"),children:[a.jsx("div",{className:"product-image",children:a.jsx("img",{src:se.image,alt:se.name})}),a.jsxs("div",{className:"product-info",children:[a.jsx("h3",{children:se.name}),a.jsxs("p",{className:"price-per-unit",children:["R",se.price," / lb (20lb / bag)"]}),a.jsxs("div",{className:"product-controls",children:[a.jsx("div",{className:"price-display",children:a.jsxs("span",{className:"total-price",children:["R",ot.toFixed(2)]})}),a.jsxs("div",{className:"quantity-controls",children:[a.jsx("button",{className:"qty-btn minus",onClick:K=>{K.stopPropagation(),gt(se.id,-1)},disabled:Xe===0,children:"-"}),a.jsx("span",{className:"quantity",children:Xe}),a.jsx("button",{className:"qty-btn plus",onClick:K=>{K.stopPropagation(),gt(se.id,1)},children:"+"})]})]})]})]},se.id)})})}),a.jsxs("div",{className:"store-hours",children:[a.jsx("h3",{children:"Store Hours"}),a.jsx("div",{className:"hours-list",children:Object.entries(i.hours).map(([se,ke])=>(console.log("Rendering day:",se,ke),a.jsxs("div",{className:"hours-item",style:{backgroundColor:"#f0f0f0",margin:"2px 0",padding:"4px"},children:[a.jsx("span",{className:"day",children:se.charAt(0).toUpperCase()+se.slice(1)}),a.jsx("span",{className:"time",children:ke.closed?"Closed":`${ke.open} - ${ke.close}`})]},se)))})]})]});return he?a.jsx("div",{className:"customer-storefront",children:a.jsx("div",{className:"loading-screen",children:a.jsxs("div",{className:"loading-content",children:[a.jsx("div",{className:"loading-logo",children:a.jsx("img",{src:i?.logo||"/assets/Kota_logo.png",alt:"Store logo"})}),a.jsx("h2",{children:"Welcome to Mama Zanele's Kota Stand"}),a.jsx("div",{className:"loading-spinner",children:a.jsx("div",{className:"spinner"})}),a.jsx("p",{children:"Loading your delicious experience..."})]})})}):a.jsxs("div",{className:"customer-storefront",children:[a.jsx("div",{className:"modern-header",children:a.jsxs("div",{className:"header-top",children:[a.jsxs("div",{className:"store-logo",children:[a.jsx("img",{src:i.logo,alt:"Store logo"}),a.jsx("h1",{children:i.merchantName})]}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("button",{className:"cart-btn",onClick:()=>F("orders"),children:[" ",it()>0&&a.jsx("span",{className:"cart-count",children:it()})]}),a.jsx("button",{className:"whatsapp-btn",onClick:()=>G(!0),children:""}),a.jsx("button",{className:"notifications-btn",onClick:()=>F("orders"),children:""})]})]})}),Dt(),_&&a.jsx("div",{className:"customer-modal-overlay",children:a.jsxs("div",{className:"customer-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:["Welcome to ",i?.merchantName]}),a.jsx("p",{children:"Please provide your details to continue shopping"})]}),a.jsxs("form",{className:"customer-form",onSubmit:Nt,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",children:"Name *"}),a.jsx("input",{type:"text",id:"name",value:w.name,onChange:se=>T({...w,name:se.target.value}),placeholder:"Enter your full name",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email *"}),a.jsx("input",{type:"email",id:"email",value:w.email,onChange:se=>T({...w,email:se.target.value}),placeholder:"Enter your email address",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"phone",children:"Phone *"}),a.jsx("input",{type:"tel",id:"phone",value:w.phone,onChange:se=>T({...w,phone:se.target.value}),placeholder:"Enter your phone number",required:!0})]}),a.jsx("button",{type:"submit",className:"submit-btn",children:"Continue Shopping"})]})]})}),ve&&a.jsx("div",{className:"payment-modal-overlay",children:a.jsxs("div",{className:"payment-modal",children:[a.jsxs("div",{className:"payment-header",children:[a.jsx("h3",{children:"Payment"}),a.jsx("button",{className:"close-payment",onClick:()=>ye(!1),children:""})]}),a.jsxs("div",{className:"payment-content",children:[a.jsxs("div",{className:"order-summary",children:[a.jsx("h4",{children:"Order Summary"}),a.jsx("div",{className:"order-items",children:U.length>0?U.map(se=>a.jsxs("div",{className:"order-item",children:[a.jsxs("span",{children:[se.name," x ",se.quantity]}),a.jsxs("span",{children:["R",(se.price*se.quantity).toFixed(2)]})]},se.id)):a.jsxs("div",{className:"order-item",children:[a.jsx("span",{children:"No items in cart"}),a.jsx("span",{children:"R0.00"})]})}),a.jsx("div",{className:"order-total",children:a.jsxs("span",{children:["Total: R",Fe().toFixed(2)]})})]}),a.jsxs("div",{className:"payment-options",children:[a.jsx("h4",{children:"Saved Cards"}),Q.map(se=>a.jsxs("div",{className:"saved-card",onClick:()=>je(se.id),children:[a.jsxs("div",{className:"card-info",children:[a.jsx("span",{className:"card-brand",children:se.brand}),a.jsxs("span",{className:"card-number",children:["**** **** **** ",se.last4]}),a.jsx("span",{className:"card-expiry",children:se.expiry})]}),se.isDefault&&a.jsx("span",{className:"default-badge",children:"Default"})]},se.id)),a.jsxs("div",{className:"new-card-section",children:[a.jsx("h4",{children:"Add New Card"}),a.jsxs("div",{className:"card-form",children:[a.jsx("input",{type:"text",placeholder:"Card Number",value:pe.cardNumber,onChange:se=>ge("cardNumber",se.target.value)}),a.jsxs("div",{className:"card-row",children:[a.jsx("input",{type:"text",placeholder:"MM/YY",value:pe.expiryDate,onChange:se=>ge("expiryDate",se.target.value)}),a.jsx("input",{type:"text",placeholder:"CVV",value:pe.cvv,onChange:se=>ge("cvv",se.target.value)})]}),a.jsx("input",{type:"text",placeholder:"Cardholder Name",value:pe.cardholderName,onChange:se=>ge("cardholderName",se.target.value)}),a.jsxs("label",{className:"save-card",children:[a.jsx("input",{type:"checkbox",checked:pe.saveCard,onChange:se=>ge("saveCard",se.target.checked.toString())}),"Save card for future orders"]}),a.jsxs("button",{className:"pay-btn",onClick:()=>je(),disabled:!pe.cardNumber||!pe.expiryDate||!pe.cvv||!pe.cardholderName,children:["Pay R",Fe().toFixed(2)]})]})]})]})]})]})}),a.jsxs("div",{className:"bottom-nav",children:[a.jsxs("div",{className:`nav-item ${N==="catalogue"?"active":""}`,onClick:()=>F("catalogue"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Catalogue"})]}),a.jsxs("div",{className:`nav-item ${N==="orders"?"active":""}`,onClick:()=>F("orders"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"My Orders"})]}),a.jsxs("div",{className:`nav-item ${N==="account"?"active":""}`,onClick:()=>F("account"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Account"})]})]}),v&&a.jsxs("div",{className:"cart-sidebar",children:[a.jsxs("div",{className:"cart-header",children:[a.jsx("button",{className:"back-btn",onClick:()=>b(!1),children:" Back"}),a.jsxs("h3",{children:["My Cart (",it(),")"]}),a.jsx("div",{})]}),a.jsx("div",{className:"cart-items",children:l.map(se=>a.jsxs("div",{className:"cart-item",children:[a.jsx("div",{className:"item-image",children:a.jsx("img",{src:se.product.image||"/api/placeholder/80/80",alt:se.product.name})}),a.jsxs("div",{className:"item-details",children:[a.jsx("h4",{children:se.product.name}),a.jsx("p",{className:"item-customization",children:"Extra Avocado, Spicy Mayo"}),a.jsxs("p",{className:"item-price",children:["Price per Item: R",se.product.price]}),a.jsxs("div",{className:"quantity-controls",children:[a.jsx("button",{className:"qty-btn minus",onClick:()=>gt(se.product.id,-1),children:"-"}),a.jsx("span",{className:"quantity",children:se.quantity}),a.jsx("button",{className:"qty-btn plus",onClick:()=>gt(se.product.id,1),children:"+"})]})]}),a.jsxs("div",{className:"item-actions",children:[a.jsxs("div",{className:"item-total",children:["R",se.totalPrice]}),a.jsx("button",{className:"remove-btn",onClick:()=>be(se.product.id),children:""})]})]},se.product.id))}),a.jsxs("div",{className:"location-section",children:[a.jsx("h4",{children:"Location"}),a.jsxs("div",{className:"location-info",children:[a.jsx("span",{children:"123 Sakura Street, Downtown City Center, 5 miles away"}),a.jsx("button",{className:"edit-location",children:""})]})]}),a.jsxs("div",{className:"order-summary",children:[a.jsx("h4",{children:"Order Summary"}),a.jsxs("div",{className:"promo-section",children:[a.jsx("label",{children:"Discount Coupon"}),a.jsxs("div",{className:"promo-input",children:[a.jsx("input",{type:"text",placeholder:"Promo code"}),a.jsx("button",{className:"apply-btn",children:"Apply"})]})]}),a.jsxs("div",{className:"summary-breakdown",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["R",Be()]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Delivery Fee"}),a.jsx("span",{children:Qe()===0?"Free":`R${Qe()}`})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Tax"}),a.jsxs("span",{children:["R",(Be()*.15).toFixed(2)]})]}),a.jsxs("div",{className:"summary-row total",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R",lt()]})]})]})]}),a.jsx("button",{className:"checkout-btn",onClick:At,disabled:l.length===0,children:" Checkout"})]}),S&&a.jsx("div",{className:"checkout-modal",children:a.jsxs("div",{className:"checkout-content",children:[a.jsxs("div",{className:"checkout-header",children:[a.jsx("h2",{children:"Complete Your Order"}),a.jsx("button",{className:"close-checkout",onClick:()=>I(!1),children:""})]}),a.jsxs("div",{className:"checkout-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Full Name"}),a.jsx("input",{type:"text",value:O.name,onChange:se=>L({...O,name:se.target.value}),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Phone Number"}),a.jsx("input",{type:"tel",value:O.phone,onChange:se=>L({...O,phone:se.target.value}),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Delivery Address"}),a.jsx("textarea",{value:O.address,onChange:se=>L({...O,address:se.target.value}),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email (Optional)"}),a.jsx("input",{type:"email",value:O.email,onChange:se=>L({...O,email:se.target.value})})]})]}),a.jsxs("div",{className:"checkout-summary",children:[a.jsx("h3",{children:"Order Summary"}),l.map(se=>a.jsxs("div",{className:"order-item",children:[a.jsxs("span",{children:[se.product.name," x ",se.quantity]}),a.jsxs("span",{children:["R",se.totalPrice]})]},se.product.id)),a.jsx("div",{className:"order-total",children:a.jsxs("span",{children:["Total: R",lt()]})})]}),a.jsxs("div",{className:"checkout-actions",children:[a.jsx("button",{className:"back-btn",onClick:()=>I(!1),children:"Back to Cart"}),a.jsx("button",{className:"place-order-btn",onClick:we,disabled:!O.name||!O.phone||!O.address,children:"Place Order"})]})]})}),H&&a.jsx("div",{className:"whatsapp-modal-overlay",children:a.jsxs("div",{className:"whatsapp-modal",children:[a.jsxs("div",{className:"whatsapp-header",children:[a.jsxs("div",{className:"whatsapp-store-info",children:[a.jsx("img",{src:i?.logo,alt:"Store",className:"whatsapp-store-logo"}),a.jsxs("div",{children:[a.jsx("h3",{children:i?.merchantName}),a.jsx("p",{children:"Online"})]})]}),a.jsx("button",{className:"close-whatsapp",onClick:()=>G(!1),children:""})]}),a.jsx("div",{className:"whatsapp-messages",children:z.map(se=>a.jsx("div",{className:`message ${se.from}`,children:a.jsxs("div",{className:"message-content",children:[a.jsx("p",{children:se.message}),a.jsx("span",{className:"message-time",children:new Date(se.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},se.id))}),a.jsxs("div",{className:"whatsapp-input",children:[a.jsx("input",{type:"text",placeholder:"Type your message...",value:J,onChange:se=>Ae(se.target.value),onKeyPress:se=>se.key==="Enter"&&Ue()}),a.jsx("button",{onClick:Ue,className:"send-btn",children:"Send"})]})]})})]})},HR=({user:i,onLogout:e})=>{const[n,r]=X.useState([]),[l,u]=X.useState(!1),[f,p]=X.useState(null),[x,m]=X.useState(!1),[v,b]=X.useState([]),[S,I]=X.useState({name:"",description:"",price:0,stock:0,category:"",image:""});X.useEffect(()=>{(async()=>{m(!0);try{{const P=await fetch("/api/products",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(P.ok){const E=await P.json();b(E.products||[]),r(E.products||[])}}}catch(F){console.error("Failed to load live products:",F);const P=localStorage.getItem("pezela-products");P&&r(JSON.parse(P))}finally{m(!1)}})()},[]);const R=async N=>{r(N),localStorage.setItem("pezela-products",JSON.stringify(N));try{await fetch("/api/products",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({businessId:i?.id,products:N,updatedAt:new Date().toISOString()})}),console.log("Products synced to live system")}catch(F){console.error("Failed to sync products to live system:",F)}},D=()=>{if(S.name&&S.price>0){const N={id:Date.now().toString(),...S};R([...n,N]),I({name:"",description:"",price:0,stock:0,category:"",image:""}),u(!1)}},k=N=>{p(N),I({name:N.name,description:N.description,price:N.price,stock:N.stock,category:N.category,image:N.image}),u(!0)},q=()=>{if(f&&S.name&&S.price>0){const N=n.map(F=>F.id===f.id?{...F,...S}:F);R(N),p(null),I({name:"",description:"",price:0,stock:0,category:"",image:""}),u(!1)}},O=N=>{if(confirm("Are you sure you want to delete this product?")){const F=n.filter(P=>P.id!==N);R(F)}},L=(N,F)=>{const P=n.map(E=>E.id===N?{...E,stock:Math.max(0,E.stock+F)}:E);R(P)};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("img",{src:"/assets/Logo2.PNG",alt:"Pezela Logo",className:"header-logo"}),a.jsxs("h1",{children:["Products (",n.length,")"]}),x&&a.jsx("div",{className:"loading-indicator",children:a.jsx("span",{children:" Loading live products..."})})]}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"product-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Total Products"}),a.jsx("p",{children:n.length})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Low Stock"}),a.jsx("p",{children:n.filter(N=>N.stock<10).length})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Categories"}),a.jsx("p",{children:new Set(n.map(N=>N.category)).size})]})]}),a.jsxs("div",{className:"products-list",children:[a.jsx("h3",{children:"Product Inventory"}),n.map(N=>a.jsxs("div",{className:"product-card",children:[a.jsx("div",{className:"product-image",children:N.image&&a.jsx("img",{src:N.image,alt:N.name})}),a.jsxs("div",{className:"product-info",children:[a.jsx("h4",{children:N.name}),a.jsx("p",{className:"product-description",children:N.description}),a.jsxs("div",{className:"product-price",children:["R",N.price.toFixed(2)]}),a.jsx("div",{className:"product-category",children:N.category})]}),a.jsxs("div",{className:"product-stock",children:[a.jsxs("div",{className:"stock-controls",children:[a.jsx("button",{onClick:()=>L(N.id,-1),className:"stock-btn",children:"-"}),a.jsx("span",{className:"stock-count",children:N.stock}),a.jsx("button",{onClick:()=>L(N.id,1),className:"stock-btn",children:"+"})]}),a.jsx("div",{className:"stock-status",children:N.stock<10&&a.jsx("span",{className:"low-stock",children:"Low Stock"})})]}),a.jsxs("div",{className:"product-actions",children:[a.jsx("button",{onClick:()=>k(N),className:"edit-btn",children:"Edit"}),a.jsx("button",{onClick:()=>O(N.id),className:"delete-btn",children:"Delete"})]})]},N.id))]}),a.jsx("div",{className:"add-product-section",children:a.jsx("button",{onClick:()=>u(!0),className:"add-product-btn",children:"+ Add Product"})}),l&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:f?"Edit Product":"Add New Product"}),a.jsx("button",{onClick:()=>{u(!1),p(null),I({name:"",description:"",price:0,stock:0,category:"",image:""})},className:"close-btn",children:""})]}),a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Product Name *"}),a.jsx("input",{type:"text",value:S.name,onChange:N=>I({...S,name:N.target.value}),placeholder:"Enter product name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Description"}),a.jsx("textarea",{value:S.description,onChange:N=>I({...S,description:N.target.value}),placeholder:"Enter product description"})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Price (R) *"}),a.jsx("input",{type:"number",step:"0.01",value:S.price,onChange:N=>I({...S,price:parseFloat(N.target.value)||0}),placeholder:"0.00"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stock Quantity"}),a.jsx("input",{type:"number",value:S.stock,onChange:N=>I({...S,stock:parseInt(N.target.value)||0}),placeholder:"0"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Category"}),a.jsxs("select",{value:S.category,onChange:N=>I({...S,category:N.target.value}),children:[a.jsx("option",{value:"",children:"Select Category"}),a.jsx("option",{value:"Kota",children:"Kota"}),a.jsx("option",{value:"Beverages",children:"Beverages"}),a.jsx("option",{value:"Sides",children:"Sides"}),a.jsx("option",{value:"Food",children:"Food"}),a.jsx("option",{value:"Desserts",children:"Desserts"}),a.jsx("option",{value:"Pastries",children:"Pastries"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>{u(!1),p(null),I({name:"",description:"",price:0,stock:0,category:"",image:""})},className:"cancel-btn",children:"Cancel"}),a.jsx("button",{onClick:f?q:D,className:"save-btn",disabled:!S.name||S.price<=0,children:f?"Update Product":"Add Product"})]})]})]})})]})]})},$R=({user:i,onLogout:e,orders:n,updateOrderStatus:r,sendOrderConfirmation:l,sendOrderReady:u})=>{const[f,p]=X.useState("all"),x=R=>({pending:"#FF6B35",confirmed:"#4ECDC4",preparing:"#45B7D1",ready:"#96CEB4",completed:"#6BCF7F",cancelled:"#FF8A80"})[R]||"#666",m=R=>({pending:"",confirmed:"",preparing:"",ready:"",completed:"",cancelled:""})[R]||"",v=n.filter(R=>f==="all"||R.status===f),b={total:n.length,pending:n.filter(R=>R.status==="pending").length,preparing:n.filter(R=>R.status==="preparing").length,ready:n.filter(R=>R.status==="ready").length,completed:n.filter(R=>R.status==="completed").length},S=async(R,D)=>{try{await r(R,D)}catch(k){console.error("Failed to update order status:",k),alert("Failed to update order status. Please try again.")}},I=R=>{const D=new Date(R),q=Math.floor((new Date().getTime()-D.getTime())/(1e3*60));return q<1?"Just now":q<60?`${q}m ago`:q<1440?`${Math.floor(q/60)}h ago`:D.toLocaleDateString()};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("img",{src:"/assets/Logo2.PNG",alt:"Pezela Logo",className:"header-logo"}),a.jsxs("h1",{children:["Orders (",n.length,")"]})]}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})})]}),a.jsxs("div",{className:"new-orders-page",children:[a.jsxs("div",{className:"stats-overview",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-number",children:b.total}),a.jsx("div",{className:"stat-label",children:"Total"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-number pending",children:b.pending}),a.jsx("div",{className:"stat-label",children:"Pending"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-number preparing",children:b.preparing}),a.jsx("div",{className:"stat-label",children:"Preparing"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-number ready",children:b.ready}),a.jsx("div",{className:"stat-label",children:"Ready"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-number completed",children:b.completed}),a.jsx("div",{className:"stat-label",children:"Completed"})]})]}),a.jsx("div",{className:"filter-section",children:a.jsxs("div",{className:"filter-tabs",children:[a.jsxs("button",{className:`tab ${f==="all"?"active":""}`,onClick:()=>p("all"),children:["All (",b.total,")"]}),a.jsxs("button",{className:`tab ${f==="pending"?"active":""}`,onClick:()=>p("pending"),children:["Pending (",b.pending,")"]}),a.jsxs("button",{className:`tab ${f==="preparing"?"active":""}`,onClick:()=>p("preparing"),children:["Preparing (",b.preparing,")"]}),a.jsxs("button",{className:`tab ${f==="ready"?"active":""}`,onClick:()=>p("ready"),children:["Ready (",b.ready,")"]}),a.jsxs("button",{className:`tab ${f==="completed"?"active":""}`,onClick:()=>p("completed"),children:["Completed (",b.completed,")"]})]})}),a.jsx("div",{className:"orders-container",children:v.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No orders found"}),a.jsx("p",{children:"Orders will appear here when customers place them"})]}):a.jsx("div",{className:"orders-grid",children:v.map(R=>a.jsxs("div",{className:"order-card-new",children:[a.jsxs("div",{className:"order-header-new",children:[a.jsxs("div",{className:"order-number",children:["#",R.orderNumber]}),a.jsx("div",{className:"order-time",children:I(R.createdAt)})]}),a.jsx("div",{className:"order-status-new",children:a.jsxs("div",{className:"status-indicator",style:{backgroundColor:x(R.status)},children:[a.jsx("span",{className:"status-icon",children:m(R.status)}),a.jsx("span",{className:"status-text",children:R.status.toUpperCase()})]})}),a.jsxs("div",{className:"customer-section",children:[a.jsx("div",{className:"customer-name",children:R.customerName}),a.jsx("div",{className:"customer-phone",children:R.customerPhone})]}),a.jsx("div",{className:"order-items-new",children:R.items.map((D,k)=>a.jsxs("div",{className:"item-row",children:[a.jsxs("div",{className:"item-info",children:[a.jsxs("span",{className:"item-quantity",children:[D.quantity,"x"]}),a.jsx("span",{className:"item-name",children:D.name})]}),a.jsxs("span",{className:"item-price",children:["R",D.price.toFixed(2)]})]},k))}),R.notes&&a.jsxs("div",{className:"order-notes-new",children:[a.jsx("span",{className:"notes-label",children:"Notes:"}),a.jsx("span",{className:"notes-text",children:R.notes})]}),a.jsxs("div",{className:"order-total-new",children:[a.jsx("span",{className:"total-label",children:"Total:"}),a.jsxs("span",{className:"total-amount",children:["R",R.totalAmount.toFixed(2)]})]}),a.jsxs("div",{className:"order-actions-new",children:[R.status==="pending"&&a.jsx("button",{className:"action-btn-new confirm",onClick:()=>S(R.id,"confirmed"),children:"Confirm"}),R.status==="confirmed"&&a.jsx("button",{className:"action-btn-new preparing",onClick:()=>S(R.id,"preparing"),children:"Start Cooking"}),R.status==="preparing"&&a.jsx("button",{className:"action-btn-new ready",onClick:()=>S(R.id,"ready"),children:"Mark Ready"}),R.status==="ready"&&a.jsx("button",{className:"action-btn-new complete",onClick:()=>S(R.id,"completed"),children:"Complete"}),a.jsx("button",{className:"action-btn-new whatsapp",onClick:()=>window.open(`https://wa.me/${R.customerPhone.replace("+","")}?text=Hello ${R.customerName}, your order #${R.orderNumber} is ${R.status}. Thank you!`),children:"WhatsApp"})]})]},R.id))})})]})]})},GR=({user:i,onLogout:e,payments:n})=>{const[r,l]=X.useState("all"),[u,f]=X.useState("all"),[p,x]=X.useState(null),[m,v]=X.useState(null),[b,S]=X.useState({start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]});X.useEffect(()=>{(async()=>{try{const F=await oE.getBusinessPaymentStats();v(F)}catch(F){console.error("Failed to load live payment stats:",F)}})()},[]);const I=n.filter(N=>{const F=new Date(N.createdAt),P=new Date(b.start),E=new Date(b.end);return(r==="all"||N.status===r)&&(u==="all"||N.method===u)&&F>=P&&F<=E}),R=N=>{switch(N){case"completed":return"#4CAF50";case"pending":return"#FF9800";case"failed":return"#F44336";default:return"#757575"}},D=N=>{switch(N.toLowerCase()){case"card":return"";case"cash":return"";case"eft":return"";default:return""}},k=()=>m?.totalAmount?m.totalAmount:I.reduce((N,F)=>N+F.amount,0),q=()=>m?.completedAmount?m.completedAmount:I.filter(N=>N.status==="completed").reduce((N,F)=>N+F.amount,0),O=()=>m?.pendingAmount?m.pendingAmount:I.filter(N=>N.status==="pending").reduce((N,F)=>N+F.amount,0),L=()=>m?.failedAmount?m.failedAmount:I.filter(N=>N.status==="failed").reduce((N,F)=>N+F.amount,0);return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("img",{src:"/assets/Logo2.PNG",alt:"Pezela Logo",className:"header-logo"}),a.jsxs("h1",{children:["Payments (",n.length,")"]})]}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"payment-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Total Amount"}),a.jsxs("p",{children:["R",k().toFixed(2)]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Completed"}),a.jsxs("p",{children:["R",q().toFixed(2)]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Pending"}),a.jsxs("p",{children:["R",O().toFixed(2)]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("h3",{children:"Failed"}),a.jsxs("p",{children:["R",L().toFixed(2)]})]})]}),a.jsxs("div",{className:"payment-filters",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Date Range:"}),a.jsx("input",{type:"date",value:b.start,onChange:N=>S({...b,start:N.target.value})}),a.jsx("input",{type:"date",value:b.end,onChange:N=>S({...b,end:N.target.value})})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Status:"}),a.jsxs("select",{value:r,onChange:N=>l(N.target.value),children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"failed",children:"Failed"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Method:"}),a.jsxs("select",{value:u,onChange:N=>f(N.target.value),children:[a.jsx("option",{value:"all",children:"All Methods"}),a.jsx("option",{value:"card",children:"Card"}),a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"eft",children:"EFT"})]})]})]}),a.jsxs("div",{className:"payments-list",children:[a.jsx("h3",{children:"Payment Transactions"}),I.length===0?a.jsx("div",{className:"no-payments",children:a.jsx("p",{children:"No payments found for the selected criteria"})}):I.map(N=>a.jsxs("div",{className:"payment-card",children:[a.jsxs("div",{className:"payment-header",children:[a.jsxs("div",{className:"payment-info",children:[a.jsxs("h4",{children:["Payment #",N.id.slice(-8)]}),a.jsx("p",{className:"payment-customer",children:N.customerName||"Unknown Customer"}),a.jsx("p",{className:"payment-time",children:new Date(N.createdAt).toLocaleString()})]}),a.jsx("div",{className:"payment-amount",children:a.jsxs("span",{className:"amount",children:["R",N.amount.toFixed(2)]})})]}),a.jsxs("div",{className:"payment-details",children:[a.jsxs("div",{className:"payment-method",children:[a.jsx("span",{className:"method-icon",children:D(N.method)}),a.jsx("span",{className:"method-name",children:N.method.toUpperCase()})]}),a.jsx("div",{className:"payment-status",children:a.jsx("span",{className:"status-badge",style:{backgroundColor:R(N.status)},children:N.status.charAt(0).toUpperCase()+N.status.slice(1)})})]}),a.jsxs("div",{className:"payment-actions",children:[a.jsx("button",{className:"details-btn",onClick:()=>x(N),children:"View Details"}),N.status==="pending"&&a.jsx("button",{className:"process-btn",children:"Process Payment"})]})]},N.id))]}),p&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Payment Details"}),a.jsx("button",{onClick:()=>x(null),className:"close-btn",children:""})]}),a.jsx("div",{className:"modal-content",children:a.jsxs("div",{className:"payment-details-full",children:[a.jsxs("div",{className:"detail-section",children:[a.jsx("h4",{children:"Transaction Information"}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Payment ID:"}),a.jsx("span",{children:p.id})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Order ID:"}),a.jsx("span",{children:p.orderId})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Amount:"}),a.jsxs("span",{children:["R",p.amount.toFixed(2)]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Method:"}),a.jsx("span",{children:p.method.toUpperCase()})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Status:"}),a.jsx("span",{className:"status-text",style:{color:R(p.status)},children:p.status.charAt(0).toUpperCase()+p.status.slice(1)})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Date:"}),a.jsx("span",{children:new Date(p.createdAt).toLocaleString()})]})]}),p.customerName&&a.jsxs("div",{className:"detail-section",children:[a.jsx("h4",{children:"Customer Information"}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Name:"}),a.jsx("span",{children:p.customerName})]}),p.customerPhone&&a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{children:"Phone:"}),a.jsx("span",{children:p.customerPhone})]})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("h4",{children:"Payment Summary"}),a.jsxs("div",{className:"payment-summary",children:[a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Gross Amount:"}),a.jsxs("span",{children:["R",p.amount.toFixed(2)]})]}),a.jsxs("div",{className:"summary-row",children:[a.jsx("span",{children:"Processing Fee (3%):"}),a.jsxs("span",{children:["-R",(p.amount*.03).toFixed(2)]})]}),a.jsxs("div",{className:"summary-row total",children:[a.jsx("span",{children:a.jsx("strong",{children:"Net Amount:"})}),a.jsx("span",{children:a.jsxs("strong",{children:["R",(p.amount*.97).toFixed(2)]})})]})]})]})]})})]})})]})]})},KR=({user:i,onLogout:e,settings:n,onSettingsChange:r,onNavigate:l})=>{const[u,f]=X.useState(n),[p,x]=X.useState("general"),[m,v]=X.useState(!1),[b,S]=X.useState(!1),[I,R]=X.useState(null);X.useEffect(()=>{f(n)},[n]),X.useEffect(()=>{(async()=>{S(!0);try{{const P=await fetch("/api/settings/business",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(P.ok){const E=await P.json();R(E),E.settings&&f(_=>({..._,...E.settings}))}}}catch(F){console.error("Failed to load live settings:",F)}finally{S(!1)}})()},[i]);const D=(N,F)=>{const P={...u,[N]:F};f(P),r(P)},k=async()=>{S(!0);try{{const F=await fetch("/api/settings/business",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({businessId:i?.id,settings:u,updatedAt:new Date().toISOString()})});if(F.ok){const P=await F.json();R(P),r(u),alert("Settings saved to live system successfully!")}else throw new Error("Failed to save settings to API")}}catch(N){console.error("Failed to save settings:",N),alert("Failed to save settings. Please try again.")}finally{S(!1)}},q=()=>{if(confirm("Are you sure you want to reset all settings to default?")){const N={notifications:!0,darkMode:!1,whatsapp:!0,currency:"ZAR",businessHours:"08:00-18:00",storeName:i?.businessName||"My Store",storeDescription:"Welcome to our store",storeAddress:"",storePhone:i?.phone||"",deliveryFee:25,minimumOrder:50,taxRate:15};f(N),r(N)}},O=()=>{const N=window.location.origin,F=I?.businessId||i?.id||"store_123";return`${N}/#customer?business=${F}`},L=()=>{const N=O();navigator.clipboard.writeText(N).then(()=>{alert("Storefront URL copied to clipboard!")})};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("img",{src:"/assets/Logo2.PNG",alt:"Pezela Logo",className:"header-logo"}),a.jsx("h1",{children:"Settings"})]}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"settings-tabs",children:[a.jsx("button",{className:`tab-btn ${p==="general"?"active":""}`,onClick:()=>x("general"),children:"General"}),a.jsx("button",{className:`tab-btn ${p==="business"?"active":""}`,onClick:()=>x("business"),children:"Business"}),a.jsx("button",{className:`tab-btn ${p==="notifications"?"active":""}`,onClick:()=>x("notifications"),children:"Notifications"}),a.jsx("button",{className:`tab-btn ${p==="storefront"?"active":""}`,onClick:()=>x("storefront"),children:"Storefront"}),a.jsx("button",{className:`tab-btn ${p==="advanced"?"active":""}`,onClick:()=>x("advanced"),children:"Advanced Features"})]}),p==="general"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h3",{children:"General Preferences"}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:u.darkMode,onChange:N=>D("darkMode",N.target.checked)}),a.jsx("span",{className:"checkmark"}),"Dark Mode"]}),a.jsx("p",{className:"setting-description",children:"Enable dark theme for the app"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:u.notifications,onChange:N=>D("notifications",N.target.checked)}),a.jsx("span",{className:"checkmark"}),"Push Notifications"]}),a.jsx("p",{className:"setting-description",children:"Receive notifications for new orders and updates"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:u.whatsapp,onChange:N=>D("whatsapp",N.target.checked)}),a.jsx("span",{className:"checkmark"}),"WhatsApp Integration"]}),a.jsx("p",{className:"setting-description",children:"Enable WhatsApp messaging with customers"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Currency"}),a.jsxs("select",{value:u.currency,onChange:N=>D("currency",N.target.value),children:[a.jsx("option",{value:"ZAR",children:"South African Rand (ZAR)"}),a.jsx("option",{value:"USD",children:"US Dollar (USD)"}),a.jsx("option",{value:"EUR",children:"Euro (EUR)"})]})]})]}),p==="business"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h3",{children:"Business Information"}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Store Name"}),a.jsx("input",{type:"text",value:u.storeName,onChange:N=>D("storeName",N.target.value),placeholder:"Enter your store name"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Store Description"}),a.jsx("textarea",{value:u.storeDescription,onChange:N=>D("storeDescription",N.target.value),placeholder:"Describe your business",rows:3})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Store Address"}),a.jsx("input",{type:"text",value:u.storeAddress,onChange:N=>D("storeAddress",N.target.value),placeholder:"Enter your store address"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Store Phone"}),a.jsx("input",{type:"tel",value:u.storePhone,onChange:N=>D("storePhone",N.target.value),placeholder:"Enter your phone number"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Business Hours"}),a.jsx("input",{type:"text",value:u.businessHours,onChange:N=>D("businessHours",N.target.value),placeholder:"e.g., 08:00-18:00"})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Delivery Fee (R)"}),a.jsx("input",{type:"number",value:u.deliveryFee,onChange:N=>D("deliveryFee",parseFloat(N.target.value)||0),placeholder:"25"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Minimum Order (R)"}),a.jsx("input",{type:"number",value:u.minimumOrder,onChange:N=>D("minimumOrder",parseFloat(N.target.value)||0),placeholder:"50"})]})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Tax Rate (%)"}),a.jsx("input",{type:"number",value:u.taxRate,onChange:N=>D("taxRate",parseFloat(N.target.value)||0),placeholder:"15"})]})]}),p==="notifications"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h3",{children:"Notification Preferences"}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:u.notifications,onChange:N=>D("notifications",N.target.checked)}),a.jsx("span",{className:"checkmark"}),"New Order Notifications"]}),a.jsx("p",{className:"setting-description",children:"Get notified when new orders are placed"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:u.whatsapp,onChange:N=>D("whatsapp",N.target.checked)}),a.jsx("span",{className:"checkmark"}),"WhatsApp Messages"]}),a.jsx("p",{className:"setting-description",children:"Receive WhatsApp messages from customers"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{children:"Notification Sound"}),a.jsxs("select",{children:[a.jsx("option",{value:"default",children:"Default"}),a.jsx("option",{value:"chime",children:"Chime"}),a.jsx("option",{value:"bell",children:"Bell"}),a.jsx("option",{value:"none",children:"None"})]})]})]}),p==="storefront"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h3",{children:"Storefront Configuration"}),a.jsxs("div",{className:"storefront-preview",children:[a.jsx("h4",{children:"Your Storefront URL"}),a.jsxs("div",{className:"url-display",children:[a.jsx("input",{type:"text",value:O(),readOnly:!0,className:"url-input"}),a.jsx("button",{onClick:L,className:"copy-btn",children:"Copy URL"})]}),a.jsx("p",{className:"url-description",children:"Share this URL with your customers to let them browse and order from your store"})]}),a.jsxs("div",{className:"storefront-actions",children:[a.jsx("button",{className:"preview-btn",onClick:()=>v(!0),children:"Preview Storefront"}),a.jsx("button",{className:"qr-btn",children:"Generate QR Code"})]}),a.jsxs("div",{className:"storefront-settings",children:[a.jsx("h4",{children:"Storefront Settings"}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),a.jsx("span",{className:"checkmark"}),"Enable Online Ordering"]}),a.jsx("p",{className:"setting-description",children:"Allow customers to place orders online"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),a.jsx("span",{className:"checkmark"}),"Show Store Hours"]}),a.jsx("p",{className:"setting-description",children:"Display your business hours to customers"})]}),a.jsxs("div",{className:"setting-item",children:[a.jsxs("label",{className:"setting-label",children:[a.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),a.jsx("span",{className:"checkmark"}),"Enable WhatsApp Chat"]}),a.jsx("p",{className:"setting-description",children:"Allow customers to chat with you via WhatsApp"})]})]})]}),a.jsxs("div",{className:"settings-actions",children:[a.jsx("button",{onClick:k,className:"save-btn",disabled:b,children:b?"Saving...":"Save Settings"}),a.jsx("button",{onClick:q,className:"reset-btn",children:"Reset to Defaults"})]}),m&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal storefront-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Storefront Preview"}),a.jsx("button",{onClick:()=>v(!1),className:"close-btn",children:""})]}),a.jsx("div",{className:"modal-content",children:a.jsxs("div",{className:"storefront-preview-content",children:[a.jsx("p",{children:"This is how your storefront will appear to customers:"}),a.jsx("div",{className:"preview-frame",children:a.jsx("iframe",{src:O(),width:"100%",height:"600",frameBorder:"0",title:"Storefront Preview"})})]})})]})}),p==="advanced"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h3",{children:"Advanced Features"}),a.jsx("p",{className:"section-description",children:"Access powerful business tools and integrations to grow your business."}),a.jsxs("div",{className:"advanced-features-grid",children:[a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Tax & SARS Compliance"}),a.jsx("p",{children:"Automated tax reporting and SARS compliance tools"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("tax"),children:"Open Tax Tools"})]})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Hardware Integrations"}),a.jsx("p",{children:"Connect POS systems, printers, and payment terminals"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("hardware"),children:"Setup Hardware"})]})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Merchant Micro-lending"}),a.jsx("p",{children:"Access business loans and credit facilities"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("lending"),children:"View Lending Options"})]})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Marketplace"}),a.jsx("p",{children:"List products on online marketplaces"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("marketplace"),children:"Explore Marketplace"})]})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Loyalty & Coupons"}),a.jsx("p",{children:"Create customer loyalty programs and discount campaigns"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("loyalty"),children:"Setup Loyalty Program"})]})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsxs("div",{className:"feature-content",children:[a.jsx("h4",{children:"Bookkeeping & Accounting"}),a.jsx("p",{children:"Advanced financial tracking and reporting"}),a.jsx("button",{className:"feature-btn",onClick:()=>l?.("bookkeeping"),children:"Open Bookkeeping"})]})]})]}),a.jsxs("div",{className:"feature-status",children:[a.jsx("h4",{children:"Feature Status"}),a.jsxs("div",{className:"status-list",children:[a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Tax & SARS Compliance - Available"})]}),a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Hardware Integrations - Available"})]}),a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Merchant Micro-lending - Available"})]}),a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Marketplace - Available"})]}),a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Loyalty & Coupons - Available"})]}),a.jsxs("div",{className:"status-item",children:[a.jsx("span",{className:"status-icon",children:""}),a.jsx("span",{className:"status-text",children:"Bookkeeping - Available"})]})]})]})]})]})]})},YR=({onComplete:i})=>(X.useEffect(()=>{const e=setTimeout(()=>{i()},3e3);return()=>clearTimeout(e)},[i]),a.jsx("div",{className:"splash-screen",children:a.jsxs("div",{className:"splash-content",children:[a.jsx("img",{src:"/assets/Logo4.PNG",alt:"Pezela",className:"splash-logo"}),a.jsx("p",{className:"splash-subtitle",children:"Digital Commerce for South Africa"}),a.jsx("div",{className:"splash-loader",children:a.jsx("div",{className:"loader"})})]})}));function QR(){const i=window.location.hash==="#customer"||window.location.pathname.includes("/customer/")&&window.location.pathname!=="/customer"||window.location.pathname.includes("/store/");console.log("URL Detection:",{hash:window.location.hash,pathname:window.location.pathname,isCustomerStorefront:i,fullURL:window.location.href});const[e,n]=X.useState(i?"customer-storefront":"splash"),[r,l]=X.useState(!1),[u,f]=X.useState(!1),[p,x]=X.useState(null),[m,v]=X.useState([]),[b,S]=X.useState([]),[I,R]=X.useState([]),[D,k]=X.useState({notifications:!0,darkMode:!1,whatsapp:!0,currency:"ZAR",businessHours:"08:00-18:00"}),[q,O]=X.useState(!1),[L,N]=X.useState([]),[F,P]=X.useState(""),[E,_]=X.useState(""),[A,w]=X.useState(!1),[T,U]=X.useState(null);X.useEffect(()=>{const be=localStorage.getItem("pezela-products");localStorage.getItem("pezela-orders"),localStorage.getItem("pezela-payments"),localStorage.getItem("pezela-settings"),be?v(JSON.parse(be)):p&&v([{id:"1",name:"Cappuccino",price:25,stock:50,category:"Beverages",image:"",description:"Rich espresso with steamed milk"},{id:"2",name:"Croissant",price:15,stock:30,category:"Pastries",image:"",description:"Buttery French pastry"},{id:"3",name:"Chocolate Cake",price:45,stock:10,category:"Desserts",image:"",description:"Rich chocolate layer cake"},{id:"4",name:"Sandwich",price:35,stock:25,category:"Food",image:"",description:"Fresh deli sandwich"},{id:"5",name:"Smoothie",price:30,stock:20,category:"Beverages",image:"",description:"Fresh fruit smoothie"},{id:"6",name:"Muffin",price:12,stock:40,category:"Pastries",image:"",description:"Blueberry muffin"}]);const Be=Id.subscribe(lt=>{S(lt)}),Qe=zl.subscribeBusiness(lt=>{N(lt)});return()=>{Be(),Qe()}},[p]),X.useEffect(()=>{m.length>0&&localStorage.setItem("pezela-products",JSON.stringify(m))},[m]),X.useEffect(()=>{b.length>0&&localStorage.setItem("pezela-orders",JSON.stringify(b))},[b]),X.useEffect(()=>{I.length>0&&localStorage.setItem("pezela-payments",JSON.stringify(I))},[I]),X.useEffect(()=>{localStorage.setItem("pezela-settings",JSON.stringify(D))},[D]);const B={totalOrders:b.length,totalRevenue:b.reduce((be,Be)=>be+Be.totalAmount,0),pendingOrders:b.filter(be=>be.status==="pending").length,completedOrders:b.filter(be=>be.status==="completed").length,totalProducts:m.length,lowStockProducts:m.filter(be=>be.stock<10).length},ve=async()=>{const be={id:"1",name:"Demo Merchant",businessName:"Demo Coffee Shop",phone:"+27821234567",email:"demo@pezela.co.za"};try{const Qe={id:be.id,businessName:be.businessName,ownerName:be.name,email:be.email,phone:be.phone,logo:"/assets/Kota_logo.png",description:"Fresh, delicious kotas made with love. Serving the community for over 10 years.",address:"123 Main Street, Soweto, Johannesburg",hours:{monday:{open:"08:00",close:"18:00",closed:!1},tuesday:{open:"08:00",close:"18:00",closed:!1},wednesday:{open:"08:00",close:"18:00",closed:!1},thursday:{open:"08:00",close:"18:00",closed:!1},friday:{open:"08:00",close:"20:00",closed:!1},saturday:{open:"09:00",close:"20:00",closed:!1},sunday:{open:"10:00",close:"16:00",closed:!1}},deliveryFee:25,minimumOrder:50,isOpen:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await np.saveBusinessData(Qe),console.log("Business data saved to Firebase")}catch(Qe){console.error("Error saving business data to Firebase:",Qe)}x(be);const Be=`https://pezela.co.za/store/${be.id}`;_(Be),n("dashboard")},ye=()=>{x({id:"admin",name:"Admin User",businessName:"Pezela Admin",phone:"+27820000000",email:"admin@pezela.co.za"}),l(!0),n("admin")},Q=()=>{x(null),l(!1),n("login")},ue=be=>{n(be)},pe=async(be,Be)=>{try{await Id.updateOrderStatus(be,Be),S(Qe=>Qe.map(lt=>lt.id===be?{...lt,status:Be}:lt))}catch(Qe){throw console.error("Failed to update order status:",Qe),Qe}},Ce=be=>{const Be={...be,id:String(Date.now())};v(Qe=>[...Qe,Be])},H=(be,Be)=>{v(Qe=>Qe.map(lt=>lt.id===be?{...lt,...Be}:lt))},G=be=>{v(Be=>Be.filter(Qe=>Qe.id!==be))},z=be=>{k(Be=>({...Be,...be}))},W=(be,Be)=>{alert(`WhatsApp Message Sent!

To: ${be}
Message: ${Be}

In a real app, this would send via WhatsApp Business API`)},J=be=>{const Be=`Order Confirmed!

Order #${be.orderNumber}
Total: R${be.totalAmount.toFixed(2)}

Thank you for choosing ${p?.businessName}!`;W(be.customerPhone,Be)},Ae=be=>{const Be=`Your order is ready!

Order #${be.orderNumber}

Please come collect your order. Thank you!`;W(be.customerPhone,Be)},he=()=>{if(F.trim()){const be=L.filter(Be=>Be.from==="customer").sort((Be,Qe)=>new Date(Qe.timestamp).getTime()-new Date(Be.timestamp).getTime())[0];be?.customerPhone?(zl.sendBusinessMessage(be.customerPhone,F),P(""),alert("WhatsApp message sent to customer!")):alert("No customer to reply to. Please wait for a customer message.")}};if(e==="splash")return a.jsx(YR,{onComplete:()=>n("login")});if(e==="admin")return a.jsx(YS,{});if(A)return a.jsx(O1,{user:p,products:m,onClose:()=>w(!1)});if(e==="subscription")return a.jsx("div",{className:"app",children:a.jsx("div",{className:"phone-frame",children:a.jsx("div",{className:"phone-screen",children:a.jsx(tA,{onSelectPlan:be=>{console.log("Selected plan:",be),n("dashboard"),ve()},onBack:()=>n("register")})})})});if(e==="register")return a.jsx("div",{className:"app",children:a.jsx("div",{className:"phone-frame",children:a.jsx("div",{className:"phone-screen",children:a.jsxs("div",{className:"login-container",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:P0,alt:"Pezela Logo",className:"login-logo"}),a.jsx("p",{children:"Digital Commerce for South Africa"})]}),a.jsxs("div",{className:"login-form",children:[a.jsx("h2",{children:"Create Account"}),a.jsx("p",{children:"Join thousands of South African merchants"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Company Logo"}),a.jsxs("div",{className:"logo-upload",children:[a.jsx("input",{type:"file",id:"logo-upload",accept:"image/*",style:{display:"none"}}),a.jsxs("label",{htmlFor:"logo-upload",className:"logo-upload-btn",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Upload Company Logo"})]}),a.jsx("p",{className:"logo-upload-hint",children:"PNG, JPG up to 2MB"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Business Name"}),a.jsx("input",{type:"text",placeholder:"Your business name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Business Registration Number"}),a.jsx("input",{type:"text",placeholder:"e.g. 2024/123456/07"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Your Name"}),a.jsx("input",{type:"text",placeholder:"Your full name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Phone Number"}),a.jsx("input",{type:"tel",placeholder:"+27821234567"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"email",placeholder:"your@email.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:"password",placeholder:"Create a password"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Confirm Password"}),a.jsx("input",{type:"password",placeholder:"Confirm your password"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ID Document"}),a.jsxs("div",{className:"document-upload",children:[a.jsx("input",{type:"file",id:"id-document",accept:".pdf,.jpg,.jpeg,.png",style:{display:"none"}}),a.jsxs("label",{htmlFor:"id-document",className:"document-upload-btn",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Upload ID Document"})]}),a.jsx("p",{className:"document-upload-hint",children:"PDF, JPG, PNG up to 5MB"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Bank Statement"}),a.jsxs("div",{className:"document-upload",children:[a.jsx("input",{type:"file",id:"bank-statement",accept:".pdf,.jpg,.jpeg,.png",style:{display:"none"}}),a.jsxs("label",{htmlFor:"bank-statement",className:"document-upload-btn",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Upload Bank Statement"})]}),a.jsx("p",{className:"document-upload-hint",children:"PDF, JPG, PNG up to 5MB"})]})]}),a.jsx("button",{onClick:()=>n("subscription"),className:"login-button",children:"Create Account"}),a.jsxs("div",{className:"login-footer",children:[a.jsx("p",{children:"Already have an account?"}),a.jsx("button",{className:"register-link",onClick:()=>n("login"),children:"Sign In"})]})]})]})})})});if(e==="login")return a.jsx("div",{className:"app",children:a.jsx("div",{className:"phone-frame",children:a.jsx("div",{className:"phone-screen",children:a.jsxs("div",{className:"login-container",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:P0,alt:"Pezela Logo",className:"login-logo"}),a.jsx("p",{children:"Digital Commerce for South Africa"})]}),a.jsxs("div",{className:"login-form",children:[a.jsx("h2",{children:"Welcome Back"}),a.jsx("p",{children:"Sign in to your merchant account"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Phone Number or Email"}),a.jsx("input",{type:"text",placeholder:"+27821234567 or your@email.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Password"}),a.jsx("input",{type:"password",placeholder:"Enter your password"})]}),a.jsx("button",{onClick:ve,className:"login-button",children:"Sign In"}),a.jsx("button",{onClick:ye,className:"admin-login-button",children:"Admin Login"}),a.jsxs("div",{className:"login-footer",children:[a.jsx("p",{children:"Don't have an account?"}),a.jsx("button",{className:"register-link",onClick:()=>n("register"),children:"Create Account"})]})]}),a.jsxs("div",{className:"features",children:[a.jsxs("div",{className:"feature",children:[a.jsx("span",{className:"feature-icon",children:""}),a.jsx("span",{className:"feature-text",children:"Mobile-First"})]}),a.jsxs("div",{className:"feature",children:[a.jsx("span",{className:"feature-icon",children:""}),a.jsx("span",{className:"feature-text",children:"Offline Support"})]}),a.jsxs("div",{className:"feature",children:[a.jsx("span",{className:"feature-icon",children:""}),a.jsx("span",{className:"feature-text",children:"South African"})]})]})]})})})});const qe=()=>{switch(e){case"products":return p?a.jsx(HR,{user:p,onLogout:Q,products:m,addProduct:Ce,updateProduct:H,deleteProduct:G,onNavigate:ue,setSelectedProduct:U}):null;case"stock-management":return p?a.jsx(XR,{user:p,onLogout:Q,products:m,updateProduct:H,onNavigate:ue}):null;case"add-product":return p?a.jsx(WR,{user:p,onLogout:Q,addProduct:Ce,onNavigate:ue}):null;case"edit-product":return p?a.jsx(ZR,{user:p,onLogout:Q,product:T,updateProduct:H,onNavigate:ue}):null;case"orders":return p?a.jsx($R,{user:p,onLogout:Q,orders:b,updateOrderStatus:pe,sendOrderConfirmation:J,sendOrderReady:Ae}):null;case"payments":return p?a.jsx(GR,{user:p,onLogout:Q,payments:I}):null;case"settings":return p?a.jsx(KR,{user:p,onLogout:Q,settings:D,onSettingsChange:z,onNavigate:ue}):null;case"tax":return p?a.jsx(JR,{user:p,onLogout:Q}):null;case"hardware":return p?a.jsx(eD,{user:p,onLogout:Q}):null;case"lending":return p?a.jsx(tD,{user:p,onLogout:Q}):null;case"marketplace":return p?a.jsx(nD,{user:p,onLogout:Q}):null;case"loyalty":return p?a.jsx(sD,{user:p,onLogout:Q}):null;case"bookkeeping":return p?a.jsx(xN,{}):null;case"dashboard":return p?a.jsx(B1,{user:p,onLogout:Q,stats:B,orders:b,storefrontUrl:E,setShowStorefront:w,handleNavigation:ue,sendOrderConfirmation:J,updateOrderStatus:pe,sendOrderReady:Ae,setShowBusinessWhatsApp:O,businessWhatsAppMessages:L}):null;default:return p?a.jsx(B1,{user:p,onLogout:Q,stats:B,orders:b,storefrontUrl:E,setShowStorefront:w,handleNavigation:ue,sendOrderConfirmation:J,updateOrderStatus:pe,sendOrderReady:Ae,setShowBusinessWhatsApp:O,businessWhatsAppMessages:L}):null}};if(e==="customer-storefront")return a.jsx("div",{className:"app",children:a.jsx("div",{className:"phone-frame",children:a.jsx("div",{className:"phone-screen customer-storefront-screen",children:a.jsx(O1,{})})})});const _e=!["splash","login","register","subscription","admin","customer-storefront"].includes(e);return a.jsx("div",{className:"app",children:a.jsx("div",{className:"phone-frame",children:a.jsxs("div",{className:"phone-screen",children:[qe(),_e&&a.jsxs("div",{className:"bottom-nav",children:[a.jsxs("button",{className:`nav-item ${e==="dashboard"?"active":""}`,onClick:()=>ue("dashboard"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Home"})]}),a.jsxs("button",{className:`nav-item ${e==="products"?"active":""}`,onClick:()=>ue("products"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Products"})]}),a.jsxs("button",{className:`nav-item ${e==="orders"?"active":""}`,onClick:()=>ue("orders"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Orders"})]}),a.jsxs("button",{className:`nav-item ${e==="payments"?"active":""}`,onClick:()=>ue("payments"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Payments"})]}),a.jsxs("button",{className:`nav-item ${e==="settings"?"active":""}`,onClick:()=>ue("settings"),children:[a.jsx("span",{className:"nav-icon",children:""}),a.jsx("span",{className:"nav-label",children:"Settings"})]})]}),q&&a.jsx("div",{className:"business-whatsapp-modal-overlay",children:a.jsxs("div",{className:"business-whatsapp-modal",children:[a.jsxs("div",{className:"business-whatsapp-header",children:[a.jsxs("div",{className:"business-whatsapp-info",children:[a.jsx("h3",{children:" Customer Messages"}),a.jsx("p",{children:"Respond to customer inquiries"})]}),a.jsx("button",{className:"close-business-whatsapp",onClick:()=>O(!1),children:""})]}),a.jsx("div",{className:"business-whatsapp-messages",children:L.map(be=>a.jsx("div",{className:`business-message ${be.from}`,children:a.jsxs("div",{className:"business-message-content",children:[be.from==="customer"&&a.jsxs("div",{className:"customer-info",children:[a.jsx("strong",{children:be.customerName}),a.jsx("span",{className:"customer-phone",children:be.customerPhone})]}),a.jsx("p",{children:be.message}),a.jsx("span",{className:"business-message-time",children:new Date(be.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},be.id))}),a.jsxs("div",{className:"business-whatsapp-input",children:[a.jsx("input",{type:"text",placeholder:"Type your response to customer...",value:F,onChange:be=>P(be.target.value),onKeyPress:be=>be.key==="Enter"&&he()}),a.jsx("button",{onClick:he,className:"business-send-btn",children:"Send"})]})]})})]})})})}const B1=({user:i,onLogout:e,stats:n,orders:r,storefrontUrl:l,setShowStorefront:u,handleNavigation:f,sendOrderConfirmation:p,updateOrderStatus:x,sendOrderReady:m,setShowBusinessWhatsApp:v,businessWhatsAppMessages:b})=>{const[S,I]=X.useState(null),[R,D]=X.useState([]),[k,q]=X.useState(!1),[O,L]=X.useState(null),[N,F]=X.useState("0"),[P,E]=X.useState(""),[_,A]=X.useState(""),[w,T]=X.useState(0),[U,B]=X.useState(!1),[ve,ye]=X.useState(""),[Q,ue]=X.useState(""),[pe,Ce]=X.useState(""),[H,G]=X.useState(""),[z,W]=X.useState(""),[J,Ae]=X.useState(""),[he,qe]=X.useState("");X.useEffect(()=>{(async()=>{q(!0);try{if(window.location.hostname!=="localhost"){const ge=await fetch("/api/dashboard/stats",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(ge.ok){const Dt=await ge.json();I(Dt)}const Ue=await fetch("/api/dashboard/orders",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(Ue.ok){const Dt=await Ue.json();D(Dt.orders||[])}}else I({totalOrders:45,totalRevenue:125e3,pendingOrders:8,completedOrders:37,totalProducts:23,lowStockProducts:3,todayOrders:5,todayRevenue:8500}),D(r.slice(0,5));L(new Date)}catch(je){console.error("Error loading dashboard data:",je),I(n),D(r.slice(0,5))}finally{q(!1)}})()},[]);const _e=we=>{U?(F(we),B(!1)):F(N==="0"?we:N+we)},be=we=>{const je=parseFloat(N);if(w===0)T(je);else if(_){const ge=Be(w,je,_);F(String(ge)),T(ge)}B(!0),A(we)},Be=(we,je,ge)=>{switch(ge){case"+":return we+je;case"-":return we-je;case"*":return we*je;case"/":return je!==0?we/je:0;default:return je}},Qe=()=>{const we=parseFloat(N);if(_&&w!==0){const je=Be(w,we,_);E(`= ${je}`),F(String(je)),T(0),A(""),B(!0)}},lt=()=>{F("0"),E(""),A(""),T(0),B(!1)},At=()=>{F("0")},Nt=()=>{if(ve&&Q){const we=parseFloat(ve),je=parseFloat(Q),ge=we-je,Ue=ge/we*100;E(`Profit: R${ge.toFixed(2)} | Margin: ${Ue.toFixed(1)}%`),F(ge.toFixed(2))}},gt=()=>{if(pe){const we=parseFloat(pe),je=we*.15,ge=we+je;E(`VAT: R${je.toFixed(2)} | Total: R${ge.toFixed(2)}`),F(ge.toFixed(2))}},Fe=()=>{if(H&&z){const we=parseFloat(H),je=parseFloat(z),ge=(we-je)/we*100,Ue=(we-je)/je*100;E(`Margin: ${ge.toFixed(1)}% | Markup: ${Ue.toFixed(1)}%`),F(ge.toFixed(1))}},it=()=>{if(J&&he){const we=parseFloat(J),je=parseFloat(he),ge=we*(je/100),Ue=we-ge;E(`Discount: R${ge.toFixed(2)} | Final: R${Ue.toFixed(2)}`),F(Ue.toFixed(2))}};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("img",{src:P0,alt:"Pezela Logo",className:"header-logo"}),a.jsx("h1",{children:"Dashboard"})]}),a.jsxs("div",{className:"header-actions",children:[k&&a.jsx("div",{className:"loading-indicator",children:"Loading live data..."}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"welcome-section",children:[a.jsxs("h2",{children:["Welcome back, ",i?.name,"! "]}),a.jsx("p",{children:"Here's what's happening with your business today"})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Total Orders"}),a.jsx("div",{className:"stat-value",children:S?.totalOrders||n.totalOrders})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Total Revenue"}),a.jsxs("div",{className:"stat-value",children:["R",(S?.totalRevenue||n.totalRevenue).toFixed(2)]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Pending"}),a.jsx("div",{className:"stat-value",children:S?.pendingOrders||n.pendingOrders})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Completed"}),a.jsx("div",{className:"stat-value",children:S?.completedOrders||n.completedOrders})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Products"}),a.jsx("div",{className:"stat-value",children:S?.totalProducts||n.totalProducts})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Low Stock"}),a.jsx("div",{className:"stat-value",children:S?.lowStockProducts||n.lowStockProducts})]})]})]}),a.jsxs("div",{className:"quick-actions",children:[a.jsx("h3",{children:"Quick Actions"}),a.jsxs("div",{className:"actions-grid",children:[a.jsx("button",{className:"action-button",onClick:()=>f("orders"),children:a.jsx("span",{children:"New Order"})}),a.jsx("button",{className:"action-button",onClick:()=>f("products"),children:a.jsx("span",{children:"Add Product"})}),a.jsx("button",{className:"action-button",onClick:()=>f("orders"),children:a.jsx("span",{children:"View Orders"})}),a.jsx("button",{className:"action-button",onClick:()=>f("payments"),children:a.jsx("span",{children:"View Payments"})}),a.jsx("button",{className:"action-button",onClick:()=>f("products"),children:a.jsx("span",{children:"View Products"})}),a.jsx("button",{className:"action-button",onClick:()=>f("settings"),children:a.jsx("span",{children:"Settings"})})]})]}),a.jsxs("div",{className:"storefront-section",children:[a.jsx("h3",{children:"Your Storefront"}),a.jsxs("div",{className:"storefront-card",children:[a.jsxs("div",{className:"storefront-info",children:[a.jsx("h4",{children:"Customer Store URL"}),a.jsxs("div",{className:"storefront-url",children:[a.jsx("input",{type:"text",value:l,readOnly:!0,className:"url-input"}),a.jsx("button",{className:"copy-btn",onClick:()=>{navigator.clipboard.writeText(l),alert("Store URL copied to clipboard!")},children:" Copy"})]}),a.jsx("p",{children:"Share this link with your customers to let them browse and order from your store"})]}),a.jsxs("div",{className:"storefront-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-value",children:"0"}),a.jsx("div",{className:"stat-label",children:"Total Views"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("div",{className:"stat-value",children:"0"}),a.jsx("div",{className:"stat-label",children:"Orders Today"})]})]}),a.jsxs("div",{className:"storefront-actions",children:[a.jsx("button",{className:"preview-btn",onClick:()=>u(!0),children:"Preview Store"}),a.jsx("button",{className:"qr-btn",onClick:()=>alert("QR Code generated! Print and display at your business."),children:"Generate QR Code"})]})]})]}),a.jsxs("div",{className:"recent-orders",children:[a.jsx("h3",{children:"Recent Orders"}),a.jsx("div",{className:"orders-list",children:(R.length>0?R:r).slice(0,3).map(we=>a.jsxs("div",{className:"order-card",onClick:()=>{const je=` Order Details:

Customer: ${we.customerName}
Phone: ${we.customerPhone}
Order: ${we.orderNumber}
Amount: R${we.totalAmount.toFixed(2)}
Status: ${we.status}
Items: ${we.items.length}
Created: ${new Date(we.createdAt).toLocaleString()}`;alert(je)},children:[a.jsxs("div",{className:"order-info",children:[a.jsxs("div",{className:"order-number",children:["Order #",we.orderNumber]}),a.jsx("div",{className:"order-date",children:new Date(we.createdAt).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),a.jsx("div",{className:"customer-name",children:we.customerName}),a.jsxs("div",{className:"order-amount",children:["R",we.totalAmount.toFixed(2)]})]}),a.jsx("div",{className:"order-status-section",children:a.jsxs("div",{className:"order-actions",children:[a.jsxs("button",{className:"order-action-btn whatsapp-btn",onClick:je=>{je.stopPropagation(),v(!0)},children:[" Chat",b.some(je=>je.from==="customer"&&!je.read)&&a.jsx("span",{className:"notification-badge",children:"!"})]}),a.jsx("button",{className:`order-action-btn status-${we.status==="pending"?"pending":we.status==="confirmed"?"ready":"complete"}`,onClick:je=>{je.stopPropagation();const ge=we.status==="pending"?"confirmed":we.status==="confirmed"?"ready":"completed";x(we.id,ge),ge==="ready"&&m(we),alert(`Order status updated to ${ge}!`)},children:we.status==="pending"?"Pending":we.status==="confirmed"?"Ready":"Complete"})]})})]},we.id))})]}),a.jsxs("div",{className:"business-calculator",children:[a.jsx("h3",{children:" Business Calculator"}),a.jsxs("div",{className:"calculator-container",children:[a.jsx("div",{className:"calculator-display",children:a.jsxs("div",{className:"calculator-screen",children:[a.jsx("div",{className:"calculator-input",children:N}),a.jsx("div",{className:"calculator-result",children:P})]})}),a.jsxs("div",{className:"calculator-buttons",children:[a.jsxs("div",{className:"calculator-row",children:[a.jsx("button",{className:"calc-btn calc-clear",onClick:()=>lt(),children:"C"}),a.jsx("button",{className:"calc-btn calc-clear",onClick:()=>At(),children:"CE"}),a.jsx("button",{className:"calc-btn calc-operator",onClick:()=>be("/"),children:""}),a.jsx("button",{className:"calc-btn calc-operator",onClick:()=>be("*"),children:""})]}),a.jsxs("div",{className:"calculator-row",children:[a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("7"),children:"7"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("8"),children:"8"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("9"),children:"9"}),a.jsx("button",{className:"calc-btn calc-operator",onClick:()=>be("-"),children:"-"})]}),a.jsxs("div",{className:"calculator-row",children:[a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("4"),children:"4"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("5"),children:"5"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("6"),children:"6"}),a.jsx("button",{className:"calc-btn calc-operator",onClick:()=>be("+"),children:"+"})]}),a.jsxs("div",{className:"calculator-row",children:[a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("1"),children:"1"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("2"),children:"2"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("3"),children:"3"}),a.jsx("button",{className:"calc-btn calc-equals",onClick:()=>Qe(),children:"="})]}),a.jsxs("div",{className:"calculator-row",children:[a.jsx("button",{className:"calc-btn calc-number calc-zero",onClick:()=>_e("0"),children:"0"}),a.jsx("button",{className:"calc-btn calc-number",onClick:()=>_e("."),children:"."})]})]}),a.jsxs("div",{className:"business-functions",children:[a.jsx("h4",{children:"Business Functions"}),a.jsxs("div",{className:"business-function-group",children:[a.jsx("h5",{children:" Profit Calculator"}),a.jsxs("div",{className:"business-inputs",children:[a.jsx("input",{type:"number",placeholder:"Revenue (R)",value:ve,onChange:we=>ye(we.target.value),className:"business-input"}),a.jsx("input",{type:"number",placeholder:"Cost (R)",value:Q,onChange:we=>ue(we.target.value),className:"business-input"}),a.jsx("button",{className:"business-btn",onClick:()=>Nt(),children:"Calculate"})]})]}),a.jsxs("div",{className:"business-function-group",children:[a.jsx("h5",{children:" VAT Calculator"}),a.jsxs("div",{className:"business-inputs",children:[a.jsx("input",{type:"number",placeholder:"Amount (R)",value:pe,onChange:we=>Ce(we.target.value),className:"business-input"}),a.jsx("button",{className:"business-btn",onClick:()=>gt(),children:"Calculate VAT"})]})]}),a.jsxs("div",{className:"business-function-group",children:[a.jsx("h5",{children:" Margin Calculator"}),a.jsxs("div",{className:"business-inputs",children:[a.jsx("input",{type:"number",placeholder:"Selling Price (R)",value:H,onChange:we=>G(we.target.value),className:"business-input"}),a.jsx("input",{type:"number",placeholder:"Cost Price (R)",value:z,onChange:we=>W(we.target.value),className:"business-input"}),a.jsx("button",{className:"business-btn",onClick:()=>Fe(),children:"Calculate"})]})]}),a.jsxs("div",{className:"business-function-group",children:[a.jsx("h5",{children:" Discount Calculator"}),a.jsxs("div",{className:"business-inputs",children:[a.jsx("input",{type:"number",placeholder:"Original Price (R)",value:J,onChange:we=>Ae(we.target.value),className:"business-input"}),a.jsx("input",{type:"number",placeholder:"Discount %",value:he,onChange:we=>qe(we.target.value),className:"business-input"}),a.jsx("button",{className:"business-btn",onClick:()=>it(),children:"Calculate"})]})]})]})]})]})]})]})},XR=({user:i,onLogout:e,products:n,updateProduct:r,onNavigate:l})=>{const[u,f]=X.useState(""),[p,x]=X.useState("all"),[m,v]=X.useState("name"),b=[...new Set(n.map(D=>D.category))],S=n.filter(D=>D.name.toLowerCase().includes(u.toLowerCase())&&(p==="all"||D.category===p)).sort((D,k)=>{switch(m){case"stock":return D.stock-k.stock;case"category":return D.category.localeCompare(k.category);default:return D.name.localeCompare(k.name)}}),I=n.filter(D=>D.stock<10),R=n.filter(D=>D.stock===0);return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("button",{className:"back-btn",onClick:()=>l("products"),children:" Back"}),a.jsx("h1",{children:"Stock Management"})]}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"stock-overview",children:[a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Low Stock"}),a.jsx("div",{className:"stat-value",children:I.length})]})]}),a.jsxs("div",{className:"stat-card danger",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"Out of Stock"}),a.jsx("div",{className:"stat-value",children:R.length})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-title",children:"In Stock"}),a.jsx("div",{className:"stat-value",children:n.length-I.length})]})]})]}),a.jsxs("div",{className:"filters-section",children:[a.jsx("div",{className:"search-box",children:a.jsx("input",{type:"text",placeholder:"Search products...",value:u,onChange:D=>f(D.target.value),className:"search-input"})}),a.jsxs("div",{className:"filter-controls",children:[a.jsxs("select",{value:p,onChange:D=>x(D.target.value),className:"filter-select",children:[a.jsx("option",{value:"all",children:"All Categories"}),b.map(D=>a.jsx("option",{value:D,children:D},D))]}),a.jsxs("select",{value:m,onChange:D=>v(D.target.value),className:"filter-select",children:[a.jsx("option",{value:"name",children:"Sort by Name"}),a.jsx("option",{value:"stock",children:"Sort by Stock"}),a.jsx("option",{value:"category",children:"Sort by Category"})]})]})]}),a.jsx("div",{className:"stock-list",children:S.map(D=>a.jsxs("div",{className:`stock-item ${D.stock===0?"out-of-stock":D.stock<10?"low-stock":""}`,children:[a.jsxs("div",{className:"product-info",children:[a.jsx("div",{className:"product-image",children:D.image}),a.jsxs("div",{className:"product-details",children:[a.jsx("h3",{children:D.name}),a.jsx("p",{className:"product-category",children:D.category}),a.jsxs("p",{className:"product-price",children:["R",D.price.toFixed(2)]})]})]}),a.jsxs("div",{className:"stock-controls",children:[a.jsxs("div",{className:"stock-display",children:[a.jsx("span",{className:`stock-value ${D.stock===0?"zero":D.stock<10?"low":"good"}`,children:D.stock}),a.jsx("span",{className:"stock-label",children:"units"})]}),a.jsxs("div",{className:"stock-actions",children:[a.jsx("button",{className:"stock-btn add",onClick:()=>{const k=prompt(`Add stock to ${D.name} (current: ${D.stock}):`);k&&!isNaN(parseInt(k))&&(r(D.id,{stock:D.stock+parseInt(k)}),alert(` Added ${k} units!`))},children:"+ Add"}),a.jsx("button",{className:"stock-btn remove",onClick:()=>{const k=prompt(`Remove stock from ${D.name} (current: ${D.stock}):`);if(k&&!isNaN(parseInt(k))){const q=Math.max(0,D.stock-parseInt(k));r(D.id,{stock:q}),alert(` Removed ${k} units!`)}},children:"- Remove"}),a.jsx("button",{className:"stock-btn set",onClick:()=>{const k=prompt(`Set stock for ${D.name} (current: ${D.stock}):`);k&&!isNaN(parseInt(k))&&(r(D.id,{stock:parseInt(k)}),alert(` Stock set to ${k}!`))},children:"Set"})]})]})]},D.id))})]})]})},WR=({user:i,onLogout:e,addProduct:n,onNavigate:r})=>{const[l,u]=X.useState({name:"",price:"",stock:"",category:"",image:"",description:""}),f=["Beverages","Food","Pastries","Desserts","Snacks","Other"],p=x=>{if(x.preventDefault(),!l.name||!l.price||!l.stock||!l.category){alert("Please fill in all required fields");return}n({name:l.name,price:parseFloat(l.price),stock:parseInt(l.stock),category:l.category,image:l.image||"",description:l.description}),alert(` Product "${l.name}" added successfully!`),r("products")};return a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("button",{className:"back-btn",onClick:()=>r("products"),children:" Back"}),a.jsx("h1",{children:"Add Product"})]}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsx("div",{className:"screen-content",children:a.jsxs("form",{onSubmit:p,className:"product-form",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Basic Information"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Product Name *"}),a.jsx("input",{type:"text",value:l.name,onChange:x=>u({...l,name:x.target.value}),placeholder:"Enter product name",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Category *"}),a.jsxs("select",{value:l.category,onChange:x=>u({...l,category:x.target.value}),required:!0,children:[a.jsx("option",{value:"",children:"Select category"}),f.map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Description"}),a.jsx("textarea",{value:l.description,onChange:x=>u({...l,description:x.target.value}),placeholder:"Product description (optional)",rows:3})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Pricing & Inventory"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Price (R) *"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:l.price,onChange:x=>u({...l,price:x.target.value}),placeholder:"0.00",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stock Quantity *"}),a.jsx("input",{type:"number",min:"0",value:l.stock,onChange:x=>u({...l,stock:x.target.value}),placeholder:"0",required:!0})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Product Image"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Emoji or Icon"}),a.jsx("input",{type:"text",value:l.image,onChange:x=>u({...l,image:x.target.value}),placeholder:"e.g., , , ",maxLength:2}),a.jsx("p",{className:"form-hint",children:"Use emojis or symbols to represent your product"})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>r("products"),children:"Cancel"}),a.jsx("button",{type:"submit",className:"submit-btn",children:"Add Product"})]})]})})]})},ZR=({user:i,onLogout:e,product:n,updateProduct:r,onNavigate:l})=>{const[u,f]=X.useState({name:n?.name||"",price:n?.price.toString()||"",stock:n?.stock.toString()||"",category:n?.category||"",image:n?.image||"",description:n?.description||""}),p=["Beverages","Food","Pastries","Desserts","Snacks","Other"],x=m=>{m.preventDefault(),n&&(r(n.id,{name:u.name,price:parseFloat(u.price),stock:parseInt(u.stock),category:u.category,image:u.image,description:u.description}),alert(` Product "${u.name}" updated successfully!`),l("products"))};return n?a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("button",{className:"back-btn",onClick:()=>l("products"),children:" Back"}),a.jsx("h1",{children:"Edit Product"})]}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsx("div",{className:"screen-content",children:a.jsxs("form",{onSubmit:x,className:"product-form",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Basic Information"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Product Name *"}),a.jsx("input",{type:"text",value:u.name,onChange:m=>f({...u,name:m.target.value}),placeholder:"Enter product name",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Category *"}),a.jsxs("select",{value:u.category,onChange:m=>f({...u,category:m.target.value}),required:!0,children:[a.jsx("option",{value:"",children:"Select category"}),p.map(m=>a.jsx("option",{value:m,children:m},m))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Description"}),a.jsx("textarea",{value:u.description,onChange:m=>f({...u,description:m.target.value}),placeholder:"Product description (optional)",rows:3})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Pricing & Inventory"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Price (R) *"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:u.price,onChange:m=>f({...u,price:m.target.value}),placeholder:"0.00",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stock Quantity *"}),a.jsx("input",{type:"number",min:"0",value:u.stock,onChange:m=>f({...u,stock:m.target.value}),placeholder:"0",required:!0})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Product Image"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Emoji or Icon"}),a.jsx("input",{type:"text",value:u.image,onChange:m=>f({...u,image:m.target.value}),placeholder:"e.g., , , ",maxLength:2}),a.jsx("p",{className:"form-hint",children:"Use emojis or symbols to represent your product"})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>l("products"),children:"Cancel"}),a.jsx("button",{type:"submit",className:"submit-btn",children:"Update Product"})]})]})})]}):a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsxs("div",{className:"header-left",children:[a.jsx("button",{className:"back-btn",onClick:()=>l("products"),children:" Back"}),a.jsx("h1",{children:"Edit Product"})]}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsx("div",{className:"screen-content",children:a.jsxs("div",{className:"error-message",children:[a.jsx("p",{children:"Product not found. Please go back and select a product to edit."}),a.jsx("button",{onClick:()=>l("products"),className:"primary-button",children:"Back to Products"})]})})]})},JR=({user:i,onLogout:e})=>{const[n,r]=X.useState("reports"),[l,u]=X.useState(""),[f,p]=X.useState(!1),[x,m]=X.useState(null),[v,b]=X.useState(!1),[S,I]=X.useState({sarsNumber:"",vatNumber:"",accountingSystem:"",accountingConfig:{}}),[R,D]=X.useState(!1),[k,q]=X.useState(!1),[O,L]=X.useState(""),[N,F]=X.useState("");return X.useEffect(()=>{(async()=>{b(!0);try{{const _=await fetch("/api/tax/data",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(_.ok){const A=await _.json();m(A)}}}catch(E){console.error("Failed to load tax data:",E)}finally{b(!1)}})()},[]),a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsx("h1",{children:"Tax & SARS Compliance"}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"segmented-control",children:[a.jsx("button",{className:`segment ${n==="reports"?"active":""}`,onClick:()=>r("reports"),children:"Reports"}),a.jsx("button",{className:`segment ${n==="settings"?"active":""}`,onClick:()=>r("settings"),children:"Settings"})]}),n==="reports"&&a.jsxs("div",{className:"content-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Tax Reports"}),a.jsx("button",{className:"primary-button",onClick:async()=>{b(!0);try{if(window.location.hostname!=="localhost"){const E=await fetch("/api/tax/generate-report",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();m(A=>({...A,generatedReport:{id:_.reportId,generatedDate:new Date().toISOString(),status:"Generated",vatReturn:_.vatReturn,incomeTax:_.incomeTax}}))}}else{const E={id:`REPORT-${Date.now()}`,generatedDate:new Date().toISOString(),status:"Generated",vatReturn:{period:"Dec 2024",vatCollected:x?.vatCollected||18750,vatPaid:x?.vatPaid||12e3,netVatOwed:x?.netVatOwed||6750},incomeTax:{period:"Q4 2024",taxableIncome:38100,taxOwed:11430,deductions:5e3,netTaxOwed:6430}};m(_=>({..._,generatedReport:E}))}}catch(P){console.error("Error generating tax report:",P)}finally{b(!1)}},disabled:v,children:v?"Generating...":"Generate"})]}),a.jsxs("div",{className:"card-list",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"VAT Return"}),a.jsx("div",{className:"badge success",children:"Ready"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:"Dec 2024"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"VAT:"}),a.jsx("span",{className:"value",children:x?`R${x.netVatOwed?.toLocaleString()||"0"}`:"Loading..."})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/vat-return/view",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();m(A=>({...A,vatReturn:_}))}}else{const E={period:"Dec 2024",vatCollected:x?.vatCollected||18750,vatPaid:x?.vatPaid||12e3,netVatOwed:x?.netVatOwed||6750,submissionDate:new Date().toLocaleDateString(),status:"Ready for submission"};m(_=>({..._,vatReturn:E}))}}catch(P){console.error("Error loading VAT return:",P)}finally{b(!1)}},children:"View"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/vat-return/export",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.blob(),A=window.URL.createObjectURL(_),w=document.createElement("a");w.href=A,w.download=`VAT_Return_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(A),document.body.removeChild(w)}}else{const E={period:"Dec 2024",vatCollected:x?.vatCollected||18750,vatPaid:x?.vatPaid||12e3,netVatOwed:x?.netVatOwed||6750,exportDate:new Date().toISOString()},_=JSON.stringify(E,null,2),A=new Blob([_],{type:"application/json"}),w=window.URL.createObjectURL(A),T=document.createElement("a");T.href=w,T.download=`VAT_Return_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(w),document.body.removeChild(T)}}catch(P){console.error("Error exporting VAT return:",P)}finally{b(!1)}},children:"Export"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/vat-return/submit",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:"Dec 2024",netVatOwed:x?.netVatOwed||6750,submissionDate:new Date().toISOString()})});if(E.ok){const _=await E.json();m(A=>({...A,vatReturn:{...A.vatReturn,status:"Submitted",submissionId:_.submissionId}}))}}else m(E=>({...E,vatReturn:{...E.vatReturn,status:"Submitted to SARS",submissionId:`SARS-${Date.now()}`,submissionDate:new Date().toISOString()}}))}catch(P){console.error("Error submitting VAT return:",P)}finally{b(!1)}},children:"Submit to SARS"})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Income Tax Summary"}),a.jsx("div",{className:"badge warning",children:"Pending"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Period:"}),a.jsx("span",{className:"value",children:"Q4 2024"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Taxable Income:"}),a.jsx("span",{className:"value",children:"R38,100.00"})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/income-tax/view",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();m(A=>({...A,incomeTax:_}))}}else{const E={period:"Q4 2024",taxableIncome:38100,taxOwed:11430,deductions:5e3,netTaxOwed:6430,submissionDate:new Date().toLocaleDateString(),status:"Ready for submission"};m(_=>({..._,incomeTax:E}))}}catch(P){console.error("Error loading income tax:",P)}finally{b(!1)}},children:"View"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/income-tax/export",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.blob(),A=window.URL.createObjectURL(_),w=document.createElement("a");w.href=A,w.download=`Income_Tax_Summary_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(A),document.body.removeChild(w)}}else{const E={period:"Q4 2024",taxableIncome:38100,taxOwed:11430,deductions:5e3,netTaxOwed:6430,exportDate:new Date().toISOString()},_=JSON.stringify(E,null,2),A=new Blob([_],{type:"application/json"}),w=window.URL.createObjectURL(A),T=document.createElement("a");T.href=w,T.download=`Income_Tax_Summary_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(w),document.body.removeChild(T)}}catch(P){console.error("Error exporting income tax:",P)}finally{b(!1)}},children:"Export"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/income-tax/submit",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({period:"Q4 2024",taxableIncome:38100,netTaxOwed:6430,submissionDate:new Date().toISOString()})});if(E.ok){const _=await E.json();m(A=>({...A,incomeTax:{...A.incomeTax,status:"Submitted",submissionId:_.submissionId}}))}}else m(E=>({...E,incomeTax:{...E.incomeTax,status:"Submitted to SARS",submissionId:`SARS-${Date.now()}`,submissionDate:new Date().toISOString()}}))}catch(P){console.error("Error submitting income tax:",P)}finally{b(!1)}},children:"Submit to SARS"})]})]})]}),a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/export-all",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.blob(),A=window.URL.createObjectURL(_),w=document.createElement("a");w.href=A,w.download=`Tax_Reports_${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(A),document.body.removeChild(w)}}else{const E={vatReturn:x?.vatReturn||{},incomeTax:x?.incomeTax||{},exportDate:new Date().toISOString(),businessName:"Your Business"},_=JSON.stringify(E,null,2),A=new Blob([_],{type:"application/json"}),w=window.URL.createObjectURL(A),T=document.createElement("a");T.href=w,T.download=`Tax_Reports_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(w),document.body.removeChild(T)}}catch(P){console.error("Error exporting all reports:",P)}finally{b(!1)}},children:"Export to Accounting"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/submit-all",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({vatReturn:x?.vatReturn,incomeTax:x?.incomeTax,submissionDate:new Date().toISOString()})});if(E.ok){const _=await E.json();m(A=>({...A,vatReturn:{...A.vatReturn,status:"Submitted",submissionId:_.vatSubmissionId},incomeTax:{...A.incomeTax,status:"Submitted",submissionId:_.incomeSubmissionId}}))}}else m(E=>({...E,vatReturn:{...E.vatReturn,status:"Submitted to SARS",submissionId:`SARS-VAT-${Date.now()}`,submissionDate:new Date().toISOString()},incomeTax:{...E.incomeTax,status:"Submitted to SARS",submissionId:`SARS-INC-${Date.now()}`,submissionDate:new Date().toISOString()}}))}catch(P){console.error("Error submitting all reports:",P)}finally{b(!1)}},children:"Submit All to SARS"})]})]}),n==="settings"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Tax Settings"})}),a.jsxs("div",{className:"settings-list",children:[a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"SARS Registration Number"}),a.jsx("div",{className:"setting-subtitle",children:"Your SARS tax number"}),R?a.jsxs("div",{className:"edit-form",children:[a.jsx("input",{type:"text",value:O,onChange:P=>L(P.target.value),placeholder:"Enter SARS Registration Number",className:"edit-input"}),a.jsxs("div",{className:"edit-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{D(!1),L("")},children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{b(!0),window.location.hostname!=="localhost"?(await fetch("/api/tax/settings/sars-number",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({sarsNumber:O})})).ok&&(I(_=>({..._,sarsNumber:O})),D(!1)):(I(E=>({...E,sarsNumber:O})),D(!1),console.log("SARS Number updated:",O))}catch(P){console.error("Error updating SARS number:",P)}finally{b(!1)}},children:v?"Saving...":"Save"})]})]}):a.jsx("div",{className:"setting-value",children:S.sarsNumber||"Not set"})]}),!R&&a.jsx("button",{className:"tertiary-button",onClick:()=>{L(S.sarsNumber),D(!0)},children:"Edit"})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"VAT Registration"}),a.jsx("div",{className:"setting-subtitle",children:"VAT number details"}),k?a.jsxs("div",{className:"edit-form",children:[a.jsx("input",{type:"text",value:N,onChange:P=>F(P.target.value),placeholder:"Enter VAT Number",className:"edit-input"}),a.jsxs("div",{className:"edit-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{q(!1),F("")},children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{b(!0),window.location.hostname!=="localhost"?(await fetch("/api/tax/settings/vat-number",{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({vatNumber:N})})).ok&&(I(_=>({..._,vatNumber:N})),q(!1)):(I(E=>({...E,vatNumber:N})),q(!1),console.log("VAT Number updated:",N))}catch(P){console.error("Error updating VAT number:",P)}finally{b(!1)}},children:v?"Saving...":"Save"})]})]}):a.jsx("div",{className:"setting-value",children:S.vatNumber||"Not set"})]}),!k&&a.jsx("button",{className:"tertiary-button",onClick:()=>{F(S.vatNumber),q(!0)},children:"Edit"})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"Accounting System"}),a.jsx("div",{className:"setting-subtitle",children:"Connect to your accounting software"})]}),a.jsxs("select",{className:"accounting-dropdown",value:l,onChange:P=>{u(P.target.value),P.target.value&&p(!0)},children:[a.jsx("option",{value:"",children:"Select System"}),a.jsx("option",{value:"quickbooks",children:"QuickBooks"}),a.jsx("option",{value:"xero",children:"Xero"}),a.jsx("option",{value:"sage",children:"Sage"}),a.jsx("option",{value:"pastel",children:"Pastel"})]})]}),f&&l&&a.jsxs("div",{className:"accounting-config",children:[a.jsxs("h3",{children:["Configure ",l.charAt(0).toUpperCase()+l.slice(1)]}),l==="quickbooks"&&a.jsxs("div",{className:"config-fields",children:[a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"QuickBooks Company ID:"}),a.jsx("input",{type:"text",placeholder:"Enter Company ID"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"API Key:"}),a.jsx("input",{type:"password",placeholder:"Enter API Key"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Sync Frequency:"}),a.jsxs("select",{children:[a.jsx("option",{children:"Daily"}),a.jsx("option",{children:"Weekly"}),a.jsx("option",{children:"Monthly"})]})]})]}),l==="xero"&&a.jsxs("div",{className:"config-fields",children:[a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Xero Tenant ID:"}),a.jsx("input",{type:"text",placeholder:"Enter Tenant ID"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Client ID:"}),a.jsx("input",{type:"text",placeholder:"Enter Client ID"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Client Secret:"}),a.jsx("input",{type:"password",placeholder:"Enter Client Secret"})]})]}),l==="sage"&&a.jsxs("div",{className:"config-fields",children:[a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Sage Company Code:"}),a.jsx("input",{type:"text",placeholder:"Enter Company Code"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Database Path:"}),a.jsx("input",{type:"text",placeholder:"Enter Database Path"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"User ID:"}),a.jsx("input",{type:"text",placeholder:"Enter User ID"})]})]}),l==="pastel"&&a.jsxs("div",{className:"config-fields",children:[a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Pastel Company:"}),a.jsx("input",{type:"text",placeholder:"Enter Company Name"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Data Path:"}),a.jsx("input",{type:"text",placeholder:"Enter Data Path"})]}),a.jsxs("div",{className:"config-field",children:[a.jsx("label",{children:"Version:"}),a.jsxs("select",{children:[a.jsx("option",{children:"Pastel Evolution"}),a.jsx("option",{children:"Pastel Partner"}),a.jsx("option",{children:"Pastel Xpress"})]})]})]}),a.jsxs("div",{className:"config-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>p(!1),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/tax/settings/accounting",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({system:l,configuration:S.accountingConfig})});if(E.ok){const _=await E.json();I(A=>({...A,accountingSystem:l,accountingConfig:_.configuration})),p(!1)}}else I(E=>({...E,accountingSystem:l,accountingConfig:{system:l,configuredDate:new Date().toISOString(),status:"Active"}})),p(!1),setTimeout(()=>{console.log("Accounting system configured:",l)},500)}catch(P){console.error("Error saving accounting configuration:",P)}finally{b(!1)}},children:v?"Saving...":"Save Configuration"})]})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"Auto-Generate Reports"}),a.jsx("div",{className:"setting-subtitle",children:"Monthly reports"})]}),a.jsxs("div",{className:"toggle",children:[a.jsx("input",{type:"checkbox",id:"auto-reports",defaultChecked:!0}),a.jsx("label",{htmlFor:"auto-reports",className:"toggle-label"})]})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"Auto-Submit to SARS"}),a.jsx("div",{className:"setting-subtitle",children:"Automatically submit reports"})]}),a.jsxs("div",{className:"toggle",children:[a.jsx("input",{type:"checkbox",id:"auto-submit"}),a.jsx("label",{htmlFor:"auto-submit",className:"toggle-label"})]})]})]})]})]})]})},eD=({user:i,onLogout:e})=>{const[n,r]=X.useState("devices"),[l,u]=X.useState([]),[f,p]=X.useState(!1),[x,m]=X.useState(!1),[v,b]=X.useState({name:"",type:"",model:"",connectionType:"usb"}),[S,I]=X.useState({});return X.useEffect(()=>{(async()=>{p(!0);try{{const k=await fetch("/api/hardware/devices",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(k.ok){const q=await k.json();u(q.devices||[])}}}catch(D){console.error("Failed to load hardware devices:",D)}finally{p(!1)}})()},[]),a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsx("h1",{children:"Hardware Integrations"}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"segmented-control",children:[a.jsx("button",{className:`segment ${n==="devices"?"active":""}`,onClick:()=>r("devices"),children:"Devices"}),a.jsx("button",{className:`segment ${n==="settings"?"active":""}`,onClick:()=>r("settings"),children:"Settings"})]}),n==="devices"&&a.jsxs("div",{className:"content-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Connected Devices"}),a.jsx("button",{className:"primary-button",onClick:()=>m(!0),children:"Add Device"})]}),x&&a.jsxs("div",{className:"add-device-form",children:[a.jsx("h3",{children:"Add New Device"}),a.jsxs("div",{className:"form-fields",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Device Name:"}),a.jsx("input",{type:"text",value:v.name,onChange:R=>b(D=>({...D,name:R.target.value})),placeholder:"Enter device name"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Device Type:"}),a.jsxs("select",{value:v.type,onChange:R=>b(D=>({...D,type:R.target.value})),children:[a.jsx("option",{value:"",children:"Select Type"}),a.jsx("option",{value:"card-reader",children:"Card Reader"}),a.jsx("option",{value:"printer",children:"Printer"}),a.jsx("option",{value:"scanner",children:"Barcode Scanner"}),a.jsx("option",{value:"pos",children:"POS Terminal"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Model:"}),a.jsx("input",{type:"text",value:v.model,onChange:R=>b(D=>({...D,model:R.target.value})),placeholder:"Enter device model"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Connection Type:"}),a.jsxs("select",{value:v.connectionType,onChange:R=>b(D=>({...D,connectionType:R.target.value})),children:[a.jsx("option",{value:"usb",children:"USB"}),a.jsx("option",{value:"bluetooth",children:"Bluetooth"}),a.jsx("option",{value:"wifi",children:"WiFi"}),a.jsx("option",{value:"ethernet",children:"Ethernet"})]})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{m(!1),b({name:"",type:"",model:"",connectionType:"usb"})},children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(p(!0),window.location.hostname!=="localhost"){const D=await fetch("/api/hardware/devices",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify(v)});if(D.ok){const k=await D.json();u(q=>[...q,k]),m(!1),b({name:"",type:"",model:"",connectionType:"usb"})}}else{const D={id:`device-${Date.now()}`,...v,status:"disconnected",lastSeen:new Date().toISOString()};u(k=>[...k,D]),m(!1),b({name:"",type:"",model:"",connectionType:"usb"}),console.log("Device added:",D)}}catch(R){console.error("Error adding device:",R)}finally{p(!1)}},children:f?"Adding...":"Add Device"})]})]}),a.jsxs("div",{className:"card-list",children:[a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Card Reader"}),a.jsx("div",{className:"badge success",children:"Connected"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Model:"}),a.jsx("span",{className:"value",children:"Yoco Card Reader"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:"Active"})]}),S["card-reader"]&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Test Result:"}),a.jsx("span",{className:"value",children:S["card-reader"]})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(p(!0),window.location.hostname!=="localhost"){const D=await fetch("/api/hardware/devices/card-reader/configure",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(D.ok){const k=await D.json();console.log("Card Reader configured:",k)}}else console.log("Card Reader configuration opened"),setTimeout(()=>{console.log("Card Reader configured successfully")},1e3)}catch(R){console.error("Error configuring card reader:",R)}finally{p(!1)}},children:f?"Configuring...":"Configure"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(p(!0),window.location.hostname!=="localhost"){const D=await fetch("/api/hardware/devices/card-reader/test",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(D.ok){const k=await D.json();I(q=>({...q,"card-reader":k.status}))}}else setTimeout(()=>{I(D=>({...D,"card-reader":"Test successful"})),console.log("Card Reader test completed")},2e3)}catch(R){console.error("Error testing card reader:",R)}finally{p(!1)}},children:f?"Testing...":"Test"})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Barcode Scanner"}),a.jsx("div",{className:"badge warning",children:"Disconnected"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Model:"}),a.jsx("span",{className:"value",children:"Generic USB Scanner"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:"Offline"})]}),S["barcode-scanner"]&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Connection Status:"}),a.jsx("span",{className:"value",children:S["barcode-scanner"]})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(p(!0),window.location.hostname!=="localhost"){const D=await fetch("/api/hardware/devices/barcode-scanner/connect",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(D.ok){const k=await D.json();I(q=>({...q,"barcode-scanner":k.status}))}}else setTimeout(()=>{I(D=>({...D,"barcode-scanner":"Connected successfully"})),console.log("Barcode Scanner connected")},2e3)}catch(R){console.error("Error connecting barcode scanner:",R)}finally{p(!1)}},children:f?"Connecting...":"Connect"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(p(!0),window.location.hostname!=="localhost"){const D=await fetch("/api/hardware/devices/barcode-scanner/setup",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(D.ok){const k=await D.json();console.log("Barcode Scanner setup completed:",k)}}else setTimeout(()=>{I(D=>({...D,"barcode-scanner":"Setup completed"})),console.log("Barcode Scanner setup completed")},3e3)}catch(R){console.error("Error setting up barcode scanner:",R)}finally{p(!1)}},children:f?"Setting up...":"Setup"})]})]})]})]}),n==="settings"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Hardware Settings"})}),a.jsxs("div",{className:"settings-list",children:[a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"Auto-Connect Devices"}),a.jsx("div",{className:"setting-subtitle",children:"Automatically connect new devices"})]}),a.jsxs("div",{className:"toggle",children:[a.jsx("input",{type:"checkbox",id:"auto-connect",defaultChecked:!0}),a.jsx("label",{htmlFor:"auto-connect",className:"toggle-label"})]})]}),a.jsxs("div",{className:"setting-row",children:[a.jsxs("div",{className:"setting-content",children:[a.jsx("div",{className:"setting-title",children:"Device Notifications"}),a.jsx("div",{className:"setting-subtitle",children:"Get notified about device status"})]}),a.jsxs("div",{className:"toggle",children:[a.jsx("input",{type:"checkbox",id:"device-notifications",defaultChecked:!0}),a.jsx("label",{htmlFor:"device-notifications",className:"toggle-label"})]})]})]})]})]})]})},tD=({user:i,onLogout:e})=>{const[n,r]=X.useState("credit"),[l,u]=X.useState(null),[f,p]=X.useState(0),[x,m]=X.useState([]),[v,b]=X.useState(!1),[S,I]=X.useState(!1),[R,D]=X.useState(null),[k,q]=X.useState([]),[O,L]=X.useState(!1),[N,F]=X.useState({loanType:"",amount:"",businessName:"",contactEmail:"",phone:"",businessRegistration:"",monthlyRevenue:"",loanPurpose:"",repaymentTerm:"12"});return X.useEffect(()=>{(async()=>{b(!0);try{{const _=await fetch("/api/lending/data",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(_.ok){const A=await _.json();u(A),p(A.creditScore||0),m(A.availableLoans||[])}}}catch(E){console.error("Failed to load lending data:",E)}finally{b(!1)}})()},[]),a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsx("h1",{children:"Merchant Micro-lending"}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"segmented-control",children:[a.jsx("button",{className:`segment ${n==="credit"?"active":""}`,onClick:()=>r("credit"),children:"Credit Score"}),a.jsx("button",{className:`segment ${n==="loans"?"active":""}`,onClick:()=>r("loans"),children:"Loans"})]}),n==="credit"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Credit Score"})}),a.jsx("div",{className:"card-list",children:a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Current Score"}),a.jsx("div",{className:"badge success",children:"Good"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Score:"}),a.jsx("span",{className:"value",children:"750/1000"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Last Updated:"}),a.jsx("span",{className:"value",children:"Dec 2024"})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/lending/credit-details",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();D(_),I(!0)}}else{const E={score:750,factors:[{factor:"Payment History",impact:"Positive",weight:35},{factor:"Credit Utilization",impact:"Good",weight:30},{factor:"Length of Credit",impact:"Excellent",weight:15},{factor:"Credit Mix",impact:"Good",weight:10},{factor:"New Credit",impact:"Neutral",weight:10}],recommendations:["Maintain current payment patterns","Keep credit utilization below 30%","Avoid opening new credit accounts"],lastUpdated:new Date().toISOString()};D(E),I(!0)}}catch(P){console.error("Error loading credit details:",P)}finally{b(!1)}},children:v?"Loading...":"View Details"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/lending/refresh-credit",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();p(_.creditScore),u(A=>({...A,creditScore:_.creditScore}))}}else{const E=Math.floor(Math.random()*50)+700;p(E),u(_=>({..._,creditScore:E})),console.log("Credit score refreshed:",E)}}catch(P){console.error("Error refreshing credit score:",P)}finally{b(!1)}},children:v?"Refreshing...":"Refresh"})]})]})}),S&&R&&a.jsxs("div",{className:"credit-details-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Credit Score Details"}),a.jsx("button",{className:"close-btn",onClick:()=>I(!1),children:""})]}),a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"score-section",children:[a.jsxs("h4",{children:["Current Score: ",R.score,"/1000"]}),a.jsxs("p",{children:["Last Updated: ",new Date(R.lastUpdated).toLocaleDateString()]})]}),a.jsxs("div",{className:"factors-section",children:[a.jsx("h4",{children:"Credit Factors"}),R.factors.map((P,E)=>a.jsxs("div",{className:"factor-item",children:[a.jsx("div",{className:"factor-name",children:P.factor}),a.jsx("div",{className:"factor-impact",children:P.impact}),a.jsxs("div",{className:"factor-weight",children:[P.weight,"%"]})]},E))]}),a.jsxs("div",{className:"recommendations-section",children:[a.jsx("h4",{children:"Recommendations"}),a.jsx("ul",{children:R.recommendations.map((P,E)=>a.jsx("li",{children:P},E))})]})]})]})]}),n==="loans"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Available Loans"})}),a.jsx("div",{className:"card-list",children:a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Working Capital Loan"}),a.jsx("div",{className:"badge success",children:"Available"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Amount:"}),a.jsx("span",{className:"value",children:"R50,000"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Interest:"}),a.jsx("span",{className:"value",children:"12% p.a."})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{F(P=>({...P,loanType:"Working Capital Loan",amount:"50000"})),L(!0)},children:"Apply"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/lending/loans/working-capital/details",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(E.ok){const _=await E.json();console.log("Loan details:",_)}}else console.log("Loan details:",{name:"Working Capital Loan",amount:5e4,interestRate:12,term:"12 months",monthlyPayment:4444,totalInterest:3333,eligibility:{minCreditScore:650,minRevenue:1e5,maxDebtRatio:.4},requirements:["Business registration certificate","6 months bank statements","Tax clearance certificate","Business plan"],benefits:["Quick approval process","Flexible repayment terms","No early payment penalties","Competitive interest rates"]})}catch(P){console.error("Error loading loan details:",P)}finally{b(!1)}},children:v?"Loading...":"Details"})]})]})}),O&&a.jsxs("div",{className:"loan-application-form",children:[a.jsxs("div",{className:"form-header",children:[a.jsx("h3",{children:"Loan Application"}),a.jsx("button",{className:"close-btn",onClick:()=>L(!1),children:""})]}),a.jsxs("div",{className:"form-content",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Loan Information"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Loan Type:"}),a.jsx("input",{type:"text",value:N.loanType,onChange:P=>F(E=>({...E,loanType:P.target.value})),placeholder:"Enter loan type"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Amount (R):"}),a.jsx("input",{type:"number",value:N.amount,onChange:P=>F(E=>({...E,amount:P.target.value})),placeholder:"Enter loan amount"})]})]}),a.jsx("div",{className:"form-row",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Repayment Term (months):"}),a.jsxs("select",{value:N.repaymentTerm,onChange:P=>F(E=>({...E,repaymentTerm:P.target.value})),children:[a.jsx("option",{value:"6",children:"6 months"}),a.jsx("option",{value:"12",children:"12 months"}),a.jsx("option",{value:"18",children:"18 months"}),a.jsx("option",{value:"24",children:"24 months"}),a.jsx("option",{value:"36",children:"36 months"})]})]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Business Information"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Business Name:"}),a.jsx("input",{type:"text",value:N.businessName,onChange:P=>F(E=>({...E,businessName:P.target.value})),placeholder:"Enter business name"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Contact Email:"}),a.jsx("input",{type:"email",value:N.contactEmail,onChange:P=>F(E=>({...E,contactEmail:P.target.value})),placeholder:"Enter contact email"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Phone Number:"}),a.jsx("input",{type:"tel",value:N.phone,onChange:P=>F(E=>({...E,phone:P.target.value})),placeholder:"Enter phone number"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Business Registration:"}),a.jsx("input",{type:"text",value:N.businessRegistration,onChange:P=>F(E=>({...E,businessRegistration:P.target.value})),placeholder:"Enter registration number"})]})]}),a.jsx("div",{className:"form-row",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Monthly Revenue (R):"}),a.jsx("input",{type:"number",value:N.monthlyRevenue,onChange:P=>F(E=>({...E,monthlyRevenue:P.target.value})),placeholder:"Enter monthly revenue"})]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Loan Purpose"}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Purpose of Loan:"}),a.jsx("textarea",{value:N.loanPurpose,onChange:P=>F(E=>({...E,loanPurpose:P.target.value})),placeholder:"Describe how you will use the loan funds",rows:3})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>L(!1),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const E=await fetch("/api/lending/loans/apply",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({...N,reviewEmail:"loan@pezela.co.za",applicationDate:new Date().toISOString()})});if(E.ok){const _=await E.json();q(A=>[...A,_]),L(!1),console.log("Loan application submitted:",_)}}else{const E={id:`app-${Date.now()}`,...N,reviewEmail:"loan@pezela.co.za",status:"Under Review",applicationDate:new Date().toISOString(),estimatedDecision:new Date(Date.now()+6048e5).toISOString()};q(_=>[..._,E]),L(!1),console.log("Loan application submitted to loan@pezela.co.za:",E)}}catch(P){console.error("Error applying for loan:",P)}finally{b(!1)}},children:v?"Submitting...":"Submit Application"})]})]})]})]})]})]})},nD=({user:i,onLogout:e})=>{const[n,r]=X.useState("storefront"),[l,u]=X.useState(null),[f,p]=X.useState(null),[x,m]=X.useState(!1),[v,b]=X.useState(""),[S,I]=X.useState(null),[R,D]=X.useState([{id:"uber",name:"Uber Eats",status:"connected",commission:"15%"},{id:"bolt",name:"Bolt Food",status:"pending",commission:"12%"},{id:"mr-d",name:"Mr D Food",status:"disconnected",commission:"18%"}]),[k,q]=X.useState({uber:"connected",bolt:"pending","mr-d":"disconnected"}),[O,L]=X.useState(null),[N,F]=X.useState({});return X.useEffect(()=>{(async()=>{console.log("MarketplaceScreen useEffect running..."),m(!0);try{const E=window.location.hostname!=="localhost";if(console.log("Is production:",E),E){const _=await fetch("/api/marketplace/data",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(_.ok){const T=await _.json();u(T),p(T.stats)}const A=await fetch("/api/marketplace/storefront",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(A.ok){const T=await A.json();b(T.url),I(T.stats)}const w=await fetch("/api/marketplace/delivery-partners",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(w.ok){const T=await w.json();D(T.partners),q(T.status)}}else{u({platforms:[{id:"1",name:"Takealot",status:"active",products:45,sales:12500},{id:"2",name:"Bidorbuy",status:"active",products:32,sales:8500},{id:"3",name:"Facebook Marketplace",status:"pending",products:0,sales:0}],totalProducts:77,totalSales:21e3,activeListings:45}),p({totalRevenue:21e3,totalOrders:156,averageOrderValue:135,conversionRate:3.2}),b("https://storefront.pezela.co.za/business/12345"),I({views:1250,visitors:890,orders:45,revenue:15750});const _=[{id:"uber",name:"Uber Eats",status:"connected",commission:"15%"},{id:"bolt",name:"Bolt Food",status:"pending",commission:"12%"},{id:"mr-d",name:"Mr D Food",status:"disconnected",commission:"18%"}];console.log("Setting delivery partners:",_),D(_),q({uber:"connected",bolt:"pending","mr-d":"disconnected"})}}catch(E){console.error("Failed to load marketplace data:",E),console.log("Loading fallback delivery partners");const _=[{id:"uber",name:"Uber Eats",status:"connected",commission:"15%"},{id:"bolt",name:"Bolt Food",status:"pending",commission:"12%"},{id:"mr-d",name:"Mr D Food",status:"disconnected",commission:"18%"}];console.log("Setting fallback partners:",_),D(_),q({uber:"connected",bolt:"pending","mr-d":"disconnected"})}finally{m(!1)}})()},[]),a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsx("h1",{children:"Marketplace"}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"segmented-control",children:[a.jsx("button",{className:`segment ${n==="storefront"?"active":""}`,onClick:()=>r("storefront"),children:"Storefront"}),a.jsx("button",{className:`segment ${n==="delivery"?"active":""}`,onClick:()=>r("delivery"),children:"Delivery"})]}),n==="storefront"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Public Storefront"})}),a.jsx("div",{className:"card-list",children:a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:"Store URL"}),a.jsx("div",{className:"badge success",children:"Live"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"URL:"}),a.jsx("span",{className:"value",children:v||"https://storefront.pezela.co.za/business/12345"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Views:"}),a.jsxs("span",{className:"value",children:[S?.views||"1,250"," this month"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Visitors:"}),a.jsx("span",{className:"value",children:S?.visitors||"890"})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Orders:"}),a.jsx("span",{className:"value",children:S?.orders||"45"})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:async()=>{try{const P=window.location.hostname!=="localhost",E=v||"https://storefront.pezela.co.za/business/12345";P&&await fetch("/api/marketplace/storefront/view",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({action:"view",timestamp:new Date().toISOString()})}),window.open(E,"_blank"),console.log("Opening storefront:",E)}catch(P){console.error("Error opening storefront:",P);const E=v||"https://storefront.pezela.co.za/business/12345";window.open(E,"_blank")}},children:"View"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{const P=window.location.hostname!=="localhost",E=v||"https://storefront.pezela.co.za/business/12345";P&&await fetch("/api/marketplace/storefront/share",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({action:"share",timestamp:new Date().toISOString()})}),await navigator.clipboard.writeText(E),console.log("Storefront URL copied to clipboard:",E),alert("Storefront URL copied to clipboard!")}catch(P){console.error("Error sharing storefront:",P),alert(`Storefront URL: ${v||"https://storefront.pezela.co.za/business/12345"}`)}},children:"Share"})]})]})})]}),n==="delivery"&&a.jsxs("div",{className:"content-section",children:[a.jsx("div",{className:"section-header",children:a.jsx("h2",{children:"Delivery Partners"})}),a.jsx("div",{className:"card-list",children:R.length===0?a.jsx("div",{className:"card",children:a.jsx("div",{className:"card-content",children:a.jsx("p",{children:"No delivery partners available"})})}):R.map(P=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:P.name}),a.jsx("div",{className:`badge ${P.status==="connected"?"success":P.status==="pending"?"warning":"error"}`,children:P.status==="connected"?"Connected":P.status==="pending"?"Pending":"Disconnected"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:"value",children:k[P.id]||P.status})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Commission:"}),a.jsx("span",{className:"value",children:P.commission})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Last Sync:"}),a.jsx("span",{className:"value",children:new Date().toLocaleDateString()})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{L(P.id),F({[P.id]:{commission:P.commission,autoAccept:!0,deliveryRadius:15,workingHours:"08:00-20:00",maxOrders:50}})},children:"Configure"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(m(!0),window.location.hostname!=="localhost"){const _=await fetch(`/api/marketplace/delivery-partners/${P.id}/test`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({partnerId:P.id,partnerName:P.name,action:"test",testType:"connection",timestamp:new Date().toISOString()})});if(_.ok){const A=await _.json();console.log("Partner test result:",A);const w=A.success?"connected":"error";q(T=>({...T,[P.id]:w})),D(T=>T.map(U=>U.id===P.id?{...U,status:w,lastTested:new Date().toISOString(),testResult:A}:U)),alert(` ${P.name} Test Results:

Status: ${A.success?" PASSED":" FAILED"}
Response Time: ${A.responseTime||"N/A"}ms
API Status: ${A.apiStatus||"Unknown"}
Last Error: ${A.error||"None"}

${A.message||""}`)}else throw new Error(`Test failed: ${_.status}`)}else{console.log(`Testing ${P.name}...`),await new Promise(T=>setTimeout(T,2e3));const A={uber:{success:!0,responseTime:245,apiStatus:"healthy",error:null},bolt:{success:!1,responseTime:1200,apiStatus:"timeout",error:"Connection timeout"},"mr-d":{success:!0,responseTime:180,apiStatus:"healthy",error:null}}[P.id]||{success:Math.random()>.3,responseTime:Math.floor(Math.random()*1e3)+100,apiStatus:"unknown",error:null},w=A.success?"connected":"error";q(T=>({...T,[P.id]:w})),D(T=>T.map(U=>U.id===P.id?{...U,status:w,lastTested:new Date().toISOString(),testResult:A}:U)),alert(` ${P.name} Test Results:

Status: ${A.success?" PASSED":" FAILED"}
Response Time: ${A.responseTime}ms
API Status: ${A.apiStatus}
Last Error: ${A.error||"None"}

${A.success?"Connection successful. Partner is ready for orders.":"Connection failed. Please check configuration and try again."}`)}}catch(E){console.error("Error testing partner:",E),alert(` Error testing ${P.name}:
${E.message||"Please try again."}`)}finally{m(!1)}},children:x?"Testing...":"Test"})]})]},P.id))}),O&&a.jsxs("div",{className:"delivery-config-form",children:[a.jsxs("div",{className:"form-header",children:[a.jsxs("h3",{children:["Configure ",R.find(P=>P.id===O)?.name]}),a.jsx("button",{className:"close-btn",onClick:()=>L(null),children:""})]}),a.jsxs("div",{className:"form-content",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Partner Settings"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Commission Rate:"}),a.jsx("input",{type:"text",value:N[O]?.commission||"",onChange:P=>F(E=>({...E,[O]:{...E[O],commission:P.target.value}})),placeholder:"e.g., 15%"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Delivery Radius (km):"}),a.jsx("input",{type:"number",value:N[O]?.deliveryRadius||"",onChange:P=>F(E=>({...E,[O]:{...E[O],deliveryRadius:parseInt(P.target.value)}})),placeholder:"15"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Working Hours:"}),a.jsx("input",{type:"text",value:N[O]?.workingHours||"",onChange:P=>F(E=>({...E,[O]:{...E[O],workingHours:P.target.value}})),placeholder:"08:00-20:00"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Max Orders per Day:"}),a.jsx("input",{type:"number",value:N[O]?.maxOrders||"",onChange:P=>F(E=>({...E,[O]:{...E[O],maxOrders:parseInt(P.target.value)}})),placeholder:"50"})]})]}),a.jsx("div",{className:"form-row",children:a.jsx("div",{className:"form-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:N[O]?.autoAccept||!1,onChange:P=>F(E=>({...E,[O]:{...E[O],autoAccept:P.target.checked}}))}),"Auto Accept Orders"]})})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>L(null),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{m(!0);const P=window.location.hostname!=="localhost",E=R.find(_=>_.id===O);if(P){const _=await fetch(`/api/marketplace/delivery-partners/${O}/configure`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({partnerId:O,partnerName:E?.name,action:"configure",configuration:N[O],timestamp:new Date().toISOString()})});if(_.ok){const A=await _.json();console.log("Partner configured:",A),q(w=>({...w,[O]:"configured"})),D(w=>w.map(T=>T.id===O?{...T,status:"configured",lastConfigured:new Date().toISOString(),config:N[O]}:T)),L(null)}else throw new Error(`Configuration failed: ${_.status}`)}else console.log(`Configuring ${E?.name}...`),await new Promise(_=>setTimeout(_,1500)),q(_=>({..._,[O]:"configured"})),D(_=>_.map(A=>A.id===O?{...A,status:"configured",lastConfigured:new Date().toISOString(),config:N[O]}:A)),L(null)}catch(P){console.error("Error configuring partner:",P)}finally{m(!1)}},children:x?"Saving...":"Save Configuration"})]})]})]})]})]})]})},sD=({user:i,onLogout:e})=>{const[n,r]=X.useState("programs"),[l,u]=X.useState(null),[f,p]=X.useState([]),[x,m]=X.useState([]),[v,b]=X.useState(!1),[S,I]=X.useState(!1),[R,D]=X.useState({name:"",description:"",pointsPerRand:1,pointsToRedeem:100,discountPercent:10,validUntil:""}),[k,q]=X.useState(null),[O,L]=X.useState({}),[N,F]=X.useState(null),[P,E]=X.useState({});return X.useEffect(()=>{(async()=>{b(!0);try{{const w=await fetch("/api/loyalty/data",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`}});if(w.ok){const T=await w.json();u(T),p(T.programs||[]),m(T.coupons||[])}}}catch(A){console.error("Failed to load loyalty data:",A)}finally{b(!1)}})()},[]),a.jsxs("div",{className:"screen",children:[a.jsxs("div",{className:"screen-header",children:[a.jsx("h1",{children:"Loyalty & Coupons"}),a.jsx("button",{onClick:e,className:"logout-btn",children:"Logout"})]}),a.jsxs("div",{className:"screen-content",children:[a.jsxs("div",{className:"segmented-control",children:[a.jsx("button",{className:`segment ${n==="programs"?"active":""}`,onClick:()=>r("programs"),children:"Programs"}),a.jsx("button",{className:`segment ${n==="coupons"?"active":""}`,onClick:()=>r("coupons"),children:"Coupons"})]}),n==="programs"&&a.jsxs("div",{className:"content-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Loyalty Programs"}),a.jsx("button",{className:"primary-button",onClick:()=>I(!0),children:"Create Program"})]}),a.jsx("div",{className:"card-list",children:f.map(_=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-title",children:_.name}),a.jsx("div",{className:`badge ${_.status==="active"?"success":"warning"}`,children:_.status==="active"?"Active":"Inactive"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Members:"}),a.jsxs("span",{className:"value",children:[_.members," customers"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Points Required:"}),a.jsxs("span",{className:"value",children:[_.points," points"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Discount:"}),a.jsxs("span",{className:"value",children:[_.discount,"% off"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Created:"}),a.jsx("span",{className:"value",children:_.createdDate||"N/A"})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{F(_.id),E({[_.id]:{status:_.status,members:_.members,points:_.points,discount:_.discount,autoEnroll:!0,emailNotifications:!0,pushNotifications:!1}})},children:"Manage"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const w=await fetch(`/api/loyalty/programs/${_.id}/analytics`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"}});if(w.ok){const T=await w.json();console.log("Program analytics:",T),alert(` ${_.name} Analytics:

Performance Metrics:
- Total Members: ${T.totalMembers}
- Active Members: ${T.activeMembers}
- Points Issued: ${T.pointsIssued}
- Points Redeemed: ${T.pointsRedeemed}
- Revenue Generated: R${T.revenue}
- Conversion Rate: ${T.conversionRate}%
- Average Order Value: R${T.avgOrderValue}

Last Updated: ${new Date().toLocaleString()}`)}}else{console.log(`Getting analytics for ${_.name}...`),await new Promise(T=>setTimeout(T,1500));const w={totalMembers:_.members,activeMembers:Math.floor(_.members*.8),pointsIssued:Math.floor(Math.random()*5e3)+1e3,pointsRedeemed:Math.floor(Math.random()*3e3)+500,revenue:Math.floor(Math.random()*5e3)+2e3,conversionRate:Math.floor(Math.random()*20)+10,avgOrderValue:Math.floor(Math.random()*200)+100};alert(` ${_.name} Analytics:

Performance Metrics:
- Total Members: ${w.totalMembers}
- Active Members: ${w.activeMembers}
- Points Issued: ${w.pointsIssued}
- Points Redeemed: ${w.pointsRedeemed}
- Revenue Generated: R${w.revenue}
- Conversion Rate: ${w.conversionRate}%
- Average Order Value: R${w.avgOrderValue}

Last Updated: ${new Date().toLocaleString()}`)}}catch(A){console.error("Error getting analytics:",A),alert(` Error getting analytics for ${_.name}:
${A.message||"Please try again."}`)}finally{b(!1)}},children:v?"Loading...":"Analytics"})]})]},_.id))}),S&&a.jsxs("div",{className:"loyalty-program-form",children:[a.jsxs("div",{className:"form-header",children:[a.jsx("h3",{children:"Create New Loyalty Program"}),a.jsx("button",{className:"close-btn",onClick:()=>I(!1),children:""})]}),a.jsxs("div",{className:"form-content",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Program Details"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Program Name:"}),a.jsx("input",{type:"text",value:R.name,onChange:_=>D(A=>({...A,name:_.target.value})),placeholder:"e.g., VIP Customer Program"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Description:"}),a.jsx("input",{type:"text",value:R.description,onChange:_=>D(A=>({...A,description:_.target.value})),placeholder:"Program description"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Points per Rand:"}),a.jsx("input",{type:"number",value:R.pointsPerRand,onChange:_=>D(A=>({...A,pointsPerRand:parseInt(_.target.value)})),placeholder:"1"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Points to Redeem:"}),a.jsx("input",{type:"number",value:R.pointsToRedeem,onChange:_=>D(A=>({...A,pointsToRedeem:parseInt(_.target.value)})),placeholder:"100"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Discount Percentage:"}),a.jsx("input",{type:"number",value:R.discountPercent,onChange:_=>D(A=>({...A,discountPercent:parseInt(_.target.value)})),placeholder:"10"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Valid Until:"}),a.jsx("input",{type:"date",value:R.validUntil,onChange:_=>D(A=>({...A,validUntil:_.target.value}))})]})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>I(!1),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const A=await fetch("/api/loyalty/programs/create",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({...R,timestamp:new Date().toISOString()})});if(A.ok){const w=await A.json();console.log("Program created:",w),p(T=>[...T,{id:w.id,name:R.name,points:R.pointsToRedeem,discount:R.discountPercent,members:0,status:"active",createdDate:new Date().toISOString().split("T")[0]}]),I(!1),D({name:"",description:"",pointsPerRand:1,pointsToRedeem:100,discountPercent:10,validUntil:""})}}else console.log("Creating new program..."),await new Promise(A=>setTimeout(A,2e3)),p(A=>[...A,{id:`program-${Date.now()}`,name:R.name,points:R.pointsToRedeem,discount:R.discountPercent,members:0,status:"active",createdDate:new Date().toISOString().split("T")[0]}]),I(!1),D({name:"",description:"",pointsPerRand:1,pointsToRedeem:100,discountPercent:10,validUntil:""})}catch(_){console.error("Error creating program:",_)}finally{b(!1)}},children:v?"Creating...":"Create Program"})]})]})]}),N&&a.jsxs("div",{className:"program-management-form",children:[a.jsxs("div",{className:"form-header",children:[a.jsxs("h3",{children:["Manage Program: ",f.find(_=>_.id===N)?.name]}),a.jsx("button",{className:"close-btn",onClick:()=>F(null),children:""})]}),a.jsxs("div",{className:"form-content",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Program Settings"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Program Status:"}),a.jsxs("select",{value:P[N]?.status||"active",onChange:_=>E(A=>({...A,[N]:{...A[N],status:_.target.value}})),children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"paused",children:"Paused"})]})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Points Required:"}),a.jsx("input",{type:"number",value:P[N]?.points||"",onChange:_=>E(A=>({...A,[N]:{...A[N],points:parseInt(_.target.value)}})),placeholder:"100"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Discount Percentage:"}),a.jsx("input",{type:"number",value:P[N]?.discount||"",onChange:_=>E(A=>({...A,[N]:{...A[N],discount:parseInt(_.target.value)}})),placeholder:"10"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Member Count:"}),a.jsx("input",{type:"number",value:P[N]?.members||"",onChange:_=>E(A=>({...A,[N]:{...A[N],members:parseInt(_.target.value)}})),placeholder:"0",readOnly:!0})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Notification Settings"}),a.jsxs("div",{className:"form-row",children:[a.jsx("div",{className:"form-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:P[N]?.autoEnroll||!1,onChange:_=>E(A=>({...A,[N]:{...A[N],autoEnroll:_.target.checked}}))}),"Auto Enroll New Customers"]})}),a.jsx("div",{className:"form-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:P[N]?.emailNotifications||!1,onChange:_=>E(A=>({...A,[N]:{...A[N],emailNotifications:_.target.checked}}))}),"Email Notifications"]})})]}),a.jsx("div",{className:"form-row",children:a.jsx("div",{className:"form-field",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:P[N]?.pushNotifications||!1,onChange:_=>E(A=>({...A,[N]:{...A[N],pushNotifications:_.target.checked}}))}),"Push Notifications"]})})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>F(null),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{b(!0);const _=window.location.hostname!=="localhost",A=f.find(w=>w.id===N);if(_){const w=await fetch(`/api/loyalty/programs/${N}/manage`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({...P[N],programId:N,programName:A?.name,timestamp:new Date().toISOString()})});if(w.ok){const T=await w.json();console.log("Program managed:",T),p(U=>U.map(B=>B.id===N?{...B,...P[N]}:B)),F(null)}}else console.log(`Managing ${A?.name}...`),await new Promise(w=>setTimeout(w,1500)),p(w=>w.map(T=>T.id===N?{...T,...P[N]}:T)),F(null)}catch(_){console.error("Error managing program:",_)}finally{b(!1)}},children:v?"Saving...":"Save Management Settings"})]})]})]})]}),n==="coupons"&&a.jsxs("div",{className:"content-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Coupons & Discounts"}),a.jsx("button",{className:"primary-button",children:"Create Coupon"})]}),a.jsx("div",{className:"card-list",children:x.map(_=>a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"card-title",children:[_.discount,"% Off Coupon"]}),a.jsx("div",{className:`badge ${_.status==="active"?"success":"warning"}`,children:_.status==="active"?"Active":"Inactive"})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Code:"}),a.jsx("span",{className:"value",children:_.code})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Uses:"}),a.jsxs("span",{className:"value",children:[_.uses,"/",_.maxUses]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Valid Until:"}),a.jsx("span",{className:"value",children:_.validUntil})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Type:"}),a.jsx("span",{className:"value",children:_.type||"percentage"})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>{q(_.id),L({[_.id]:{code:_.code,discount:_.discount,maxUses:_.maxUses,validUntil:_.validUntil,type:_.type||"percentage"}})},children:"Edit"}),a.jsx("button",{className:"secondary-button",onClick:async()=>{try{if(window.location.hostname!=="localhost"){const w=await fetch(`/api/loyalty/coupons/${_.id}/share`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({couponId:_.id,action:"share",timestamp:new Date().toISOString()})});if(w.ok){const T=await w.json();console.log("Coupon shared:",T),await navigator.clipboard.writeText(T.shareUrl),alert(` ${_.code} coupon shared successfully!

Share URL copied to clipboard:
${T.shareUrl}

Share Details:
- Code: ${_.code}
- Discount: ${_.discount}%
- Valid Until: ${_.validUntil}
- Remaining Uses: ${_.maxUses-_.uses}`)}}else{console.log(`Sharing ${_.code}...`);const w=`https://storefront.pezela.co.za/coupon/${_.code}`;await navigator.clipboard.writeText(w),alert(` ${_.code} coupon shared successfully!

Share URL copied to clipboard:
${w}

Share Details:
- Code: ${_.code}
- Discount: ${_.discount}%
- Valid Until: ${_.validUntil}
- Remaining Uses: ${_.maxUses-_.uses}
- Share URL: ${w}`)}}catch(A){console.error("Error sharing coupon:",A),alert(` Error sharing ${_.code}:
${A.message||"Please try again."}`)}},children:"Share"})]})]},_.id))}),k&&a.jsxs("div",{className:"coupon-edit-form",children:[a.jsxs("div",{className:"form-header",children:[a.jsxs("h3",{children:["Edit Coupon: ",x.find(_=>_.id===k)?.code]}),a.jsx("button",{className:"close-btn",onClick:()=>q(null),children:""})]}),a.jsxs("div",{className:"form-content",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Coupon Settings"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Coupon Code:"}),a.jsx("input",{type:"text",value:O[k]?.code||"",onChange:_=>L(A=>({...A,[k]:{...A[k],code:_.target.value}})),placeholder:"e.g., SAVE10"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Discount (%):"}),a.jsx("input",{type:"number",value:O[k]?.discount||"",onChange:_=>L(A=>({...A,[k]:{...A[k],discount:parseInt(_.target.value)}})),placeholder:"10"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Max Uses:"}),a.jsx("input",{type:"number",value:O[k]?.maxUses||"",onChange:_=>L(A=>({...A,[k]:{...A[k],maxUses:parseInt(_.target.value)}})),placeholder:"100"})]}),a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Valid Until:"}),a.jsx("input",{type:"date",value:O[k]?.validUntil||"",onChange:_=>L(A=>({...A,[k]:{...A[k],validUntil:_.target.value}}))})]})]}),a.jsx("div",{className:"form-row",children:a.jsxs("div",{className:"form-field",children:[a.jsx("label",{children:"Coupon Type:"}),a.jsxs("select",{value:O[k]?.type||"percentage",onChange:_=>L(A=>({...A,[k]:{...A[k],type:_.target.value}})),children:[a.jsx("option",{value:"percentage",children:"Percentage"}),a.jsx("option",{value:"fixed",children:"Fixed Amount"}),a.jsx("option",{value:"shipping",children:"Free Shipping"})]})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"secondary-button",onClick:()=>q(null),children:"Cancel"}),a.jsx("button",{className:"primary-button",onClick:async()=>{try{if(b(!0),window.location.hostname!=="localhost"){const A=await fetch(`/api/loyalty/coupons/${k}/update`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")}`,"Content-Type":"application/json"},body:JSON.stringify({...O[k],timestamp:new Date().toISOString()})});if(A.ok){const w=await A.json();console.log("Coupon updated:",w),m(T=>T.map(U=>U.id===k?{...U,...O[k]}:U)),q(null)}}else console.log("Updating coupon..."),await new Promise(A=>setTimeout(A,1500)),m(A=>A.map(w=>w.id===k?{...w,...O[k]}:w)),q(null)}catch(_){console.error("Error updating coupon:",_)}finally{b(!1)}},children:v?"Saving...":"Save Changes"})]})]})]})]})]})]})};KS.createRoot(document.getElementById("root")).render(a.jsx(LS.StrictMode,{children:a.jsx(QR,{})}));
